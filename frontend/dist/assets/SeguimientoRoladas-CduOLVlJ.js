import{o as _e,a as R,c as A,b as t,t as l,e as Tt,f as et,q as Te,u as Ee,F as Z,r as ht,A as jt,i as Ce,n as Et,d as u,m as M,p as ct,z as Oe}from"./index-DYTbJAB1.js";import{_ as Fe}from"./LogoSantana-C2JneU89.js";import{e as te}from"./exceljs.min-DtXTVuKQ.js";import{h as ee}from"./html2canvas.esm-BfYXEYrK.js";import{S as K}from"./sweetalert2.esm.all-AlKuj1Cq.js";import{C as we}from"./CustomDatepicker-0U2xKFTQ.js";import{_ as Me}from"./_plugin-vue_export-helper-DlAUqK2U.js";const De={class:"w-full h-screen flex flex-col p-1"},Ie={key:0,class:"absolute inset-0 bg-white/60 backdrop-blur-[1px] flex items-center justify-center z-50 rounded-xl"},Se={class:"flex flex-col items-center gap-3"},Le={class:"flex flex-col items-center"},Ue={class:"text-sm text-slate-600 font-medium mt-0.5"},ke={class:"flex items-center justify-between gap-4 flex-shrink-0 mb-3 pb-3 border-b border-slate-100"},Pe={class:"flex items-center gap-5"},$e={class:"flex items-center gap-1.5 px-2.5 py-1 bg-slate-100 rounded-md ml-2"},Ne={class:"text-sm font-semibold text-slate-700 tabular-nums"},ze={class:"flex items-center gap-2"},Be={class:"flex items-center gap-1.5"},He=["disabled"],Ve={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ge={key:1,class:"h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},je=["disabled"],Je=["disabled"],Qe={class:"px-3 py-2.5 font-semibold text-slate-800 text-center tabular-nums border-r-2 border-slate-300 bg-slate-50/50"},qe={class:"px-2 py-2.5 text-center text-slate-600 tabular-nums border-r border-slate-200"},We={class:"px-2 py-2.5 text-center text-slate-600 tabular-nums border-r border-slate-200"},Ye=["onClick"],Ze=["onClick"],Ke=["onClick"],Xe=["onClick"],tr=["onClick"],er=["onClick"],rr=["onClick"],or=["onClick"],ar=["onClick"],lr=["onClick"],sr=["onClick"],dr=["onClick"],nr=["onClick"],ir=["onClick"],cr=["onClick"],br=["onClick"],pr={key:0,class:"sticky bottom-0 z-10 bg-slate-100"},ur={class:"font-semibold text-slate-700"},xr={class:"px-3 py-3 text-center border-l border-l-slate-200 border-r border-slate-200 border-t-2 border-t-slate-300",colspan:"3"},gr={class:"ml-2 text-slate-700"},hr={class:"px-2 py-3 text-center text-emerald-600 font-semibold tabular-nums border-r-2 border-slate-300 border-t-2 border-t-slate-300"},fr={class:"px-2 py-3 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},mr={class:"px-2 py-3 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},Rr={class:"px-2 py-3 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},Ar={class:"px-2 py-3 text-center tabular-nums border-r-2 border-slate-300 border-t-2 border-t-slate-300"},vr={class:"px-2 py-3 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},yr={class:"px-2 py-3 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},_r={class:"px-2 py-3 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},Tr={class:"px-2 py-3 text-center tabular-nums border-r-2 border-slate-300 border-t-2 border-t-slate-300"},Er={class:"px-2 py-3 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},Cr={class:"px-2 py-3 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},Or={class:"px-2 py-3 text-center tabular-nums border-t-2 border-t-slate-300"},Fr={key:0,class:"flex items-center justify-center h-64 bg-white"},wr={class:"bg-white rounded-xl shadow-2xl w-[calc(100vw-8px)] h-[calc(100vh-8px)] flex flex-col overflow-hidden border border-slate-300"},Mr={class:"flex items-center justify-between px-5 py-3 bg-white"},Dr={class:"flex items-center gap-4"},Ir={class:"flex items-center"},Sr={class:"text-base font-semibold text-slate-800"},Lr={class:"text-xs text-slate-500"},Ur={class:"flex items-center"},kr=["disabled"],Pr=["disabled"],$r={class:"flex items-center gap-2"},Nr=["disabled"],zr=["disabled"],Br=["disabled"],Hr={key:0,class:"flex-1 flex items-center justify-center py-20"},Vr={class:"w-full text-[13px] text-slate-700 border-separate border-spacing-0"},Gr={class:"px-2 py-2.5 font-semibold text-slate-800 text-center bg-slate-50/50"},jr={class:"px-2 py-2.5 text-center text-slate-500 text-xs border-r border-slate-200"},Jr={class:"px-2 py-2.5 text-center text-slate-600 tabular-nums border-r border-slate-200"},Qr={class:"px-2 py-2.5 text-center text-slate-500 text-xs border-r border-slate-200"},qr={class:"px-2 py-2.5 text-center text-slate-600 tabular-nums border-r border-slate-200"},Wr={class:"px-2 py-2.5 text-center text-slate-700 border-r border-slate-200"},Yr={class:"px-2 py-2.5 text-center font-medium text-slate-700 tabular-nums border-r border-slate-200"},Zr={class:"px-2 py-2.5 text-center text-slate-600 tabular-nums border-r border-slate-200"},Kr={class:"px-2 py-2.5 text-center font-semibold text-amber-600 border-r border-slate-200"},Xr={class:"px-2 py-2.5 text-center text-slate-600 tabular-nums border-r border-slate-200"},to={class:"px-2 py-2.5 text-center text-slate-600 tabular-nums border-r border-slate-200"},eo={class:"px-2 py-2.5 text-center text-slate-600 tabular-nums border-r border-slate-200"},ro={class:"px-2 py-2.5 text-center font-medium text-red-600 tabular-nums border-r border-slate-200"},oo={class:"px-2 py-2.5 text-center text-purple-600 tabular-nums border-r border-slate-200"},ao={class:"px-2 py-2.5 text-center text-slate-600 border-r border-slate-200"},lo={class:"px-2 py-2.5 text-center text-slate-600 border-r border-slate-200"},so={class:"px-2 py-2.5 text-center text-slate-600 border-r border-slate-200"},no={class:"px-2 py-2.5 text-center text-slate-700"},io={class:"sticky bottom-0 z-10 bg-slate-100"},co={class:"font-semibold text-slate-700"},bo={class:"px-2 py-3 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},po={class:"px-2 py-3 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},uo={class:"px-2 py-3 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},xo={class:"px-2 py-3 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},go={class:"px-2 py-3 text-center tabular-nums text-red-600 border-r border-slate-200 border-t-2 border-t-slate-300"},ho={key:1,class:"flex-1 flex items-center justify-center py-20 text-slate-500"},fo={class:"text-center"},mo={class:"text-sm text-slate-400"},Ro={class:"w-full text-[13px] text-slate-700 border-separate border-spacing-0"},Ao={class:"px-3 py-2.5 font-semibold text-slate-800"},vo={class:"px-3 py-2.5 text-center text-slate-500 text-xs"},yo={class:"px-3 py-2.5 text-center text-slate-600 tabular-nums"},_o={class:"px-3 py-2.5 text-center text-slate-500 text-xs"},To={class:"px-3 py-2.5 text-center text-slate-600 tabular-nums"},Eo={class:"px-3 py-2.5 text-center font-semibold text-blue-600"},Co={class:"px-3 py-2.5 text-slate-700"},Oo={class:"px-3 py-2.5 text-slate-600"},Fo={class:"px-3 py-2.5 text-right font-medium text-slate-700 tabular-nums"},wo={class:"px-3 py-2.5 text-center text-slate-600 tabular-nums"},Mo={class:"px-3 py-2.5 text-center text-slate-600"},Do={class:"px-3 py-2.5 text-right text-purple-600 tabular-nums"},Io={class:"px-3 py-2.5 text-right text-red-600 tabular-nums"},So={class:"px-3 py-2.5 text-center text-slate-600 tabular-nums"},Lo={class:"px-3 py-2.5 text-slate-600"},Uo={class:"sticky bottom-0 z-10 bg-slate-100"},ko={class:"font-semibold text-slate-700"},Po={class:"px-3 py-3 text-right tabular-nums border-t-2 border-t-slate-300"},$o={class:"px-3 py-3 text-right text-purple-700 tabular-nums border-t-2 border-t-slate-300"},No={class:"px-3 py-3 text-right text-red-700 tabular-nums border-t-2 border-t-slate-300"},zo={class:"px-3 py-3 text-center tabular-nums border-t-2 border-t-slate-300"},Bo={key:1,class:"flex-1 flex items-center justify-center py-20 text-slate-500"},Ho={class:"text-center"},Vo={class:"text-sm text-slate-400"},Go={class:"w-full text-[13px] text-slate-700 border-separate border-spacing-0"},jo=["onClick"],Jo={class:"px-3 py-2.5 font-semibold text-slate-800"},Qo={class:"px-3 py-2.5 text-center text-slate-500 text-xs"},qo={class:"px-3 py-2.5 text-center text-slate-500 text-xs"},Wo={class:"px-3 py-2.5 text-right font-medium text-slate-700 tabular-nums"},Yo={class:"px-3 py-2.5 text-center font-semibold text-purple-600"},Zo={class:"px-3 py-2.5 text-right text-green-600 tabular-nums"},Ko={class:"px-3 py-2.5 text-right text-orange-600 tabular-nums"},Xo={class:"px-3 py-2.5 text-right text-red-600 tabular-nums"},ta={class:"px-3 py-2.5 text-slate-700"},ea={class:"px-3 py-2.5 text-center text-slate-600"},ra={class:"px-3 py-2.5 text-slate-600"},oa={class:"px-3 py-2.5 text-slate-600"},aa={class:"px-3 py-2.5 text-right text-slate-600 tabular-nums"},la={class:"px-3 py-2.5 text-right text-slate-700 tabular-nums"},sa={class:"sticky bottom-0 z-10 bg-purple-100"},da={class:"font-semibold text-slate-700"},na={class:"px-3 py-3 text-right tabular-nums border-t-2 border-t-slate-300"},ia={class:"px-3 py-3 text-right text-green-700 tabular-nums border-t-2 border-t-slate-300"},ca={class:"px-3 py-3 text-right text-orange-700 tabular-nums border-t-2 border-t-slate-300"},ba={class:"px-3 py-3 text-right text-red-700 tabular-nums border-t-2 border-t-slate-300"},pa={class:"px-3 py-3 text-right tabular-nums border-t-2 border-t-slate-300"},ua={class:"px-3 py-3 text-right tabular-nums border-t-2 border-t-slate-300"},xa={key:1,class:"flex-1 flex items-center justify-center py-20 text-slate-500"},ga={class:"text-center"},ha={class:"text-sm text-slate-400"},fa={class:"bg-purple-50 border-b border-purple-200 px-4 py-3 m-3 mb-0 rounded-t-lg"},ma={class:"flex items-center gap-4"},Ra={class:"flex-1 grid grid-cols-6 gap-4 text-sm"},Aa={class:"ml-1 font-bold text-slate-800"},va={class:"ml-1 font-bold text-slate-800"},ya={class:"ml-1 text-slate-700"},_a={class:"ml-1 font-bold text-purple-700"},Ta={class:"ml-1 text-slate-700"},Ea={class:"ml-1 text-slate-700"},Ca={key:0,class:"flex-1 flex items-center justify-center"},Oa={key:1,class:"overflow-auto bg-white mx-3 mb-3 rounded-b-lg border border-t-0 border-slate-300",style:{flex:"0 1 auto","max-height":"calc(100vh - 200px)"}},Fa={class:"w-full text-[13px] text-slate-700 border-separate border-spacing-0"},wa={class:"px-3 py-2.5 text-center text-slate-600"},Ma={class:"px-3 py-2.5 text-center font-semibold text-slate-800"},Da={class:"px-3 py-2.5 font-semibold text-slate-800"},Ia={class:"px-3 py-2.5 text-right text-slate-700 tabular-nums"},Sa={class:"px-3 py-2.5 text-right text-slate-700 tabular-nums"},La={class:"px-3 py-2.5 text-right font-medium text-slate-700 tabular-nums"},Ua={class:"px-3 py-2.5 text-center text-slate-600 tabular-nums"},ka={class:"px-3 py-2.5 text-center text-slate-600 tabular-nums"},Pa={class:"px-3 py-2.5 text-center font-medium text-slate-700 tabular-nums"},$a={class:"px-3 py-2.5 text-right text-green-600 tabular-nums"},Na={class:"px-3 py-2.5 text-right text-orange-600 tabular-nums"},za={class:"px-3 py-2.5 text-right text-red-600 tabular-nums"},Ba={class:"px-3 py-2.5 text-right text-slate-700 tabular-nums"},Ha={class:"sticky bottom-0 z-10 bg-purple-100"},Va={class:"font-semibold text-slate-700"},Ga={class:"px-3 py-3 text-right tabular-nums border-t-2 border-t-slate-300"},ja={class:"px-3 py-3 text-center tabular-nums border-t-2 border-t-slate-300"},Ja={class:"px-3 py-3 text-center tabular-nums border-t-2 border-t-slate-300"},Qa={class:"px-3 py-3 text-center tabular-nums border-t-2 border-t-slate-300"},qa={class:"px-3 py-3 text-right text-green-700 tabular-nums border-t-2 border-t-slate-300"},Wa={class:"px-3 py-3 text-right text-orange-700 tabular-nums border-t-2 border-t-slate-300"},Ya={class:"px-3 py-3 text-right text-red-700 tabular-nums border-t-2 border-t-slate-300"},Za={class:"px-3 py-3 text-right tabular-nums border-t-2 border-t-slate-300"},Ka={key:2,class:"flex-1 flex items-center justify-center py-20 text-slate-500"},Xa={class:"w-full text-[12px] text-slate-700 border-separate border-spacing-0"},tl=["onClick"],el={class:"px-2 py-2 font-semibold text-slate-800 text-center border-r border-slate-200 bg-slate-50/50"},rl={class:"px-2 py-2 text-center text-slate-600 border-r border-slate-200"},ol={class:"px-2 py-2 text-center font-semibold text-teal-600 border-r-2 border-slate-300"},al={class:"px-2 py-2 text-center tabular-nums text-slate-700 border-r border-slate-200"},ll={class:"px-2 py-2 text-center tabular-nums text-slate-700 border-r border-slate-200"},sl={class:"px-2 py-2 text-center tabular-nums text-slate-700 border-r border-slate-200"},dl={class:"px-2 py-2 text-center tabular-nums text-slate-600 border-r border-slate-200"},nl={class:"px-2 py-2 text-center tabular-nums text-slate-600 border-r border-slate-200"},il={class:"px-2 py-2 text-center tabular-nums text-slate-600 border-r border-slate-200"},cl={class:"px-2 py-2 text-center tabular-nums text-slate-600 border-r-2 border-slate-300"},bl={class:"px-2 py-2 text-center tabular-nums text-green-600 border-r border-slate-200"},pl={class:"px-2 py-2 text-center tabular-nums text-amber-600 border-r border-slate-200"},ul={class:"px-2 py-2 text-center tabular-nums text-slate-500 border-r border-slate-200"},xl={class:"px-2 py-2 text-center tabular-nums text-slate-500 border-r border-slate-200"},gl={class:"px-2 py-2 text-center tabular-nums text-slate-500 border-r border-slate-200"},hl={class:"px-2 py-2 text-center tabular-nums text-slate-500 border-r-2 border-slate-300"},fl={class:"px-2 py-2 text-center text-slate-700 border-r border-slate-200"},ml={class:"px-2 py-2 text-center text-slate-600 border-r border-slate-200"},Rl={class:"px-2 py-2 text-center text-slate-600 border-r border-slate-200"},Al={class:"px-2 py-2 text-center text-slate-600"},vl={class:"sticky bottom-0 z-10 bg-slate-100"},yl={class:"font-semibold text-slate-700"},_l={class:"px-2 py-3 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},Tl={class:"px-2 py-3 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},El={class:"px-2 py-3 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},Cl={class:"px-2 py-3 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},Ol={class:"px-2 py-3 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},Fl={class:"px-2 py-3 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},wl={class:"px-2 py-3 text-center tabular-nums border-r-2 border-slate-300 border-t-2 border-t-slate-300"},Ml={class:"px-2 py-3 text-center text-green-700 tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},Dl={class:"px-2 py-3 text-center text-amber-700 tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},Il={class:"px-2 py-3 text-center tabular-nums text-slate-500 border-r border-slate-200 border-t-2 border-t-slate-300"},Sl={class:"px-2 py-3 text-center tabular-nums text-slate-500 border-r border-slate-200 border-t-2 border-t-slate-300"},Ll={class:"px-2 py-3 text-center tabular-nums text-slate-500 border-r border-slate-200 border-t-2 border-t-slate-300"},Ul={class:"px-2 py-3 text-center tabular-nums text-slate-500 border-r-2 border-slate-300 border-t-2 border-t-slate-300"},kl={key:1,class:"flex-1 flex items-center justify-center py-20 text-slate-500"},Pl={class:"text-center"},$l={class:"text-sm text-slate-400"},Nl={class:"bg-teal-50 border-b border-teal-200 px-4 py-3 m-3 mb-0 rounded-t-lg"},zl={class:"flex items-center gap-4"},Bl={class:"flex-1 grid grid-cols-5 gap-4 text-sm"},Hl={class:"ml-1 font-bold text-slate-800"},Vl={class:"ml-1 font-bold text-slate-800"},Gl={class:"ml-1 text-slate-700"},jl={class:"ml-1 font-bold text-teal-700"},Jl={class:"ml-1 text-slate-700"},Ql={key:0,class:"flex-1 flex items-center justify-center"},ql={key:1,class:"overflow-auto bg-white mx-3 mb-3 rounded-b-lg border border-t-0 border-slate-300",style:{flex:"0 1 auto","max-height":"calc(100vh - 200px)"}},Wl={class:"w-full text-[12px] text-slate-700 border-separate border-spacing-0"},Yl={class:"px-2 py-2 text-left"},Zl={class:"px-2 py-2 text-left"},Kl={class:"px-2 py-2 text-left"},Xl={class:"px-2 py-2 text-right tabular-nums"},ts={class:"px-2 py-2 text-center"},es={class:"px-2 py-2 text-center"},rs={class:"px-2 py-2 text-center"},os={class:"px-2 py-2 text-center"},as={class:"px-2 py-2 text-center"},ls={class:"px-2 py-2 text-right tabular-nums"},ss={class:"px-2 py-2 text-right tabular-nums border-r border-slate-200"},ds={class:"px-2 py-2 text-left"},ns={key:2,class:"flex-1 flex items-center justify-center py-20 text-slate-500"},is={__name:"SeguimientoRoladas",setup(cs){const Jt="".replace(/\/$/,""),pt=Jt?`${Jt}/api`:"/api",Ct=M(!1),vt=M(!1),Ft=M(!1),k=M([]),p=M(null),ft=M(15),bt=M(""),wt=M(!1),Mt=M(!1),$=M(null),mt=M(0),ut=M([]),h=M("indigo"),V=M([]),Dt=M(!1),rt=M([]),It=M(!1),G=M([]),St=M(!1),j=M(!1),N=M(null),z=M([]),Lt=M(!1),lt=M(!1),st=M(null),W=M([]),Ut=M(!1),re=M(null),Qt=M(null),qt=M(null),oe=M(null),Wt=M(null),ae=M(null),le=M(null),i=(a,e=0)=>{if(a==null||a==="")return"-";const d=Number(a);if(isNaN(d))return"-";const c=d.toFixed(e),[x,g]=c.split("."),_=x.replace(/\B(?=(\d{3})+(?!\d))/g,".");return g?`${_},${g}`:_},xt=a=>{if(!a||a==="")return"-";const e=a.split(",").map(x=>x.trim()).filter(x=>x!=="");if(e.length===0)return"-";if(e.length===1)return e[0];if(e.length===2)return e.join(" y ");const d=e.slice(-2).join(" y ");return e.slice(0,-2).join(", ")+", "+d},v=a=>a==null||a===""?"":new Intl.NumberFormat("es-ES",{minimumFractionDigits:0,maximumFractionDigits:2}).format(a),Yt=(a,e)=>{if(!e||e===0)return"";const d=a*1e3/e;return new Intl.NumberFormat("es-ES",{minimumFractionDigits:1,maximumFractionDigits:1}).format(d)},ot=a=>{if(a==null||a==="")return"-";const e=parseFloat(a);return isNaN(e)?"-":Math.round(e)},dt=(a,e,d)=>{if(a==null||a==="")return"-";const c=parseFloat(a)||0,x=parseFloat(e)||0,g=parseFloat(d)||0;if(x===0||g===0)return"-";if(c===0)return"0,0";const _=c*1e6/(x*g);return new Intl.NumberFormat("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2}).format(_)},Rt=a=>{if(!a)return"";try{const e=a.trim().split(" ");if(e.length<2)return a;const d=e[0],c=e[1];let x,g,_;if(d.includes("/")){const U=d.split("/");x=U[0],g=U[1],_=U[2]}else if(d.includes("-")){const U=d.split("-");_=U[0],g=U[1],x=U[2]}else return a;const f=_.slice(-2),n=c.split(":"),O=n[0],I=n[1];return`${x}/${g}/${f} ${O}:${I}`}catch{return a}},tt=ct(()=>{if(ut.value.length===0)return[];const a={};return ut.value.forEach(e=>{const d=e.PARTIDA;a[d]||(a[d]=[]),a[d].push(e)}),Object.keys(a).map(e=>{const d=a[e];if(d.length===1)return d[0];d.sort((n,O)=>{const I=`${n.DT_INICIO} ${n.HORA_INICIO}`,U=`${O.DT_INICIO} ${O.HORA_INICIO}`;return I.localeCompare(U)});const c=d[0],x=d[d.length-1],g=d.reduce((n,O)=>n+(parseFloat(O.METRAGEM)||0),0),_=d.reduce((n,O)=>n+(parseInt(O.RUPTURAS)||0),0),f=d.reduce((n,O)=>n+(parseFloat(O.CAVALOS)||0),0);return{PARTIDA:e,DT_INICIO:c.DT_INICIO,HORA_INICIO:c.HORA_INICIO,DT_FINAL:x.DT_FINAL,HORA_FINAL:x.HORA_FINAL,TURNO:c.TURNO,ARTIGO:c.ARTIGO,COR:c.COR,METRAGEM:g,VELOC:c.VELOC,S:c.S,RUPTURAS:_,CAVALOS:f,NM_OPERADOR:c.NM_OPERADOR}})}),B=ct(()=>tt.value.reduce((a,e)=>(a.metros+=parseFloat(e.METRAGEM)||0,a.roturas+=parseInt(e.RUPTURAS)||0,a.cv+=parseFloat(e.CAVALOS)||0,a),{metros:0,roturas:0,cv:0})),at=ct(()=>G.value.reduce((a,e)=>(a.metros+=parseFloat(e.METRAGEM)||0,a.rupFiacao+=parseFloat(e.RUP_FIACAO)||0,a.rupUrd+=parseFloat(e.RUP_URD)||0,a.rupOper+=parseFloat(e.RUP_OPER)||0,a.rupturas+=parseFloat(e.RUPTURAS)||0,a),{metros:0,rupFiacao:0,rupUrd:0,rupOper:0,rupturas:0})),L=ct(()=>{let a=0,e=0,d=0,c=0,x=0,g=0,_=0;return V.value.forEach(f=>{const n=parseFloat(f.METRAGEM)||0;a+=n,e+=(parseFloat(f.EFICIENCIA)||0)*n,d+=(parseFloat(f.ROTURAS_TRA_105)||0)*n,c+=(parseFloat(f.ROTURAS_URD_105)||0)*n,x+=(parseFloat(f.RPM)||0)*n,g+=parseFloat(f.PASADAS)||0,_++}),{metros:a,eficiencia:a>0?e/a:0,roturasTra:a>0?d/a:0,roturasUrd:a>0?c/a:0,rpm:a>0?x/a:0,pasadas:_>0?g/_:0}}),S=ct(()=>{let a=0,e=0,d=0,c=0,x=0,g=0,_=0,f=0,n=0;return z.value.forEach(O=>{const I=parseFloat(O.METRAGEM)||0;a+=I,e+=parseInt(O.PARADA_TRAMA)||0,d+=parseInt(O.PARADA_URDUME)||0,c+=(parseFloat(O.EFICIENCIA)||0)*I,x+=(parseFloat(O.ROTURAS_TRA_105)||0)*I,g+=(parseFloat(O.ROTURAS_URD_105)||0)*I,_+=(parseFloat(O.RPM)||0)*I,f+=parseFloat(O.BATIDAS)||0,n++}),{metros:a,paradasTrama:e,paradasUrdumbre:d,totalParadas:e+d,eficiencia:a>0?c/a:0,roturasTra:a>0?x/a:0,roturasUrd:a>0?g/a:0,rpm:a>0?_/a:0,pasadas:n>0?f/n:0}}),gt=ct(()=>{const a={};return rt.value.forEach(e=>{const d=e.PARTIDA;a[d]||(a[d]={PARTIDA:e.PARTIDA,ST_IND:e.ST_IND,REPROCESSO:e.REPROCESSO,TEAR:e.TEAR,METRAGEM_TOTAL:0,METROS_1ERA:0,METROS_2DA:0,METROS_2DA_HIL:0,METROS_2DA_IND:0,METROS_2DA_TE:0,METROS_2DA_TEF:0,ARTIGO:e.ARTIGO,COR:e.COR,NM_MERCADO:e.NM_MERCADO,TRAMA:e.TRAMA}),a[d].METRAGEM_TOTAL+=parseFloat(e.METRAGEM_TOTAL)||0,a[d].METROS_1ERA+=parseFloat(e.METROS_1ERA)||0,a[d].METROS_2DA+=parseFloat(e.METROS_2DA)||0,a[d].METROS_2DA_HIL+=parseFloat(e.METROS_2DA_HIL)||0,a[d].METROS_2DA_IND+=parseFloat(e.METROS_2DA_IND)||0,a[d].METROS_2DA_TE+=parseFloat(e.METROS_2DA_TE)||0,a[d].METROS_2DA_TEF+=parseFloat(e.METROS_2DA_TEF)||0}),Object.values(a).sort((e,d)=>e.PARTIDA.localeCompare(d.PARTIDA))}),P=ct(()=>{let a=0,e=0,d=0,c=0,x=0,g=0,_=0;return gt.value.forEach(f=>{a+=f.METRAGEM_TOTAL||0,e+=f.METROS_1ERA||0,d+=f.METROS_2DA||0,c+=f.METROS_2DA_HIL||0,x+=f.METROS_2DA_IND||0,g+=f.METROS_2DA_TE||0,_+=f.METROS_2DA_TEF||0}),{metrosTotal:a,metros1era:e,metros2da:d,metros2daHil:c,metros2daInd:x,metros2daTe:g,metros2daTef:_,porcPrimera:a>0?e/a*100:0,porcSegunda:a>0?d/a*100:0,porc2daHil:a>0?c/a*100:0,porc2daInd:a>0?x/a*100:0,porc2daTe:a>0?g/a*100:0,porc2daTef:a>0?_/a*100:0}}),nt=ct(()=>{let a=0,e=0,d=0,c=0,x=0;return gt.value.forEach(g=>{a+=g.METRAGEM_TOTAL||0,e+=g.METROS_1ERA||0,d+=g.METROS_2DA||0,g.PONTUACAO&&(c+=parseFloat(g.PONTUACAO)||0,x++)}),{metrosTotal:a,metros1era:e,metros2da:d,perc1era:a>0?e/a*100:0,perc2da:a>0?d/a*100:0,pontuacao:x>0?c/x:0}}),yt=ct(()=>{let a=0,e=0,d=0;return W.value.forEach(c=>{a+=parseFloat(c.METRAGEM)||0,c.PONTUACAO&&(e+=parseFloat(c.PONTUACAO)||0,d++)}),{metraje:a,pontuacao:d>0?e/d:0,puntuacion:d>0?e/d:0}}),At=(a,e)=>!e||e===0?0:a/e*100,se=async a=>{N.value=a,Lt.value=!0,z.value=[];try{const e=a.COR||"",d=await fetch(`${pt}/consulta-partida-tecelagem?partida=${encodeURIComponent(a.PARTIDA)}&cor=${encodeURIComponent(e)}`);if(!d.ok)throw new Error("Error al cargar detalle de partida");z.value=await d.json(),j.value=!0}catch(e){console.error("Error cargando detalle de partida:",e),K.fire({icon:"error",title:"Error",text:"No se pudo cargar el detalle de la partida"})}finally{Lt.value=!1}},de=()=>{j.value=!1,N.value=null,z.value=[]},kt=a=>{if(!a)return"";const e=a.split("/");if(e.length===3){const d=e[0],c=e[1],x=e[2].slice(-2);return`${d}/${c}/${x}`}return a},ne=a=>{var d;let e=0;for(let c=0;c<=a;c++)e+=parseFloat((d=z.value[c])==null?void 0:d.METRAGEM)||0;return e},J=async(a,e,d="indigo")=>{$.value=a,mt.value=e,wt.value=!0,h.value=d,d==="urdimbre"?G.value.length===0&&await zt(a):d==="indigo"?ut.value.length===0&&await Pt(a):d==="tecelagem"?V.value.length===0&&await $t(a):d==="calidad"&&rt.value.length===0&&await Nt(a)},Pt=async a=>{Mt.value=!0,ut.value=[];try{const e=await fetch(`${pt}/consulta-rolada-indigo?rolada=${a}`);if(!e.ok)throw new Error("Error al cargar detalle");ut.value=await e.json()}catch(e){console.error("Error cargando detalle ÍNDIGO:",e)}finally{Mt.value=!1}},$t=async a=>{Dt.value=!0,V.value=[];try{const e=await fetch(`${pt}/consulta-rolada-tecelagem?rolada=${a}`);if(!e.ok)throw new Error("Error al cargar detalle tecelagem");V.value=await e.json()}catch(e){console.error("Error cargando detalle TECELAGEM:",e)}finally{Dt.value=!1}},Nt=async a=>{It.value=!0,rt.value=[];try{const e=await fetch(`${pt}/consulta-rolada-calidad?rolada=${a}`);if(!e.ok)throw new Error("Error al cargar detalle calidad");rt.value=await e.json()}catch(e){console.error("Error cargando detalle CALIDAD:",e)}finally{It.value=!1}},ie=async a=>{st.value=a,Ut.value=!0,W.value=[];try{const e=await fetch(`${pt}/consulta-partida-calidad?partida=${encodeURIComponent(a.PARTIDA)}`);if(!e.ok)throw new Error("Error al cargar detalle de partida");W.value=await e.json(),lt.value=!0}catch(e){console.error("Error cargando detalle de partida CALIDAD:",e),K.fire({icon:"error",title:"Error",text:"No se pudo cargar el detalle de la partida"})}finally{Ut.value=!1}},ce=()=>{lt.value=!1,st.value=null,W.value=[]},zt=async a=>{St.value=!0,G.value=[];try{const e=await fetch(`${pt}/consulta-rolada-urdimbre?rolada=${a}`);if(!e.ok)throw new Error("Error al cargar detalle urdimbre");G.value=await e.json()}catch(e){console.error("Error cargando detalle URDIMBRE:",e)}finally{St.value=!1}},Ot=async a=>{h.value=a,j.value=!1,N.value=null,z.value=[],lt.value=!1,st.value=null,W.value=[],a==="urdimbre"&&G.value.length===0&&await zt($.value),a==="indigo"&&ut.value.length===0&&await Pt($.value),a==="tecelagem"&&V.value.length===0&&await $t($.value),a==="calidad"&&rt.value.length===0&&await Nt($.value)},Zt=async a=>{const e=mt.value+a;e>=0&&e<k.value.length&&(mt.value=e,$.value=k.value[e].ROLADA,G.value=[],V.value=[],rt.value=[],j.value=!1,lt.value=!1,h.value==="urdimbre"?await zt($.value):h.value==="indigo"?await Pt($.value):h.value==="tecelagem"?await $t($.value):await Nt($.value))},Kt=()=>{wt.value=!1,ut.value=[],V.value=[],rt.value=[],G.value=[],h.value="indigo",j.value=!1,N.value=null,z.value=[],lt.value=!1,st.value=null,W.value=[]},be=async()=>{var a,e,d,c;if(h.value==="urdimbre"){if(!Wt.value||G.value.length===0)return}else if(h.value==="indigo"){if(!Qt.value||tt.value.length===0)return}else if(h.value==="tecelagem"){if(j.value){if(z.value.length===0)return}else if(!qt.value||V.value.length===0)return}else if(rt.value.length===0)return;Ft.value=!0;try{const x=document.createElement("div");x.style.cssText='position: absolute; left: -9999px; top: 0; background: #ffffff; padding: 16px; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;',document.body.appendChild(x);const g=document.createElement("div"),_=h.value==="urdimbre"?"#d97706":h.value==="indigo"?"#1e40af":"#9333ea";g.style.cssText=`display: flex; align-items: center; gap: 12px; margin-bottom: 12px; padding-bottom: 8px; border-bottom: 2px solid ${_};`;const f=document.createElement("img");f.src="/LogoSantana.jpg",f.style.cssText="height: 40px; width: auto;",g.appendChild(f);const n=document.createElement("div");let O=h.value==="urdimbre"?"URDIMBRE":h.value==="indigo"?"ÍNDIGO":"TEJEDURÍA",I=h.value==="urdimbre"?G.value.length:h.value==="indigo"?tt.value.length:V.value.length,U=`${I} partidas`;h.value==="tecelagem"&&j.value&&(I=z.value.length,U=`Partida ${((e=(a=N.value)==null?void 0:a.PARTIDA)==null?void 0:e.replace(/^0/,""))||""} - ${I} turnos | Art: ${((d=N.value)==null?void 0:d.ARTIGO)||""} | Telar: ${(c=N.value)!=null&&c.MAQUINA?parseInt(N.value.MAQUINA.slice(-3)):""}`),n.innerHTML=`
      <div style="font-size: 16px; font-weight: 600; color: #1e293b;">Detalle ${O} - Rolada ${$.value}</div>
      <div style="font-size: 12px; color: #64748b;">${U}</div>
    `,g.appendChild(n),x.appendChild(g);const Q=document.createElement("table");Q.style.cssText="width: 100%; border-collapse: separate; border-spacing: 0; font-size: 13px; color: #334155; border: 1px solid #cbd5e1; border-radius: 8px; overflow: hidden;";const X=document.createElement("thead");h.value==="urdimbre"?X.innerHTML=`
        <tr style="background: #fffbeb; font-size: 11px; color: #475569;">
          <th style="padding: 8px 12px; text-align: left; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Partida</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Fecha<br>Inicio</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Hora<br>Inicio</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Fecha<br>Final</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Hora<br>Final</th>
          <th style="padding: 8px 12px; text-align: left; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Artículo</th>
          <th style="padding: 8px 12px; text-align: right; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Metros</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Vel.</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Puntas</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Rot<br>Hil.</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Rot<br>Urd.</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Rot<br>Ope.</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Rot<br>Total</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Rot<br>10⁶</th>
          <th style="padding: 8px 12px; text-align: left; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Operador</th>
          <th style="padding: 8px 12px; text-align: left; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Lote</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Maq.</th>
          <th style="padding: 8px 12px; text-align: left; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Base</th>
        </tr>
      `:h.value==="indigo"?X.innerHTML=`
        <tr style="background: #f8fafc; font-size: 11px; color: #475569;">
          <th style="padding: 8px 12px; text-align: left; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Partida</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Fecha<br>Inicio</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Hora<br>Inicio</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Fecha<br>Final</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Hora<br>Final</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Turno</th>
          <th style="padding: 8px 12px; text-align: left; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Base</th>
          <th style="padding: 8px 12px; text-align: left; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Color</th>
          <th style="padding: 8px 12px; text-align: right; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Metros</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Veloc.</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">S</th>
          <th style="padding: 8px 12px; text-align: right; border-bottom: 2px solid #cbd5e1; font-weight: 500;">R10³</th>
          <th style="padding: 8px 12px; text-align: right; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Roturas</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">CV</th>
          <th style="padding: 8px 12px; text-align: left; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Operador</th>
        </tr>
      `:h.value==="tecelagem"&&j.value?X.innerHTML=`
        <tr style="background: #faf5ff; font-size: 11px; color: #475569;">
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Fecha</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Tur</th>
          <th style="padding: 8px 12px; text-align: left; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Partida</th>
          <th style="padding: 8px 12px; text-align: right; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Metros<br>Crudos</th>
          <th style="padding: 8px 12px; text-align: right; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Metros<br>Termin.</th>
          <th style="padding: 8px 12px; text-align: right; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Metros<br>Acumul.</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Paradas<br>Trama</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Paradas<br>Urdimbre</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Total<br>Paradas</th>
          <th style="padding: 8px 12px; text-align: right; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Eficiencia<br>%</th>
          <th style="padding: 8px 12px; text-align: right; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Roturas<br>TRAMA 10⁵</th>
          <th style="padding: 8px 12px; text-align: right; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Roturas<br>URDIDO 10⁵</th>
          <th style="padding: 8px 12px; text-align: right; border-bottom: 2px solid #cbd5e1; font-weight: 500;">RPM</th>
        </tr>
      `:X.innerHTML=`
        <tr style="background: #faf5ff; font-size: 11px; color: #475569;">
          <th style="padding: 8px 12px; text-align: left; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Partida</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Fecha<br>Inicial</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Fecha<br>Final</th>
          <th style="padding: 8px 12px; text-align: right; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Metros</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Telar</th>
          <th style="padding: 8px 12px; text-align: right; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Eficiencia<br>%</th>
          <th style="padding: 8px 12px; text-align: right; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Roturas<br>TRA 10⁵</th>
          <th style="padding: 8px 12px; text-align: right; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Roturas<br>URD 10⁵</th>
          <th style="padding: 8px 12px; text-align: left; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Artículo</th>
          <th style="padding: 8px 12px; text-align: center; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Color</th>
          <th style="padding: 8px 12px; text-align: left; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Nombre</th>
          <th style="padding: 8px 12px; text-align: left; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Trama</th>
          <th style="padding: 8px 12px; text-align: right; border-bottom: 2px solid #cbd5e1; font-weight: 500;">Pasadas</th>
          <th style="padding: 8px 12px; text-align: right; border-bottom: 2px solid #cbd5e1; font-weight: 500;">RPM</th>
        </tr>
      `,Q.appendChild(X);const o=document.createElement("tbody");if(h.value==="urdimbre")G.value.forEach(r=>{const b=document.createElement("tr");b.style.cssText="border-bottom: 1px solid #e2e8f0;",b.innerHTML=`
          <td style="padding: 10px 12px; font-weight: 600; color: #1e293b;">${r.PARTIDA?r.PARTIDA.replace(/^0/,""):""}</td>
          <td style="padding: 10px 12px; text-align: center; color: #64748b; font-size: 11px;">${r.DT_INICIO||""}</td>
          <td style="padding: 10px 12px; text-align: center; color: #475569;">${r.HORA_INICIO||""}</td>
          <td style="padding: 10px 12px; text-align: center; color: #64748b; font-size: 11px;">${r.DT_FINAL||""}</td>
          <td style="padding: 10px 12px; text-align: center; color: #475569;">${r.HORA_FINAL||""}</td>
          <td style="padding: 10px 12px; color: #334155;">${r.ARTIGO||""}</td>
          <td style="padding: 10px 12px; text-align: right; font-weight: 500; color: #334155;">${i(r.METRAGEM,0)}</td>
          <td style="padding: 10px 12px; text-align: center; color: #475569;">${v(r.VELOC)}</td>
          <td style="padding: 10px 12px; text-align: center; font-weight: 600; color: #d97706;">${r.NUM_FIOS||""}</td>
          <td style="padding: 10px 12px; text-align: center; color: #475569;">${ot(r.RUP_FIACAO)}</td>
          <td style="padding: 10px 12px; text-align: center; color: #475569;">${ot(r.RUP_URD)}</td>
          <td style="padding: 10px 12px; text-align: center; color: #475569;">${ot(r.RUP_OPER)}</td>
          <td style="padding: 10px 12px; text-align: center; font-weight: 500; color: #dc2626;">${ot(r.RUPTURAS)}</td>
          <td style="padding: 10px 12px; text-align: center; color: #9333ea;">${dt(r.RUPTURAS,r.METRAGEM,r.NUM_FIOS)}</td>
          <td style="padding: 10px 12px; color: #475569;">${r.NM_OPERADOR||""}</td>
          <td style="padding: 10px 12px; color: #475569;">${r.LOTE_FIACAO||""}</td>
          <td style="padding: 10px 12px; text-align: center; color: #475569;">${r.MAQ_FIACAO||""}</td>
          <td style="padding: 10px 12px; color: #334155;">${r.BASE_URDUME||""}</td>
        `,o.appendChild(b)});else if(h.value==="indigo")tt.value.forEach(r=>{const b=r.RUPTURAS&&r.METRAGEM?(r.RUPTURAS*1e3/r.METRAGEM).toFixed(1):"",y=document.createElement("tr");y.style.cssText="border-bottom: 1px solid #e2e8f0;",y.innerHTML=`
          <td style="padding: 10px 12px; font-weight: 600; color: #1e293b;">${r.PARTIDA?r.PARTIDA.replace(/^0/,""):""}</td>
          <td style="padding: 10px 12px; text-align: center; color: #64748b; font-size: 11px;">${r.DT_INICIO||""}</td>
          <td style="padding: 10px 12px; text-align: center; color: #475569;">${r.HORA_INICIO||""}</td>
          <td style="padding: 10px 12px; text-align: center; color: #64748b; font-size: 11px;">${r.DT_FINAL||""}</td>
          <td style="padding: 10px 12px; text-align: center; color: #475569;">${r.HORA_FINAL||""}</td>
          <td style="padding: 10px 12px; text-align: center; font-weight: 600; color: #2563eb;">${r.TURNO||""}</td>
          <td style="padding: 10px 12px; color: #334155;">${r.ARTIGO?r.ARTIGO.substring(0,10):""}</td>
          <td style="padding: 10px 12px; color: #475569;">${r.COR||""}</td>
          <td style="padding: 10px 12px; text-align: right; font-weight: 500; color: #334155;">${i(r.METRAGEM,0)}</td>
          <td style="padding: 10px 12px; text-align: center; color: #475569;">${v(r.VELOC)}</td>
          <td style="padding: 10px 12px; text-align: center; color: #475569;">${r.S||""}</td>
          <td style="padding: 10px 12px; text-align: right; color: #9333ea;">${b}</td>
          <td style="padding: 10px 12px; text-align: right; color: #dc2626;">${r.RUPTURAS||""}</td>
          <td style="padding: 10px 12px; text-align: center; color: #475569;">${v(r.CAVALOS)}</td>
          <td style="padding: 10px 12px; color: #475569;">${r.NM_OPERADOR||""}</td>
        `,o.appendChild(y)});else if(h.value==="tecelagem"&&j.value){let r=0;z.value.forEach(b=>{r+=parseFloat(b.METRAGEM)||0;const y=(parseInt(b.PARADA_TRAMA)||0)+(parseInt(b.PARADA_URDUME)||0),H=document.createElement("tr");H.style.cssText="border-bottom: 1px solid #e2e8f0;",H.innerHTML=`
          <td style="padding: 10px 12px; text-align: center; color: #475569;">${kt(b.DT_BASE_PRODUCAO)}</td>
          <td style="padding: 10px 12px; text-align: center; font-weight: 600; color: #1e293b;">${b.TURNO||""}</td>
          <td style="padding: 10px 12px; font-weight: 600; color: #1e293b;">${b.PARTIDA?b.PARTIDA.replace(/^0/,""):""}</td>
          <td style="padding: 10px 12px; text-align: right; color: #334155;">${i(b.METRAGEM,0)}</td>
          <td style="padding: 10px 12px; text-align: right; color: #334155;">${i(b.METRAGEM,0)}</td>
          <td style="padding: 10px 12px; text-align: right; font-weight: 500; color: #334155;">${i(r,0)}</td>
          <td style="padding: 10px 12px; text-align: center; color: #475569;">${b.PARADA_TRAMA||0}</td>
          <td style="padding: 10px 12px; text-align: center; color: #475569;">${b.PARADA_URDUME||0}</td>
          <td style="padding: 10px 12px; text-align: center; font-weight: 500; color: #334155;">${y}</td>
          <td style="padding: 10px 12px; text-align: right; color: #16a34a;">${v(b.EFICIENCIA)}</td>
          <td style="padding: 10px 12px; text-align: right; color: #ea580c;">${v(b.ROTURAS_TRA_105)}</td>
          <td style="padding: 10px 12px; text-align: right; color: #dc2626;">${v(b.ROTURAS_URD_105)}</td>
          <td style="padding: 10px 12px; text-align: right; color: #334155;">${i(b.RPM,0)}</td>
        `,o.appendChild(H)})}else V.value.forEach(r=>{const b=document.createElement("tr");b.style.cssText="border-bottom: 1px solid #e2e8f0;",b.innerHTML=`
          <td style="padding: 10px 12px; font-weight: 600; color: #1e293b;">${r.PARTIDA?r.PARTIDA.replace(/^0/,""):""}</td>
          <td style="padding: 10px 12px; text-align: center; color: #64748b; font-size: 11px;">${Rt(r.FECHA_INICIAL)}</td>
          <td style="padding: 10px 12px; text-align: center; color: #64748b; font-size: 11px;">${Rt(r.FECHA_FINAL)}</td>
          <td style="padding: 10px 12px; text-align: right; font-weight: 500; color: #334155;">${i(r.METRAGEM,2)}</td>
          <td style="padding: 10px 12px; text-align: center; font-weight: 600; color: #9333ea;">${r.MAQUINA?parseInt(r.MAQUINA.slice(-3)):""}</td>
          <td style="padding: 10px 12px; text-align: right; color: #16a34a;">${v(r.EFICIENCIA)}</td>
          <td style="padding: 10px 12px; text-align: right; color: #ea580c;">${v(r.ROTURAS_TRA_105)}</td>
          <td style="padding: 10px 12px; text-align: right; color: #dc2626;">${v(r.ROTURAS_URD_105)}</td>
          <td style="padding: 10px 12px; color: #334155;">${r.ARTIGO||""}</td>
          <td style="padding: 10px 12px; text-align: center; color: #475569;">${r.COR||""}</td>
          <td style="padding: 10px 12px; color: #475569;">${r.NM_MERCADO||""}</td>
          <td style="padding: 10px 12px; color: #475569;">${r.TRAMA||""}</td>
          <td style="padding: 10px 12px; text-align: right; color: #475569;">${v(r.PASADAS)}</td>
          <td style="padding: 10px 12px; text-align: right; color: #334155;">${i(r.RPM,0)}</td>
        `,o.appendChild(b)});Q.appendChild(o);const C=document.createElement("tfoot");if(h.value==="urdimbre")C.innerHTML=`
        <tr style="background: #fef3c7; font-weight: 600; color: #334155;">
          <td style="padding: 12px; border-top: 2px solid #cbd5e1;">TOTAL</td>
          <td style="padding: 12px; border-top: 2px solid #cbd5e1;" colspan="5"></td>
          <td style="padding: 12px; text-align: right; border-top: 2px solid #cbd5e1;">${i(at.value.metros,0)}</td>
          <td style="padding: 12px; border-top: 2px solid #cbd5e1;" colspan="6"></td>
        </tr>
      `;else if(h.value==="indigo"){const r=B.value.metros>0?(B.value.roturas*1e3/B.value.metros).toFixed(1):"";C.innerHTML=`
        <tr style="background: #f1f5f9; font-weight: 600; color: #334155;">
            <td style="padding: 12px; border-top: 2px solid #cbd5e1;">TOTAL</td>
          <td style="padding: 12px; border-top: 2px solid #cbd5e1;" colspan="7"></td>
          <td style="padding: 12px; text-align: right; border-top: 2px solid #cbd5e1;">${i(B.value.metros,0)}</td>
          <td style="padding: 12px; border-top: 2px solid #cbd5e1;"></td>
          <td style="padding: 12px; border-top: 2px solid #cbd5e1;"></td>
          <td style="padding: 12px; text-align: right; color: #7c3aed; border-top: 2px solid #cbd5e1;">${r}</td>
          <td style="padding: 12px; text-align: right; color: #b91c1c; border-top: 2px solid #cbd5e1;">${B.value.roturas}</td>
          <td style="padding: 12px; text-align: center; border-top: 2px solid #cbd5e1;">${v(B.value.cv)}</td>
          <td style="padding: 12px; border-top: 2px solid #cbd5e1;"></td>
        </tr>
      `}else h.value==="tecelagem"&&j.value?C.innerHTML=`
        <tr style="background: #faf5ff; font-weight: 600; color: #334155;">
          <td style="padding: 12px; border-top: 2px solid #cbd5e1;" colspan="3">TOTAL</td>
          <td style="padding: 12px; text-align: right; border-top: 2px solid #cbd5e1;">${i(S.value.metros,0)}</td>
          <td style="padding: 12px; border-top: 2px solid #cbd5e1;"></td>
          <td style="padding: 12px; border-top: 2px solid #cbd5e1;"></td>
          <td style="padding: 12px; text-align: center; border-top: 2px solid #cbd5e1;">${S.value.paradasTrama}</td>
          <td style="padding: 12px; text-align: center; border-top: 2px solid #cbd5e1;">${S.value.paradasUrdumbre}</td>
          <td style="padding: 12px; text-align: center; border-top: 2px solid #cbd5e1;">${S.value.totalParadas}</td>
          <td style="padding: 12px; text-align: right; color: #15803d; border-top: 2px solid #cbd5e1;">${v(S.value.eficiencia)}</td>
          <td style="padding: 12px; text-align: right; color: #c2410c; border-top: 2px solid #cbd5e1;">${v(S.value.roturasTra)}</td>
          <td style="padding: 12px; text-align: right; color: #b91c1c; border-top: 2px solid #cbd5e1;">${v(S.value.roturasUrd)}</td>
          <td style="padding: 12px; text-align: right; border-top: 2px solid #cbd5e1;">${i(S.value.rpm,0)}</td>
        </tr>
      `:C.innerHTML=`
        <tr style="background: #faf5ff; font-weight: 600; color: #334155;">
          <td style="padding: 12px; border-top: 2px solid #cbd5e1;" colspan="3">TOTAL</td>
          <td style="padding: 12px; text-align: right; border-top: 2px solid #cbd5e1;">${i(L.value.metros,2)}</td>
          <td style="padding: 12px; border-top: 2px solid #cbd5e1;"></td>
          <td style="padding: 12px; text-align: right; color: #15803d; border-top: 2px solid #cbd5e1;">${v(L.value.eficiencia)}</td>
          <td style="padding: 12px; text-align: right; color: #c2410c; border-top: 2px solid #cbd5e1;">${v(L.value.roturasTra)}</td>
          <td style="padding: 12px; text-align: right; color: #b91c1c; border-top: 2px solid #cbd5e1;">${v(L.value.roturasUrd)}</td>
          <td style="padding: 12px; border-top: 2px solid #cbd5e1;" colspan="4"></td>
          <td style="padding: 12px; text-align: right; border-top: 2px solid #cbd5e1;">${v(L.value.pasadas)}</td>
          <td style="padding: 12px; text-align: right; border-top: 2px solid #cbd5e1;">${i(L.value.rpm,0)}</td>
        </tr>
      `;Q.appendChild(C),x.appendChild(Q);const m=await ee(x,{backgroundColor:"#ffffff",scale:2,useCORS:!0,logging:!1});document.body.removeChild(x),m.toBlob(async r=>{try{await navigator.clipboard.write([new ClipboardItem({"image/png":r})]),K.fire({icon:"success",title:"Copiado",text:"Imagen copiada al portapapeles",timer:1e3,showConfirmButton:!1,timerProgressBar:!0})}catch(b){console.error("Error al copiar:",b),K.fire({icon:"error",title:"Error",text:"Error al copiar la imagen",timer:2e3,showConfirmButton:!1})}},"image/png")}catch(x){console.error("Error:",x),K.fire({icon:"error",title:"Error",text:"Error al generar la imagen",timer:2e3,showConfirmButton:!1})}finally{Ft.value=!1}},pe=async()=>{var g,_,f,n,O,I,U,Q,X,o;let a,e=!1,d=!1,c=!1,x=!1;if(h.value==="urdimbre"?(a=G.value,c=!0):h.value==="indigo"?a=tt.value:h.value==="tecelagem"&&j.value?(a=z.value,e=!0):h.value==="tecelagem"?a=V.value:h.value==="calidad"&&lt.value?(a=W.value,d=!0,x=!0):h.value==="calidad"&&(a=gt.value,x=!0),a.length!==0)try{const C=new te.Workbook;let m=c?"URDIMBRE":h.value==="indigo"?"INDIGO":x?"CALIDAD":"TEJEDURIA";e?m=`TEJ_Partida_${((_=(g=N.value)==null?void 0:g.PARTIDA)==null?void 0:_.replace(/^0/,""))||""}`:d&&(m=`CAL_Partida_${((n=(f=st.value)==null?void 0:f.PARTIDA)==null?void 0:n.replace(/^0/,""))||""}`);const r=C.addWorksheet(`Rolada_${$.value}_${m}`),b=c?{headerBg:"FFFFFBEB",headerText:"1e293b",border:"FFcbd5e1",totalsBg:"FFFEF3C7",amber:"FFd97706"}:h.value==="indigo"?{headerBg:"FFF8FAFC",headerText:"1e293b",border:"FFcbd5e1",totalsBg:"FFF1F5F9",purple:"FF9333ea",red:"FFdc2626",blue:"FF2563eb"}:x?{headerBg:"FFF0FDFA",headerText:"1e293b",border:"FFcbd5e1",totalsBg:"FFCCFBF1",teal:"FF14b8a6",green:"FF16a34a"}:{headerBg:"FFFAF5FF",headerText:"1e293b",border:"FFcbd5e1",totalsBg:"FFFAF5FF",purple:"FF9333ea",red:"FFdc2626",green:"FF16a34a",orange:"FFea580c"},y=c?"M":h.value==="indigo"?"O":e?"M":d?"L":x?"K":"N";r.mergeCells(`A1:${y}1`);const H=c?"URDIMBRE":h.value==="indigo"?"ÍNDIGO":x?"CALIDAD":"TEJEDURÍA";r.getCell("A1").value=`Detalle ${H} - Rolada ${$.value}`,r.getCell("A1").font={bold:!0,size:14,color:{argb:"FF1e293b"}},r.getCell("A1").alignment={horizontal:"left",vertical:"middle"},r.getRow(1).height=24,r.mergeCells(`A2:${y}2`);let it=`${a.length} partidas`;e?it=`Partida ${((I=(O=N.value)==null?void 0:O.PARTIDA)==null?void 0:I.replace(/^0/,""))||""} - ${a.length} turnos | Art: ${((U=N.value)==null?void 0:U.ARTIGO)||""} | Telar: ${(Q=N.value)!=null&&Q.MAQUINA?parseInt(N.value.MAQUINA.slice(-3)):""}`:d&&(it=`Partida ${((o=(X=st.value)==null?void 0:X.PARTIDA)==null?void 0:o.replace(/^0/,""))||""} - ${a.length} defectos | Total: ${yt.value.metraje} m`),r.getCell("A2").value=it,r.getCell("A2").font={size:10,color:{argb:"FF64748b"}},r.getRow(2).height=18;let q;c?q=["Partida","Fecha Inicio","Hora Inicio","Fecha Final","Hora Final","Artículo","Metros","Vel.","Puntas","Rot Hil.","Rot Urd.","Rot Ope.","Rot Total","Rot 10⁶","Operador","Lote","Maq.","Base"]:h.value==="indigo"?q=["Partida","Fecha Inicio","Hora Inicio","Fecha Final","Hora Final","Turno","Base","Color","Metros","Veloc.","S","R10³","Roturas","CV","Operador"]:d?q=["Grupo","Código","Defecto","Metraje","Calidad","Hora","Emendas","Pieza","Etiqueta","Ancho","Puntuación","Revisor Final"]:x?q=["Partida","Proceso","Reproc","Telar","Metros Total","Metros 1ª","Metros 2ª","% 1ª","% 2ª","Puntuación","Revisor"]:e?q=["Fecha","Tur","Partida","Metros Crudos","Metros Termin.","Metros Acumul.","Paradas Trama","Paradas Urdimbre","Total Paradas","Eficiencia %","Roturas TRAMA 10⁵","Roturas URDIDO 10⁵","RPM"]:q=["Partida","Fecha Inicial","Fecha Final","Metros","Telar","Eficiencia %","Roturas TRA 10⁵","Roturas URD 10⁵","Artículo","Color","Nombre","Trama","Pasadas","RPM"];const _t=r.addRow(q);if(_t.height=c||h.value==="indigo"?24:30,_t.eachCell((s,E)=>{s.fill={type:"pattern",pattern:"solid",fgColor:{argb:b.headerBg}},s.font={bold:!0,size:10,color:{argb:"FF475569"}},s.alignment={horizontal:"center",vertical:"middle",wrapText:!0},s.border={bottom:{style:"medium",color:{argb:b.border}}}}),c)G.value.forEach((s,E)=>{let D="-";s.RUPTURAS&&s.METRAGEM&&s.NUM_FIOS&&s.METRAGEM>0&&s.NUM_FIOS>0&&(D=s.RUPTURAS*1e6/(s.METRAGEM*s.NUM_FIOS));const F=r.addRow([s.PARTIDA?s.PARTIDA.replace(/^0/,""):"",s.DT_INICIO||"",s.HORA_INICIO||"",s.DT_FINAL||"",s.HORA_FINAL||"",s.ARTIGO||"",s.METRAGEM||0,s.VELOC||"",s.NUM_FIOS||"",ot(s.RUP_FIACAO),ot(s.RUP_URD),ot(s.RUP_OPER),ot(s.RUPTURAS),D,s.NM_OPERADOR||"",s.LOTE_FIACAO||"",s.MAQ_FIACAO||"",s.BASE_URDUME||""]);F.height=22,F.eachCell((w,Y)=>{w.alignment={vertical:"middle",horizontal:Y===1||Y===6||Y===15||Y===16||Y===18?"left":"center"},w.font={size:10},w.border={bottom:{style:"thin",color:{argb:"FFe2e8f0"}}},Y===9&&(w.font={size:10,bold:!0,color:{argb:b.amber}}),Y===13&&(w.font={size:10,bold:!0,color:{argb:"FFdc2626"}}),Y===14&&(w.font={size:10,color:{argb:"FF9333ea"}})}),F.getCell(7).numFmt="#,##0",F.getCell(7).alignment={horizontal:"right",vertical:"middle"},typeof D=="number"&&(F.getCell(14).numFmt="#,##0.0")});else if(h.value==="indigo")tt.value.forEach((s,E)=>{const D=r.addRow([s.PARTIDA?s.PARTIDA.replace(/^0/,""):"",s.DT_INICIO||"",s.HORA_INICIO||"",s.DT_FINAL||"",s.HORA_FINAL||"",s.TURNO||"",s.ARTIGO?s.ARTIGO.substring(0,10):"",s.COR||"",s.METRAGEM||0,s.VELOC||"",s.S||"",s.RUPTURAS&&s.METRAGEM?(s.RUPTURAS*1e3/s.METRAGEM).toFixed(1):"",s.RUPTURAS||0,s.CAVALOS||0,s.NM_OPERADOR||""]);D.height=22,D.eachCell((F,w)=>{F.alignment={vertical:"middle",horizontal:w===1||w===7||w===8||w===15?"left":"center"},F.font={size:10},F.border={bottom:{style:"thin",color:{argb:"FFe2e8f0"}}},w===6&&(F.font={size:10,bold:!0,color:{argb:b.blue}}),w===12&&(F.font={size:10,color:{argb:b.purple}}),w===13&&(F.font={size:10,color:{argb:b.red}})}),D.getCell(9).numFmt="#,##0",D.getCell(9).alignment={horizontal:"right",vertical:"middle"}});else if(e){let s=0;z.value.forEach((E,D)=>{s+=parseFloat(E.METRAGEM)||0;const F=(parseInt(E.PARADA_TRAMA)||0)+(parseInt(E.PARADA_URDUME)||0),w=r.addRow([kt(E.DT_BASE_PRODUCAO),E.TURNO||"",E.PARTIDA?E.PARTIDA.replace(/^0/,""):"",E.METRAGEM||0,E.METRAGEM||0,s,E.PARADA_TRAMA||0,E.PARADA_URDUME||0,F,E.EFICIENCIA||0,E.ROTURAS_TRA_105||0,E.ROTURAS_URD_105||0,E.RPM||0]);w.height=22,w.eachCell((Y,Gt)=>{Y.font={size:10},Y.border={bottom:{style:"thin",color:{argb:"FFe2e8f0"}}},Y.alignment={vertical:"middle",horizontal:"center"},Gt===10&&(Y.font={size:10,color:{argb:b.green}}),Gt===11&&(Y.font={size:10,color:{argb:b.orange}}),Gt===12&&(Y.font={size:10,color:{argb:b.red}})}),w.getCell(4).numFmt="#,##0",w.getCell(5).numFmt="#,##0",w.getCell(6).numFmt="#,##0",w.getCell(10).numFmt="0.00",w.getCell(11).numFmt="0.00",w.getCell(12).numFmt="0.00",w.getCell(13).numFmt="#,##0"})}else x&&!d?gt.value.forEach((s,E)=>{const D=r.addRow([s.PARTIDA?s.PARTIDA.replace(/^0/,""):"",s.ST_IND==="R"?"Reproceso":"Normal",s.REPROCE||"",s.TEAR?parseInt(s.TEAR.slice(-3)):"",s.METRAGEM_TOTAL||0,s.METROS_1ERA||0,s.METROS_2DA||0,s.PERC_1ERA||0,s.PERC_2DA||0,s.PONTUACAO||0,s.REVISOR||""]);D.height=22,D.eachCell((F,w)=>{F.font={size:10},F.border={bottom:{style:"thin",color:{argb:"FFe2e8f0"}}},F.alignment={vertical:"middle",horizontal:"center"},w===8&&(F.font={size:10,color:{argb:b.teal}}),w===9&&(F.font={size:10,color:{argb:b.green}}),w===10&&(F.font={size:10,bold:!0,color:{argb:b.teal}})}),D.getCell(5).numFmt="#,##0",D.getCell(6).numFmt="#,##0",D.getCell(7).numFmt="#,##0",D.getCell(8).numFmt="0.0",D.getCell(9).numFmt="0.0",D.getCell(10).numFmt="0.0"}):d?W.value.forEach((s,E)=>{const D=r.addRow([s.GRP_DEF||"",s.COD_DE||"",s.DEFEITO||"",s.METRAGEM||0,s.QUALIDADE||"",s.HORA||"",s.EMENDAS||"",s.PECA||s.PEÇA||"",s.ETIQUETA||"",s.LARGURA||"",s.PONTUACAO||0,s.REVISOR_FINAL||""]);D.height=22,D.eachCell((F,w)=>{F.font={size:10},F.border={bottom:{style:"thin",color:{argb:"FFe2e8f0"}}},F.alignment={vertical:"middle"},w===1||w===2||w===3||w===5||w===12?F.alignment={...F.alignment,horizontal:"left"}:F.alignment={...F.alignment,horizontal:"center"},w===5&&(s.QUALIDADE==="1ª"?F.font={size:10,bold:!0,color:{argb:b.teal}}:s.QUALIDADE==="2ª"&&(F.font={size:10,color:{argb:b.green}})),w===11&&(F.font={size:10,color:{argb:b.teal}})}),D.getCell(4).numFmt="#,##0",D.getCell(11).numFmt="0.0"}):V.value.forEach((s,E)=>{const D=r.addRow([s.PARTIDA?s.PARTIDA.replace(/^0/,""):"",Rt(s.FECHA_INICIAL),Rt(s.FECHA_FINAL),s.METRAGEM||0,s.MAQUINA?parseInt(s.MAQUINA.slice(-3)):"",s.EFICIENCIA||0,s.ROTURAS_TRA_105||0,s.ROTURAS_URD_105||0,s.ARTIGO||"",s.COR||"",s.NM_MERCADO||"",s.TRAMA||"",v(s.PASADAS),s.RPM||0]);D.height=22,D.eachCell((F,w)=>{F.font={size:10},F.border={bottom:{style:"thin",color:{argb:"FFe2e8f0"}}},F.alignment={vertical:"middle"},w===9||w===11||w===12?F.alignment={...F.alignment,horizontal:"left"}:F.alignment={...F.alignment,horizontal:"center"},w===5&&(F.font={size:10,bold:!0,color:{argb:b.purple}}),w===6&&(F.font={size:10,color:{argb:b.green}}),w===7&&(F.font={size:10,color:{argb:b.orange}}),w===8&&(F.font={size:10,color:{argb:b.red}})}),D.getCell(4).numFmt="#,##0.00",D.getCell(6).numFmt="0.00",D.getCell(7).numFmt="0.00",D.getCell(8).numFmt="0.00",D.getCell(14).numFmt="#,##0"});let T;c?(T=r.addRow(["TOTAL","","","","","",at.value.metros,"","","","","",""]),T.height=26,T.eachCell((s,E)=>{s.fill={type:"pattern",pattern:"solid",fgColor:{argb:b.totalsBg}},s.font={bold:!0,size:10},s.border={top:{style:"medium",color:{argb:b.border}}},s.alignment={vertical:"middle",horizontal:"center"}}),T.getCell(1).alignment={horizontal:"left",vertical:"middle"},T.getCell(7).numFmt="#,##0",T.getCell(7).alignment={horizontal:"right",vertical:"middle"}):h.value==="indigo"?(T=r.addRow(["TOTAL","","","","","","","",B.value.metros,"","",B.value.metros>0?(B.value.roturas*1e3/B.value.metros).toFixed(1):"",B.value.roturas,B.value.cv,""]),T.height=26,T.eachCell((s,E)=>{s.fill={type:"pattern",pattern:"solid",fgColor:{argb:b.totalsBg}},s.font={bold:!0,size:10},s.border={top:{style:"medium",color:{argb:b.border}}},s.alignment={vertical:"middle",horizontal:"center"},E===12&&(s.font={bold:!0,size:10,color:{argb:b.purple}}),E===13&&(s.font={bold:!0,size:10,color:{argb:b.red}})}),T.getCell(1).alignment={horizontal:"left",vertical:"middle"},T.getCell(9).numFmt="#,##0",T.getCell(9).alignment={horizontal:"right",vertical:"middle"}):e?(T=r.addRow(["TOTAL","","",S.value.metros,"","",S.value.paradasTrama,S.value.paradasUrdumbre,S.value.totalParadas,S.value.eficiencia,S.value.roturasTra,S.value.roturasUrd,S.value.rpm]),T.height=26,T.eachCell((s,E)=>{s.fill={type:"pattern",pattern:"solid",fgColor:{argb:b.totalsBg}},s.font={bold:!0,size:10},s.border={top:{style:"medium",color:{argb:b.border}}},s.alignment={vertical:"middle",horizontal:"center"},E===10&&(s.font={bold:!0,size:10,color:{argb:b.green}}),E===11&&(s.font={bold:!0,size:10,color:{argb:b.orange}}),E===12&&(s.font={bold:!0,size:10,color:{argb:b.red}})}),T.getCell(4).numFmt="#,##0",T.getCell(10).numFmt="0.00",T.getCell(11).numFmt="0.00",T.getCell(12).numFmt="0.00",T.getCell(13).numFmt="#,##0"):x&&!d?(T=r.addRow(["TOTAL","","","",nt.value.metrosTotal,nt.value.metros1era,nt.value.metros2da,nt.value.perc1era,nt.value.perc2da,nt.value.pontuacao,""]),T.height=26,T.eachCell((s,E)=>{s.fill={type:"pattern",pattern:"solid",fgColor:{argb:b.totalsBg}},s.font={bold:!0,size:10},s.border={top:{style:"medium",color:{argb:b.border}}},s.alignment={vertical:"middle",horizontal:"center"},E===8&&(s.font={bold:!0,size:10,color:{argb:b.teal}}),E===9&&(s.font={bold:!0,size:10,color:{argb:b.green}}),E===10&&(s.font={bold:!0,size:10,color:{argb:b.teal}})}),T.getCell(1).alignment={horizontal:"left",vertical:"middle"},T.getCell(5).numFmt="#,##0",T.getCell(6).numFmt="#,##0",T.getCell(7).numFmt="#,##0",T.getCell(8).numFmt="0.0",T.getCell(9).numFmt="0.0",T.getCell(10).numFmt="0.0"):d?(T=r.addRow(["TOTAL","","",yt.value.metraje,"","","","","","",yt.value.pontuacao,""]),T.height=26,T.eachCell((s,E)=>{s.fill={type:"pattern",pattern:"solid",fgColor:{argb:b.totalsBg}},s.font={bold:!0,size:10},s.border={top:{style:"medium",color:{argb:b.border}}},s.alignment={vertical:"middle"},E===1||E===2||E===3||E===5||E===12?s.alignment={...s.alignment,horizontal:"left"}:s.alignment={...s.alignment,horizontal:"center"},E===11&&(s.font={bold:!0,size:10,color:{argb:b.teal}})}),T.getCell(4).numFmt="#,##0",T.getCell(11).numFmt="0.0"):(T=r.addRow(["TOTAL","","",L.value.metros,"",L.value.eficiencia,L.value.roturasTra,L.value.roturasUrd,"","","","",v(L.value.pasadas),L.value.rpm]),T.height=26,T.eachCell((s,E)=>{s.fill={type:"pattern",pattern:"solid",fgColor:{argb:b.totalsBg}},s.font={bold:!0,size:10},s.border={top:{style:"medium",color:{argb:b.border}}},s.alignment={vertical:"middle"},E===9||E===11||E===12?s.alignment={...s.alignment,horizontal:"left"}:s.alignment={...s.alignment,horizontal:"center"},E===6&&(s.font={bold:!0,size:10,color:{argb:b.green}}),E===7&&(s.font={bold:!0,size:10,color:{argb:b.orange}}),E===8&&(s.font={bold:!0,size:10,color:{argb:b.red}})}),T.getCell(4).numFmt="#,##0.00",T.getCell(6).numFmt="0.00",T.getCell(7).numFmt="0.00",T.getCell(8).numFmt="0.00",T.getCell(14).numFmt="#,##0"),c?r.columns=[{width:10},{width:12},{width:10},{width:12},{width:10},{width:12},{width:10},{width:8},{width:9},{width:20},{width:12},{width:12},{width:12}]:h.value==="indigo"?r.columns=[{width:10},{width:12},{width:10},{width:12},{width:10},{width:7},{width:12},{width:8},{width:10},{width:8},{width:5},{width:8},{width:9},{width:6},{width:30}]:e?r.columns=[{width:12},{width:5},{width:8},{width:10},{width:10},{width:10},{width:8},{width:9},{width:9},{width:9},{width:11},{width:11},{width:6}]:d?r.columns=[{width:8},{width:8},{width:25},{width:10},{width:8},{width:10},{width:8},{width:8},{width:10},{width:8},{width:10},{width:20}]:x?r.columns=[{width:10},{width:12},{width:8},{width:8},{width:10},{width:10},{width:10},{width:8},{width:8},{width:10},{width:20}]:r.columns=[{width:7.86},{width:13},{width:13.14},{width:8.57},{width:4.43},{width:7.29},{width:7.29},{width:7.29},{width:10.29},{width:5},{width:18.57},{width:28},{width:6.14},{width:4}],r.pageSetup={orientation:"landscape",fitToPage:!0,fitToWidth:1,fitToHeight:0,margins:{left:.196850394,right:.196850394,top:.196850394,bottom:.393700787,header:.3,footer:.3}},r.pageSetup.printTitlesRow="3:3";const fe=await C.xlsx.writeBuffer(),me=new Blob([fe],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),Xt=URL.createObjectURL(me),Ht=document.createElement("a"),Vt=new Date,Re=Vt.toISOString().slice(0,10).replace(/-/g,""),Ae=String(Vt.getHours()).padStart(2,"0"),ve=String(Vt.getMinutes()).padStart(2,"0"),ye=h.value==="indigo"?"INDIGO":"TEJEDURIA";Ht.href=Xt,Ht.download=`Detalle_${ye}_Rolada_${$.value}_${Re}_${Ae}_${ve}.xlsx`,Ht.click(),URL.revokeObjectURL(Xt),K.fire({icon:"success",title:"Exportado",text:"Excel generado correctamente",timer:1e3,showConfirmButton:!1,timerProgressBar:!0})}catch(C){console.error("Error exportando Excel:",C),K.fire({icon:"error",title:"Error",text:"Error al exportar a Excel",timer:2e3,showConfirmButton:!1})}},Bt=async()=>{Ct.value=!0;try{if(!bt.value)return;const a=new Date(bt.value+"T00:00:00"),e=new Date(a);e.setDate(e.getDate()-ft.value);const d=e.toISOString().split("T")[0],c=a.toISOString().split("T")[0];console.log("Consultando desde:",d,"hasta:",c);const x=await fetch(`${pt}/seguimiento-roladas?fechaInicio=${d}&fechaFin=${c}`);if(!x.ok)throw new Error("Error al cargar datos");const g=await x.json();k.value=g.datos,p.value=g.totales,console.log("Datos cargados:",k.value.length,"roladas"),console.log("Primera rolada:",k.value[0]),console.log("Totales:",p.value)}catch(a){console.error("Error cargando datos:",a),K.fire({icon:"error",title:"Error",text:"Error al cargar los datos",timer:2e3,showConfirmButton:!1})}finally{Ct.value=!1}},ue=async()=>{if(k.value.length===0){K.fire({icon:"warning",title:"Sin datos",text:"No hay datos para copiar",timer:1500,showConfirmButton:!1});return}vt.value=!0;try{const a=new Date(bt.value+"T00:00:00"),e=new Date(a);e.setDate(e.getDate()-ft.value);const d=m=>m.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}),c=document.createElement("div");c.style.cssText="position: absolute; left: -9999px; background: #ffffff; padding: 16px; font-family: system-ui, -apple-system, sans-serif;";const x=document.createElement("div");x.style.cssText="display: flex; align-items: center; gap: 16px; margin-bottom: 12px; padding-bottom: 10px; border-bottom: 1px solid #e2e8f0;";const g=document.createElement("img");g.src="/LogoSantana.jpg",g.style.cssText="height: 36px; width: auto;",x.appendChild(g);const _=document.createElement("div");_.innerHTML=`
      <div style="font-size: 16px; font-weight: 600; color: #1e293b;">
        Seguimiento de Roladas
      </div>
      <div style="font-size: 12px; color: #94a3b8;">
        Producción ÍNDIGO
      </div>
    `,x.appendChild(_);const f=document.createElement("div");f.style.cssText="margin-left: auto; display: flex; align-items: center; gap: 16px;",f.innerHTML=`
      <div style="background: #f1f5f9; padding: 4px 10px; border-radius: 6px;">
        <span style="font-size: 11px; color: #64748b;">Registros:</span>
        <span style="font-size: 13px; font-weight: 600; color: #334155; margin-left: 4px;">${k.value.length}</span>
      </div>
      <div style="font-size: 12px; color: #64748b;">
        Período: ${d(e)} al ${d(a)}
      </div>
    `,x.appendChild(f),c.appendChild(x);const n={headerBg:"#f8fafc",headerText:"#64748b",headerTextDark:"#334155",border:"#cbd5e1",borderLight:"#e2e8f0",text:"#334155",textLight:"#64748b",white:"#ffffff",blue:"#2563eb",green:"#16a34a",orange:"#ea580c",cyan:"#0891b2"},O=document.createElement("table");O.style.cssText="border-collapse: collapse; font-size: 12px; width: 100%; border: 1px solid "+n.border+";";const I=document.createElement("thead"),U=document.createElement("tr");U.innerHTML=`
      <th rowspan="2" style="background: ${n.headerBg}; color: ${n.headerTextDark}; padding: 10px 12px; text-align: center; vertical-align: middle; border-right: 2px solid ${n.border}; border-bottom: 2px solid ${n.border}; font-size: 11px; font-weight: 600; text-transform: uppercase;">ROLADA</th>
      <th colspan="3" style="background: ${n.headerBg}; color: ${n.headerTextDark}; padding: 8px; text-align: center; vertical-align: middle; border-right: 2px solid ${n.border}; border-bottom: 1px solid ${n.border}; font-size: 11px; font-weight: 600; text-transform: uppercase;">URDIDORA</th>
      <th colspan="8" style="background: ${n.headerBg}; color: ${n.headerTextDark}; padding: 8px; text-align: center; vertical-align: middle; border-right: 2px solid ${n.border}; border-bottom: 1px solid ${n.border}; font-size: 11px; font-weight: 600; text-transform: uppercase;">ÍNDIGO</th>
      <th colspan="4" style="background: ${n.headerBg}; color: ${n.headerTextDark}; padding: 8px; text-align: center; vertical-align: middle; border-right: 2px solid ${n.border}; border-bottom: 1px solid ${n.border}; font-size: 11px; font-weight: 600; text-transform: uppercase;">TEJEDURÍA</th>
      <th colspan="3" style="background: ${n.headerBg}; color: ${n.headerTextDark}; padding: 8px; text-align: center; vertical-align: middle; border-bottom: 1px solid ${n.border}; font-size: 11px; font-weight: 600; text-transform: uppercase;">CALIDAD</th>
    `,I.appendChild(U);const Q=document.createElement("tr");[{text:"Maq. OE",borderRight:"1px solid "+n.borderLight},{text:"Lote",borderRight:"1px solid "+n.borderLight},{text:"Rot 10⁶",borderRight:"2px solid "+n.border},{text:"Fecha",borderRight:"1px solid "+n.borderLight},{text:"Base",borderRight:"1px solid "+n.borderLight},{text:"Color",borderRight:"1px solid "+n.borderLight},{text:"Metros",borderRight:"1px solid "+n.borderLight},{text:"R10³",borderRight:"1px solid "+n.borderLight},{text:"Cav",borderRight:"1px solid "+n.borderLight},{text:"Vel. Nom.",borderRight:"1px solid "+n.borderLight},{text:"Vel. Prom.",borderRight:"2px solid "+n.border},{text:"Metros",borderRight:"1px solid "+n.borderLight},{text:"Efic. %",borderRight:"1px solid "+n.borderLight},{text:"RU10⁵",borderRight:"1px solid "+n.borderLight},{text:"RT10⁵",borderRight:"2px solid "+n.border},{text:"Metros",borderRight:"1px solid "+n.borderLight},{text:"Cal. %",borderRight:"1px solid "+n.borderLight},{text:"Pts/100m²",borderRight:"none"}].forEach(m=>{const r=document.createElement("th");r.style.cssText=`background: ${n.headerBg}; color: ${n.headerText}; padding: 0 8px; height: 32px; line-height: 32px; text-align: center; vertical-align: middle; border-bottom: 2px solid ${n.border}; border-right: ${m.borderRight}; font-size: 11px; font-weight: 500;`,r.textContent=m.text,Q.appendChild(r)}),I.appendChild(Q),O.appendChild(I);const o=document.createElement("tbody");if(k.value.forEach((m,r)=>{const b=document.createElement("tr");b.style.cssText="border-bottom: 1px solid "+n.borderLight+";",[{value:m.ROLADA,bold:!0,color:n.text,borderRight:"2px solid "+n.border},{value:xt(m.MAQ_OE),color:n.textLight,borderRight:"1px solid "+n.borderLight},{value:xt(m.LOTE),color:n.textLight,borderRight:"1px solid "+n.borderLight},{value:dt(m.URDIDORA_ROTURAS,m.URDIDORA_METROS,m.NUM_FIOS),color:n.cyan,bold:!0,borderRight:"2px solid "+n.border},{value:m.FECHA||"-",color:n.textLight,borderRight:"1px solid "+n.borderLight,small:!0},{value:m.BASE||"-",color:n.cyan,borderRight:"1px solid "+n.borderLight},{value:m.COLOR||"-",color:n.text,borderRight:"1px solid "+n.borderLight},{value:i(m.MTS_IND,0),color:n.text,bold:!0,borderRight:"1px solid "+n.borderLight},{value:i(m.R103,1),color:n.textLight,borderRight:"1px solid "+n.borderLight},{value:m.CAV||"-",color:n.textLight,borderRight:"1px solid "+n.borderLight},{value:i(m.VEL_NOM,0),color:n.textLight,borderRight:"1px solid "+n.borderLight},{value:i(m.VEL_PROM,0),color:n.textLight,borderRight:"2px solid "+n.border},{value:i(m.MTS_CRUDOS,0),color:n.text,bold:!0,borderRight:"1px solid "+n.borderLight},{value:i(m.EFI_TEJ,1),color:n.green,borderRight:"1px solid "+n.borderLight},{value:i(m.RU105,1),color:n.cyan,borderRight:"1px solid "+n.borderLight},{value:i(m.RT105,1),color:n.cyan,borderRight:"2px solid "+n.border},{value:i(m.MTS_CAL,0),color:n.text,bold:!0,borderRight:"1px solid "+n.borderLight},{value:i(m.CAL_PERCENT,1),color:n.textLight,borderRight:"1px solid "+n.borderLight},{value:i(m.PTS_100M2,1),color:n.textLight,borderRight:"none"}].forEach(H=>{const it=document.createElement("td");it.style.cssText=`background: ${n.white}; color: ${H.color}; padding: 0 8px; height: 36px; line-height: 36px; text-align: center; vertical-align: middle; border-right: ${H.borderRight}; ${H.bold?"font-weight: 600;":""} ${H.small?"font-size: 11px;":""}`,it.textContent=H.value,b.appendChild(it)}),o.appendChild(b)}),O.appendChild(o),p.value){const m=document.createElement("tfoot"),r=document.createElement("tr");r.style.cssText="background: #f8fafc; font-weight: 600;",[{value:"TOTAL "+p.value.TOTAL_ROLADAS+" roladas",colspan:3,borderRight:"1px solid "+n.borderLight},{value:dt(p.value.URDIDORA_ROTURAS,p.value.URDIDORA_METROS,p.value.NUM_FIOS),color:n.cyan,bold:!0,borderRight:"2px solid "+n.border},{value:"-",colspan:3,borderRight:"1px solid "+n.borderLight},{value:i(p.value.MTS_IND,0),borderRight:"1px solid "+n.borderLight},{value:i(p.value.R103,1),borderRight:"1px solid "+n.borderLight},{value:p.value.CAV||"-",borderRight:"1px solid "+n.borderLight},{value:"-",borderRight:"1px solid "+n.borderLight},{value:i(p.value.VEL_PROM,0),borderRight:"2px solid "+n.border},{value:i(p.value.MTS_CRUDOS,0),borderRight:"1px solid "+n.borderLight},{value:i(p.value.EFI_TEJ,1),borderRight:"1px solid "+n.borderLight},{value:i(p.value.RU105,1),borderRight:"1px solid "+n.borderLight},{value:i(p.value.RT105,1),borderRight:"2px solid "+n.border},{value:i(p.value.MTS_CAL,0),borderRight:"1px solid "+n.borderLight},{value:i(p.value.CAL_PERCENT,1),borderRight:"1px solid "+n.borderLight},{value:i(p.value.PTS_100M2,1),borderRight:"none"}].forEach(y=>{const H=document.createElement("td");H.style.cssText=`background: #f8fafc; color: ${y.color||n.text}; padding: 0 8px; height: 40px; line-height: 40px; text-align: center; vertical-align: middle; border-top: 2px solid ${n.border}; border-right: ${y.borderRight}; ${y.bold?"font-weight: 700;":"font-weight: 600;"}`,H.textContent=y.value,y.colspan&&(H.colSpan=y.colspan),r.appendChild(H)}),m.appendChild(r),O.appendChild(m)}c.appendChild(O),document.body.appendChild(c);const C=await ee(c,{scale:2,backgroundColor:"#ffffff",logging:!1});document.body.removeChild(c),C.toBlob(async m=>{try{await navigator.clipboard.write([new ClipboardItem({"image/png":m})]),K.fire({icon:"success",title:"Copiado",text:"Imagen copiada al portapapeles",timer:1e3,showConfirmButton:!1,timerProgressBar:!0})}catch(r){console.error("Error al copiar al portapapeles:",r);const b=C.toDataURL("image/png"),y=document.createElement("a");y.download="SeguimientoRoladas.png",y.href=b,y.click(),K.fire({icon:"info",title:"Imagen descargada",text:"No se pudo copiar al portapapeles. La imagen se ha descargado.",timer:2500,showConfirmButton:!1})}},"image/png")}catch(a){console.error("Error al generar imagen:",a),K.fire({icon:"error",title:"Error",text:"Error al generar la imagen",timer:2e3,showConfirmButton:!1})}finally{vt.value=!1}},xe=async()=>{if(k.value.length===0){K.fire({icon:"warning",title:"Sin datos",text:"No hay datos para exportar",timer:1500,showConfirmButton:!1});return}try{const a=new te.Workbook,e=a.addWorksheet("Seguimiento Roladas");e.pageSetup={paperSize:9,orientation:"landscape",fitToPage:!0,fitToWidth:1,fitToHeight:0,margins:{left:.1968,right:.1968,top:.3937,bottom:.3937,header:.1968,footer:.1968}},e.addRow(["Rolada","URDIDORA","","","ÍNDIGO","","","","","","","","TEJEDURÍA","","","","CALIDAD","",""]),e.addRow(["","Maq. OE","Lote","Rot 10⁶","Fecha","Base","Color","Metros","R10³","Cav","Vel.Nom","Vel.Prom","Metros","Efic.%","RU10⁵","RT10⁵","Metros","Cal.%","Pts/100m²"]),e.mergeCells("A1:A2"),e.mergeCells("B1:D1"),e.mergeCells("E1:L1"),e.mergeCells("M1:P1"),e.mergeCells("Q1:S1");const d=e.getRow(1);d.height=20,d.font={bold:!0,size:10},d.alignment={vertical:"middle",horizontal:"center"},d.getCell(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF1F5F9"}},d.getCell(1).value="Rolada",d.getCell(2).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFDCFCE7"}},d.getCell(2).value="URDIDORA",d.getCell(5).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFDBEAFE"}},d.getCell(5).value="ÍNDIGO",d.getCell(13).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF3E8FF"}},d.getCell(13).value="TEJEDURÍA",d.getCell(17).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFEF3C7"}},d.getCell(17).value="CALIDAD",d.getCell(1).border={right:{style:"medium",color:{argb:"FF64748B"}},bottom:{style:"thin",color:{argb:"FFCBD5E1"}}},d.getCell(2).border={right:{style:"medium",color:{argb:"FF64748B"}},bottom:{style:"thin",color:{argb:"FFCBD5E1"}}},d.getCell(5).border={right:{style:"medium",color:{argb:"FF64748B"}},bottom:{style:"thin",color:{argb:"FFCBD5E1"}}},d.getCell(13).border={right:{style:"medium",color:{argb:"FF64748B"}},bottom:{style:"thin",color:{argb:"FFCBD5E1"}}},d.getCell(17).border={right:{style:"thin",color:{argb:"FFE2E8F0"}},bottom:{style:"thin",color:{argb:"FFCBD5E1"}}};const c=e.getRow(2);c.height=30,c.font={bold:!1,size:9},c.alignment={vertical:"middle",horizontal:"center",wrapText:!0};for(let r=1;r<=19;r++){const b=c.getCell(r);b.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF8FAFC"}};let y={style:"thin",color:{argb:"FFE2E8F0"}};(r===1||r===4||r===12||r===16)&&(y={style:"medium",color:{argb:"FF64748B"}}),r===19&&(y={style:"thin",color:{argb:"FFE2E8F0"}}),b.border={right:y,bottom:{style:"medium",color:{argb:"FF94A3B8"}}}}if(e.columns=[{key:"ROLADA",width:7},{key:"MAQ_OE",width:10},{key:"LOTE",width:10},{key:"ROT_106",width:8},{key:"FECHA",width:10},{key:"BASE",width:12},{key:"COLOR",width:7},{key:"MTS_IND",width:9},{key:"R103",width:8},{key:"CAV",width:4},{key:"VEL_NOM",width:7},{key:"VEL_PROM",width:7},{key:"MTS_CRUDOS",width:9},{key:"EFI_TEJ",width:7},{key:"RU105",width:8},{key:"RT105",width:8},{key:"MTS_CAL",width:9},{key:"CAL_PERCENT",width:7},{key:"PTS_100M2",width:8}],k.value.forEach(r=>{let b=null;r.URDIDORA_METROS&&r.NUM_FIOS&&Number(r.URDIDORA_METROS)>0&&Number(r.NUM_FIOS)>0&&(b=Number(r.URDIDORA_ROTURAS||0)*1e6/(Number(r.URDIDORA_METROS)*Number(r.NUM_FIOS)));const y=e.addRow({ROLADA:r.ROLADA,MAQ_OE:xt(r.MAQ_OE),LOTE:xt(r.LOTE),ROT_106:b,FECHA:r.FECHA,BASE:r.BASE,COLOR:r.COLOR,MTS_IND:r.MTS_IND?Number(r.MTS_IND):null,R103:r.R103?Number(r.R103):null,CAV:r.CAV?Number(r.CAV):null,VEL_NOM:r.VEL_NOM?Number(r.VEL_NOM):null,VEL_PROM:r.VEL_PROM?Number(r.VEL_PROM):null,MTS_CRUDOS:r.MTS_CRUDOS?Number(r.MTS_CRUDOS):null,EFI_TEJ:r.EFI_TEJ?Number(r.EFI_TEJ):null,RU105:r.RU105?Number(r.RU105):null,RT105:r.RT105?Number(r.RT105):null,MTS_CAL:r.MTS_CAL?Number(r.MTS_CAL):null,CAL_PERCENT:r.CAL_PERCENT?Number(r.CAL_PERCENT):null,PTS_100M2:r.PTS_100M2?Number(r.PTS_100M2):null});y.height=16,y.alignment={vertical:"middle",horizontal:"center"},y.font={size:9};const it=y.number%2===1?"FFFFFFFF":"FFF8FAFC";for(let q=1;q<=19;q++){const _t=y.getCell(q);_t.fill={type:"pattern",pattern:"solid",fgColor:{argb:it}};let T={style:"thin",color:{argb:"FFE2E8F0"}};(q===1||q===4||q===12||q===16)&&(T={style:"medium",color:{argb:"FF64748B"}}),q===19&&(T={style:"thin",color:{argb:"FFE2E8F0"}}),_t.border={right:T,bottom:{style:"thin",color:{argb:"FFE2E8F0"}}}}y.getCell(1).font={bold:!0,size:9},y.getCell("MTS_IND").numFmt="#,##0",y.getCell("R103").numFmt="#,##0.00",y.getCell("CAV").numFmt="#,##0",y.getCell("VEL_NOM").numFmt="#,##0.0",y.getCell("VEL_PROM").numFmt="#,##0.0",y.getCell("MTS_CRUDOS").numFmt="#,##0",y.getCell("EFI_TEJ").numFmt="#,##0.0",y.getCell("RU105").numFmt="#,##0.00",y.getCell("RT105").numFmt="#,##0.00",y.getCell("MTS_CAL").numFmt="#,##0",y.getCell("CAL_PERCENT").numFmt="#,##0.0",y.getCell("PTS_100M2").numFmt="#,##0.0",y.getCell("ROT_106").numFmt="#,##0.00",y.getCell("ROT_106").font={size:9,color:{argb:"FF059669"},bold:!0},y.getCell("R103").font={size:9,color:{argb:"FF2563EB"},bold:!0},y.getCell("EFI_TEJ").font={size:9,color:{argb:"FF7C3AED"},bold:!0},y.getCell("CAL_PERCENT").font={size:9,color:{argb:"FFB45309"},bold:!0}}),p.value){const r=e.addRow({ROLADA:`TOTAL ${p.value.TOTAL_ROLADAS} roladas`,ROT_106:Number(p.value.URDIDORA_ROTURAS)*1e6/(Number(p.value.URDIDORA_METROS)*Number(p.value.NUM_FIOS)||1),MTS_IND:Number(p.value.MTS_IND),R103:Number(p.value.R103),CAV:Number(p.value.CAV),VEL_PROM:Number(p.value.VEL_PROM),MTS_CRUDOS:Number(p.value.MTS_CRUDOS),EFI_TEJ:Number(p.value.EFI_TEJ),RU105:Number(p.value.RU105),RT105:Number(p.value.RT105),MTS_CAL:Number(p.value.MTS_CAL),CAL_PERCENT:Number(p.value.CAL_PERCENT),PTS_100M2:Number(p.value.PTS_100M2)});r.font={bold:!0,size:9},r.alignment={vertical:"middle",horizontal:"center"},r.eachCell(b=>{b.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF1F5F9"}},b.border={top:{style:"medium",color:{argb:"FF94A3B8"}},bottom:{style:"medium",color:{argb:"FF94A3B8"}},right:{style:"thin",color:{argb:"FFCBD5E1"}}}}),r.getCell("MTS_IND").numFmt="#,##0",r.getCell("R103").numFmt="#,##0.00",r.getCell("CAV").numFmt="#,##0",r.getCell("VEL_PROM").numFmt="#,##0.0",r.getCell("MTS_CRUDOS").numFmt="#,##0",r.getCell("EFI_TEJ").numFmt="#,##0.0",r.getCell("RU105").numFmt="#,##0.00",r.getCell("RT105").numFmt="#,##0.00",r.getCell("MTS_CAL").numFmt="#,##0",r.getCell("CAL_PERCENT").numFmt="#,##0.0",r.getCell("PTS_100M2").numFmt="#,##0.0",r.getCell("ROT_106").numFmt="#,##0.00"}if(p.value){const r=e.addRow({ROLADA:`TOTAL MES (${p.value.TOTAL_ROLADAS} roladas)`,MAQ_OE:"",LOTE:"",ROT_106:dt(p.value.URDIDORA_ROTURAS,p.value.URDIDORA_METROS,p.value.NUM_FIOS),FECHA:"-",BASE:"-",COLOR:"-",MTS_IND:p.value.MTS_IND,R103:p.value.R103,CAV:p.value.CAV,VEL_NOM:"-",VEL_PROM:p.value.VEL_PROM,MTS_CRUDOS:p.value.MTS_CRUDOS,EFI_TEJ:p.value.EFI_TEJ,RU105:p.value.RU105,RT105:p.value.RT105,MTS_CAL:p.value.MTS_CAL,CAL_PERCENT:p.value.CAL_PERCENT,PTS_100M2:p.value.PTS_100M2});r.height=20,r.alignment={vertical:"middle",horizontal:"center"},r.font={bold:!0,size:10},e.mergeCells(r.number,1,r.number,3);for(let b=1;b<=19;b++){const y=r.getCell(b);y.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF1F5F9"}};let H={style:"thin",color:{argb:"FFE2E8F0"}};(b===1||b===4||b===12||b===16)&&(H={style:"medium",color:{argb:"FF64748B"}}),y.border={top:{style:"medium",color:{argb:"FF94A3B8"}},right:H,bottom:{style:"medium",color:{argb:"FF94A3B8"}}}}r.getCell("MTS_IND").numFmt="#,##0",r.getCell("R103").numFmt="#,##0.00",r.getCell("VEL_PROM").numFmt="#,##0.0",r.getCell("MTS_CRUDOS").numFmt="#,##0",r.getCell("EFI_TEJ").numFmt="#,##0.0",r.getCell("RU105").numFmt="#,##0.00",r.getCell("RT105").numFmt="#,##0.00",r.getCell("MTS_CAL").numFmt="#,##0",r.getCell("CAL_PERCENT").numFmt="#,##0.0",r.getCell("PTS_100M2").numFmt="#,##0.0",r.getCell("ROT_106").numFmt="#,##0.00",r.getCell("ROT_106").font={size:10,color:{argb:"FF059669"},bold:!0},r.getCell("R103").font={size:10,color:{argb:"FF2563EB"},bold:!0},r.getCell("EFI_TEJ").font={size:10,color:{argb:"FF7C3AED"},bold:!0},r.getCell("CAL_PERCENT").font={size:10,color:{argb:"FFB45309"},bold:!0}}const x=e.rowCount;e.autoFilter={from:{row:2,column:1},to:{row:x,column:19}};const g=new Date,_=String(g.getDate()).padStart(2,"0"),f=String(g.getMonth()+1).padStart(2,"0"),n=String(g.getFullYear()).slice(-2),O=String(g.getHours()).padStart(2,"0"),I=String(g.getMinutes()).padStart(2,"0"),U=String(g.getSeconds()).padStart(2,"0"),Q=`${_}-${f}-${n}_${O}${I}${U}`,X=await a.xlsx.writeBuffer(),o=new Blob([X],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),C=window.URL.createObjectURL(o),m=document.createElement("a");m.href=C,m.download=`SeguimientoRoladas_${bt.value}_${Q}.xlsx`,m.click(),window.URL.revokeObjectURL(C),K.fire({icon:"success",title:"Exportado",text:"Excel generado correctamente",timer:1e3,showConfirmButton:!1,timerProgressBar:!0})}catch(a){console.error("Error exportando a Excel:",a),K.fire({icon:"error",title:"Error",text:"Error al exportar a Excel",timer:2e3,showConfirmButton:!1})}},ge=()=>{if(k.value.length===0)return;const a=new Date().toLocaleString("es-ES");let e=`
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="UTF-8">
      <title>Seguimiento de Roladas</title>
      <style>
        @page { 
          size: landscape; 
          margin: 0;
        }
        body { 
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
          font-size: 9px;
          margin: 0;
          padding: 5mm 5mm 10mm 5mm;
          background: white;
        }
        .header-row {
          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: 12px;
          margin-bottom: 8px;
        }
        .header-logo {
          display: flex;
          align-items: center;
          height: 25px;
          flex-shrink: 0;
        }
        .header-logo img {
          height: 25px;
          width: auto;
          object-fit: contain;
          max-width: 120px;
        }
        .header-text {
          display: flex;
          flex-direction: column;
          align-items: flex-start;
          gap: 2px;
          flex: 1;
        }
        h2 { 
          text-align: left; 
          margin: 0;
          font-size: 16px;
          font-weight: 600;
          color: #1e293b;
        }
        .fecha-info {
          text-align: left;
          margin: 0;
          color: #64748b;
          font-size: 10px;
        }
        .footer-info {
          position: fixed;
          bottom: 4mm;
          left: 5mm;
          width: calc(100% - 10mm);
          font-size: 8px;
          color: #64748b;
          background: white;
        }
        table { 
          border-collapse: collapse; 
          width: 100%;
          font-size: 9px;
          background: white;
          border: 1px solid #94a3b8;
        }
        th { 
          padding: 6px 5px;
          text-align: center;
          font-weight: 600;
          border: 1px solid #cbd5e1;
        }
        td { 
          padding: 6px 5px; 
          text-align: center;
          border: 1px solid #e2e8f0;
        }
        .section-header th {
          font-size: 10px;
          text-transform: uppercase;
          letter-spacing: 0.5px;
          padding: 8px 5px;
          border-bottom: 2px solid #94a3b8;
          color: #334155;
          background: #f8fafc;
          font-weight: 600;
        }
        .section-rolada { background: #f8fafc; border-right: 2px solid #94a3b8 !important; }
        .section-urdidora { background: #f8fafc; border-right: 2px solid #94a3b8 !important; }
        .section-indigo { background: #f8fafc; border-right: 2px solid #94a3b8 !important; }
        .section-tejeduria { background: #f8fafc; border-right: 2px solid #94a3b8 !important; }
        .section-calidad { background: #f8fafc; }
        .col-header { 
          color: #475569; 
          background: #f8fafc;
          font-size: 9px;
          font-weight: 500;
          border-bottom: 2px solid #94a3b8 !important;
        }
        .border-section { border-right: 2px solid #94a3b8 !important; }
        .totales-row td {
          background-color: #f1f5f9 !important;
          font-weight: 600;
          border-top: 2px solid #94a3b8 !important;
          padding: 8px 5px;
        }
        .font-medium { font-weight: 500; }
        @media print {
          body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        }
      </style>
    </head>
    <body>
      <div class="header-row">
        <div class="header-logo">
          <img src="/LogoSantana.jpg" alt="Logo Santana">
        </div>
        <div class="header-text">
          <h2>SEGUIMIENTO DE ROLADAS</h2>
          <div class="fecha-info">
            Período: Últimos ${ft.value} días hasta ${new Date(bt.value+"T00:00:00").toLocaleDateString("es-ES")} | ${k.value.length} roladas encontradas
          </div>
        </div>
      </div>
      <table>
        <thead>
          <tr class="section-header">
            <th rowspan="2" class="section-rolada" style="color: #475569; background: #f8fafc;">ROLADA</th>
            <th colspan="3" class="section-urdidora">URDIDORA</th>
            <th colspan="8" class="section-indigo">ÍNDIGO</th>
            <th colspan="4" class="section-tejeduria">TEJEDURÍA</th>
            <th colspan="3" class="section-calidad">CALIDAD</th>
          </tr>
          <tr class="col-header">
            <th>Maq OE</th>
            <th>Lote</th>
            <th class="border-section">Rot 10⁶</th>
            <th>Fecha</th>
            <th>Base</th>
            <th>Color</th>
            <th>Metros</th>
            <th>R‰</th>
            <th>Cav</th>
            <th>Vel.Nom</th>
            <th class="border-section">Vel.Prom</th>
            <th>Metros</th>
            <th>Efi%</th>
            <th>RU‰</th>
            <th class="border-section">RT‰</th>
            <th>Metros</th>
            <th>Cal%</th>
            <th>Pts/100m²</th>
          </tr>
        </thead>
        <tbody>`;k.value.forEach((c,x)=>{e+=`
          <tr>
            <td class="border-section font-medium">${c.ROLADA}</td>
            <td>${c.MAQ_OE||"-"}</td>
            <td>${c.LOTE||"-"}</td>
            <td class="border-section" style="color: #059669; font-weight: 600;">${dt(c.URDIDORA_ROTURAS,c.URDIDORA_METROS,c.NUM_FIOS)}</td>
            <td>${c.FECHA||"-"}</td>
            <td>${c.BASE||"-"}</td>
            <td>${xt(c.COLOR)}</td>
            <td class="font-medium">${i(c.MTS_IND,0)}</td>
            <td>${i(c.R103,1)}</td>
            <td>${c.CAV||"-"}</td>
            <td>${c.VEL_NOM||"-"}</td>
            <td class="border-section">${i(c.VEL_PROM,1)}</td>
            <td class="font-medium">${i(c.MTS_CRUDOS,0)}</td>
            <td>${i(c.EFI_TEJ,1)}</td>
            <td>${i(c.RU105,1)}</td>
            <td class="border-section">${i(c.RT105,1)}</td>
            <td class="font-medium">${i(c.MTS_CAL,0)}</td>
            <td>${i(c.CAL_PERCENT,1)}</td>
            <td>${i(c.PTS_100M2,1)}</td>
          </tr>`}),p.value&&(e+=`
          <tr class="totales-row">
            <td colspan="3">TOTAL (${p.value.TOTAL_ROLADAS} roladas)</td>
            <td class="border-section" style="color: #059669; font-weight: 700;">${dt(p.value.URDIDORA_ROTURAS,p.value.URDIDORA_METROS,p.value.NUM_FIOS)}</td>
            <td colspan="3">-</td>
            <td>${i(p.value.MTS_IND,0)}</td>
            <td>${i(p.value.R103,1)}</td>
            <td>${p.value.CAV||"-"}</td>
            <td>-</td>
            <td class="border-section">${i(p.value.VEL_PROM,1)}</td>
            <td>${i(p.value.MTS_CRUDOS,0)}</td>
            <td>${i(p.value.EFI_TEJ,1)}</td>
            <td>${i(p.value.RU105,1)}</td>
            <td class="border-section">${i(p.value.RT105,1)}</td>
            <td>${i(p.value.MTS_CAL,0)}</td>
            <td>${i(p.value.CAL_PERCENT,1)}</td>
            <td>${i(p.value.PTS_100M2,1)}</td>
          </tr>`),e+=`
        </tbody>
      </table>
      <div class="footer-info">Impreso: ${a}</div>
    </body>
    </html>`;const d=window.open("","_blank","width=1200,height=800");d.document.write(e),d.document.close(),d.onload=()=>{d.focus(),setTimeout(()=>{let c=!1;const x=()=>{d.closed||d.close()};d.onafterprint=x,d.onfocus=()=>{c&&x()};const g=d.matchMedia("print");g&&g.addEventListener&&g.addEventListener("change",_=>{_.matches||x()}),setTimeout(x,3e4),d.print(),c=!0},100)}},he=()=>{let a="",e=[],d=[],c=null;if(h.value==="urdimbre"){if(G.value.length===0)return;a="URDIMBRE",e=G.value,d=[{label:"Partida",key:"PARTIDA",align:"center"},{label:"Fecha Inicio",key:"DT_INICIO",align:"center"},{label:"Hora Inicio",key:"HORA_INICIO",align:"center"},{label:"Fecha Final",key:"DT_FINAL",align:"center"},{label:"Hora Final",key:"HORA_FINAL",align:"center"},{label:"Artigo",key:"ARTIGO",align:"center"},{label:"Metros",key:"METRAGEM",align:"right",format:"number0"},{label:"Veloc",key:"VELOC",align:"right",format:"number0"},{label:"Fios",key:"NUM_FIOS",align:"center"},{label:"R-Fiação",key:"RUP_FIACAO",align:"right",format:"number0"},{label:"R-Urd",key:"RUP_URD",align:"right",format:"number0"},{label:"R-Oper",key:"RUP_OPER",align:"right",format:"number0"},{label:"Roturas",key:"RUPTURAS",align:"right",format:"number0"},{label:"Operador",key:"NM_OPERADOR",align:"left"},{label:"Lote Fiação",key:"LOTE_FIACAO",align:"center"},{label:"Maq Fiação",key:"MAQ_FIACAO",align:"center"},{label:"Base Urdume",key:"BASE_URDUME",align:"center"}],c={METRAGEM:at.value.metros,RUP_FIACAO:at.value.rupFiacao,RUP_URD:at.value.rupUrd,RUP_OPER:at.value.rupOper,RUPTURAS:at.value.rupturas}}else if(h.value==="indigo"){if(tt.value.length===0)return;a="ÍNDIGO",e=tt.value,d=[{label:"Partida",key:"PARTIDA",align:"center"},{label:"Fecha Inicio",key:"DT_INICIO",align:"center"},{label:"Hora Inicio",key:"HORA_INICIO",align:"center"},{label:"Fecha Final",key:"DT_FINAL",align:"center"},{label:"Hora Final",key:"HORA_FINAL",align:"center"},{label:"Turno",key:"TURNO",align:"center"},{label:"Base",key:"ARTIGO",align:"center"},{label:"Color",key:"COR",align:"center"},{label:"Metros",key:"METRAGEM",align:"right",format:"number0"},{label:"Veloc.",key:"VELOC",align:"right",format:"number0"},{label:"S",key:"S",align:"center"},{label:"Roturas",key:"RUPTURAS",align:"right",format:"number0"},{label:"CV",key:"CAVALOS",align:"right",format:"number0"},{label:"Operador",key:"NM_OPERADOR",align:"left"}],c={METRAGEM:B.value.metros,RUPTURAS:B.value.roturas,CAVALOS:B.value.cv}}else if(h.value==="tecelagem")if(j.value){if(z.value.length===0)return;a=`TEJEDURÍA - Partida ${N.value}`,e=z.value,d=[{label:"Partida",key:"PARTIDA",align:"center"},{label:"Máquina",key:"MAQUINA",align:"center"},{label:"Fecha Inicio",key:"FECHA_INICIAL",align:"center"},{label:"Fecha Final",key:"FECHA_FINAL",align:"center"},{label:"Turno",key:"TURNO",align:"center"},{label:"Metros",key:"METRAGEM",align:"right",format:"number2"},{label:"Efi%",key:"EFICIENCIA",align:"right",format:"number1"},{label:"R-Tra 10⁵",key:"ROTURAS_TRA_105",align:"right",format:"number1"},{label:"R-Urd 10⁵",key:"ROTURAS_URD_105",align:"right",format:"number1"},{label:"Operador",key:"NM_OPERADOR",align:"left"}],c={METRAGEM:S.value.metros,EFICIENCIA:S.value.eficiencia,ROTURAS_TRA_105:S.value.roturasTra,ROTURAS_URD_105:S.value.roturasUrd}}else{if(V.value.length===0)return;a="TEJEDURÍA",e=V.value,d=[{label:"Partida",key:"PARTIDA",align:"center"},{label:"Fecha Inicio",key:"FECHA_INICIAL",align:"center"},{label:"Fecha Final",key:"FECHA_FINAL",align:"center"},{label:"Metros",key:"METRAGEM",align:"right",format:"number2"},{label:"Telar",key:"MAQUINA",align:"center"},{label:"Efi%",key:"EFICIENCIA",align:"right",format:"number1"},{label:"R-Tra 10⁵",key:"ROTURAS_TRA_105",align:"right",format:"number1"},{label:"R-Urd 10⁵",key:"ROTURAS_URD_105",align:"right",format:"number1"},{label:"Artigo",key:"ARTIGO",align:"left"},{label:"Cor",key:"COR",align:"center"},{label:"Nombre",key:"NOME",align:"left"},{label:"Trama",key:"TRAMA",align:"left"},{label:"Pasadas",key:"PASADAS",align:"right",format:"number0"},{label:"RPM",key:"RPM_AVER",align:"right",format:"number0"}],c={METRAGEM:L.value.metros,EFICIENCIA:L.value.eficiencia,ROTURAS_TRA_105:L.value.roturasTra,ROTURAS_URD_105:L.value.roturasUrd,PASADAS:L.value.pasadas,RPM_AVER:L.value.rpm}}else if(h.value==="calidad")if(lt.value){if(W.value.length===0)return;a=`CALIDAD - Partida ${partidaSeleccionadaCalidad.value}`,e=W.value,d=[{label:"Grupo",key:"GRP_DEF",align:"left"},{label:"Código",key:"COD_DE",align:"left"},{label:"Defecto",key:"DEFEITO",align:"left"},{label:"Metraje",key:"METRAGEM",align:"right",format:"number0"},{label:"Calidad",key:"QUALIDADE",align:"center"},{label:"Hora",key:"HORA",align:"center"},{label:"Emendas",key:"EMENDAS",align:"center"},{label:"Pieza",key:"PECA",align:"center"},{label:"Etiqueta",key:"ETIQUETA",align:"center"},{label:"Ancho",key:"LARGURA",align:"right",format:"number1"},{label:"Puntuación",key:"PONTUACAO",align:"right",format:"number1"}],c={METRAGEM:yt.value.metraje,PONTUACAO:yt.value.puntuacion}}else{if(gt.value.length===0)return;a="CALIDAD",e=gt.value,d=[{label:"Partida",key:"PARTIDA",align:"center"},{label:"Proceso",key:"ST_IND",align:"center"},{label:"Reproc",key:"REPROCESSO",align:"center"},{label:"Telar",key:"TEAR",align:"center"},{label:"Metros Total",key:"METRAGEM_TOTAL",align:"right",format:"number0"},{label:"Metros 1ª",key:"METROS_1ERA",align:"right",format:"number0"},{label:"Metros 2ª",key:"METROS_2DA",align:"right",format:"number0"},{label:"% 1ª",key:"PCT_1ERA",align:"right",format:"number1"},{label:"% 2ª",key:"PCT_2DA",align:"right",format:"number1"},{label:"Artigo",key:"ARTIGO",align:"center"},{label:"Cor",key:"COR",align:"center"}],c={METRAGEM_TOTAL:nt.value.metrosTotal,METROS_1ERA:nt.value.metros1era,METROS_2DA:nt.value.metros2da}}const x=(f,n)=>{if(f==null||f==="")return"-";if(n==="number0")return Math.round(f).toLocaleString("es-ES");if(n==="number1")return Number(f).toLocaleString("es-ES",{minimumFractionDigits:1,maximumFractionDigits:1});if(n==="number2")return Number(f).toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2});if(n==="date")try{return new Date(f+"T00:00:00").toLocaleDateString("es-ES")}catch{return f}return f};if(!e||e.length===0){console.error("No hay datos para imprimir");return}let g=`
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="UTF-8">
      <title>Detalle ${a} - Rolada ${$.value}</title>
      <style>
        @page { 
          size: landscape; 
          margin: 5mm 5mm 10mm 5mm;
          @top-left {
            content: url('/LogoSantana.jpg');
            margin-top: 0;
          }
          @bottom-left {
            content: 'Fecha: ${new Date().toLocaleDateString("es-ES")} ${new Date().toLocaleTimeString("es-ES")}';
            font-size: 8px;
            color: #64748b;
          }
        }
        body { 
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
          font-size: 9px;
          margin: 0;
          padding: 15px;
          background: white;
        }
        .header-logo {
          display: flex;
          align-items: center;
          margin-bottom: 12px;
          height: 50px;
        }
        .header-logo img {
          height: 50px;
          width: auto;
          object-fit: contain;
        }
        h2 { 
          text-align: center; 
          margin: 0 0 12px 0;
          font-size: 16px;
          font-weight: 600;
          color: #1e293b;
        }
        table { 
          border-collapse: collapse; 
          width: 100%;
          font-size: 9px;
          background: white;
          border: 1px solid #94a3b8;
        }
        th { 
          padding: 6px 5px;
          text-align: center;
          font-weight: 600;
          border: 1px solid #cbd5e1;
          background: #f8fafc;
          color: #334155;
        }
        td { 
          padding: 6px 5px; 
          border: 1px solid #e2e8f0;
        }
        .text-left { text-align: left; }
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .totales-row td {
          background-color: #f1f5f9 !important;
          font-weight: 600;
          border-top: 2px solid #94a3b8 !important;
          padding: 8px 5px;
        }
        @media print {
          body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        }
      </style>
    </head>
    <body>
      <div class="header-logo">
        <img src="/LogoSantana.jpg" alt="Logo Santana">
      </div>
      <h2>DETALLE ${a} - ROLADA ${$.value}</h2>
      <table>
        <thead>
          <tr>`;d.forEach(f=>{g+=`<th>${f.label}</th>`}),g+=`</tr>
        </thead>
        <tbody>`,console.log("Datos a imprimir:",e.length,"filas"),console.log("Muestra de datos:",e[0]),e.forEach((f,n)=>{g+="<tr>",d.forEach(O=>{const I=x(f[O.key],O.format);g+=`<td class="text-${O.align}">${I}</td>`}),g+="</tr>"}),c&&(g+='<tr class="totales-row">',d.forEach((f,n)=>{if(n===0)g+='<td class="text-center"><strong>TOTAL</strong></td>';else if(c[f.key]!==void 0){const O=x(c[f.key],f.format);g+=`<td class="text-${f.align}"><strong>${O}</strong></td>`}else g+="<td></td>"}),g+="</tr>"),g+=`
        </tbody>
      </table>
    </body>
    </html>`,console.log("HTML generado, longitud:",g.length);const _=window.open("","_blank","width=1200,height=800");if(!_){alert("No se pudo abrir la ventana de impresión. Verifica que no esté bloqueada por el navegador.");return}_.document.open(),_.document.write(g),_.document.close(),setTimeout(()=>{_.focus(),setTimeout(()=>{let f=!1;const n=()=>{_.closed||_.close()};_.onafterprint=n,_.onfocus=()=>{f&&n()};const O=_.matchMedia("print");O&&O.addEventListener&&O.addEventListener("change",I=>{I.matches||n()}),setTimeout(n,3e4),_.print(),f=!0},100)},250)};return _e(()=>{const a=new Date;a.setDate(a.getDate()-1),bt.value=a.toISOString().split("T")[0],Bt()}),(a,e)=>{var c,x,g,_,f,n,O,I,U,Q,X;const d=Oe("tippy");return R(),A("div",De,[t("main",{ref_key:"mainContentRef",ref:re,class:"w-full flex-1 min-h-0 bg-white rounded-xl shadow-sm px-4 py-3 border border-slate-200/60 flex flex-col relative"},[Ct.value?(R(),A("div",Ie,[t("div",Se,[e[9]||(e[9]=t("div",{class:"relative"},[t("div",{class:"animate-spin rounded-full h-10 w-10 border-2 border-slate-200 border-t-slate-600"})],-1)),t("div",Le,[e[8]||(e[8]=t("span",{class:"text-xs text-slate-400 uppercase tracking-wider"},"Cargando",-1)),t("span",Ue,"Últimos "+l(ft.value)+" días",1)])])])):Tt("",!0),t("div",ke,[t("div",Pe,[e[11]||(e[11]=t("img",{src:Fe,alt:"Santana Textiles",class:"h-9 w-auto object-contain opacity-90"},null,-1)),e[12]||(e[12]=t("div",null,[t("h3",{class:"text-base font-semibold text-slate-800 tracking-tight"},"Seguimiento de Roladas"),t("p",{class:"text-xs text-slate-400 mt-0.5"},"Producción ÍNDIGO")],-1)),t("div",$e,[e[10]||(e[10]=t("span",{class:"text-xs text-slate-500"},"Registros:",-1)),t("span",Ne,l(k.value.length),1)])]),t("div",ze,[t("div",Be,[e[14]||(e[14]=t("label",{for:"dias-select",class:"text-xs font-medium text-slate-500"},"Período:",-1)),et(t("select",{id:"dias-select","onUpdate:modelValue":e[0]||(e[0]=o=>ft.value=o),onChange:Bt,class:"px-2.5 py-1.5 border border-slate-200 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-blue-500 text-sm bg-white text-slate-700"},[...e[13]||(e[13]=[t("option",{value:15},"15 días",-1),t("option",{value:30},"30 días",-1),t("option",{value:45},"45 días",-1),t("option",{value:60},"60 días",-1)])],544),[[Te,ft.value,void 0,{number:!0}]])]),Ee(we,{modelValue:bt.value,"onUpdate:modelValue":e[1]||(e[1]=o=>bt.value=o),label:"Hasta:","show-buttons":!0,onChange:Bt},null,8,["modelValue"]),et((R(),A("button",{onClick:ue,disabled:vt.value||k.value.length===0,class:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-emerald-600 hover:bg-emerald-700 disabled:bg-slate-400 text-white text-sm font-medium rounded-md transition-colors"},[vt.value?(R(),A("svg",Ge,[...e[16]||(e[16]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(R(),A("svg",Ve,[...e[15]||(e[15]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",null,l(vt.value?"Copiando...":"Copiar"),1)],8,He)),[[d,{content:"Copiar como imagen al portapapeles",placement:"bottom"}]]),et((R(),A("button",{onClick:ge,disabled:k.value.length===0,class:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-indigo-600 hover:bg-indigo-700 disabled:bg-slate-400 text-white text-sm font-medium rounded-md transition-colors"},[...e[17]||(e[17]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"6 9 6 2 18 2 18 9"}),t("path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"}),t("rect",{x:"6",y:"14",width:"12",height:"8"})],-1),t("span",null,"Imprimir",-1)])],8,je)),[[d,{content:"Imprimir tabla",placement:"bottom"}]]),et((R(),A("button",{onClick:xe,disabled:k.value.length===0,class:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-slate-800 hover:bg-slate-700 disabled:bg-slate-400 text-white text-sm font-medium rounded-md transition-colors"},[...e[18]||(e[18]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M12.9,14.5L15.8,19H14L12,15.6L10,19H8.2L11.1,14.5L8.2,10H10L12,13.4L14,10H15.8L12.9,14.5Z"})],-1),t("span",null,"Excel",-1)])],8,Je)),[[d,{content:"Exportar a archivo Excel",placement:"bottom"}]])])]),t("div",{class:"overflow-auto relative bg-white rounded-lg shadow-sm border border-slate-300",ref_key:"tablaRef",ref:ae},[t("table",{ref_key:"tableElementRef",ref:le,class:"w-full text-[13px] text-slate-700 border-separate border-spacing-0"},[e[22]||(e[22]=t("thead",{class:"sticky top-0 z-10"},[t("tr",{class:"text-slate-500 text-[11px] uppercase tracking-wider"},[t("th",{scope:"col",rowspan:"2",class:"px-3 py-3 font-semibold text-center border-r-2 border-slate-300 border-b-2 border-b-slate-300 text-slate-700 bg-slate-50"},"Rolada"),t("th",{scope:"col",colspan:"3",class:"px-3 py-2 font-semibold text-center border-r-2 border-slate-300 border-b border-b-slate-300 text-slate-700 bg-slate-50"},"Urdidora"),t("th",{scope:"col",colspan:"8",class:"px-3 py-2 font-semibold text-center border-r-2 border-slate-300 border-b border-b-slate-300 text-slate-700 bg-slate-50"},"Índigo"),t("th",{scope:"col",colspan:"4",class:"px-3 py-2 font-semibold text-center border-r-2 border-slate-300 border-b border-b-slate-300 text-slate-700 bg-slate-50"},"Tejeduría"),t("th",{scope:"col",colspan:"3",class:"px-3 py-2 font-semibold text-center border-b border-b-slate-300 text-slate-700 bg-slate-50"},"Calidad")]),t("tr",{class:"text-slate-600 text-[11px] bg-slate-50"},[t("th",{scope:"col",class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Maq. OE"),t("th",{scope:"col",class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Lote"),t("th",{scope:"col",class:"px-2 py-2 font-medium text-center border-r-2 border-slate-300 border-b-2 border-b-slate-300"},"Rot 10⁶"),t("th",{scope:"col",class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Fecha"),t("th",{scope:"col",class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Base"),t("th",{scope:"col",class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Color"),t("th",{scope:"col",class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Metros"),t("th",{scope:"col",class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"R10³"),t("th",{scope:"col",class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Cav"),t("th",{scope:"col",class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Vel. Nom."),t("th",{scope:"col",class:"px-2 py-2 font-medium text-center border-r-2 border-slate-300 border-b-2 border-b-slate-300"},"Vel. Prom."),t("th",{scope:"col",class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Metros"),t("th",{scope:"col",class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Efic. %"),t("th",{scope:"col",class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"RU10⁵"),t("th",{scope:"col",class:"px-2 py-2 font-medium text-center border-r-2 border-slate-300 border-b-2 border-b-slate-300"},"RT10⁵"),t("th",{scope:"col",class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Metros"),t("th",{scope:"col",class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Cal. %"),t("th",{scope:"col",class:"px-2 py-2 font-medium text-center border-b-2 border-b-slate-300"},"Pts/100m²")])],-1)),t("tbody",null,[(R(!0),A(Z,null,ht(k.value,(o,C)=>(R(),A("tr",{key:o.ROLADA,class:"border-b border-slate-200 hover:bg-slate-50/80 transition-colors"},[t("td",Qe,l(o.ROLADA),1),t("td",qe,l(xt(o.MAQ_OE)),1),t("td",We,l(xt(o.LOTE)),1),t("td",{class:"px-2 py-2.5 text-center text-emerald-600 font-semibold tabular-nums border-r-2 border-slate-300",onClick:m=>J(o.ROLADA,C,"urdimbre")},l(dt(o.URDIDORA_ROTURAS,o.URDIDORA_METROS,o.NUM_FIOS)),9,Ye),t("td",{onClick:m=>J(o.ROLADA,C,"indigo"),class:"px-2 py-2.5 text-center text-slate-500 text-xs border-r border-slate-200 cursor-pointer hover:bg-blue-50 transition-colors"},l(o.FECHA),9,Ze),t("td",{onClick:m=>J(o.ROLADA,C,"indigo"),class:"px-2 py-2.5 text-center text-slate-700 border-r border-slate-200 cursor-pointer hover:bg-blue-50 transition-colors"},l(o.BASE),9,Ke),t("td",{onClick:m=>J(o.ROLADA,C,"indigo"),class:"px-2 py-2.5 text-center text-slate-600 border-r border-slate-200 cursor-pointer hover:bg-blue-50 transition-colors"},l(o.COLOR),9,Xe),t("td",{onClick:m=>J(o.ROLADA,C,"indigo"),class:"px-2 py-2.5 text-center text-slate-700 font-medium tabular-nums border-r border-slate-200 cursor-pointer hover:bg-blue-50 transition-colors"},l(i(o.MTS_IND,0)),9,tr),t("td",{onClick:m=>J(o.ROLADA,C,"indigo"),class:"px-2 py-2.5 text-center text-slate-600 tabular-nums border-r border-slate-200 cursor-pointer hover:bg-blue-50 transition-colors"},l(i(o.R103,2)),9,er),t("td",{onClick:m=>J(o.ROLADA,C,"indigo"),class:"px-2 py-2.5 text-center text-slate-600 tabular-nums border-r border-slate-200 cursor-pointer hover:bg-blue-50 transition-colors"},l(i(o.CAV,0)),9,rr),t("td",{onClick:m=>J(o.ROLADA,C,"indigo"),class:"px-2 py-2.5 text-center text-slate-600 tabular-nums border-r border-slate-200 cursor-pointer hover:bg-blue-50 transition-colors"},l(i(o.VEL_NOM,1)),9,or),t("td",{onClick:m=>J(o.ROLADA,C,"indigo"),class:"px-2 py-2.5 text-center text-slate-600 tabular-nums border-r-2 border-slate-300 cursor-pointer hover:bg-blue-50 transition-colors"},l(i(o.VEL_PROM,1)),9,ar),t("td",{class:"px-2 py-2.5 text-center text-slate-700 font-medium tabular-nums border-r border-slate-200 cursor-pointer hover:bg-purple-50 transition-colors",onClick:m=>J(o.ROLADA,C,"tecelagem")},l(i(o.MTS_CRUDOS,0)),9,lr),t("td",{class:"px-2 py-2.5 text-center text-slate-600 tabular-nums border-r border-slate-200 cursor-pointer hover:bg-purple-50 transition-colors",onClick:m=>J(o.ROLADA,C,"tecelagem")},l(i(o.EFI_TEJ,1)),9,sr),t("td",{class:"px-2 py-2.5 text-center text-slate-600 tabular-nums border-r border-slate-200 cursor-pointer hover:bg-purple-50 transition-colors",onClick:m=>J(o.ROLADA,C,"tecelagem")},l(i(o.RU105,2)),9,dr),t("td",{class:"px-2 py-2.5 text-center text-slate-600 tabular-nums border-r-2 border-slate-300 cursor-pointer hover:bg-purple-50 transition-colors",onClick:m=>J(o.ROLADA,C,"tecelagem")},l(i(o.RT105,2)),9,nr),t("td",{class:"px-2 py-2.5 text-center text-slate-700 font-medium tabular-nums border-r border-slate-200 cursor-pointer hover:bg-teal-50 transition-colors",onClick:m=>J(o.ROLADA,C,"calidad")},l(i(o.MTS_CAL,0)),9,ir),t("td",{class:"px-2 py-2.5 text-center text-slate-600 tabular-nums border-r border-slate-200 cursor-pointer hover:bg-teal-50 transition-colors",onClick:m=>J(o.ROLADA,C,"calidad")},l(i(o.CAL_PERCENT,1)),9,cr),t("td",{class:"px-2 py-2.5 text-center text-slate-600 tabular-nums cursor-pointer hover:bg-teal-50 transition-colors",onClick:m=>J(o.ROLADA,C,"calidad")},l(i(o.PTS_100M2,1)),9,br)]))),128))]),p.value&&k.value.length>0?(R(),A("tfoot",pr,[t("tr",ur,[t("td",xr,[e[19]||(e[19]=t("span",{class:"text-xs uppercase tracking-wide text-slate-500"},"Total",-1)),t("span",gr,l(p.value.TOTAL_ROLADAS)+" roladas",1)]),t("td",hr,l(dt(p.value.URDIDORA_ROTURAS,p.value.URDIDORA_METROS,p.value.NUM_FIOS)),1),e[20]||(e[20]=t("td",{class:"px-2 py-3 text-center text-slate-400 border-r border-slate-200 border-t-2 border-t-slate-300",colspan:"3"},"-",-1)),t("td",fr,l(i(p.value.MTS_IND,0)),1),t("td",mr,l(i(p.value.R103,1)),1),t("td",Rr,l(p.value.CAV||"-"),1),e[21]||(e[21]=t("td",{class:"px-2 py-3 text-center tabular-nums text-slate-400 border-r border-slate-200 border-t-2 border-t-slate-300"},"-",-1)),t("td",Ar,l(i(p.value.VEL_PROM,0)),1),t("td",vr,l(i(p.value.MTS_CRUDOS,0)),1),t("td",yr,l(i(p.value.EFI_TEJ,1)),1),t("td",_r,l(i(p.value.RU105,2)),1),t("td",Tr,l(i(p.value.RT105,2)),1),t("td",Er,l(i(p.value.MTS_CAL,0)),1),t("td",Cr,l(i(p.value.CAL_PERCENT,1)),1),t("td",Or,l(i(p.value.PTS_100M2,1)),1)])])):Tt("",!0)],512),!Ct.value&&k.value.length===0?(R(),A("div",Fr,[...e[23]||(e[23]=[jt('<div class="text-center" data-v-d5f44c1f><svg class="mx-auto h-10 w-10 text-slate-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-d5f44c1f><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" data-v-d5f44c1f></path></svg><h3 class="mt-3 text-sm font-medium text-slate-700" data-v-d5f44c1f>No hay datos disponibles</h3><p class="mt-1 text-xs text-slate-400" data-v-d5f44c1f>No se encontraron roladas para el período seleccionado</p></div>',1)])])):Tt("",!0)],512)],512),wt.value?(R(),A("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-1 bg-black/50 backdrop-blur-sm",onClick:Ce(Kt,["self"])},[t("div",wr,[t("div",Mr,[t("div",Dr,[t("div",Ir,[et((R(),A("button",{onClick:e[2]||(e[2]=o=>Ot("urdimbre")),class:Et(["px-3 py-2 rounded-l-md border border-slate-200 shadow-sm transition-colors text-sm font-medium flex items-center gap-1.5",h.value==="urdimbre"?"bg-amber-600 text-white border-amber-600":"bg-white text-slate-500 hover:bg-slate-50"])},[...e[24]||(e[24]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})],-1),u(" URDIMBRE ",-1)])],2)),[[d,{content:"Ver URDIMBRE",placement:"bottom"}]]),et((R(),A("button",{onClick:e[3]||(e[3]=o=>Ot("indigo")),class:Et(["px-3 py-2 border border-l-0 border-slate-200 shadow-sm transition-colors text-sm font-medium",h.value==="indigo"?"bg-blue-600 text-white border-blue-600":"bg-white text-slate-500 hover:bg-slate-50"])},[...e[25]||(e[25]=[u(" ÍNDIGO ",-1)])],2)),[[d,{content:"Ver ÍNDIGO",placement:"bottom"}]]),et((R(),A("button",{onClick:e[4]||(e[4]=o=>Ot("tecelagem")),class:Et(["px-3 py-2 border border-l-0 border-slate-200 shadow-sm transition-colors text-sm font-medium",h.value==="tecelagem"?"bg-purple-600 text-white border-purple-600":"bg-white text-slate-500 hover:bg-slate-50"])},[...e[26]||(e[26]=[u(" TEJEDURÍA ",-1)])],2)),[[d,{content:"Ver TEJEDURÍA",placement:"bottom"}]]),et((R(),A("button",{onClick:e[5]||(e[5]=o=>Ot("calidad")),class:Et(["px-3 py-2 rounded-r-md border border-l-0 border-slate-200 shadow-sm transition-colors text-sm font-medium flex items-center gap-1.5",h.value==="calidad"?"bg-teal-600 text-white border-teal-600":"bg-white text-slate-500 hover:bg-slate-50"])},[...e[27]||(e[27]=[u(" CALIDAD ",-1),t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 5l7 7-7 7M5 5l7 7-7 7"})],-1)])],2)),[[d,{content:"Ver CALIDAD",placement:"bottom"}]])]),t("div",null,[t("h3",Sr," Detalle "+l(h.value==="urdimbre"?"URDIMBRE":h.value==="indigo"?"ÍNDIGO":h.value==="tecelagem"?"TEJEDURÍA":"CALIDAD")+" - Rolada "+l($.value),1),t("p",Lr,l(mt.value+1)+" de "+l(k.value.length)+" roladas",1)]),t("div",Ur,[et((R(),A("button",{onClick:e[6]||(e[6]=o=>Zt(-1)),disabled:mt.value===0,class:"p-2 rounded-l-md border border-slate-200 shadow-sm hover:bg-slate-50 disabled:opacity-30 disabled:cursor-not-allowed transition-colors"},[...e[28]||(e[28]=[t("svg",{class:"w-5 h-5 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 19l-7-7 7-7"})],-1)])],8,kr)),[[d,{content:"Rolada anterior",placement:"bottom"}]]),et((R(),A("button",{onClick:e[7]||(e[7]=o=>Zt(1)),disabled:mt.value===k.value.length-1,class:"p-2 rounded-r-md border border-l-0 border-slate-200 shadow-sm hover:bg-slate-50 disabled:opacity-30 disabled:cursor-not-allowed transition-colors"},[...e[29]||(e[29]=[t("svg",{class:"w-5 h-5 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 5l7 7-7 7"})],-1)])],8,Pr)),[[d,{content:"Rolada siguiente",placement:"bottom"}]])])]),t("div",$r,[et((R(),A("button",{onClick:be,disabled:Ft.value||(h.value==="urdimbre"?G.value.length===0:h.value==="indigo"?tt.value.length===0:h.value==="tecelagem"?j.value?z.value.length===0:V.value.length===0:lt.value?W.value.length===0:rt.value.length===0),class:"p-2 rounded-md border border-slate-200 shadow-sm hover:bg-slate-50 disabled:opacity-30 disabled:cursor-not-allowed transition-colors"},[...e[30]||(e[30]=[t("svg",{class:"w-5 h-5 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)])],8,Nr)),[[d,{content:"Copiar como imagen",placement:"bottom"}]]),et((R(),A("button",{onClick:he,disabled:h.value==="urdimbre"?G.value.length===0:h.value==="indigo"?tt.value.length===0:h.value==="tecelagem"?j.value?z.value.length===0:V.value.length===0:lt.value?W.value.length===0:rt.value.length===0,class:"p-2 rounded-md border border-slate-200 shadow-sm hover:bg-slate-50 disabled:opacity-30 disabled:cursor-not-allowed transition-colors"},[...e[31]||(e[31]=[t("svg",{class:"w-5 h-5 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[t("polyline",{points:"6 9 6 2 18 2 18 9"}),t("path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"}),t("rect",{x:"6",y:"14",width:"12",height:"8"})],-1)])],8,zr)),[[d,{content:"Imprimir detalle",placement:"bottom"}]]),et((R(),A("button",{onClick:pe,disabled:h.value==="urdimbre"?G.value.length===0:h.value==="indigo"?tt.value.length===0:h.value==="tecelagem"?j.value?z.value.length===0:V.value.length===0:lt.value?W.value.length===0:rt.value.length===0,class:"p-2 rounded-md border border-slate-200 shadow-sm hover:bg-slate-50 disabled:opacity-30 disabled:cursor-not-allowed transition-colors"},[...e[32]||(e[32]=[t("svg",{class:"w-5 h-5 text-slate-400",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M12.9,14.5L15.8,19H14L12,15.6L10,19H8.2L11.1,14.5L8.2,10H10L12,13.4L14,10H15.8L12.9,14.5Z"})],-1)])],8,Br)),[[d,{content:"Exportar a Excel",placement:"bottom"}]]),t("button",{onClick:Kt,class:"p-2 rounded-md border border-slate-200 shadow-sm hover:bg-slate-50 transition-colors"},[...e[33]||(e[33]=[t("svg",{class:"w-5 h-5 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),h.value==="urdimbre"&&St.value||h.value==="indigo"&&Mt.value||h.value==="tecelagem"&&Dt.value||h.value==="calidad"&&It.value?(R(),A("div",Hr,[...e[34]||(e[34]=[t("div",{class:"flex flex-col items-center gap-3"},[t("div",{class:"animate-spin rounded-full h-12 w-12 border-4 border-slate-200 border-t-slate-600"}),t("span",{class:"text-slate-600"},"Cargando detalles...")],-1)])])):h.value==="urdimbre"?(R(),A(Z,{key:1},[G.value.length>0?(R(),A("div",{key:0,class:"flex-1 overflow-auto bg-white m-3 rounded-lg shadow-sm border border-slate-300",ref_key:"modalTableUrdimbreRef",ref:Wt},[t("table",Vr,[e[39]||(e[39]=t("thead",{class:"sticky top-0 z-10"},[t("tr",{class:"text-slate-600 text-[11px] bg-slate-50"},[t("th",{class:"px-2 py-2 font-medium text-center border-b-2 border-b-slate-300"},"Partida"),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},[u("Fecha"),t("br"),u("Inicio")]),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},[u("Hora"),t("br"),u("Inicio")]),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},[u("Fecha"),t("br"),u("Final")]),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},[u("Hora"),t("br"),u("Final")]),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Artículo"),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Metros"),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Vel."),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Puntas"),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},[u("Rot"),t("br"),u("Hil.")]),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},[u("Rot"),t("br"),u("Urd.")]),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},[u("Rot"),t("br"),u("Ope.")]),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},[u("Rot"),t("br"),u("Total")]),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},[u("Rot"),t("br"),u("10⁶")]),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Operador"),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Lote"),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Maq."),t("th",{class:"px-2 py-2 font-medium text-center border-b-2 border-b-slate-300"},"Base")])],-1)),t("tbody",null,[(R(!0),A(Z,null,ht(G.value,(o,C)=>(R(),A("tr",{key:C,class:"border-b border-slate-200 hover:bg-slate-50/80 transition-colors"},[t("td",Gr,l(o.PARTIDA?o.PARTIDA.replace(/^0/,""):""),1),t("td",jr,l(o.DT_INICIO),1),t("td",Jr,l(o.HORA_INICIO),1),t("td",Qr,l(o.DT_FINAL),1),t("td",qr,l(o.HORA_FINAL),1),t("td",Wr,l(o.ARTIGO),1),t("td",Yr,l(i(o.METRAGEM,0)),1),t("td",Zr,l(v(o.VELOC)),1),t("td",Kr,l(o.NUM_FIOS),1),t("td",Xr,l(ot(o.RUP_FIACAO)),1),t("td",to,l(ot(o.RUP_URD)),1),t("td",eo,l(ot(o.RUP_OPER)),1),t("td",ro,l(ot(o.RUPTURAS)),1),t("td",oo,l(dt(o.RUPTURAS,o.METRAGEM,o.NUM_FIOS)),1),t("td",ao,l(o.NM_OPERADOR),1),t("td",lo,l(o.LOTE_FIACAO),1),t("td",so,l(o.MAQ_FIACAO),1),t("td",no,l(o.BASE_URDUME),1)]))),128))]),t("tfoot",io,[t("tr",co,[e[35]||(e[35]=t("td",{class:"px-2 py-3 text-center border-t-2 border-t-slate-300"},[t("span",{class:"text-xs uppercase tracking-wide text-slate-500"},"TOTAL")],-1)),e[36]||(e[36]=t("td",{class:"px-2 py-3 border-r border-slate-200 border-t-2 border-t-slate-300",colspan:"5"},null,-1)),t("td",bo,l(i(at.value.metros,0)),1),e[37]||(e[37]=t("td",{class:"px-2 py-3 border-r border-slate-200 border-t-2 border-t-slate-300",colspan:"2"},null,-1)),t("td",po,l(at.value.rupFiacao),1),t("td",uo,l(at.value.rupUrd),1),t("td",xo,l(at.value.rupOper),1),t("td",go,l(at.value.rupturas),1),e[38]||(e[38]=t("td",{class:"px-2 py-3 border-t-2 border-t-slate-300",colspan:"5"},null,-1))])])])],512)):(R(),A("div",ho,[t("div",fo,[e[40]||(e[40]=t("svg",{class:"mx-auto h-12 w-12 text-slate-300 mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("circle",{cx:"11",cy:"11",r:"8"}),t("path",{d:"m21 21-4.35-4.35"})],-1)),e[41]||(e[41]=t("p",{class:"font-medium"},"No se encontraron detalles URDIMBRE",-1)),t("p",mo,"Rolada "+l($.value),1)])]))],64)):h.value==="indigo"?(R(),A(Z,{key:2},[tt.value.length>0?(R(),A("div",{key:0,class:"flex-1 overflow-auto bg-white m-3 rounded-lg border border-slate-300",ref_key:"modalTableRef",ref:Qt},[t("table",Ro,[e[47]||(e[47]=t("thead",{class:"sticky top-0 z-10"},[t("tr",{class:"text-slate-600 text-[11px] bg-slate-50"},[t("th",{class:"px-3 py-2 font-medium text-left border-b-2 border-b-slate-300"},"Partida"),t("th",{class:"px-3 py-2 font-medium text-center border-b-2 border-b-slate-300"},[u("Fecha"),t("br"),u("Inicio")]),t("th",{class:"px-3 py-2 font-medium text-center border-b-2 border-b-slate-300"},[u("Hora"),t("br"),u("Inicio")]),t("th",{class:"px-3 py-2 font-medium text-center border-b-2 border-b-slate-300"},[u("Fecha"),t("br"),u("Final")]),t("th",{class:"px-3 py-2 font-medium text-center border-b-2 border-b-slate-300"},[u("Hora"),t("br"),u("Final")]),t("th",{class:"px-3 py-2 font-medium text-center border-b-2 border-b-slate-300"},"Turno"),t("th",{class:"px-3 py-2 font-medium text-left border-b-2 border-b-slate-300"},"Base"),t("th",{class:"px-3 py-2 font-medium text-left border-b-2 border-b-slate-300"},"Color"),t("th",{class:"px-3 py-2 font-medium text-right border-b-2 border-b-slate-300"},"Metros"),t("th",{class:"px-3 py-2 font-medium text-center border-b-2 border-b-slate-300"},"Veloc."),t("th",{class:"px-3 py-2 font-medium text-center border-b-2 border-b-slate-300"},"S"),t("th",{class:"px-3 py-2 font-medium text-right border-b-2 border-b-slate-300"},"R10³"),t("th",{class:"px-3 py-2 font-medium text-right border-b-2 border-b-slate-300"},"Roturas"),t("th",{class:"px-3 py-2 font-medium text-center border-b-2 border-b-slate-300"},"CV"),t("th",{class:"px-3 py-2 font-medium text-left border-b-2 border-b-slate-300"},"Operador")])],-1)),t("tbody",null,[(R(!0),A(Z,null,ht(tt.value,(o,C)=>(R(),A("tr",{key:C,class:"border-b border-slate-200 hover:bg-slate-50/80 transition-colors"},[t("td",Ao,l(o.PARTIDA?o.PARTIDA.replace(/^0/,""):""),1),t("td",vo,l(o.DT_INICIO),1),t("td",yo,l(o.HORA_INICIO),1),t("td",_o,l(o.DT_FINAL),1),t("td",To,l(o.HORA_FINAL),1),t("td",Eo,l(o.TURNO),1),t("td",Co,l(o.ARTIGO?o.ARTIGO.substring(0,10):""),1),t("td",Oo,l(o.COR),1),t("td",Fo,l(i(o.METRAGEM,0)),1),t("td",wo,l(v(o.VELOC)),1),t("td",Mo,l(o.S),1),t("td",Do,l(Yt(o.RUPTURAS,o.METRAGEM)),1),t("td",Io,l(o.RUPTURAS),1),t("td",So,l(v(o.CAVALOS)),1),t("td",Lo,l(o.NM_OPERADOR),1)]))),128))]),t("tfoot",Uo,[t("tr",ko,[e[42]||(e[42]=t("td",{class:"px-3 py-3 border-t-2 border-t-slate-300"},"TOTAL",-1)),e[43]||(e[43]=t("td",{class:"px-3 py-3 border-t-2 border-t-slate-300",colspan:"7"},null,-1)),t("td",Po,l(i(B.value.metros,0)),1),e[44]||(e[44]=t("td",{class:"px-3 py-3 border-t-2 border-t-slate-300"},null,-1)),e[45]||(e[45]=t("td",{class:"px-3 py-3 border-t-2 border-t-slate-300"},null,-1)),t("td",$o,l(Yt(B.value.roturas,B.value.metros)),1),t("td",No,l(B.value.roturas),1),t("td",zo,l(v(B.value.cv)),1),e[46]||(e[46]=t("td",{class:"px-3 py-3 border-t-2 border-t-slate-300"},null,-1))])])])],512)):(R(),A("div",Bo,[t("div",Ho,[e[48]||(e[48]=t("svg",{class:"mx-auto h-12 w-12 text-slate-300 mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("circle",{cx:"11",cy:"11",r:"8"}),t("path",{d:"m21 21-4.35-4.35"})],-1)),e[49]||(e[49]=t("p",{class:"font-medium"},"No se encontraron detalles ÍNDIGO",-1)),t("p",Vo,"Rolada "+l($.value),1)])]))],64)):h.value==="tecelagem"?(R(),A(Z,{key:3},[j.value?(R(),A(Z,{key:1},[t("div",fa,[t("div",ma,[t("button",{onClick:de,class:"flex items-center gap-1 text-purple-700 hover:text-purple-900 font-medium transition-colors"},[...e[56]||(e[56]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),u(" Volver ",-1)])]),e[63]||(e[63]=t("div",{class:"h-6 w-px bg-purple-300"},null,-1)),t("div",Ra,[t("div",null,[e[57]||(e[57]=t("span",{class:"text-purple-600 font-medium"},"Artículo:",-1)),t("span",Aa,l((c=N.value)==null?void 0:c.ARTIGO),1)]),t("div",null,[e[58]||(e[58]=t("span",{class:"text-purple-600 font-medium"},"Nombre:",-1)),t("span",va,l((x=N.value)==null?void 0:x.NM_MERCADO),1)]),t("div",null,[e[59]||(e[59]=t("span",{class:"text-purple-600 font-medium"},"Trama:",-1)),t("span",ya,l((g=N.value)==null?void 0:g.TRAMA),1)]),t("div",null,[e[60]||(e[60]=t("span",{class:"text-purple-600 font-medium"},"Telar:",-1)),t("span",_a,l((_=N.value)!=null&&_.MAQUINA?parseInt(N.value.MAQUINA.slice(-3)):""),1)]),t("div",null,[e[61]||(e[61]=t("span",{class:"text-purple-600 font-medium"},"Pasadas:",-1)),t("span",Ta,l(v((f=N.value)==null?void 0:f.PASADAS)),1)]),t("div",null,[e[62]||(e[62]=t("span",{class:"text-purple-600 font-medium"},"Base:",-1)),t("span",Ea,l(((n=z.value[0])==null?void 0:n.BASE_URDUME)||""),1)])])])]),Lt.value?(R(),A("div",Ca,[...e[64]||(e[64]=[t("div",{class:"text-center"},[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600 mx-auto mb-3"}),t("p",{class:"text-slate-500"},"Cargando detalle...")],-1)])])):z.value.length>0?(R(),A("div",Oa,[t("table",Fa,[e[68]||(e[68]=t("thead",{class:"sticky top-0 z-10"},[t("tr",{class:"text-slate-600 text-[11px] bg-purple-50"},[t("th",{class:"px-3 py-2 font-medium text-center border-b-2 border-b-slate-300"},"Fecha"),t("th",{class:"px-3 py-2 font-medium text-center border-b-2 border-b-slate-300"},"Tur"),t("th",{class:"px-3 py-2 font-medium text-left border-b-2 border-b-slate-300"},"Partida"),t("th",{class:"px-3 py-2 font-medium text-right border-b-2 border-b-slate-300"},[u("Metros"),t("br"),u("Crudos")]),t("th",{class:"px-3 py-2 font-medium text-right border-b-2 border-b-slate-300"},[u("Metros"),t("br"),u("Termin.")]),t("th",{class:"px-3 py-2 font-medium text-right border-b-2 border-b-slate-300"},[u("Metros"),t("br"),u("Acumul.")]),t("th",{class:"px-3 py-2 font-medium text-center border-b-2 border-b-slate-300"},[u("Paradas"),t("br"),u("Trama")]),t("th",{class:"px-3 py-2 font-medium text-center border-b-2 border-b-slate-300"},[u("Paradas"),t("br"),u("Urdimbre")]),t("th",{class:"px-3 py-2 font-medium text-center border-b-2 border-b-slate-300"},[u("Total"),t("br"),u("Paradas")]),t("th",{class:"px-3 py-2 font-medium text-right border-b-2 border-b-slate-300"},[u("Eficiencia"),t("br"),u("%")]),t("th",{class:"px-3 py-2 font-medium text-right border-b-2 border-b-slate-300"},[u("Roturas"),t("br"),u("TRAMA 10⁵")]),t("th",{class:"px-3 py-2 font-medium text-right border-b-2 border-b-slate-300"},[u("Roturas"),t("br"),u("URDIDO 10⁵")]),t("th",{class:"px-3 py-2 font-medium text-right border-b-2 border-b-slate-300"},"RPM")])],-1)),t("tbody",null,[(R(!0),A(Z,null,ht(z.value,(o,C)=>(R(),A("tr",{key:C,class:"border-b border-slate-200 hover:bg-purple-50/50 transition-colors"},[t("td",wa,l(kt(o.DT_BASE_PRODUCAO)),1),t("td",Ma,l(o.TURNO),1),t("td",Da,l(o.PARTIDA?o.PARTIDA.replace(/^0/,""):""),1),t("td",Ia,l(i(o.METRAGEM,0)),1),t("td",Sa,l(i(o.METRAGEM,0)),1),t("td",La,l(i(ne(C),0)),1),t("td",Ua,l(o.PARADA_TRAMA),1),t("td",ka,l(o.PARADA_URDUME),1),t("td",Pa,l((o.PARADA_TRAMA||0)+(o.PARADA_URDUME||0)),1),t("td",$a,l(v(o.EFICIENCIA)),1),t("td",Na,l(v(o.ROTURAS_TRA_105)),1),t("td",za,l(v(o.ROTURAS_URD_105)),1),t("td",Ba,l(i(o.RPM,0)),1)]))),128))]),t("tfoot",Ha,[t("tr",Va,[e[65]||(e[65]=t("td",{class:"px-3 py-3 border-t-2 border-t-slate-300",colspan:"3"},"TOTAL",-1)),t("td",Ga,l(i(S.value.metros,0)),1),e[66]||(e[66]=t("td",{class:"px-3 py-3 border-t-2 border-t-slate-300"},null,-1)),e[67]||(e[67]=t("td",{class:"px-3 py-3 border-t-2 border-t-slate-300"},null,-1)),t("td",ja,l(S.value.paradasTrama),1),t("td",Ja,l(S.value.paradasUrdumbre),1),t("td",Qa,l(S.value.totalParadas),1),t("td",qa,l(v(S.value.eficiencia)),1),t("td",Wa,l(v(S.value.roturasTra)),1),t("td",Ya,l(v(S.value.roturasUrd)),1),t("td",Za,l(i(S.value.rpm,0)),1)])])])])):(R(),A("div",Ka,[...e[69]||(e[69]=[jt('<div class="text-center" data-v-d5f44c1f><svg class="mx-auto h-12 w-12 text-slate-300 mb-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-d5f44c1f><circle cx="11" cy="11" r="8" data-v-d5f44c1f></circle><path d="m21 21-4.35-4.35" data-v-d5f44c1f></path></svg><p class="font-medium" data-v-d5f44c1f>No se encontraron detalles para esta partida</p></div>',1)])]))],64)):(R(),A(Z,{key:0},[V.value.length>0?(R(),A("div",{key:0,class:"flex-1 overflow-auto bg-white m-3 rounded-lg border border-slate-300",ref_key:"modalTableTecelagemRef",ref:qt},[t("table",Go,[e[53]||(e[53]=t("thead",{class:"sticky top-0 z-10"},[t("tr",{class:"text-slate-600 text-[11px] bg-purple-50"},[t("th",{class:"px-3 py-2 font-medium text-left border-b-2 border-b-slate-300"},"Partida"),t("th",{class:"px-3 py-2 font-medium text-center border-b-2 border-b-slate-300"},[u("Fecha"),t("br"),u("Inicial")]),t("th",{class:"px-3 py-2 font-medium text-center border-b-2 border-b-slate-300"},[u("Fecha"),t("br"),u("Final")]),t("th",{class:"px-3 py-2 font-medium text-right border-b-2 border-b-slate-300"},"Metros"),t("th",{class:"px-3 py-2 font-medium text-center border-b-2 border-b-slate-300"},"Telar"),t("th",{class:"px-3 py-2 font-medium text-right border-b-2 border-b-slate-300"},[u("Eficiencia"),t("br"),u("%")]),t("th",{class:"px-3 py-2 font-medium text-right border-b-2 border-b-slate-300"},[u("Roturas"),t("br"),u("TRA 10⁵")]),t("th",{class:"px-3 py-2 font-medium text-right border-b-2 border-b-slate-300"},[u("Roturas"),t("br"),u("URD 10⁵")]),t("th",{class:"px-3 py-2 font-medium text-left border-b-2 border-b-slate-300"},"Artículo"),t("th",{class:"px-3 py-2 font-medium text-center border-b-2 border-b-slate-300"},"Color"),t("th",{class:"px-3 py-2 font-medium text-left border-b-2 border-b-slate-300"},"Nombre"),t("th",{class:"px-3 py-2 font-medium text-left border-b-2 border-b-slate-300"},"Trama"),t("th",{class:"px-3 py-2 font-medium text-right border-b-2 border-b-slate-300"},"Pasadas"),t("th",{class:"px-3 py-2 font-medium text-right border-b-2 border-b-slate-300"},"RPM")])],-1)),t("tbody",null,[(R(!0),A(Z,null,ht(V.value,(o,C)=>(R(),A("tr",{key:C,class:"border-b border-slate-200 hover:bg-purple-50/50 transition-colors cursor-pointer",onClick:m=>se(o)},[t("td",Jo,l(o.PARTIDA?o.PARTIDA.replace(/^0/,""):""),1),t("td",Qo,l(Rt(o.FECHA_INICIAL)),1),t("td",qo,l(Rt(o.FECHA_FINAL)),1),t("td",Wo,l(i(o.METRAGEM,2)),1),t("td",Yo,l(o.MAQUINA?parseInt(o.MAQUINA.slice(-3)):""),1),t("td",Zo,l(v(o.EFICIENCIA)),1),t("td",Ko,l(v(o.ROTURAS_TRA_105)),1),t("td",Xo,l(v(o.ROTURAS_URD_105)),1),t("td",ta,l(o.ARTIGO),1),t("td",ea,l(o.COR),1),t("td",ra,l(o.NM_MERCADO),1),t("td",oa,l(o.TRAMA),1),t("td",aa,l(v(o.PASADAS)),1),t("td",la,l(i(o.RPM,0)),1)],8,jo))),128))]),t("tfoot",sa,[t("tr",da,[e[50]||(e[50]=t("td",{class:"px-3 py-3 border-t-2 border-t-slate-300",colspan:"3"},"TOTAL",-1)),t("td",na,l(i(L.value.metros,2)),1),e[51]||(e[51]=t("td",{class:"px-3 py-3 border-t-2 border-t-slate-300"},null,-1)),t("td",ia,l(v(L.value.eficiencia)),1),t("td",ca,l(v(L.value.roturasTra)),1),t("td",ba,l(v(L.value.roturasUrd)),1),e[52]||(e[52]=t("td",{class:"px-3 py-3 border-t-2 border-t-slate-300",colspan:"4"},null,-1)),t("td",pa,l(v(L.value.pasadas)),1),t("td",ua,l(i(L.value.rpm,0)),1)])])])],512)):(R(),A("div",xa,[t("div",ga,[e[54]||(e[54]=t("svg",{class:"mx-auto h-12 w-12 text-slate-300 mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("circle",{cx:"11",cy:"11",r:"8"}),t("path",{d:"m21 21-4.35-4.35"})],-1)),e[55]||(e[55]=t("p",{class:"font-medium"},"No se encontraron detalles TEJEDURÍA",-1)),t("p",ha,"Rolada "+l($.value),1)])]))],64))],64)):h.value==="calidad"?(R(),A(Z,{key:4},[lt.value?(R(),A(Z,{key:1},[t("div",Nl,[t("div",zl,[t("button",{onClick:ce,class:"flex items-center gap-1 text-teal-700 hover:text-teal-900 font-medium transition-colors"},[...e[75]||(e[75]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),u(" Volver ",-1)])]),e[81]||(e[81]=t("div",{class:"h-6 w-px bg-teal-300"},null,-1)),t("div",Bl,[t("div",null,[e[76]||(e[76]=t("span",{class:"text-teal-600 font-medium"},"Partida:",-1)),t("span",Hl,l((O=st.value)==null?void 0:O.PARTIDA),1)]),t("div",null,[e[77]||(e[77]=t("span",{class:"text-teal-600 font-medium"},"Artículo:",-1)),t("span",Vl,l((I=st.value)==null?void 0:I.ARTIGO),1)]),t("div",null,[e[78]||(e[78]=t("span",{class:"text-teal-600 font-medium"},"Color:",-1)),t("span",Gl,l((U=st.value)==null?void 0:U.COR),1)]),t("div",null,[e[79]||(e[79]=t("span",{class:"text-teal-600 font-medium"},"Telar:",-1)),t("span",jl,l((Q=st.value)==null?void 0:Q.TEAR),1)]),t("div",null,[e[80]||(e[80]=t("span",{class:"text-teal-600 font-medium"},"Total:",-1)),t("span",Jl,l(i((X=st.value)==null?void 0:X.METRAGEM_TOTAL,0))+" m",1)])])])]),Ut.value?(R(),A("div",Ql,[...e[82]||(e[82]=[t("div",{class:"text-center"},[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-600 mx-auto mb-3"}),t("p",{class:"text-slate-500"},"Cargando detalle...")],-1)])])):W.value.length>0?(R(),A("div",ql,[t("table",Wl,[e[83]||(e[83]=t("thead",{class:"sticky top-0 z-10"},[t("tr",{class:"text-[11px] text-slate-600 bg-teal-50"},[t("th",{class:"px-2 py-2 font-medium text-left border-r border-slate-200 border-b-2 border-b-slate-300"},"Grupo"),t("th",{class:"px-2 py-2 font-medium text-left border-r border-slate-200 border-b-2 border-b-slate-300"},"Código"),t("th",{class:"px-2 py-2 font-medium text-left border-r border-slate-200 border-b-2 border-b-slate-300"},"Defecto"),t("th",{class:"px-2 py-2 font-medium text-right border-r border-slate-200 border-b-2 border-b-slate-300"},"Metraje"),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Calidad"),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Hora"),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Emendas"),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Pieza"),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Etiqueta"),t("th",{class:"px-2 py-2 font-medium text-right border-r border-slate-200 border-b-2 border-b-slate-300"},"Ancho"),t("th",{class:"px-2 py-2 font-medium text-right border-r border-slate-200 border-b-2 border-b-slate-300"},"Puntuación"),t("th",{class:"px-2 py-2 font-medium text-left border-b-2 border-b-slate-300"},"Revisor Final")])],-1)),t("tbody",null,[(R(!0),A(Z,null,ht(W.value,(o,C)=>(R(),A("tr",{key:C,class:"border-b border-slate-200 hover:bg-teal-50/50 transition-colors"},[t("td",Yl,l(o.GRP_DEF),1),t("td",Zl,l(o.COD_DE),1),t("td",Kl,l(o.DEFEITO),1),t("td",Xl,l(i(o.METRAGEM,0)),1),t("td",ts,l(o.QUALIDADE),1),t("td",es,l(o.HORA),1),t("td",rs,l(o.EMENDAS),1),t("td",os,l(o.PECA||o.PEÇA||""),1),t("td",as,l(o.ETIQUETA),1),t("td",ls,l(o.LARGURA),1),t("td",ss,l(o.PONTUACAO),1),t("td",ds,l(o.REVISOR_FINAL||"-"),1)]))),128))])])])):(R(),A("div",ns,[...e[84]||(e[84]=[jt('<div class="text-center" data-v-d5f44c1f><svg class="mx-auto h-12 w-12 text-slate-300 mb-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-d5f44c1f><circle cx="11" cy="11" r="8" data-v-d5f44c1f></circle><path d="m21 21-4.35-4.35" data-v-d5f44c1f></path></svg><p class="font-medium" data-v-d5f44c1f>No se encontraron detalles para esta partida</p></div>',1)])]))],64)):(R(),A(Z,{key:0},[rt.value.length>0?(R(),A("div",{key:0,class:"flex-1 overflow-auto bg-white m-3 rounded-lg shadow-sm border border-slate-300",ref_key:"modalTableCalidadRef",ref:oe},[t("table",Xa,[e[72]||(e[72]=t("thead",{class:"sticky top-0 z-10"},[t("tr",{class:"text-slate-600 text-[10px] bg-slate-50"},[t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300",rowspan:"2"},"Partida"),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300",rowspan:"2"},"S"),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300",rowspan:"2"},"R"),t("th",{class:"px-2 py-2 font-medium text-center border-r-2 border-slate-300 border-b-2 border-b-slate-300",rowspan:"2"},"Telar"),t("th",{class:"px-2 py-1 font-medium text-center border-r-2 border-slate-300 border-b border-b-slate-200 bg-slate-100",colspan:"7"},"Metros"),t("th",{class:"px-2 py-1 font-medium text-center border-r-2 border-slate-300 border-b border-b-slate-200 bg-slate-100",colspan:"6"},"Porcentaje"),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300",rowspan:"2"},"Artículo"),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300",rowspan:"2"},"Color"),t("th",{class:"px-2 py-2 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300",rowspan:"2"},"Nombre"),t("th",{class:"px-2 py-2 font-medium text-center border-b-2 border-b-slate-300",rowspan:"2"},"Trama")]),t("tr",{class:"text-slate-600 text-[9px] bg-slate-50"},[t("th",{class:"px-1 py-1 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"Total"),t("th",{class:"px-1 py-1 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"1era"),t("th",{class:"px-1 py-1 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"2da"),t("th",{class:"px-1 py-1 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},[u("2da"),t("br"),u("HIL")]),t("th",{class:"px-1 py-1 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},[u("2da"),t("br"),u("IND")]),t("th",{class:"px-1 py-1 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},[u("2da"),t("br"),u("TEJ")]),t("th",{class:"px-1 py-1 font-medium text-center border-r-2 border-slate-300 border-b-2 border-b-slate-300"},[u("2da"),t("br"),u("ACA")]),t("th",{class:"px-1 py-1 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"1era"),t("th",{class:"px-1 py-1 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},"2da"),t("th",{class:"px-1 py-1 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},[u("2da"),t("br"),u("HIL")]),t("th",{class:"px-1 py-1 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},[u("2da"),t("br"),u("IND")]),t("th",{class:"px-1 py-1 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300"},[u("2da"),t("br"),u("TEJ")]),t("th",{class:"px-1 py-1 font-medium text-center border-r-2 border-slate-300 border-b-2 border-b-slate-300"},[u("2da"),t("br"),u("ACA")])])],-1)),t("tbody",null,[(R(!0),A(Z,null,ht(gt.value,(o,C)=>(R(),A("tr",{key:C,onClick:m=>ie(o),class:"border-b border-slate-200 hover:bg-teal-50/50 transition-colors cursor-pointer"},[t("td",el,l(o.PARTIDA?o.PARTIDA.replace(/^0/,""):""),1),t("td",{class:Et(["px-2 py-2 text-center font-medium border-r border-slate-200",o.ST_IND==="1"?"text-green-600":"text-amber-600"])},l(o.ST_IND==="1"?"P":"N"),3),t("td",rl,l(o.REPROCESSO?o.REPROCESSO.charAt(0):""),1),t("td",ol,l(o.TEAR),1),t("td",al,l(i(o.METRAGEM_TOTAL,0)),1),t("td",ll,l(i(o.METROS_1ERA,0)),1),t("td",sl,l(o.METROS_2DA>0?i(o.METROS_2DA,0):""),1),t("td",dl,l(o.METROS_2DA_HIL>0?i(o.METROS_2DA_HIL,0):""),1),t("td",nl,l(o.METROS_2DA_IND>0?i(o.METROS_2DA_IND,0):""),1),t("td",il,l(o.METROS_2DA_TE>0?i(o.METROS_2DA_TE,0):""),1),t("td",cl,l(o.METROS_2DA_TEF>0?i(o.METROS_2DA_TEF,0):""),1),t("td",bl,l(v(At(o.METROS_1ERA,o.METRAGEM_TOTAL))),1),t("td",pl,l(o.METROS_2DA>0?v(At(o.METROS_2DA,o.METRAGEM_TOTAL)):""),1),t("td",ul,l(o.METROS_2DA_HIL>0?v(At(o.METROS_2DA_HIL,o.METRAGEM_TOTAL)):""),1),t("td",xl,l(o.METROS_2DA_IND>0?v(At(o.METROS_2DA_IND,o.METRAGEM_TOTAL)):""),1),t("td",gl,l(o.METROS_2DA_TE>0?v(At(o.METROS_2DA_TE,o.METRAGEM_TOTAL)):""),1),t("td",hl,l(o.METROS_2DA_TEF>0?v(At(o.METROS_2DA_TEF,o.METRAGEM_TOTAL)):""),1),t("td",fl,l(o.ARTIGO),1),t("td",ml,l(o.COR),1),t("td",Rl,l(o.NM_MERCADO),1),t("td",Al,l(o.TRAMA),1)],8,tl))),128))]),t("tfoot",vl,[t("tr",yl,[e[70]||(e[70]=t("td",{class:"px-2 py-3 text-center border-r-2 border-slate-300 border-t-2 border-t-slate-300",colspan:"4"},[t("span",{class:"text-xs uppercase tracking-wide text-slate-500"},"TOTAL")],-1)),t("td",_l,l(i(P.value.metrosTotal,0)),1),t("td",Tl,l(i(P.value.metros1era,0)),1),t("td",El,l(P.value.metros2da>0?i(P.value.metros2da,0):""),1),t("td",Cl,l(P.value.metros2daHil>0?i(P.value.metros2daHil,0):""),1),t("td",Ol,l(P.value.metros2daInd>0?i(P.value.metros2daInd,0):""),1),t("td",Fl,l(P.value.metros2daTe>0?i(P.value.metros2daTe,0):""),1),t("td",wl,l(P.value.metros2daTef>0?i(P.value.metros2daTef,0):""),1),t("td",Ml,l(v(P.value.porcPrimera)),1),t("td",Dl,l(v(P.value.porcSegunda)),1),t("td",Il,l(P.value.porc2daHil>0?v(P.value.porc2daHil):""),1),t("td",Sl,l(P.value.porc2daInd>0?v(P.value.porc2daInd):""),1),t("td",Ll,l(P.value.porc2daTe>0?v(P.value.porc2daTe):""),1),t("td",Ul,l(P.value.porc2daTef>0?v(P.value.porc2daTef):""),1),e[71]||(e[71]=t("td",{class:"px-2 py-3 border-t-2 border-t-slate-300",colspan:"4"},null,-1))])])])],512)):(R(),A("div",kl,[t("div",Pl,[e[73]||(e[73]=t("svg",{class:"mx-auto h-12 w-12 text-slate-300 mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("circle",{cx:"11",cy:"11",r:"8"}),t("path",{d:"m21 21-4.35-4.35"})],-1)),e[74]||(e[74]=t("p",{class:"font-medium"},"No se encontraron datos de CALIDAD",-1)),t("p",$l,"Rolada "+l($.value),1)])]))],64))],64)):Tt("",!0)])])):Tt("",!0)])}}},ms=Me(is,[["__scopeId","data-v-d5f44c1f"]]);export{ms as default};
