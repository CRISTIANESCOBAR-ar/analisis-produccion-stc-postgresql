import{I as yt,m as y,_ as It,o as Ot,a as r,c as i,b as t,f as H,g as Ut,h as _t,i as I,F as $,r as F,e as L,d as O,q as $t,t as l,p as z,z as Ft,n as st}from"./index-TiZQyHOj.js";import{_ as Lt}from"./LogoSantana-C2JneU89.js";import{u as zt}from"./useDatabase-DjBWN7Ss.js";import{S as at}from"./sweetalert2.esm.all-AlKuj1Cq.js";const lt=y(null),G=y([]),Qt=50,S={NETWORK:"network",API:"api",VALIDATION:"validation",AUTH:"auth",UNKNOWN:"unknown"},Ht=b=>{var T;return b?b.name==="TypeError"&&((T=b.message)!=null&&T.includes("fetch"))?S.NETWORK:b.status===401||b.status===403?S.AUTH:b.status>=400&&b.status<600?S.API:b.name==="ValidationError"||b.type==="validation"?S.VALIDATION:S.UNKNOWN:S.UNKNOWN},Yt=(b,T)=>{const Y={[S.NETWORK]:"No se pudo conectar al servidor. Verifica tu conexiÃ³n a internet.",[S.AUTH]:"SesiÃ³n expirada o no autorizado. Por favor, inicia sesiÃ³n nuevamente.",[S.API]:(b==null?void 0:b.message)||"Error al procesar la solicitud en el servidor.",[S.VALIDATION]:(b==null?void 0:b.message)||"Los datos ingresados no son vÃ¡lidos.",[S.UNKNOWN]:"OcurriÃ³ un error inesperado. Por favor, intenta nuevamente."};return Y[T]||Y[S.UNKNOWN]};function Kt(){const b=(x,P="",f={})=>{const{silent:k=!1,toast:g=!0,logToConsole:Q=!0,duration:U=5e3}=f,A=Ht(x),w=Yt(x,A),j=new Date().toISOString(),R={id:Date.now(),type:A,message:w,originalMessage:(x==null?void 0:x.message)||String(x),context:P,timestamp:j,stack:x==null?void 0:x.stack};return lt.value=R,G.value.unshift(R),G.value.length>Qt&&G.value.pop(),Q&&console.error(`[${P||"Error"}]`,{type:A,message:w,original:x}),k||(g?at.fire({icon:"error",title:P||"Error",text:w,toast:!0,position:"top-end",timer:U,timerProgressBar:!0,showConfirmButton:!1,didOpen:u=>{u.addEventListener("mouseenter",at.stopTimer),u.addEventListener("mouseleave",at.resumeTimer)}}):at.fire({icon:"error",title:P||"Error",text:w,confirmButtonText:"Entendido",confirmButtonColor:"#3085d6"})),R},T=async(x,P="",f={})=>{try{return await x()}catch(k){return b(k,P,f),null}},Y=()=>{lt.value=null},W=()=>{G.value=[],lt.value=null},E=x=>G.value.filter(P=>P.type===x);return{globalError:yt(lt),errorHistory:yt(G),handleError:b,tryCatch:T,clearError:Y,clearHistory:W,getErrorsByType:E,ErrorTypes:S}}const Bt={class:"w-full flex-1 min-h-0 bg-white rounded-2xl shadow-xl px-4 py-3 border border-slate-200 flex flex-col overflow-y-auto"},Vt={class:"flex items-center justify-between gap-4 mb-3"},Gt={class:"flex items-center gap-4"},Wt={class:"filter-inline fecha-nav"},jt={class:"fecha-controls"},qt={key:0,class:"calendar-dropdown"},Jt={class:"calendar-header"},Xt={class:"calendar-selects"},Zt=["value"],te=["value"],ee=["value"],se=["value"],ae={class:"calendar-weekdays"},le={class:"calendar-days"},oe=["onClick","disabled"],ne={class:"flex gap-1.5"},re=["disabled"],ie=["disabled"],de={class:"filter-inline"},ce={class:"grid grid-cols-1 lg:grid-cols-[450px_1fr] gap-4"},ue={class:"flex flex-col gap-2"},pe={class:"text-sm font-semibold text-slate-700"},xe={class:"overflow-auto w-full rounded-xl border border-slate-200 max-h-125"},ve={class:"min-w-full w-full table-auto divide-y divide-slate-200 text-xs tabla-resumen"},me=["onClick"],be={class:"col-revisor px-2 py-[0.3rem] text-center font-medium text-slate-700"},fe={class:"col-metros px-2 py-[0.3rem] text-center font-bold text-slate-700"},ye={class:"col-calidad px-2 py-[0.3rem] text-center text-slate-700"},_e={class:"col-pts px-2 py-[0.3rem] text-center text-slate-700"},he={class:"col-rollos px-2 py-[0.3rem] text-center text-slate-700"},ge={class:"col-sin-pts-un px-2 py-[0.3rem] text-center text-slate-700"},Pe={class:"col-sin-pts-perc px-2 py-[0.3rem] text-center text-slate-700"},De={key:0,class:"bg-slate-100 font-bold border-t-2 border-slate-300"},Re={class:"col-metros px-2 py-[0.3rem] text-center text-slate-800"},Te={class:"col-calidad px-2 py-[0.3rem] text-center text-slate-800"},Ee={class:"col-pts px-2 py-[0.3rem] text-center text-slate-800"},Ne={class:"col-rollos px-2 py-[0.3rem] text-center text-slate-800"},Se={class:"col-sin-pts-un px-2 py-[0.3rem] text-center text-slate-800"},ke={class:"col-sin-pts-perc px-2 py-[0.3rem] text-center text-slate-800"},Ce={class:"flex flex-col gap-2"},Ae={class:"text-sm font-semibold text-slate-700"},we={key:0,class:"overflow-auto w-full rounded-xl border border-slate-200 max-h-125"},Me={class:"min-w-full w-full table-auto divide-y divide-slate-200 text-xs tabla-detalle"},Ie=["onClick"],Oe={class:"px-2 py-[0.3rem] text-center text-slate-700"},Ue={class:"px-2 py-[0.3rem] text-center text-slate-700"},$e={class:"px-2 py-[0.3rem] text-center text-slate-700"},Fe={class:"px-2 py-[0.3rem] text-center text-slate-700"},Le={class:"px-2 py-[0.3rem] text-center text-slate-700"},ze={class:"px-2 py-[0.3rem] text-center text-slate-700"},Qe={class:"px-2 py-[0.3rem] text-center text-slate-700"},He={class:"px-2 py-[0.3rem] text-center text-slate-700"},Ye={class:"px-2 py-[0.3rem] text-center text-slate-700"},Ke={class:"px-2 py-[0.3rem] text-center text-slate-700"},Be={class:"px-2 py-[0.3rem] text-center text-slate-700"},Ve={class:"px-2 py-[0.3rem] text-center text-slate-700"},Ge={class:"px-2 py-[0.3rem] text-center text-slate-700"},We={key:0,class:"bg-slate-100 font-bold border-t-2 border-slate-300"},je={class:"px-2 py-[0.3rem] text-center text-slate-800"},qe={class:"px-2 py-[0.3rem] text-center text-slate-800"},Je={class:"px-2 py-[0.3rem] text-center text-slate-800"},Xe={class:"px-2 py-[0.3rem] text-center text-slate-800"},Ze={class:"px-2 py-[0.3rem] text-center text-slate-800"},ts={class:"px-2 py-[0.3rem] text-center text-slate-800"},es={class:"px-2 py-[0.3rem] text-center text-slate-800"},ss={class:"px-2 py-[0.3rem] text-center text-slate-800"},as={class:"px-2 py-[0.3rem] text-center text-slate-800"},ls={class:"px-2 py-[0.3rem] text-center text-slate-800"},os={key:1,class:"empty-state-detail"},ns={key:0,class:"mt-4 flex flex-col gap-2"},rs={class:"text-sm text-slate-700"},is={class:"ml-1 font-bold text-slate-900 text-base"},ds={class:"ml-1 font-bold text-slate-900 text-base"},cs={class:"ml-1 font-bold text-slate-900 text-base"},us={class:"ml-1 font-bold text-slate-900 text-base"},ps={class:"ml-1 font-bold text-slate-900 text-base"},xs={class:"overflow-auto w-full rounded-xl border border-slate-200 max-h-100"},vs={class:"min-w-full w-full table-auto divide-y divide-slate-200 text-xs"},ms=["onClick"],bs={class:"px-2 py-[0.3rem] text-center text-slate-700"},fs={class:"px-2 py-[0.3rem] text-center text-slate-700"},ys={class:"px-2 py-[0.3rem] text-center text-slate-700"},_s={class:"px-2 py-[0.3rem] text-center text-slate-700"},hs={class:"px-2 py-[0.3rem] text-center text-slate-700"},gs={class:"px-2 py-[0.3rem] text-center text-slate-700"},Ps={class:"px-2 py-[0.3rem] text-center text-slate-700"},Ds={class:"px-2 py-[0.3rem] text-center text-slate-700"},Rs={class:"px-2 py-[0.3rem] text-center text-slate-700"},Ts={class:"px-2 py-[0.3rem] text-center text-slate-700"},Es={class:"px-2 py-[0.3rem] text-center text-slate-700"},Ns={key:1,class:"loading-overlay"},Ss={key:2,class:"error-message"},ks={key:3,class:"empty-state"},Cs={class:"modal-content",style:{"max-width":"1200px","max-height":"80vh"}},As={class:"modal-header"},ws={class:"modal-header-title"},Ms={class:"text-xs text-slate-500 ml-2"},Is={class:"flex items-center gap-1.5"},Os=["disabled"],Us=["disabled"],$s={class:"modal-body",style:{"overflow-y":"auto","max-height":"calc(80vh - 90px)"}},Fs={key:0,class:"text-center py-8"},Ls={key:1,class:"text-center py-8 text-slate-500"},zs={key:2},Qs={class:"mb-3 p-2 bg-slate-50 rounded-lg border border-slate-200"},Hs={class:"grid grid-cols-2 gap-x-6 gap-y-1 text-sm"},Ys={class:"text-slate-900"},Ks={class:"text-slate-900"},Bs={class:"text-slate-900"},Vs={class:"text-slate-900 font-bold"},Gs={class:"overflow-auto rounded-lg border border-slate-200"},Ws={class:"min-w-full divide-y divide-slate-200 text-xs"},js={class:"bg-white divide-y divide-slate-100"},qs={class:"px-3 py-2 text-slate-600"},Js={class:"px-3 py-2 text-slate-700"},Xs={class:"px-3 py-2 text-slate-700"},Zs={class:"px-3 py-2 text-slate-700"},ta={class:"px-3 py-2 text-slate-700 font-mono"},ea={class:"px-3 py-2 text-slate-700"},sa={class:"px-3 py-2 text-center text-slate-700 font-semibold"},aa={class:"px-3 py-2 text-center"},la={class:"px-3 py-2 text-center text-slate-700"},oa={__name:"RevisionCQ",setup(b){const T=zt(),{handleError:Y,tryCatch:W}=Kt(),E=y([]),x=y({Mts_Total:0,Calidad_Perc:0,Pts_100m2:0,Rollos_1era:0,Rollos_Sin_Pts:0,Perc_Sin_Pts:0}),P=y(null),f=y([]),k=y(null),g=y([]),Q=y(!1),U=y(null),A=y(-1),w=y([]),j=y(!1),R=z(()=>{if(f.value.length===0)return{MetrosRevisados:0,CalidadPct:0,Pts100m2:0,TotalRollos:0,SinPuntos:0,SinPuntosPct:0,Telar:0,EficienciaPct:0,RU105:0,RT105:0};const s=f.value.reduce((o,c)=>o+Number(c.MetrosRevisados||0),0),e=f.value.reduce((o,c)=>o+Number(c.TotalRollos||0),0),n=f.value.reduce((o,c)=>o+Number(c.SinPuntos||0),0),v=new Set(f.value.map(o=>o.Telar).filter(o=>Number(o)>0)).size,h=s>0?f.value.reduce((o,c)=>o+Number(c.CalidadPct||0)*Number(c.MetrosRevisados||0),0)/s:0,m=s>0?f.value.reduce((o,c)=>o+Number(c.Pts100m2||0)*Number(c.MetrosRevisados||0),0)/s:0,p=s>0?f.value.reduce((o,c)=>o+Number(c.EficienciaPct||0)*Number(c.MetrosRevisados||0),0)/s:0,M=s>0?f.value.reduce((o,c)=>o+Number(c.RU105||0)*Number(c.MetrosRevisados||0),0)/s:0,V=s>0?f.value.reduce((o,c)=>o+Number(c.RT105||0)*Number(c.MetrosRevisados||0),0)/s:0;return{MetrosRevisados:s,CalidadPct:h,Pts100m2:m,TotalRollos:e,SinPuntos:n,SinPuntosPct:e>0?n/e*100:0,Telar:v,EficienciaPct:p,RU105:M,RT105:V}}),u=y({fecha:"",tramas:"Todas"}),K=y(!1),D=y(new Date().getMonth()),C=y(new Date().getFullYear()),it=y(null),dt=z(()=>{if(!u.value.fecha)return"";const[s,e,n]=u.value.fecha.split("-").map(Number),d=new Date(s,e-1,n),h=["dom","lun","mar","miÃ©","jue","vie","sÃ¡b"][d.getDay()],m=d.getDate().toString().padStart(2,"0"),p=(d.getMonth()+1).toString().padStart(2,"0"),M=d.getFullYear();return`${h} ${m}/${p}/${M}`}),ht=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],gt=z(()=>{const s=new Date().getFullYear(),e=2020,n=[];for(let d=e;d<=s+1;d++)n.push(d);return n}),ct=z(()=>new Date(C.value,D.value));function Pt(s){D.value=parseInt(s.target.value)}function Dt(s){C.value=parseInt(s.target.value)}const Rt=z(()=>{const s=[],e=new Date(C.value,D.value,1),n=new Date(C.value,D.value+1,0),d=new Date(C.value,D.value,0),v=e.getDay(),h=n.getDate(),m=d.getDate();for(let o=v-1;o>=0;o--)s.push({day:m-o,otherMonth:!0,key:`prev-${m-o}`});const p=new Date,M=u.value.fecha?new Date(u.value.fecha+"T00:00:00"):null;for(let o=1;o<=h;o++){const c=new Date(C.value,D.value,o);s.push({day:o,otherMonth:!1,selected:M&&M.getDate()===o&&M.getMonth()===D.value&&M.getFullYear()===C.value,today:p.getDate()===o&&p.getMonth()===D.value&&p.getFullYear()===C.value,key:`current-${o}`,date:c})}const V=42-s.length;for(let o=1;o<=V;o++)s.push({day:o,otherMonth:!0,key:`next-${o}`});return s});function ut(){if(K.value=!K.value,K.value&&u.value.fecha){const[s,e]=u.value.fecha.split("-").map(Number);D.value=e-1,C.value=s}}function pt(s){D.value+=s,D.value>11?(D.value=0,C.value++):D.value<0&&(D.value=11,C.value--)}function Tt(s){if(s.otherMonth)return;const e=C.value,n=(D.value+1).toString().padStart(2,"0"),d=s.day.toString().padStart(2,"0");u.value.fecha=`${e}-${n}-${d}`,K.value=!1,J()}function Et(s){setTimeout(()=>{var e;(e=it.value)!=null&&e.contains(document.activeElement)||(K.value=!1)},200)}const ot=y(null),q=z(()=>T.loading.value),xt=z(()=>T.error.value),Nt=z(()=>u.value.fecha);function B(s){if(!u.value.fecha)return;const[e,n,d]=u.value.fecha.split("-").map(Number),v=new Date(e,n-1,d);v.setDate(v.getDate()+s);const h=v.getFullYear(),m=(v.getMonth()+1).toString().padStart(2,"0"),p=v.getDate().toString().padStart(2,"0");u.value.fecha=`${h}-${m}-${p}`,J()}function St(s){Q.value||(s.key==="ArrowLeft"?(s.preventDefault(),B(-1)):s.key==="ArrowRight"&&(s.preventDefault(),B(1)))}Ot(async()=>{const s=new Date,e=new Date(s.getFullYear(),s.getMonth(),s.getDate()-1),n=e.getFullYear(),d=(e.getMonth()+1).toString().padStart(2,"0"),v=e.getDate().toString().padStart(2,"0"),h=`${n}-${d}-${v}`;u.value.fecha=h,ot.value&&ot.value.focus(),J()});async function J(){if(!Nt.value)return;P.value=null,f.value=[],k.value=null,g.value=[];const s=await W(async()=>{const e={startDate:u.value.fecha,endDate:u.value.fecha,tramas:u.value.tramas};return await T.getRevisionCQ(e)},"Cargar RevisiÃ³n CQ");E.value=s||[],At()}async function kt(s){P.value=s,k.value=null,g.value=[];const e=await W(async()=>{const n={startDate:u.value.fecha,endDate:u.value.fecha,revisor:s.Revisor,tramas:u.value.tramas};return await T.getRevisorDetalle(n)},"Cargar detalle revisor",{toast:!0});f.value=e||[]}async function Ct(s){k.value=s;try{const e={fecha:u.value.fecha,partida:s.PARTIDA||s.Partidas,revisor:P.value.Revisor};console.log("ðŸ“¦ Solicitando detalle de partida:",JSON.stringify(e,null,2));const n=await T.getPartidaDetalle(e);console.log("ðŸ“Š Respuesta del servidor:",n),console.log("ðŸ“Š NÃºmero de registros:",(n==null?void 0:n.length)||0),g.value=n||[]}catch(e){Y(e,"Cargar detalle partida",{silent:!0}),g.value=[]}}async function vt(s,e=-1){U.value=s,e===-1?A.value=g.value.findIndex(d=>d.ETIQUETA===s.ETIQUETA):A.value=e,Q.value=!0,j.value=!0,w.value=[],window.addEventListener("keydown",mt);const n=await W(async()=>(console.log("ðŸ” [FRONTEND] Pieza completa:",s),console.log("ðŸ” [FRONTEND] Etiqueta:",s.ETIQUETA),await T.getDefectosDetalle(s.ETIQUETA)),"Cargar defectos",{silent:!0});w.value=n||[],j.value=!1}function X(){Q.value=!1,U.value=null,A.value=-1,w.value=[],window.removeEventListener("keydown",mt)}function Z(s){const e=A.value+s;if(e>=0&&e<g.value.length){const n=g.value[e];vt(n,e)}}function mt(s){if(Q.value)switch(s.key){case"Escape":X();break;case"ArrowLeft":s.preventDefault(),Z(-1);break;case"ArrowRight":s.preventDefault(),Z(1);break}}function At(){if(E.value.length===0){x.value={Mts_Total:0,Calidad_Perc:0,Pts_100m2:0,Rollos_1era:0,Rollos_Sin_Pts:0,Perc_Sin_Pts:0};return}const s=E.value.reduce((m,p)=>m+Number(p.Mts_Total||0),0),e=E.value.reduce((m,p)=>m+Number(p.Rollos_1era||0),0),n=E.value.reduce((m,p)=>m+Number(p.Rollos_Sin_Pts||0),0);let d=0;s>0&&(d=E.value.reduce((m,p)=>m+Number(p.Calidad_Perc||0)*Number(p.Mts_Total||0),0)/s);let v=0;s>0&&(v=E.value.reduce((m,p)=>m+Number(p.Pts_100m2||0)*Number(p.Mts_Total||0),0)/s);let h=0;e>0&&(h=n/e*100),x.value={Mts_Total:s,Calidad_Perc:d,Pts_100m2:v,Rollos_1era:e,Rollos_Sin_Pts:n,Perc_Sin_Pts:h}}function _(s){if(s==null)return"-";const e=Number(s);return Number.isNaN(e)?"-":new Intl.NumberFormat("es-ES",{minimumFractionDigits:1,maximumFractionDigits:1}).format(e)}function tt(s){if(s==null)return"-";const e=Number(s);if(Number.isNaN(e))return"-";const d=Math.round(e).toString().replace(/\B(?=(\d{3})+(?!\d))/g,".");return e<0?`-${d.replace("-","")}`:d}function bt(s){if(!s)return"-";const e=s.toString().padStart(4,"0");return e.slice(0,2)+":"+e.slice(2,4)}function nt(s){if(!s)return"-";const e=s.toString().padStart(7,"0");return e.slice(0,1)+"-"+e.slice(1,5)+"."+e.slice(5,7)}function rt(s){if(!s)return"-";const e=s.toString();return e.length<3?e:e.slice(0,-3)+" "+e.slice(-3)}function wt(s){if(s==null)return"-";const e=parseFloat(s);return Number.isNaN(e)?"-":(e%1===0,e.toString())}function Mt(s){if(!s)return"-";const n=s.toString().split(" ")[0],[d,v,h]=n.split("-");return!d||!v||!h?s:`${h}/${v}/${d}`}return(s,e)=>{var d,v,h,m,p,M,V,o,c,ft;const n=Ft("tippy");return r(),i("div",{class:"w-full h-screen flex flex-col p-1",onKeydown:St,tabindex:"0",ref_key:"containerRef",ref:ot},[t("main",Bt,[t("div",Vt,[t("div",Gt,[e[19]||(e[19]=t("img",{src:Lt,alt:"Logo Santana",class:"h-8 w-auto object-contain shrink-0"},null,-1)),t("div",Wt,[e[16]||(e[16]=t("label",{class:"sr-only"},"Fecha:",-1)),t("div",jt,[t("div",{class:"custom-datepicker",ref_key:"datepickerRef",ref:it},[H(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>dt.value=a),class:"filter-input datepicker-input",placeholder:"Selecciona una fecha",onClick:ut,onKeydown:[e[1]||(e[1]=_t(I(a=>B(-1),["prevent"]),["left"])),e[2]||(e[2]=_t(I(a=>B(1),["prevent"]),["right"]))],onBlur:Et,readonly:""},null,544),[[Ut,dt.value]]),t("span",{class:"calendar-icon",onClick:ut},"ðŸ“…"),K.value?(r(),i("div",qt,[t("div",Jt,[t("button",{class:"calendar-nav-btn",onClick:e[3]||(e[3]=I(a=>pt(-1),["stop"]))},"<"),t("div",Xt,[t("select",{value:ct.value.getMonth(),onChange:Pt,onClick:e[4]||(e[4]=I(()=>{},["stop"])),class:"calendar-select"},[(r(),i($,null,F(ht,(a,N)=>t("option",{key:N,value:N},l(a),9,te)),64))],40,Zt),t("select",{value:ct.value.getFullYear(),onChange:Dt,onClick:e[5]||(e[5]=I(()=>{},["stop"])),class:"calendar-select"},[(r(!0),i($,null,F(gt.value,a=>(r(),i("option",{key:a,value:a},l(a),9,se))),128))],40,ee)]),t("button",{class:"calendar-nav-btn",onClick:e[6]||(e[6]=I(a=>pt(1),["stop"]))},">")]),t("div",ae,[(r(),i($,null,F(["Dom","Lun","Mar","MiÃ©","Jue","Vie","SÃ¡b"],a=>t("span",{key:a},l(a),1)),64))]),t("div",le,[(r(!0),i($,null,F(Rt.value,a=>(r(),i("button",{key:a.key,class:st(["calendar-day",{"other-month":a.otherMonth,selected:a.selected,today:a.today}]),onClick:I(N=>Tt(a),["stop"]),disabled:a.otherMonth},l(a.day),11,oe))),128))])])):L("",!0)],512),t("div",ne,[H((r(),i("button",{class:"inline-flex items-center justify-center px-2 py-1 border border-slate-200 bg-white text-slate-700 rounded-md text-sm font-medium hover:bg-slate-50 transition-colors duration-150 shadow-sm",onClick:e[7]||(e[7]=a=>B(-1)),onMousedown:e[8]||(e[8]=I(()=>{},["prevent"])),tabindex:"-1",disabled:q.value},[...e[14]||(e[14]=[O("<",-1)])],40,re)),[[n,"DÃ­a anterior (â†)"]]),H((r(),i("button",{class:"inline-flex items-center justify-center px-2 py-1 border border-slate-200 bg-white text-slate-700 rounded-md text-sm font-medium hover:bg-slate-50 transition-colors duration-150 shadow-sm",onClick:e[9]||(e[9]=a=>B(1)),onMousedown:e[10]||(e[10]=I(()=>{},["prevent"])),tabindex:"-1",disabled:q.value},[...e[15]||(e[15]=[O(">",-1)])],40,ie)),[[n,"DÃ­a siguiente (â†’)"]])])])]),t("div",de,[e[18]||(e[18]=t("label",{class:"filter-label"},"Trama:",-1)),H(t("select",{"aria-label":"Tramas","onUpdate:modelValue":e[11]||(e[11]=a=>u.value.tramas=a),class:"filter-input",onChange:J},[...e[17]||(e[17]=[t("option",{value:"Todas"},"Todas",-1),t("option",{value:"ALG 100%"},"ALG 100%",-1),t("option",{value:"P + E"},"P + E",-1),t("option",{value:"POL 100%"},"POL 100%",-1)])],544),[[$t,u.value.tramas]])])]),e[20]||(e[20]=t("div",{class:"flex items-center gap-3"},[t("span",{class:"text-lg font-bold text-slate-700"},"Informe detallado de revisiÃ³n de calidad")],-1))]),t("div",ce,[t("div",ue,[t("span",pe,l(E.value.length)+" revisores",1),t("div",xe,[t("table",ve,[e[22]||(e[22]=t("thead",{class:"bg-linear-to-r from-slate-50 to-slate-100 sticky top-0 z-20"},[t("tr",null,[t("th",{class:"col-revisor px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Revisor"),t("th",{class:"col-metros px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Metros DÃ­a"),t("th",{class:"col-calidad px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Calidad %"),t("th",{class:"col-pts px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Pts 100 mÂ²"),t("th",{class:"col-rollos px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Rollos 1era"),t("th",{class:"col-sin-pts-un px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Sin Pts [un]"),t("th",{class:"col-sin-pts-perc px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Sin Pts [%]")])],-1)),t("tbody",null,[(r(!0),i($,null,F(E.value,a=>{var N;return r(),i("tr",{key:a.Revisor,onClick:et=>kt(a),class:st([{"selected-row":((N=P.value)==null?void 0:N.Revisor)===a.Revisor},"border-t border-slate-100 hover:bg-blue-50/30 transition-colors duration-150 cursor-pointer"])},[t("td",be,l(a.Revisor),1),t("td",fe,l(tt(a.Mts_Total)),1),t("td",ye,l(_(a.Calidad_Perc)),1),t("td",_e,l(_(a.Pts_100m2)),1),t("td",he,l(a.Rollos_1era),1),t("td",ge,l(a.Rollos_Sin_Pts),1),t("td",Pe,l(_(a.Perc_Sin_Pts)),1)],10,me)}),128)),E.value.length>0?(r(),i("tr",De,[e[21]||(e[21]=t("td",{class:"col-revisor px-2 py-[0.3rem] text-center text-slate-800"},"Total",-1)),t("td",Re,l(tt(x.value.Mts_Total)),1),t("td",Te,l(_(x.value.Calidad_Perc)),1),t("td",Ee,l(_(x.value.Pts_100m2)),1),t("td",Ne,l(x.value.Rollos_1era),1),t("td",Se,l(x.value.Rollos_Sin_Pts),1),t("td",ke,l(_(x.value.Perc_Sin_Pts)),1)])):L("",!0)])])])]),t("div",Ce,[t("span",Ae,l(P.value?`Detalle - ${P.value.Revisor}`:"Seleccione un revisor"),1),P.value&&f.value.length>0?(r(),i("div",we,[t("table",Me,[e[25]||(e[25]=t("thead",{class:"bg-linear-to-r from-slate-50 to-slate-100 sticky top-0 z-20"},[t("tr",null,[t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Hora"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Nombre ArtÃ­culo"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Partidas"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Metros Revisados"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Cal. %"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Pts 100mÂ²"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Total [un]"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Sin Pts [un]"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Sin Pts [%]"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Telar"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Efic. %"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"RU 105"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"RT 105")])],-1)),t("tbody",null,[(r(!0),i($,null,F(f.value,(a,N)=>{var et;return r(),i("tr",{key:N,onClick:na=>Ct(a),class:st([{"bg-blue-100":((et=k.value)==null?void 0:et.Partidas)===a.Partidas},"border-t border-slate-100 hover:bg-blue-50/30 transition-colors duration-150 cursor-pointer"])},[t("td",Oe,l(bt(a.HoraInicio)),1),t("td",Ue,l(a.NombreArticulo),1),t("td",$e,l(nt(a.Partidas)),1),t("td",Fe,l(tt(a.MetrosRevisados)),1),t("td",Le,l(_(a.CalidadPct)),1),t("td",ze,l(_(a.Pts100m2)),1),t("td",Qe,l(a.TotalRollos),1),t("td",He,l(a.SinPuntos),1),t("td",Ye,l(_(a.SinPuntosPct)),1),t("td",Ke,l(a.Telar),1),t("td",Be,l(_(a.EficienciaPct)),1),t("td",Ve,l(_(a.RU105)),1),t("td",Ge,l(_(a.RT105)),1)],10,Ie)}),128)),f.value.length>0?(r(),i("tr",We,[e[23]||(e[23]=t("td",{class:"px-2 py-[0.3rem]"},null,-1)),e[24]||(e[24]=t("td",{colspan:"2",class:"px-2 py-[0.3rem] text-center text-slate-800"},"Total",-1)),t("td",je,l(tt(R.value.MetrosRevisados)),1),t("td",qe,l(_(R.value.CalidadPct)),1),t("td",Je,l(_(R.value.Pts100m2)),1),t("td",Xe,l(R.value.TotalRollos),1),t("td",Ze,l(R.value.SinPuntos),1),t("td",ts,l(_(R.value.SinPuntosPct)),1),t("td",es,l(R.value.Telar),1),t("td",ss,l(_(R.value.EficienciaPct)),1),t("td",as,l(_(R.value.RU105)),1),t("td",ls,l(_(R.value.RT105)),1)])):L("",!0)])])])):(r(),i("div",os,[...e[26]||(e[26]=[t("p",null,"ðŸ‘† Haz clic en un revisor para ver el detalle de su producciÃ³n",-1)])]))])]),k.value&&g.value.length>0?(r(),i("div",ns,[t("div",rs,[e[27]||(e[27]=t("span",{class:"text-slate-600"},"Detalle de Partida:",-1)),t("span",is,l(nt(k.value.Partidas)),1),e[28]||(e[28]=t("span",{class:"mx-2 text-slate-600"},"-",-1)),e[29]||(e[29]=t("span",{class:"text-slate-600"},"ArtÃ­culo:",-1)),t("span",ds,l(((v=(d=g.value[0])==null?void 0:d.ARTIGO)==null?void 0:v.substring(0,10))||"N/A"),1),e[30]||(e[30]=t("span",{class:"mx-2 text-slate-600"},"-",-1)),e[31]||(e[31]=t("span",{class:"text-slate-600"},"Color:",-1)),t("span",cs,l(((h=g.value[0])==null?void 0:h.COR)||"N/A"),1),e[32]||(e[32]=t("span",{class:"mx-2 text-slate-600"},"-",-1)),e[33]||(e[33]=t("span",{class:"text-slate-600"},"Nombre:",-1)),t("span",us,l(((m=g.value[0])==null?void 0:m.NM_MERC)||k.value.NombreArticulo),1),e[34]||(e[34]=t("span",{class:"mx-2 text-slate-600"},"-",-1)),e[35]||(e[35]=t("span",{class:"text-slate-600"},"Trama:",-1)),t("span",ps,l(((p=g.value[0])==null?void 0:p.TRAMA)||"N/A"),1)]),t("div",xs,[t("table",vs,[e[36]||(e[36]=t("thead",{class:"bg-linear-to-r from-slate-50 to-slate-100 sticky top-0 z-20"},[t("tr",null,[t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Grupo"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"CÃ³digo"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Defecto"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Metraje"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Calidad"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Hora"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Emendas"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Pieza"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Etiqueta"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Ancho"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"PuntuaciÃ³n")])],-1)),t("tbody",null,[(r(!0),i($,null,F(g.value,(a,N)=>H((r(),i("tr",{key:N,class:"border-t border-slate-100 hover:bg-blue-50/30 transition-colors duration-150 cursor-pointer",onClick:et=>vt(a)},[t("td",bs,l(a.GRP_DEF),1),t("td",fs,l(a.COD_DE),1),t("td",ys,l(a.DEFEITO),1),t("td",_s,l(wt(a.METRAGEM)),1),t("td",hs,l(a.QUALIDADE),1),t("td",gs,l(bt(a.HORA)),1),t("td",Ps,l(a.EMENDAS),1),t("td",Ds,l(rt(a.PEÃ‡A)),1),t("td",Rs,l(a.ETIQUETA),1),t("td",Ts,l(a.LARGURA),1),t("td",Es,l(a.PONTUACAO),1)],8,ms)),[[n,"Clic para ver defectos detallados"]])),128))])])])])):L("",!0),q.value?(r(),i("div",Ns,[...e[37]||(e[37]=[t("div",{class:"spinner"},null,-1),t("p",null,"Cargando datos...",-1)])])):L("",!0),xt.value?(r(),i("div",Ss," âš ï¸ Error: "+l(xt.value),1)):L("",!0),!q.value&&E.value.length===0?(r(),i("div",ks,[...e[38]||(e[38]=[t("div",{class:"empty-icon"},"ðŸ“‹",-1),t("p",{class:"empty-message"},"No hay datos de calidad disponibles",-1),t("p",{class:"empty-hint"},"Intenta ajustar los filtros o verifica la importaciÃ³n",-1)])])):L("",!0),Q.value?(r(),i("div",{key:4,class:"modal-overlay",onClick:I(X,["self"])},[t("div",Cs,[t("div",As,[t("h3",ws,[O(" ðŸ” Defectos Detallados - Pieza "+l((M=U.value)==null?void 0:M.ETIQUETA)+" ",1),t("span",Ms,"("+l(A.value+1)+" / "+l(g.value.length)+")",1)]),t("div",Is,[H((r(),i("button",{onClick:e[12]||(e[12]=a=>Z(-1)),disabled:A.value<=0,class:"nav-btn"},[...e[39]||(e[39]=[O(" â€¹ ",-1)])],8,Os)),[[n,"Pieza anterior (â†)"]]),H((r(),i("button",{onClick:e[13]||(e[13]=a=>Z(1)),disabled:A.value>=g.value.length-1,class:"nav-btn"},[...e[40]||(e[40]=[O(" â€º ",-1)])],8,Us)),[[n,"Pieza siguiente (â†’)"]]),t("button",{onClick:X,class:"modal-close-btn"},"Ã—")])]),t("div",$s,[j.value?(r(),i("div",Fs,[...e[41]||(e[41]=[t("div",{class:"spinner mx-auto mb-3"},null,-1),t("p",{class:"text-slate-600"},"Cargando defectos...",-1)])])):w.value.length===0?(r(),i("div",Ls,[...e[42]||(e[42]=[t("p",{class:"text-lg"},"ðŸ“‹ No se encontraron defectos para esta pieza",-1)])])):(r(),i("div",zs,[t("div",Qs,[t("div",Hs,[t("div",null,[e[43]||(e[43]=t("span",{class:"font-semibold text-slate-700"},"Partida:",-1)),e[44]||(e[44]=O()),t("span",Ys,l(((V=U.value)==null?void 0:V.PARTIDA)||nt((o=k.value)==null?void 0:o.Partidas)),1)]),t("div",null,[e[45]||(e[45]=t("span",{class:"font-semibold text-slate-700"},"Pieza:",-1)),e[46]||(e[46]=O()),t("span",Ks,l(rt((c=U.value)==null?void 0:c.PEÃ‡A)),1)]),t("div",null,[e[47]||(e[47]=t("span",{class:"font-semibold text-slate-700"},"Etiqueta:",-1)),e[48]||(e[48]=O()),t("span",Bs,l((ft=U.value)==null?void 0:ft.ETIQUETA),1)]),t("div",null,[e[49]||(e[49]=t("span",{class:"font-semibold text-slate-700"},"Total Defectos:",-1)),e[50]||(e[50]=O()),t("span",Vs,l(w.value.length),1)])])]),t("div",Gs,[t("table",Ws,[e[51]||(e[51]=t("thead",{class:"bg-linear-to-r from-slate-50 to-slate-100 sticky top-0"},[t("tr",null,[t("th",{class:"px-3 py-2 text-left font-semibold text-slate-700 border-b border-slate-200"},"#"),t("th",{class:"px-3 py-2 text-left font-semibold text-slate-700 border-b border-slate-200"},"Partida"),t("th",{class:"px-3 py-2 text-left font-semibold text-slate-700 border-b border-slate-200"},"Pieza"),t("th",{class:"px-3 py-2 text-left font-semibold text-slate-700 border-b border-slate-200"},"Etiqueta"),t("th",{class:"px-3 py-2 text-left font-semibold text-slate-700 border-b border-slate-200"},"CÃ³d. Defecto"),t("th",{class:"px-3 py-2 text-left font-semibold text-slate-700 border-b border-slate-200"},"DescripciÃ³n"),t("th",{class:"px-3 py-2 text-center font-semibold text-slate-700 border-b border-slate-200"},"Puntos"),t("th",{class:"px-3 py-2 text-center font-semibold text-slate-700 border-b border-slate-200"},"Calidad"),t("th",{class:"px-3 py-2 text-center font-semibold text-slate-700 border-b border-slate-200"},"Fecha Prod.")])],-1)),t("tbody",js,[(r(!0),i($,null,F(w.value,(a,N)=>(r(),i("tr",{key:N,class:"hover:bg-slate-50 transition-colors"},[t("td",qs,l(N+1),1),t("td",Js,l(a.PARTIDA),1),t("td",Xs,l(rt(a.PECA)),1),t("td",Zs,l(a.ETIQUETA),1),t("td",ta,l(a.COD_DEF),1),t("td",ea,l(a.DESC_DEFEITO),1),t("td",sa,l(a.PONTOS),1),t("td",aa,[t("span",{class:st({"px-2 py-1 rounded text-xs font-medium":!0,"bg-green-100 text-green-800":a.QUALIDADE==="PRIMEIRA","bg-yellow-100 text-yellow-800":a.QUALIDADE==="SEGUNDA","bg-red-100 text-red-800":a.QUALIDADE==="TERCEIRA"})},l(a.QUALIDADE),3)]),t("td",la,l(Mt(a.DATA_PROD)),1)]))),128))])])])]))]),t("div",{class:"modal-footer"},[t("button",{onClick:X,class:"btn-secondary"},"Cerrar")])])])):L("",!0)])],544)}}},ua=It(oa,[["__scopeId","data-v-47271cc0"]]);export{ua as default};
