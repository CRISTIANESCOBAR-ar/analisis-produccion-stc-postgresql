import{_ as re}from"./LogoSantana-C2JneU89.js";import{C as oe}from"./CustomDatepicker-CPXk6jek.js";import{E as le}from"./exceljs.min-DtXTVuKQ.js";import{h as se}from"./html2canvas.esm-BfYXEYrK.js";import{S as k}from"./sweetalert2.esm.all-AlKuj1Cq.js";import{_ as de,m as T,o as ae,a as g,c as x,b as t,t as b,e as j,f as V,u as ne,d as O,F as ie,r as be,p as ce,z as pe,n as I}from"./index-TiZQyHOj.js";const ge={class:"w-full h-screen flex flex-col p-1"},xe={key:0,class:"absolute inset-0 bg-white/40 backdrop-blur-[2px] flex items-center justify-center z-50 rounded-2xl transition-all duration-300"},ue={class:"flex flex-col items-center gap-4 bg-white/90 px-10 py-8 rounded-2xl shadow-2xl border border-blue-100"},he={class:"flex flex-col items-center gap-1"},Re={class:"text-xl text-slate-800 font-bold"},Ee={class:"flex items-center justify-between gap-4 flex-shrink-0 mb-4"},fe={class:"flex items-center gap-6"},me={class:"flex items-center gap-2 px-3 py-1.5 bg-blue-50 border border-blue-200 rounded-lg"},Ce={class:"text-sm font-bold text-blue-700"},_e={class:"flex items-center gap-2"},Te=["disabled"],Oe={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor"},Ae={key:1,class:"h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},ye={class:"text-sm"},we={class:"pl-1.5 pr-1.5 py-1.5 font-semibold text-slate-800 text-center border-r-2 border-slate-300 bg-slate-50/50 whitespace-nowrap"},De={class:"px-1 py-1.5 border-r border-slate-200 text-center text-slate-500 text-xs whitespace-nowrap"},Ie={class:"px-2 py-1.5 border-r border-slate-200 text-center text-slate-600 font-mono"},Ne={class:"px-2 py-1.5 border-r border-slate-200 text-center text-slate-600 font-mono"},Fe={class:"px-1.5 py-1.5 border-r border-slate-200 text-center text-slate-700 font-medium font-mono tabular-nums"},Le={class:"px-2 py-1.5 border-r border-slate-200 text-center text-slate-600 font-mono tabular-nums"},Me={class:"px-2 py-1.5 border-r border-slate-200 text-center font-mono font-semibold text-emerald-700 tabular-nums"},ve={class:"px-0.5 py-1.5 border-r-2 border-slate-300 text-center text-slate-600 font-mono tabular-nums text-xs"},Ue={class:"px-1 py-1.5 border-r border-slate-200 text-center text-slate-500 text-xs whitespace-nowrap"},Pe={class:"px-2 py-1.5 border-r border-slate-200 text-center text-slate-700"},Se={class:"px-0.5 py-1.5 border-r border-slate-200 text-center text-slate-600 text-xs break-words"},ke={class:"px-1.5 py-1.5 border-r border-slate-200 text-center text-slate-700 font-medium font-mono tabular-nums"},$e={class:"px-2 py-1.5 border-r border-slate-200 text-center text-slate-600 font-mono tabular-nums"},Ve={class:"px-2 py-1.5 border-r border-slate-200 text-center font-mono font-semibold text-blue-700 tabular-nums"},Ge={class:"px-2 py-1.5 border-r border-slate-200 text-center text-slate-600 font-mono tabular-nums"},Be={class:"px-0.5 py-1.5 border-r border-slate-200 text-center text-slate-600 font-mono tabular-nums text-xs"},He={class:"px-1.5 py-1.5 border-r border-slate-200 text-center text-slate-600 font-mono tabular-nums"},ze={class:"px-1.5 py-1.5 border-r border-slate-200 text-center text-slate-700 font-medium font-mono tabular-nums"},Qe={class:"px-2 py-1.5 border-r border-slate-200 text-center font-mono font-semibold text-purple-700 tabular-nums"},je={class:"px-2 py-1.5 border-r border-slate-200 text-center text-slate-600 font-mono tabular-nums"},Je={class:"px-2 py-1.5 border-r-2 border-slate-300 text-center text-slate-600 font-mono tabular-nums"},Ye={class:"px-1.5 py-1.5 border-r border-slate-200 text-center text-slate-700 font-medium font-mono tabular-nums"},We={class:"px-2 py-1.5 border-r border-slate-200 text-center font-mono font-semibold text-amber-700 tabular-nums"},qe={class:"px-0.5 py-1.5 text-center text-slate-600 font-mono tabular-nums text-xs"},Ze={key:0,class:"bg-slate-50"},Xe={__name:"InformeProduccionIndigo",setup(Ke){const G="".replace(/\/$/,""),J=G?`${G}/api`:"/api",L=T(!1),N=T(!1),p=T([]),Y=new Date,F=new Date(Y);F.setDate(F.getDate()-1);const A=T(`${F.getFullYear()}-${String(F.getMonth()+1).padStart(2,"0")}-${String(F.getDate()).padStart(2,"0")}`),W=T(null),q=T(null),Z=T(null),M=ce(()=>{if(!A.value)return"";const[s,o]=A.value.split("-").map(Number),l=new Date(s,o-1,1).toLocaleString("es-ES",{month:"long",year:"numeric"});return l.charAt(0).toUpperCase()+l.slice(1)}),i=(s,o=0)=>{if(s==null||s==="")return"";const d=parseFloat(s);return isNaN(d)?"":d.toLocaleString("es-ES",{minimumFractionDigits:o,maximumFractionDigits:o,useGrouping:!0})},v=s=>{if(!s||s<=0)return"";const o=Math.floor(s/60),d=Math.round(s%60);return`${o}:${d.toString().padStart(2,"0")}`},U=s=>{if(!s)return"";const o=s.includes("-")?s.split("-"):s.split("/");if(o.length!==3)return s;let d,l,c;return o[0].length===4?(c=o[0].slice(2),l=o[1],d=o[2]):(d=o[0],l=o[1],c=o[2].slice(2)),`${d}/${l}/${c}`},B=s=>{if(!s||s==="")return null;try{const o=s.includes("-")?s.split("-"):s.split("/");if(o.length!==3)return null;let d,l,c;o[0].length===4?(c=parseInt(o[0]),l=parseInt(o[1])-1,d=parseInt(o[2])):(d=parseInt(o[0]),l=parseInt(o[1])-1,c=parseInt(o[2]));const r=new Date(c,l,d);return isNaN(r.getTime())?null:r}catch(o){return console.error("Error convirtiendo fecha:",s,o),null}},y=s=>!s||s===0?"text-slate-400":s>=80?"text-green-600":s>=60?"text-yellow-600":"text-red-600",w=s=>{if(!s||s==="")return"";const o=s.split(",").map(c=>c.trim()).filter(c=>c!=="");if(o.length===0)return"";if(o.length===1)return o[0];if(o.length===2)return o.join(" y ");const d=o.slice(-2).join(" y ");return o.slice(0,-2).join(", ")+", "+d},H=async()=>{L.value=!0;try{if(!A.value)return;const[s,o]=A.value.split("-").map(Number),d=new Date(s,o-1,1),l=new Date,c=new Date(l.getFullYear(),l.getMonth(),l.getDate()-1);let r;s===l.getFullYear()&&o===l.getMonth()+1?r=c:r=new Date(s,o,0);const E=d.toISOString().split("T")[0],f=r.toISOString().split("T")[0],u=await fetch(`${J}/informe-produccion-indigo?fechaInicio=${E}&fechaFin=${f}`);if(!u.ok)throw new Error("Error al cargar datos");p.value=await u.json()}catch(s){console.error("Error cargando datos:",s),alert("Error al cargar los datos")}finally{L.value=!1}},X=async()=>{if(p.value.length===0){alert("No hay datos para exportar");return}try{const s=new le.Workbook,o=s.addWorksheet("ROLADAS del Mes");o.pageSetup={paperSize:9,orientation:"landscape",fitToPage:!0,fitToWidth:1,fitToHeight:0,margins:{left:.1968,right:.1968,top:.3937,bottom:.3937,header:.1968,footer:.1968}},o.addRow(["Rolada","URDIDEIRA","","","","","","","ÍNDIGO","","","","","","","","","","","","","","","TEJEDURÍA","","","","CALIDAD","",""]),o.addRow(["","Fecha","Maq. OE","Lote","Metros","Rot. Tot.","Rot 10⁶","Tiempo","Fecha","Base","Col","Metros","Rot. Tot.","Rot 10³","CV","Tiempo","Vel.","N","%","P","%","Q","%","Metros","Efic. %","Rot URD 10⁵","Rot TRA 10⁵","Metros","Cal. %","Pts. 100m²"]),o.mergeCells("A1:A2"),o.mergeCells("B1:H1"),o.mergeCells("I1:W1"),o.mergeCells("X1:AA1"),o.mergeCells("AB1:AD1");const d=o.getRow(1);d.height=20,d.font={bold:!0,size:10},d.alignment={vertical:"middle",horizontal:"center"},d.getCell(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF1F5F9"}},d.getCell(1).value="Rolada",d.getCell(2).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFDCFCE7"}},d.getCell(2).value="URDIDEIRA",d.getCell(9).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFDBEAFE"}},d.getCell(9).value="ÍNDIGO",d.getCell(24).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF3E8FF"}},d.getCell(24).value="TEJEDURÍA",d.getCell(28).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFEF3C7"}},d.getCell(28).value="CALIDAD",d.getCell(1).border={right:{style:"medium",color:{argb:"FF64748B"}},bottom:{style:"thin",color:{argb:"FFCBD5E1"}}},d.getCell(2).border={right:{style:"medium",color:{argb:"FF64748B"}},bottom:{style:"thin",color:{argb:"FFCBD5E1"}}},d.getCell(9).border={right:{style:"medium",color:{argb:"FF64748B"}},bottom:{style:"thin",color:{argb:"FFCBD5E1"}}},d.getCell(24).border={right:{style:"medium",color:{argb:"FF64748B"}},bottom:{style:"thin",color:{argb:"FFCBD5E1"}}},d.getCell(28).border={right:{style:"thin",color:{argb:"FFE2E8F0"}},bottom:{style:"thin",color:{argb:"FFCBD5E1"}}};const l=o.getRow(2);l.height=30,l.font={bold:!1,size:9},l.alignment={vertical:"middle",horizontal:"center",wrapText:!0};for(let e=1;e<=30;e++){const a=l.getCell(e);a.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF8FAFC"}};let m={style:"thin",color:{argb:"FFE2E8F0"}};(e===1||e===8||e===23||e===27)&&(m={style:"medium",color:{argb:"FF64748B"}}),e===30&&(m={style:"thin",color:{argb:"FFE2E8F0"}}),a.border={right:m,bottom:{style:"medium",color:{argb:"FF94A3B8"}}}}o.columns=[{key:"ROLADA",width:7},{key:"FECHA_URDIDORA",width:10},{key:"MAQ_OE",width:10},{key:"LOTE",width:10},{key:"URDIDORA_M",width:9},{key:"URDIDORA_ROT_TOT",width:8},{key:"URDIDORA_ROT_106",width:8},{key:"URDIDORA_TIEMPO",width:7},{key:"FECHA_INDIGO",width:10},{key:"ARTIGO",width:12},{key:"COR",width:7},{key:"METRAGEM",width:9},{key:"RUPTURAS",width:8},{key:"ROT_103",width:8},{key:"CAVALOS",width:3},{key:"TIEMPO_MINUTOS",width:7},{key:"VELOC_PROMEDIO",width:7},{key:"N_COUNT",width:5},{key:"N_PERCENT",width:5},{key:"P_COUNT",width:5},{key:"P_PERCENT",width:5},{key:"Q_COUNT",width:5},{key:"Q_PERCENT",width:5},{key:"TECELAGEM_METROS",width:9},{key:"TECELAGEM_EFICIENCIA",width:8},{key:"RT105",width:8},{key:"RU105",width:8},{key:"METROS_CAL",width:9},{key:"CAL_PERCENT",width:7},{key:"PTS_100M2",width:6}],p.value.forEach(e=>{const a=o.addRow({ROLADA:e.ROLADA,FECHA_URDIDORA:B(e.FECHA_URDIDORA),MAQ_OE:w(e.MAQ_OE),LOTE:w(e.LOTE),URDIDORA_M:e.URDIDORA_M!==null&&e.URDIDORA_M!==void 0&&e.URDIDORA_M!==""?Number(e.URDIDORA_M):null,URDIDORA_ROT_TOT:e.URDIDORA_ROT_TOT!==null&&e.URDIDORA_ROT_TOT!==void 0&&e.URDIDORA_ROT_TOT!==""?Number(e.URDIDORA_ROT_TOT):null,URDIDORA_ROT_106:e.URDIDORA_ROT_106!==null&&e.URDIDORA_ROT_106!==void 0&&e.URDIDORA_ROT_106!==""?Number(e.URDIDORA_ROT_106):null,URDIDORA_TIEMPO:e.URDIDORA_TIEMPO_MIN?e.URDIDORA_TIEMPO_MIN/1440:null,FECHA_INDIGO:B(e.FECHA_INDIGO),ARTIGO:e.ARTIGO?e.ARTIGO.substring(0,10):"",COR:e.COR,METRAGEM:e.METRAGEM!==null&&e.METRAGEM!==void 0&&e.METRAGEM!==""?Number(e.METRAGEM):null,RUPTURAS:e.RUPTURAS!==null&&e.RUPTURAS!==void 0&&e.RUPTURAS!==""?Number(e.RUPTURAS):null,ROT_103:e.ROT_103!==null&&e.ROT_103!==void 0&&e.ROT_103!==""?Number(e.ROT_103):null,CAVALOS:e.CAVALOS!==null&&e.CAVALOS!==void 0&&e.CAVALOS!==""?Number(e.CAVALOS):null,TIEMPO_MINUTOS:e.TIEMPO_MINUTOS?e.TIEMPO_MINUTOS/1440:null,VELOC_PROMEDIO:e.VELOC_PROMEDIO!==null&&e.VELOC_PROMEDIO!==void 0&&e.VELOC_PROMEDIO!==""?Number(e.VELOC_PROMEDIO):null,N_COUNT:e.N_COUNT!==null&&e.N_COUNT!==void 0&&e.N_COUNT!==""?Number(e.N_COUNT):null,N_PERCENT:e.N_PERCENT!==null&&e.N_PERCENT!==void 0&&e.N_PERCENT!==""?Number(e.N_PERCENT):null,P_COUNT:e.P_COUNT!==null&&e.P_COUNT!==void 0&&e.P_COUNT!==""?Number(e.P_COUNT):null,P_PERCENT:e.P_PERCENT!==null&&e.P_PERCENT!==void 0&&e.P_PERCENT!==""?Number(e.P_PERCENT):null,Q_COUNT:e.Q_COUNT!==null&&e.Q_COUNT!==void 0&&e.Q_COUNT!==""?Number(e.Q_COUNT):null,Q_PERCENT:e.Q_PERCENT!==null&&e.Q_PERCENT!==void 0&&e.Q_PERCENT!==""?Number(e.Q_PERCENT):null,TECELAGEM_METROS:e.TECELAGEM_METROS!==null&&e.TECELAGEM_METROS!==void 0&&e.TECELAGEM_METROS!==""?Number(e.TECELAGEM_METROS):null,TECELAGEM_EFICIENCIA:e.TECELAGEM_EFICIENCIA!==null&&e.TECELAGEM_EFICIENCIA!==void 0&&e.TECELAGEM_EFICIENCIA!==""?Number(e.TECELAGEM_EFICIENCIA):null,RT105:e.RT105!==null&&e.RT105!==void 0&&e.RT105!==""?Number(e.RT105):null,RU105:e.RU105!==null&&e.RU105!==void 0&&e.RU105!==""?Number(e.RU105):null,METROS_CAL:e.METROS_CAL!==null&&e.METROS_CAL!==void 0&&e.METROS_CAL!==""?Number(e.METROS_CAL):null,CAL_PERCENT:e.CAL_PERCENT!==null&&e.CAL_PERCENT!==void 0&&e.CAL_PERCENT!==""?Number(e.CAL_PERCENT):null,PTS_100M2:e.PTS_100M2!==null&&e.PTS_100M2!==void 0&&e.PTS_100M2!==""?Number(e.PTS_100M2):null});a.height=16,a.alignment={vertical:"middle",horizontal:"center"},a.font={size:9};const te=a.number%2===1?"FFFFFFFF":"FFF8FAFC";for(let C=1;C<=30;C++){const Q=a.getCell(C);Q.fill={type:"pattern",pattern:"solid",fgColor:{argb:te}};let $={style:"thin",color:{argb:"FFE2E8F0"}};(C===1||C===8||C===23||C===27)&&($={style:"medium",color:{argb:"FF64748B"}}),C===30&&($={style:"thin",color:{argb:"FFE2E8F0"}}),Q.border={right:$,bottom:{style:"thin",color:{argb:"FFE2E8F0"}}}}a.getCell(1).font={bold:!0,size:9},a.getCell("FECHA_URDIDORA").numFmt="dd/mm/yy",a.getCell("URDIDORA_M").numFmt="#,##0",a.getCell("URDIDORA_ROT_TOT").numFmt="#,##0",a.getCell("URDIDORA_ROT_106").numFmt="#,##0.00",a.getCell("URDIDORA_TIEMPO").numFmt="[hh]:mm",a.getCell("FECHA_INDIGO").numFmt="dd/mm/yy",a.getCell("METRAGEM").numFmt="#,##0",a.getCell("RUPTURAS").numFmt="#,##0",a.getCell("ROT_103").numFmt="#,##0.00",a.getCell("CAVALOS").numFmt="#,##0",a.getCell("TIEMPO_MINUTOS").numFmt="[hh]:mm",a.getCell("VELOC_PROMEDIO").numFmt="#,##0.0",a.getCell("N_COUNT").numFmt="#,##0",a.getCell("N_PERCENT").numFmt="#,##0.0",a.getCell("P_COUNT").numFmt="#,##0",a.getCell("P_PERCENT").numFmt="#,##0.0",a.getCell("Q_COUNT").numFmt="#,##0",a.getCell("Q_PERCENT").numFmt="#,##0.0",a.getCell("TECELAGEM_METROS").numFmt="#,##0",a.getCell("TECELAGEM_EFICIENCIA").numFmt="#,##0.00",a.getCell("RT105").numFmt="#,##0.00",a.getCell("RU105").numFmt="#,##0.00",a.getCell("METROS_CAL").numFmt="#,##0",a.getCell("CAL_PERCENT").numFmt="#,##0.0",a.getCell("PTS_100M2").numFmt="#,##0.0",a.getCell("URDIDORA_ROT_106").font={size:9,color:{argb:"FF059669"},bold:!0},a.getCell("ROT_103").font={size:9,color:{argb:"FF2563EB"},bold:!0},a.getCell("TECELAGEM_EFICIENCIA").font={size:9,color:{argb:"FF7C3AED"},bold:!0},a.getCell("CAL_PERCENT").font={size:9,color:{argb:"FFB45309"},bold:!0}});const c=o.rowCount;o.autoFilter={from:{row:2,column:1},to:{row:c,column:29}};const r=await s.xlsx.writeBuffer(),E=new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),f=window.URL.createObjectURL(E),u=document.createElement("a");u.href=f;const h=new Date,z=String(h.getDate()).padStart(2,"0"),P=String(h.getMonth()+1).padStart(2,"0"),S=String(h.getFullYear()).slice(-2),n=String(h.getHours()).padStart(2,"0"),R=String(h.getMinutes()).padStart(2,"0"),D=String(h.getSeconds()).padStart(2,"0"),_=`${z}-${P}-${S}_${n}${R}${D}`;u.download=`ROLADAS_${M.value}_${_}.xlsx`,u.click(),window.URL.revokeObjectURL(f)}catch(s){console.error("Error exportando a Excel:",s),alert("Error al exportar a Excel")}},K=async()=>{if(p.value.length===0){k.fire({icon:"warning",title:"Sin datos",text:"No hay datos para copiar",timer:1500,showConfirmButton:!1});return}N.value=!0;try{const s=document.createElement("div");s.style.cssText="position: absolute; left: -9999px; background: #ffffff; padding: 16px; font-family: Verdana, sans-serif;";const o=document.createElement("div");o.style.cssText="display: flex; align-items: center; gap: 16px; margin-bottom: 12px; padding-bottom: 10px; border-bottom: 1px solid #cbd5e1;";const d=document.createElement("img");d.src="/LogoSantana.jpg",d.style.cssText="height: 36px; width: auto;",o.appendChild(d);const l=document.createElement("div");l.innerHTML=`
      <div style="font-size: 16px; font-weight: 600; color: #1e293b;">ROLADAS del Mes - Producción ÍNDIGO</div>
      <div style="font-size: 12px; color: #64748b;">${M.value}</div>
    `,o.appendChild(l);const c=document.createElement("div");c.style.cssText="margin-left: auto; background: #dbeafe; padding: 4px 12px; border-radius: 6px;",c.innerHTML=`
      <span style="font-size: 11px; color: #64748b;">Total Roladas:</span>
      <span style="font-size: 13px; font-weight: 700; color: #1d4ed8; margin-left: 4px;">${p.value.length}</span>
    `,o.appendChild(c),s.appendChild(o);const r={headerBg:"#f8fafc",headerBg2:"#f1f5f9",headerText:"#334155",border:"#cbd5e1",borderLight:"#e2e8f0",text:"#334155",textLight:"#64748b"},E=document.createElement("table");E.style.cssText="border-collapse: collapse; font-size: 11px; width: 100%; font-family: Verdana, sans-serif; border: 1px solid "+r.border+";";const f=document.createElement("thead"),u=document.createElement("tr");u.innerHTML=`
      <th rowspan="2" style="background: ${r.headerBg}; color: ${r.headerText}; padding: 8px 6px; text-align: center; vertical-align: middle; border-right: 2px solid ${r.border}; border-bottom: 1px solid ${r.borderLight}; font-size: 10px; font-weight: 600;">Rolada</th>
      <th colspan="7" style="background: ${r.headerBg2}; color: ${r.headerText}; padding: 6px; text-align: center; border-right: 2px solid ${r.border}; border-bottom: 1px solid ${r.borderLight}; font-size: 10px; font-weight: 600;">URDIDEIRA</th>
      <th colspan="15" style="background: ${r.headerBg2}; color: ${r.headerText}; padding: 6px; text-align: center; border-right: 2px solid ${r.border}; border-bottom: 1px solid ${r.borderLight}; font-size: 10px; font-weight: 600;">ÍNDIGO</th>
      <th colspan="3" style="background: ${r.headerBg2}; color: ${r.headerText}; padding: 6px; text-align: center; border-right: 2px solid ${r.border}; border-bottom: 1px solid ${r.borderLight}; font-size: 10px; font-weight: 600;">TEJEDURÍA</th>
      <th colspan="3" style="background: ${r.headerBg2}; color: ${r.headerText}; padding: 6px; text-align: center; border-bottom: 1px solid ${r.borderLight}; font-size: 10px; font-weight: 600;">CALIDAD</th>
    `,f.appendChild(u);const h=document.createElement("tr");[{text:"Fecha",width:"60px",borderRight:"1px solid "+r.borderLight},{text:"Maq. OE",width:"55px",borderRight:"1px solid "+r.borderLight},{text:"Lote",width:"55px",borderRight:"1px solid "+r.borderLight},{text:"Metros",width:"55px",borderRight:"1px solid "+r.borderLight},{text:"Rot. Tot.",width:"50px",borderRight:"1px solid "+r.borderLight},{text:"Rot 10⁶",width:"50px",borderRight:"1px solid "+r.borderLight},{text:"Tiempo",width:"50px",borderRight:"2px solid "+r.border},{text:"Fecha",width:"60px",borderRight:"1px solid "+r.borderLight},{text:"Base",width:"65px",borderRight:"1px solid "+r.borderLight},{text:"Col",width:"50px",borderRight:"1px solid "+r.borderLight},{text:"Metros",width:"55px",borderRight:"1px solid "+r.borderLight},{text:"Rot. Tot.",width:"50px",borderRight:"1px solid "+r.borderLight},{text:"Rot 10³",width:"50px",borderRight:"1px solid "+r.borderLight},{text:"CV",width:"17px",borderRight:"1px solid "+r.borderLight},{text:"Tiempo",width:"50px",borderRight:"1px solid "+r.borderLight},{text:"Vel.",width:"45px",borderRight:"1px solid "+r.borderLight},{text:"N",width:"35px",borderRight:"1px solid "+r.borderLight},{text:"%",width:"40px",borderRight:"1px solid "+r.borderLight},{text:"P",width:"35px",borderRight:"1px solid "+r.borderLight},{text:"%",width:"40px",borderRight:"1px solid "+r.borderLight},{text:"Q",width:"35px",borderRight:"1px solid "+r.borderLight},{text:"%",width:"40px",borderRight:"2px solid "+r.border},{text:"Efic. %",width:"50px",borderRight:"1px solid "+r.borderLight},{text:"Rot URD 10⁵",width:"60px",borderRight:"1px solid "+r.borderLight},{text:"Rot TRA 10⁵",width:"60px",borderRight:"2px solid "+r.border},{text:"Metros",width:"55px",borderRight:"1px solid "+r.borderLight},{text:"Cal. %",width:"50px",borderRight:"1px solid "+r.borderLight},{text:"Pts. 100m²",width:"55px",borderRight:"none"}].forEach(n=>{const R=document.createElement("th");R.style.cssText=`background: ${r.headerBg}; color: ${r.headerText}; padding: 6px 4px; text-align: center; vertical-align: middle; border-right: ${n.borderRight}; border-bottom: 2px solid ${r.border}; font-size: 9px; font-weight: 500; width: ${n.width};`,R.textContent=n.text,h.appendChild(R)}),f.appendChild(h),E.appendChild(f);const P=document.createElement("tbody");p.value.forEach((n,R)=>{const D=document.createElement("tr"),_=R%2===0?"#ffffff":"#f8fafc";[{value:n.ROLADA,bold:!0,borderRight:"2px solid "+r.border},{value:U(n.FECHA_URDIDORA),borderRight:"1px solid "+r.borderLight},{value:w(n.MAQ_OE),borderRight:"1px solid "+r.borderLight},{value:w(n.LOTE),borderRight:"1px solid "+r.borderLight},{value:i(n.URDIDORA_M,0),borderRight:"1px solid "+r.borderLight},{value:i(n.URDIDORA_ROT_TOT,0),borderRight:"1px solid "+r.borderLight},{value:i(n.URDIDORA_ROT_106,2),color:"#059669",bold:!0,borderRight:"1px solid "+r.borderLight},{value:v(n.URDIDORA_TIEMPO_MIN),borderRight:"2px solid "+r.border},{value:U(n.FECHA_INDIGO),borderRight:"1px solid "+r.borderLight},{value:n.ARTIGO?n.ARTIGO.substring(0,10):"",borderRight:"1px solid "+r.borderLight},{value:n.COR,borderRight:"1px solid "+r.borderLight},{value:i(n.METRAGEM,0),borderRight:"1px solid "+r.borderLight},{value:i(n.RUPTURAS,0),borderRight:"1px solid "+r.borderLight},{value:i(n.ROT_103,2),color:"#2563eb",bold:!0,borderRight:"1px solid "+r.borderLight},{value:i(n.CAVALOS,0),borderRight:"1px solid "+r.borderLight},{value:v(n.TIEMPO_MINUTOS),borderRight:"1px solid "+r.borderLight},{value:i(n.VELOC_PROMEDIO,1).replace(",0",""),borderRight:"1px solid "+r.borderLight},{value:n.N_COUNT,borderRight:"1px solid "+r.borderLight},{value:i(n.N_PERCENT,1),borderRight:"1px solid "+r.borderLight},{value:n.P_COUNT,borderRight:"1px solid "+r.borderLight},{value:i(n.P_PERCENT,1),borderRight:"1px solid "+r.borderLight},{value:n.Q_COUNT,borderRight:"1px solid "+r.borderLight},{value:i(n.Q_PERCENT,1),borderRight:"2px solid "+r.border},{value:i(n.TECELAGEM_EFICIENCIA,1),color:"#7c3aed",bold:!0,borderRight:"1px solid "+r.borderLight},{value:i(n.RT105,2),borderRight:"1px solid "+r.borderLight},{value:i(n.RU105,2),borderRight:"2px solid "+r.border},{value:i(n.METROS_CAL,0),borderRight:"1px solid "+r.borderLight},{value:i(n.CAL_PERCENT,1),color:"#b45309",bold:!0,borderRight:"1px solid "+r.borderLight},{value:i(n.PTS_100M2,1),borderRight:"none"}].forEach(a=>{const m=document.createElement("td");m.style.cssText=`background: ${_}; color: ${a.color||r.text}; padding: 6px 4px; text-align: center; vertical-align: middle; border-right: ${a.borderRight}; border-bottom: 1px solid ${r.borderLight}; font-size: 10px; ${a.bold?"font-weight: 700;":"font-weight: 400;"}`,m.textContent=a.value,D.appendChild(m)}),P.appendChild(D)}),E.appendChild(P),s.appendChild(E),document.body.appendChild(s);const S=await se(s,{scale:2,backgroundColor:"#ffffff",logging:!1});document.body.removeChild(s),S.toBlob(async n=>{try{await navigator.clipboard.write([new ClipboardItem({"image/png":n})]),k.fire({icon:"success",title:"Copiado",text:"Imagen copiada al portapapeles",timer:1e3,showConfirmButton:!1,timerProgressBar:!0})}catch(R){console.error("Error al copiar al portapapeles:",R);const D=S.toDataURL("image/png"),_=document.createElement("a");_.download=`ROLADAS_${M.value}.png`,_.href=D,_.click(),k.fire({icon:"info",title:"Imagen descargada",text:"No se pudo copiar al portapapeles. La imagen se ha descargado.",timer:2500,showConfirmButton:!1})}},"image/png")}catch(s){console.error("Error al generar imagen:",s),k.fire({icon:"error",title:"Error",text:"Error al generar la imagen",timer:2e3,showConfirmButton:!1})}finally{N.value=!1}},ee=()=>{if(p.value.length===0){alert("No hay datos para imprimir");return}window.print()};return ae(()=>{H()}),(s,o)=>{const d=pe("tippy");return g(),x("div",ge,[t("main",{ref_key:"mainContentRef",ref:W,class:"w-full flex-1 min-h-0 bg-white rounded-2xl shadow-xl px-2 py-1.5 border border-slate-200 flex flex-col relative"},[L.value?(g(),x("div",xe,[t("div",ue,[o[2]||(o[2]=t("div",{class:"relative"},[t("div",{class:"animate-spin rounded-full h-16 w-16 border-4 border-blue-50 border-t-blue-600"}),t("div",{class:"absolute inset-0 flex items-center justify-center"},[t("div",{class:"h-8 w-8 bg-blue-600 rounded-full animate-pulse opacity-10"})])],-1)),t("div",he,[o[1]||(o[1]=t("span",{class:"text-slate-500 font-medium tracking-wider uppercase text-[10px]"},"Cargando ROLADAS",-1)),t("span",Re,b(M.value),1)])])])):j("",!0),t("div",Ee,[t("div",fe,[o[4]||(o[4]=t("img",{src:re,alt:"Santana Textiles",class:"h-10 w-auto object-contain"},null,-1)),o[5]||(o[5]=t("h3",{class:"text-lg font-semibold text-slate-800"},"ROLADAS del Mes - Producción ÍNDIGO",-1)),t("div",me,[o[3]||(o[3]=t("span",{class:"text-sm font-medium text-slate-600"},"Total Roladas:",-1)),t("span",Ce,b(p.value.length),1)])]),t("div",_e,[V((g(),x("button",{onClick:K,disabled:N.value||p.value.length===0,class:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-purple-600 hover:bg-purple-700 disabled:bg-slate-400 text-white font-medium rounded-md transition-colors shadow-sm"},[N.value?(g(),x("svg",Ae,[...o[7]||(o[7]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(g(),x("svg",Oe,[...o[6]||(o[6]=[t("path",{d:"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"},null,-1)])])),t("span",ye,b(N.value?"Copiando...":"Copiar"),1)],8,Te)),[[d,{content:"Copiar tabla como imagen",placement:"bottom"}]]),V((g(),x("button",{onClick:ee,class:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors shadow-sm"},[...o[8]||(o[8]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z"})],-1),t("span",{class:"text-sm"},"Imprimir",-1)])])),[[d,{content:"Imprimir informe",placement:"bottom"}]]),V((g(),x("button",{onClick:X,class:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-emerald-600 hover:bg-emerald-700 text-white font-medium rounded-md transition-colors shadow-sm"},[...o[9]||(o[9]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M12.9,14.5L15.8,19H14L12,15.6L10,19H8.2L11.1,14.5L8.2,10H10L12,13.4L14,10H15.8L12.9,14.5Z"})],-1),t("span",{class:"text-sm"},"Excel",-1)])])),[[d,{content:"Exportar informe a Excel",placement:"bottom"}]]),ne(oe,{modelValue:A.value,"onUpdate:modelValue":o[0]||(o[0]=l=>A.value=l),label:"Fecha:","show-buttons":!0,onChange:H},null,8,["modelValue"])])]),t("div",{class:"flex-1 overflow-auto min-h-0 border border-slate-300 rounded-lg shadow-sm relative",ref_key:"tablaRef",ref:q},[t("table",{ref_key:"tableElementRef",ref:Z,class:"w-full text-sm text-left text-slate-600 font-[Verdana] border-separate border-spacing-0"},[o[11]||(o[11]=t("thead",{class:"text-xs text-slate-700 bg-slate-50 sticky top-0 z-10"},[t("tr",null,[t("th",{scope:"col",rowspan:"2",class:"pl-1.5 pr-1.5 py-1 font-semibold border-b-2 border-b-slate-300 border-r-2 border-slate-300 text-center bg-slate-50 w-14"},"Rolada"),t("th",{scope:"col",colspan:"7",class:"px-2 py-0.5 font-semibold border-b border-b-slate-200 border-r-2 border-slate-300 bg-slate-100 text-center"},"URDIDEIRA"),t("th",{scope:"col",colspan:"15",class:"px-2 py-0.5 font-semibold border-b border-b-slate-200 border-r-2 border-slate-300 bg-slate-100 text-center"},"ÍNDIGO"),t("th",{scope:"col",colspan:"4",class:"px-2 py-0.5 font-semibold border-b border-b-slate-200 border-r-2 border-slate-300 bg-slate-100 text-center"},"TEJEDURÍA"),t("th",{scope:"col",colspan:"3",class:"px-2 py-0.5 font-semibold border-b border-b-slate-200 bg-slate-100 text-center"},"CALIDAD")]),t("tr",null,[t("th",{scope:"col",class:"px-1 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center w-16"},"Fecha"),t("th",{scope:"col",class:"px-2 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center"},"Maq. OE"),t("th",{scope:"col",class:"px-2 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center"},"Lote"),t("th",{scope:"col",class:"px-1.5 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center w-16"},"Metros"),t("th",{scope:"col",class:"px-2 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center"},"Rot. Tot."),t("th",{scope:"col",class:"px-2 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center"},"Rot 10⁶"),t("th",{scope:"col",class:"px-0.5 py-1 font-medium border-b-2 border-b-slate-300 border-r-2 border-slate-300 bg-slate-50 text-center w-12 text-[10px] leading-tight"},[O("Tiem"),t("br"),O("po")]),t("th",{scope:"col",class:"px-1 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center w-16"},"Fecha"),t("th",{scope:"col",class:"px-2 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center"},"Base"),t("th",{scope:"col",class:"px-0.5 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center w-12"},"Col"),t("th",{scope:"col",class:"px-1.5 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center w-16"},"Metros"),t("th",{scope:"col",class:"px-2 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center"},"Rot. Tot."),t("th",{scope:"col",class:"px-2 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center"},"Rot 10³"),t("th",{scope:"col",class:"px-2 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center"},"CV"),t("th",{scope:"col",class:"px-0.5 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center w-12 text-[10px] leading-tight"},[O("Tiem"),t("br"),O("po")]),t("th",{scope:"col",class:"px-1.5 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center w-12"},"Vel."),t("th",{scope:"col",class:"px-2 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center"},"N"),t("th",{scope:"col",class:"px-2 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center"},"%"),t("th",{scope:"col",class:"px-2 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center"},"P"),t("th",{scope:"col",class:"px-2 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center"},"%"),t("th",{scope:"col",class:"px-2 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center"},"Q"),t("th",{scope:"col",class:"px-2 py-1 font-medium border-b-2 border-b-slate-300 border-r-2 border-slate-300 bg-slate-50 text-center"},"%"),t("th",{scope:"col",class:"px-1.5 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center w-16"},"Metros"),t("th",{scope:"col",class:"px-2 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center"},"Efic. %"),t("th",{scope:"col",class:"px-2 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center"},"Rot URD 10⁵"),t("th",{scope:"col",class:"px-2 py-1 font-medium border-b-2 border-b-slate-300 border-r-2 border-slate-300 bg-slate-50 text-center"},"Rot TRA 10⁵"),t("th",{scope:"col",class:"px-1.5 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center w-16"},"Metros"),t("th",{scope:"col",class:"px-2 py-1 font-medium border-b-2 border-b-slate-300 border-r border-slate-200 bg-slate-50 text-center"},"Cal. %"),t("th",{scope:"col",class:"px-0.5 py-1 font-medium border-b-2 border-b-slate-300 bg-slate-50 text-center w-10 text-[10px] leading-tight"},[O("Pts"),t("br"),O("100"),t("br"),O("m²")])])],-1)),t("tbody",null,[(g(!0),x(ie,null,be(p.value,(l,c)=>(g(),x("tr",{key:`${l.ROLADA}-${l.COR}`,class:"border-b border-slate-200 hover:bg-slate-50/80 transition-colors"},[t("td",we,b(l.ROLADA),1),t("td",De,b(U(l.FECHA_URDIDORA)),1),t("td",Ie,b(w(l.MAQ_OE)),1),t("td",Ne,b(w(l.LOTE)),1),t("td",Fe,b(i(l.URDIDORA_M,0)),1),t("td",Le,b(l.URDIDORA_ROT_TOT),1),t("td",Me,b(i(l.URDIDORA_ROT_106,2)),1),t("td",ve,b(v(l.URDIDORA_TIEMPO_MIN)),1),t("td",Ue,b(U(l.FECHA_INDIGO)),1),t("td",Pe,b(l.ARTIGO?l.ARTIGO.substring(0,10):""),1),t("td",Se,b(l.COR),1),t("td",ke,b(i(l.METRAGEM,0)),1),t("td",$e,b(i(l.RUPTURAS,0)),1),t("td",Ve,b(i(l.ROT_103,2)),1),t("td",Ge,b(i(l.CAVALOS,0)),1),t("td",Be,b(v(l.TIEMPO_MINUTOS)),1),t("td",He,b(i(l.VELOC_PROMEDIO,1).replace(",0","")),1),t("td",{class:I(["px-2 py-1.5 border-r border-slate-200 text-center font-mono tabular-nums",y(l.N_PERCENT)])},b(l.N_COUNT),3),t("td",{class:I(["px-2 py-1.5 border-r border-slate-200 text-center font-mono font-semibold tabular-nums",y(l.N_PERCENT)])},b(i(l.N_PERCENT,1)),3),t("td",{class:I(["px-2 py-1.5 border-r border-slate-200 text-center font-mono tabular-nums",y(l.P_PERCENT)])},b(l.P_COUNT),3),t("td",{class:I(["px-2 py-1.5 border-r border-slate-200 text-center font-mono font-semibold tabular-nums",y(l.P_PERCENT)])},b(i(l.P_PERCENT,1)),3),t("td",{class:I(["px-2 py-1.5 border-r border-slate-200 text-center font-mono tabular-nums",y(l.Q_PERCENT)])},b(l.Q_COUNT),3),t("td",{class:I(["px-2 py-1.5 border-r-2 border-slate-300 text-center font-mono font-semibold tabular-nums",y(l.Q_PERCENT)])},b(i(l.Q_PERCENT,1)),3),t("td",ze,b(i(l.TECELAGEM_METROS,0)),1),t("td",Qe,b(i(l.TECELAGEM_EFICIENCIA,1)),1),t("td",je,b(i(l.RT105,2)),1),t("td",Je,b(i(l.RU105,2)),1),t("td",Ye,b(i(l.METROS_CAL,0)),1),t("td",We,b(i(l.CAL_PERCENT,1)),1),t("td",qe,b(i(l.PTS_100M2,1)),1)]))),128)),p.value.length===0&&!L.value?(g(),x("tr",Ze,[...o[10]||(o[10]=[t("td",{colspan:"30",class:"px-4 py-8 text-center text-slate-500"}," No hay datos disponibles para el período seleccionado ",-1)])])):j("",!0)])],512)],512)],512)])}}},dt=de(Xe,[["__scopeId","data-v-fbb6b4c9"]]);export{dt as default};
