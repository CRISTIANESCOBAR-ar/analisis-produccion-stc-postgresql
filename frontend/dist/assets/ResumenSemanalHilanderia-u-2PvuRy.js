import{w as ye,o as he,a as y,c as h,b as l,u as ie,f as F,q as I,F as C,r as R,d as T,m as U,p as H,z as Te,t as p}from"./index-DOrYTJc_.js";import{S as ke}from"./sweetalert2.esm.all-AlKuj1Cq.js";import{e as Me}from"./exceljs.min-DtXTVuKQ.js";import{f as Se}from"./dataService-CkzvrtSC.js";import{C as ce}from"./CustomDatepicker-CvHj9gtp.js";const De={class:"w-full h-screen flex flex-col p-1"},_e={class:"w-full flex-1 min-h-0 bg-white rounded-2xl shadow-xl px-4 py-3 border border-slate-200 flex flex-col"},Ne={class:"flex flex-wrap items-center justify-between gap-3 mb-3"},we={class:"flex flex-wrap items-center gap-3"},Ee={class:"flex items-center gap-2"},Fe=["disabled"],Ce={key:0,class:"text-sm text-slate-600 py-8 text-center flex-1"},Re={key:1,class:"flex-1 min-h-0 flex flex-col"},Ae={key:0,class:"text-sm text-slate-600 py-8 text-center"},Ie={key:1,class:"overflow-auto _minimal-scroll w-full flex-1 min-h-0 rounded-xl border border-slate-200"},Ue={class:"min-w-full w-full table-auto divide-y divide-slate-200 text-xs"},Le={class:"bg-gradient-to-r from-slate-50 to-slate-100 sticky top-0 z-20"},Be={rowspan:"2",class:"px-2 py-2 text-center font-semibold text-slate-700 border-b-2 border-slate-200"},Pe={class:"flex items-center justify-center gap-1"},Ve=["value"],Ge={class:"px-2 py-2 text-center font-semibold text-slate-700 border-b-2 border-b-slate-200 border-l-2 border-l-emerald-500 bg-emerald-50"},Oe=["value"],$e={class:"px-2 py-2 text-center font-semibold text-slate-700 border-b-2 border-b-slate-200 bg-emerald-50"},je=["value"],ze={class:"px-2 py-2 text-center font-semibold text-slate-700 border-b-2 border-b-slate-200 bg-emerald-50"},He=["value"],Ke={class:"px-2 py-2 text-center font-semibold text-slate-700 border-b-2 border-slate-200"},We=["value"],Ye={class:"px-2 py-2 text-center font-semibold text-slate-700 border-b-2 border-slate-200"},qe=["value"],Je={class:"px-2 py-2 text-center font-semibold text-slate-700 border-b-2 border-slate-200"},Ze=["value"],Qe={class:"px-2 py-2 text-center font-semibold text-slate-700 border-b-2 border-slate-200"},Xe=["value"],et={class:"px-2 py-2 text-center text-slate-700 capitalize"},tt={class:"px-2 py-2 text-center text-slate-700"},lt={class:"px-2 py-2 text-center text-slate-700"},st={class:"px-2 py-2 text-center text-slate-700"},nt={class:"px-2 py-2 text-center text-slate-700"},at={class:"px-2 py-2 text-center text-slate-700 bg-emerald-50/30 border-l-2 border-l-emerald-500"},rt={class:"px-2 py-2 text-center text-slate-700 bg-emerald-50/30"},ot={class:"px-2 py-2 text-center text-slate-700 bg-emerald-50/30"},it={class:"px-2 py-2 text-center text-slate-700 bg-emerald-50/30"},ct={class:"px-2 py-2 text-center text-slate-700 bg-emerald-50/30"},dt={class:"px-2 py-2 text-center text-slate-700 bg-emerald-50/30 border-r-2 border-r-emerald-500"},ut={class:"px-2 py-2 text-center text-slate-700"},mt={class:"px-2 py-2 text-center text-slate-700"},bt={class:"px-2 py-2 text-center text-slate-700"},pt={class:"px-2 py-2 text-center text-slate-700"},ft={class:"px-2 py-2 text-center text-slate-700"},xt={class:"px-2 py-2 text-center text-slate-700"},vt={class:"px-2 py-2 text-center text-slate-700"},gt={class:"px-2 py-2 text-center text-slate-700"},Dt={__name:"ResumenSemanalHilanderia",setup(yt){const q=U(!1),L=U([]),A=U(""),B=U(""),D=U(""),Q=U("10"),K=[{key:"SCI",label:"SCI"},{key:"MST",label:"MST"},{key:"MIC",label:"MIC"},{key:"MAT",label:"MAT"},{key:"UHML",label:"UHML"},{key:"UI",label:"UI"},{key:"SF",label:"SF"},{key:"STR",label:"STR"},{key:"ELG",label:"ELG"},{key:"RD",label:"RD"},{key:"+b",label:"+b"},{key:"TrCNT",label:"TrCNT"},{key:"TrAR",label:"TrAR"},{key:"TRID",label:"TRID"}],O=[{key:"CVm %",label:"CVm %"},{key:"Delg -30%",label:"Delg -30%"},{key:"Delg -40%",label:"Delg -40%"},{key:"Delg -50%",label:"Delg -50%"},{key:"Grue +35%",label:"Grue +35%"},{key:"Grue +50%",label:"Grue +50%"},{key:"Neps +140%",label:"Neps +140%"},{key:"Neps +280%",label:"Neps +280%"},{key:"Fuerza B",label:"Fuerza B"},{key:"Elong. %",label:"Elong. %"},{key:"Tenac.",label:"Tenac."},{key:"Trabajo B",label:"Trabajo B"}],E=U(["MIC","STR","UHML"]),_=U(["Fuerza B","Elong. %","Tenac.","Trabajo B"]),de=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"];function P(s){if(s==null||s==="")return null;if(typeof s=="number"&&Number.isFinite(s))return s;const e=String(s).trim();if(!e||e==="â€”")return null;const r=e.replace(/%/g,"").replace(/\s+/g,"").replace(/,/g,"."),t=Number(r);return Number.isFinite(t)?t:null}function ue(s){if(!s||s==="")return"";const e=String(s).trim(),r=e.match(/[\s-](\d+)[\s-]/);return r&&r[1]?r[1]:e}function X(s,e){if(s==null||s==="")return"";const r=String(s).trim();let t=r;const i=parseFloat(t.replace(",","."));isNaN(i)||(t=String(parseFloat(t.replace(",","."))));const f=e?String(e).toLowerCase().trim():"";return/flame/i.test(r)||f.includes("flame")||f.includes("fantasia")?`${t}Flame`:t}function ee(s){if(!s)return null;const e=String(s).trim().match(/^(\d+(?:[\.,]\d+)?)/);if(!e)return null;const r=e[1].replace(",","."),t=Number(r);return Number.isFinite(t)?r:null}function te(s,e){if(!s||!e)return"";const r=String(s).slice(0,3),t=String(e).slice(-2);return`${r}-${t}`}function le(s){if(s.Ne!=null&&s.Ne!=="")return String(s.Ne);const e=s.MATCLASS??s.matclass??s.Matclass??s.MatClass??null;return X(s.NOMCOUNT??s.Ne,e)}function V(s,e=2){if(s==null||!Number.isFinite(s))return"â€”";const t=s.toFixed(e).replace(/\.0+$/,"").replace(/(\.\d*?)0+$/,"$1"),[i,f]=t.split("."),x=Math.abs(parseInt(i))>=1e3?i.replace(/\B(?=(\d{3})+(?!\d))/g,"."):i;return f?`${x},${f}`:x}function se(s){const e=s.TIME_STAMP||s.TIME||s.TIMESTAMP||s.Fecha||s.fecha||s.FECHA||null;if(!e)return null;if(e instanceof Date&&!isNaN(e.getTime()))return e;if(typeof e=="number"&&Number.isFinite(e)){const f=e>1e12?new Date(e):new Date(e*1e3);return isNaN(f.getTime())?null:f}const r=String(e).trim(),t=r.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2,4})/);if(t){const f=parseInt(t[1],10),x=parseInt(t[2],10)-1;let k=parseInt(t[3],10);k<100&&(k+=2e3);const c=new Date(k,x,f);return isNaN(c.getTime())?null:c}const i=new Date(r);return isNaN(i.getTime())?null:i}function me(s){const e=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate())),r=e.getUTCDay()||7;e.setUTCDate(e.getUTCDate()+4-r);const t=new Date(Date.UTC(e.getUTCFullYear(),0,1)),i=Math.ceil(((e-t)/864e5+1)/7);return{year:e.getUTCFullYear(),week:i}}function J(s){const e=s.getFullYear(),r=String(s.getMonth()+1).padStart(2,"0"),t=String(s.getDate()).padStart(2,"0");return`${e}-${r}-${t}`}const Z=H(()=>{const s=new Set;for(const e of L.value||[]){const r=le(e);r&&s.add(r)}return Array.from(s).sort((e,r)=>{const t=parseFloat(String(e).replace(",",".")),i=parseFloat(String(r).replace(",","."));return!isNaN(t)&&!isNaN(i)?t-i:e.localeCompare(r)})});function ne(s,e){if(!window.calidadFibraByLote)return null;const t={SCI:"SCI",MST:"MST",MIC:"MIC",MAT:"MAT",UHML:"UHML",UI:"UI",SF:"SF",STR:"STR",ELG:"ELG",RD:"RD","+b":"PLUS_B",TrCNT:"TrCNT",TrAR:"TrAR",TRID:"TRID"}[e]||e;let i=0,f=0;return s.forEach(x=>{(window.calidadFibraByLote.get(x)||[]).forEach(c=>{const u=P(c.PESO??c.peso),d=P(c[t]);u!=null&&d!=null&&(i+=u,f+=d*u)})}),i===0?null:f/i}const ae=H(()=>{if(!L.value||L.value.length===0)return[];const s=A.value?new Date(`${A.value}T00:00:00`):null,e=B.value?new Date(`${B.value}T23:59:59`):null,r=D.value?String(D.value):"";return L.value.filter(t=>{if(r&&le(t)!==r)return!1;const i=se(t);return!(!i||s&&i<s||e&&i>e)})}),be=H(()=>{const s=ae.value;if(!s.length)return{};const e={},r=s.map(i=>P(i.Titulo)).filter(i=>i!=null);e.Titulo=r.length?r.reduce((i,f)=>i+f,0)/r.length:null;for(const i of O){const f=s.map(x=>P(x[i.key])).filter(x=>x!=null);e[i.key]=f.length?f.reduce((x,k)=>x+k,0)/f.length:null}const t=[...new Set(s.map(i=>i.Lote).filter(i=>i))];for(const i of K)e[i.key]=ne(t,i.key);return e}),pe=H(()=>{const s=P(Q.value);if(s!=null)return s;const e=D.value?ee(D.value):null,r=e!=null?P(e):null;return r??null});ye(D,s=>{const e=ee(s);e!=null&&(Q.value=e)});const $=H(()=>{const s=ae.value;if(!s.length)return[];const e=new Map;s.forEach(c=>{const u=se(c);if(!u)return;const{year:d,week:M}=me(u),n=`${d}-W${M}`;e.has(n)||e.set(n,{key:n,year:d,week:M,dates:[],rows:[]});const a=e.get(n);a.dates.push(u),a.rows.push(c)});const r=be.value,t=pe.value,i=(c,u)=>{const d=c.map(M=>P(M[u])).filter(M=>M!=null);return d.length?d.reduce((M,n)=>M+n,0)/d.length:null},f=(c,u)=>c==null||u==null||u===0?null:(u-c)/u*100,x=(c,u)=>c==null||u==null||u===0?null:(c-u)/u*100,k=[];return e.forEach(c=>{const u=c.dates.slice().sort((S,N)=>S-N),d=u.length?de[u[0].getMonth()]:"",M=i(c.rows,"Titulo"),n=D.value?t:r.Titulo,a=n!=null?f(M,n):null,b=_.value.map(S=>{const N=i(c.rows,S),j=r[S],G=x(N,j);return{avgRaw:N,devRaw:G,avg:V(N,2),dev:V(G,1)}}),m=[...new Set(c.rows.map(S=>S.Lote).filter(S=>S))],v=E.value.map(S=>{const N=ne(m,S),j=r[S],G=x(N,j);return{avgRaw:N,devRaw:G,avg:V(N,2),dev:V(G,1)}});k.push({key:c.key,year:c.year,week:c.week,month:d,neDisplay:D.value?String(D.value):"Todos",standardTitle:t!=null?V(t,2):"â€”",tituloAvgRaw:M,tituloDevRaw:a,tituloAvg:V(M,2),tituloDev:V(a,1),hviMetricA:v[0],hviMetricB:v[1],hviMetricC:v[2],metricA:b[0],metricB:b[1],metricC:b[2],metricD:b[3]})}),k.sort((c,u)=>c.year!==u.year?c.year-u.year:c.week-u.week)}),fe=async()=>{if(!$.value.length)return;const s=new Me.Workbook;s.creator="STC Dashboard",s.created=new Date;const e=s.addWorksheet("Resumen Semanal");e.pageSetup={paperSize:9,orientation:"landscape",fitToPage:!0,fitToWidth:1,fitToHeight:0,margins:{left:.2,right:.2,top:.4,bottom:.4,header:.2,footer:.2}};const r=["Mes","Semana","Ne","Ne Promedio","Desv %",...E.value.flatMap(a=>[a,"Desv %"]),..._.value.flatMap(a=>[a,"Desv %"])];e.addRow(r),r.forEach((a,o)=>{const b=e.getColumn(o+1);b.width=o===0?9:o===2?10:11});const t=e.getRow(1);t.font={bold:!0,size:10,color:{argb:"FF0F172A"}},t.alignment={vertical:"middle",horizontal:"center",wrapText:!0},t.eachCell(a=>{a.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF1F5F9"}},a.border={top:{style:"thin",color:{argb:"FFE2E8F0"}},left:{style:"thin",color:{argb:"FFE2E8F0"}},bottom:{style:"thin",color:{argb:"FFE2E8F0"}},right:{style:"thin",color:{argb:"FFE2E8F0"}}}}),$.value.forEach(a=>{const b=[a.hviMetricA,a.hviMetricB,a.hviMetricC].flatMap(v=>[v.avgRaw,v.devRaw]),g=[a.metricA,a.metricB,a.metricC,a.metricD].flatMap(v=>[v.avgRaw,v.devRaw]);e.addRow([te(a.month,a.year),a.week,a.neDisplay,a.tituloAvgRaw,a.tituloDevRaw,...b,...g])});const i=e.rowCount;for(let a=2;a<=i;a+=1){const o=e.getRow(a);o.alignment={vertical:"middle",horizontal:"center"},o.getCell(2).numFmt="0",o.getCell(4).numFmt="0.00",o.getCell(5).numFmt="0.0";for(let m=0;m<E.value.length;m++){const g=6+m*2,v=g+1;o.getCell(g).numFmt="0.00",o.getCell(v).numFmt="0.0"}const b=E.value.length*2;for(let m=0;m<_.value.length;m++){const g=_.value[m],v=6+b+m*2,S=v+1;g==="Fuerza B"||g==="Trabajo B"?o.getCell(v).numFmt="#,##0.00":o.getCell(v).numFmt="0.00",o.getCell(S).numFmt="0.0"}}e.autoFilter={from:{row:1,column:1},to:{row:i,column:r.length}},e.views=[{state:"frozen",ySplit:1}];const f=await s.xlsx.writeBuffer(),x=new Blob([f],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),k=window.URL.createObjectURL(x),c=document.createElement("a"),d=new Date().toTimeString().slice(0,8).replace(/:/g,""),M=A.value||"inicio",n=B.value||"fin";c.href=k,c.download=`Resumen_Semanal_Hilanderia_${M}_${n}_${d}.xlsx`,c.click(),window.URL.revokeObjectURL(k)};async function re(){q.value=!0;try{const s=await Se(),e=Array.isArray(s.usterPar)?s.usterPar:[],r=Array.isArray(s.usterTbl)?s.usterTbl:[],t=Array.isArray(s.tensorapidTbl)?s.tensorapidTbl:[],i=Array.isArray(s.tensorapidPar)?s.tensorapidPar:[],f=Array.isArray(s.calidadFibra)?s.calidadFibra:[],x=new Map;r.forEach(n=>{const a=String(n.TESTNR??n.testnr??n.Testnr??"");a&&(x.has(a)||x.set(a,[]),x.get(a).push(n))});const k=new Map;t.forEach(n=>{const a=String(n.TESTNR??n.testnr??n.Testnr??"");a&&(k.has(a)||k.set(a,[]),k.get(a).push(n))});const c=new Map;i.forEach(n=>{const a=String(n.USTER_TESTNR??n.uster_testnr??n.usterTestnr??"");a&&(c.has(a)||c.set(a,[]),c.get(a).push(n))});const u=new Map;f.forEach(n=>{const a=String(n.LOTE_FIAC??n.lote_fiac??"");if(!a)return;const o=String(parseInt(a,10));o&&o!=="NaN"&&(u.has(o)||u.set(o,[]),u.get(o).push(n))}),window.calidadFibraByLote=u;const d=(n,a)=>{const o=n.map(m=>m[a]).filter(m=>m!=null&&m!=="").map(m=>Number(String(m).replace(",","."))).filter(m=>!isNaN(m));if(o.length===0)return"";const b=o.reduce((m,g)=>m+g,0)/o.length;return Number(b.toFixed(2)).toString()},M=e.map(n=>{const a=String(n.TESTNR??n.testnr??n.Testnr??""),o=x.get(a)||[];let b=null;c.has(a)&&(b=c.get(a).slice().sort((W,Y)=>{const z=new Date(W.TIME_STAMP||W.time_stamp||0);return new Date(Y.TIME_STAMP||Y.time_stamp||0)-z})[0]);let m=[];b&&b.TESTNR&&(m=k.get(String(b.TESTNR))||[]);const g=n.TIME_STAMP||n.TIME||n.TIMESTAMP||n.CREATED_AT||n.created_at||null;let v=null;if(g)if(g instanceof Date)v=g;else if(typeof g=="string"){const w=g.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2,4})(?:\s+(\d{1,2}):(\d{2})(?::(\d{2}))?)?/);if(w){const W=parseInt(w[1],10),Y=parseInt(w[2],10)-1;let z=parseInt(w[3],10);z<100&&(z+=2e3);const oe=w[4]?parseInt(w[4],10):0,ve=w[5]?parseInt(w[5],10):0,ge=w[6]?parseInt(w[6],10):0;v=new Date(z,Y,W,oe,ve,ge)}else v=new Date(g)}else v=new Date(g);const S=n.NOMCOUNT??n.Ne??n.NE??n.titulo??n.TITULO??"",N=n.MATCLASS??n.matclass??n.Matclass??n.MatClass??null,j=X(S,N),G=n.LOTE??n.Lote??n.lote??"",xe=ue(G);return{Ensayo:a,TIME_STAMP:v,Ne:j,Lote:xe,Titulo:d(o,"TITULO"),"CVm %":d(o,"CVM_PERCENT")||d(o,"CVM_%"),"Delg -30%":d(o,"DELG_MINUS30_KM")||d(o,"DELG_-30%"),"Delg -40%":d(o,"DELG_MINUS40_KM")||d(o,"DELG_-40%"),"Delg -50%":d(o,"DELG_MINUS50_KM")||d(o,"DELG_-50%"),"Grue +35%":d(o,"GRUE_35_KM")||d(o,"GRUE_+35%"),"Grue +50%":d(o,"GRUE_50_KM")||d(o,"GRUE_+50%"),"Neps +140%":d(o,"NEPS_140_KM")||d(o,"NEPS_+140%"),"Neps +280%":d(o,"NEPS_280_KM")||d(o,"NEPS_+280%"),"Fuerza B":d(m,"FUERZA_B"),"Elong. %":d(m,"ELONGACION"),"Tenac.":d(m,"TENACIDAD"),"Trabajo B":d(m,"TRABAJO")}});if(L.value=M.filter(n=>n.TIME_STAMP),L.value.length>0){const n=L.value.map(b=>b.TIME_STAMP).filter(b=>b instanceof Date&&!isNaN(b)),a=n.length?new Date(Math.max(...n)):new Date,o=n.length?new Date(Math.min(...n)):new Date;if(B.value||(B.value=J(a)),!A.value){const b=new Date(a);b.setDate(b.getDate()-90),b<o?A.value=J(o):A.value=J(b)}!D.value&&Z.value.length>0&&(D.value=Z.value[0])}}catch(s){console.error("Error cargando resumen semanal",s),ke.fire({icon:"error",title:"Error",text:"No se pudo cargar el resumen semanal."})}finally{q.value=!1}}return he(()=>{re()}),(s,e)=>{const r=Te("tippy");return y(),h("div",De,[l("main",_e,[l("div",Ne,[l("div",we,[e[10]||(e[10]=l("div",{class:"flex items-center gap-2"},[l("span",{class:"text-lg"},"ðŸ§ª"),l("h3",{class:"text-lg font-semibold text-slate-800"},"Resumen Semanal Hilanderia")],-1)),ie(ce,{modelValue:A.value,"onUpdate:modelValue":e[0]||(e[0]=t=>A.value=t),label:"Desde","show-buttons":!1},null,8,["modelValue"]),ie(ce,{modelValue:B.value,"onUpdate:modelValue":e[1]||(e[1]=t=>B.value=t),label:"Hasta","show-buttons":!1},null,8,["modelValue"])]),l("div",Ee,[F((y(),h("button",{onClick:re,class:"inline-flex items-center gap-1 px-2 py-1 border border-slate-200 bg-white text-slate-700 rounded-lg text-sm font-medium hover:bg-slate-50 transition-colors duration-150 shadow-sm hover:shadow-md"},[...e[11]||(e[11]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},[l("path",{d:"M21 12a9 9 0 1 1-3-6.7","stroke-linecap":"round","stroke-linejoin":"round"}),l("polyline",{points:"21 3 21 9 15 9","stroke-linecap":"round","stroke-linejoin":"round"})],-1),l("span",null,"Refrescar",-1)])])),[[r,{content:"Refrescar datos",placement:"bottom",theme:"custom"}]]),F((y(),h("button",{onClick:fe,disabled:!$.value.length,class:"inline-flex items-center gap-1 px-2 py-1 border border-emerald-200 bg-emerald-50 text-emerald-700 rounded-lg text-sm font-medium hover:bg-emerald-100 transition-colors duration-150 shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed"},[...e[12]||(e[12]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},[l("path",{d:"M14 3v4a1 1 0 0 0 1 1h4","stroke-linecap":"round","stroke-linejoin":"round"}),l("path",{d:"M17 21H7a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7l5 5v11a2 2 0 0 1-2 2z","stroke-linecap":"round","stroke-linejoin":"round"}),l("path",{d:"M9 13l2 2 4-4","stroke-linecap":"round","stroke-linejoin":"round"})],-1),l("span",null,"Excel",-1)])],8,Fe)),[[r,{content:"Exportar a Excel",placement:"bottom",theme:"custom"}]])])]),q.value?(y(),h("div",Ce,[...e[13]||(e[13]=[l("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-slate-300 border-t-blue-600"},null,-1),l("p",{class:"mt-2"},"Cargando...",-1)])])):(y(),h("div",Re,[$.value.length===0?(y(),h("div",Ae,"No hay datos para el rango seleccionado.")):(y(),h("div",Ie,[l("table",Ue,[l("thead",Le,[l("tr",null,[e[16]||(e[16]=l("th",{rowspan:"2",class:"px-2 py-2 text-center font-semibold text-slate-700 border-b-2 border-slate-200"},"Mes",-1)),e[17]||(e[17]=l("th",{rowspan:"2",class:"px-2 py-2 text-center font-semibold text-slate-700 border-b-2 border-slate-200"},"Semana",-1)),l("th",Be,[l("div",Pe,[e[15]||(e[15]=l("span",{class:"text-[10px] font-semibold uppercase tracking-wide text-slate-500"},"Ne",-1)),F(l("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>D.value=t),class:"w-full bg-transparent text-xs font-semibold text-slate-700",style:{width:"9.33ch","min-width":"9.33ch","max-width":"9.33ch"}},[e[14]||(e[14]=l("option",{value:""},"Todos",-1)),(y(!0),h(C,null,R(Z.value,t=>(y(),h("option",{key:t,value:t},p(t),9,Ve))),128))],512),[[I,D.value]])])]),e[18]||(e[18]=l("th",{rowspan:"2",class:"px-2 py-2 text-center font-semibold text-slate-700 border-b-2 border-slate-200"},[l("span",null,[T("Ne"),l("br"),T("Promedio")])],-1)),e[19]||(e[19]=l("th",{rowspan:"2",class:"px-2 py-2 text-center font-semibold text-slate-700 border-b-2 border-b-slate-200"},[l("span",null,[T("Desv"),l("br"),T("%")])],-1)),e[20]||(e[20]=l("th",{colspan:"6",class:"px-2 py-1 text-center font-bold text-emerald-700 border-b-2 border-b-slate-200 border-l-2 border-l-emerald-500 border-r-2 border-r-emerald-500 bg-emerald-100"}," HVI - Calidad Fibra ",-1)),e[21]||(e[21]=l("th",{colspan:"8",class:"px-2 py-1 text-center font-bold text-slate-700 border-b-2 border-b-slate-200 bg-slate-100"}," USTER + TENSORAPID - Calidad Hilo ",-1))]),l("tr",null,[l("th",Ge,[F(l("select",{"onUpdate:modelValue":e[3]||(e[3]=t=>E.value[0]=t),class:"w-full bg-transparent text-xs font-semibold text-slate-700"},[(y(),h(C,null,R(K,t=>l("option",{key:t.key,value:t.key},p(t.label),9,Oe)),64))],512),[[I,E.value[0]]])]),e[22]||(e[22]=l("th",{class:"px-2 py-2 text-center font-semibold text-slate-700 border-b-2 border-b-slate-200 bg-emerald-50"},[l("span",null,[T("Desv"),l("br"),T("%")])],-1)),l("th",$e,[F(l("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>E.value[1]=t),class:"w-full bg-transparent text-xs font-semibold text-slate-700"},[(y(),h(C,null,R(K,t=>l("option",{key:t.key,value:t.key},p(t.label),9,je)),64))],512),[[I,E.value[1]]])]),e[23]||(e[23]=l("th",{class:"px-2 py-2 text-center font-semibold text-slate-700 border-b-2 border-b-slate-200 bg-emerald-50"},[l("span",null,[T("Desv"),l("br"),T("%")])],-1)),l("th",ze,[F(l("select",{"onUpdate:modelValue":e[5]||(e[5]=t=>E.value[2]=t),class:"w-full bg-transparent text-xs font-semibold text-slate-700"},[(y(),h(C,null,R(K,t=>l("option",{key:t.key,value:t.key},p(t.label),9,He)),64))],512),[[I,E.value[2]]])]),e[24]||(e[24]=l("th",{class:"px-2 py-2 text-center font-semibold text-slate-700 border-b-2 border-b-slate-200 border-r-2 border-r-emerald-500 bg-emerald-50"},[l("span",null,[T("Desv"),l("br"),T("%")])],-1)),l("th",Ke,[F(l("select",{"onUpdate:modelValue":e[6]||(e[6]=t=>_.value[0]=t),class:"w-full bg-transparent text-xs font-semibold text-slate-700"},[(y(),h(C,null,R(O,t=>l("option",{key:t.key,value:t.key},p(t.label),9,We)),64))],512),[[I,_.value[0]]])]),e[25]||(e[25]=l("th",{class:"px-2 py-2 text-center font-semibold text-slate-700 border-b-2 border-slate-200"},[l("span",null,[T("Desv"),l("br"),T("%")])],-1)),l("th",Ye,[F(l("select",{"onUpdate:modelValue":e[7]||(e[7]=t=>_.value[1]=t),class:"w-full bg-transparent text-xs font-semibold text-slate-700"},[(y(),h(C,null,R(O,t=>l("option",{key:t.key,value:t.key},p(t.label),9,qe)),64))],512),[[I,_.value[1]]])]),e[26]||(e[26]=l("th",{class:"px-2 py-2 text-center font-semibold text-slate-700 border-b-2 border-slate-200"},[l("span",null,[T("Desv"),l("br"),T("%")])],-1)),l("th",Je,[F(l("select",{"onUpdate:modelValue":e[8]||(e[8]=t=>_.value[2]=t),class:"w-full bg-transparent text-xs font-semibold text-slate-700"},[(y(),h(C,null,R(O,t=>l("option",{key:t.key,value:t.key},p(t.label),9,Ze)),64))],512),[[I,_.value[2]]])]),e[27]||(e[27]=l("th",{class:"px-2 py-2 text-center font-semibold text-slate-700 border-b-2 border-slate-200"},[l("span",null,[T("Desv"),l("br"),T("%")])],-1)),l("th",Qe,[F(l("select",{"onUpdate:modelValue":e[9]||(e[9]=t=>_.value[3]=t),class:"w-full bg-transparent text-xs font-semibold text-slate-700"},[(y(),h(C,null,R(O,t=>l("option",{key:t.key,value:t.key},p(t.label),9,Xe)),64))],512),[[I,_.value[3]]])]),e[28]||(e[28]=l("th",{class:"px-2 py-2 text-center font-semibold text-slate-700 border-b-2 border-slate-200"},[l("span",null,[T("Desv"),l("br"),T("%")])],-1))])]),l("tbody",null,[(y(!0),h(C,null,R($.value,t=>(y(),h("tr",{key:t.key,class:"border-t border-slate-100 hover:bg-blue-50/30 transition-colors duration-150"},[l("td",et,p(te(t.month,t.year)),1),l("td",tt,p(t.week),1),l("td",lt,p(t.neDisplay),1),l("td",st,p(t.tituloAvg),1),l("td",nt,p(t.tituloDev),1),l("td",at,p(t.hviMetricA.avg),1),l("td",rt,p(t.hviMetricA.dev),1),l("td",ot,p(t.hviMetricB.avg),1),l("td",it,p(t.hviMetricB.dev),1),l("td",ct,p(t.hviMetricC.avg),1),l("td",dt,p(t.hviMetricC.dev),1),l("td",ut,p(t.metricA.avg),1),l("td",mt,p(t.metricA.dev),1),l("td",bt,p(t.metricB.avg),1),l("td",pt,p(t.metricB.dev),1),l("td",ft,p(t.metricC.avg),1),l("td",xt,p(t.metricC.dev),1),l("td",vt,p(t.metricD.avg),1),l("td",gt,p(t.metricD.dev),1)]))),128))])])]))]))])])}}};export{Dt as default};
