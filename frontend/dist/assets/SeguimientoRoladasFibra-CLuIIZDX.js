import{o as je,a as u,c as p,A as he,e as J,b as e,t as s,f as fe,g as ye,d as q,F as G,r as H,n as Me,k as Qe,m as y,p as K}from"./index-DYTbJAB1.js";import{_ as Je}from"./LogoSantana-C2JneU89.js";import{e as We}from"./exceljs.min-DtXTVuKQ.js";import{_ as Ze}from"./_plugin-vue_export-helper-DlAUqK2U.js";const qe={class:"w-full h-screen flex flex-col p-1 relative"},Ke={key:0,class:"fixed inset-0 bg-white/40 backdrop-blur-[2px] flex items-center justify-center z-[9999] transition-all duration-300"},Ye={class:"flex items-center justify-between gap-4 flex-shrink-0 mb-3 pb-3 border-b border-slate-100"},et={class:"flex items-center gap-5"},tt={class:"flex items-center gap-1.5 px-2.5 py-1 bg-slate-100 rounded-md ml-2"},rt={class:"text-sm font-semibold text-slate-700 tabular-nums"},lt={class:"flex items-center gap-2"},ot={class:"flex items-center gap-1.5"},st={class:"flex items-center gap-1.5"},at=["disabled"],nt={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},dt={key:1,class:"h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},bt=["disabled"],ct={class:"px-2 py-2 font-semibold text-slate-800 text-center tabular-nums border-r-2 border-slate-300 bg-slate-50/50 sticky left-0 z-10"},it={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200"},ut={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200"},pt={class:"px-1 py-2 text-center text-emerald-600 font-semibold tabular-nums border-r-2 border-slate-300"},xt={class:"px-1 py-2 text-center text-slate-500 text-xs border-r border-slate-200"},mt={class:"px-1 py-2 text-center text-slate-700 border-r border-slate-200 text-xs"},gt={class:"px-1 py-2 text-center text-slate-600 border-r border-slate-200"},_t={class:"px-1 py-2 text-center text-slate-700 font-medium tabular-nums border-r border-slate-200"},ht={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200"},ft={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200"},yt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200"},Mt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r-2 border-slate-300"},At={class:"px-1 py-2 text-center text-slate-700 font-medium tabular-nums border-r border-slate-200"},Ft={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200"},St={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200"},Ct={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r-2 border-slate-300"},It={class:"px-1 py-2 text-center text-slate-700 font-medium tabular-nums border-r border-slate-200"},Tt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200"},Rt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r-2 border-slate-300"},wt=["onClick","title"],vt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-amber-50/30 text-xs"},Et={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-blue-50/30"},Nt={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-blue-50/20 text-[9px]"},Lt={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-blue-50/20 text-[9px]"},Dt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-blue-50/30 text-[9px] font-medium"},Ut={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-blue-50/30"},kt={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-blue-50/20 text-[9px]"},Ot={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-blue-50/20 text-[9px]"},Bt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-blue-50/30 text-[9px] font-medium"},Vt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-blue-50/30"},Xt={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-blue-50/20 text-[9px]"},Pt={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-blue-50/20 text-[9px]"},$t={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-blue-50/30 text-[9px] font-medium"},Gt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-blue-50/30"},Ht={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-blue-50/20 text-[9px]"},zt={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-blue-50/20 text-[9px]"},jt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-blue-50/30 text-[9px] font-medium"},Qt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-green-50/30"},Jt={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-green-50/20 text-[9px]"},Wt={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-green-50/20 text-[9px]"},Zt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-green-50/30 text-[9px] font-medium"},qt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-green-50/30"},Kt={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-green-50/20 text-[9px]"},Yt={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-green-50/20 text-[9px]"},er={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-green-50/30 text-[9px] font-medium"},tr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-green-50/30"},rr={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-green-50/20 text-[9px]"},lr={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-green-50/20 text-[9px]"},or={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-green-50/30 text-[9px] font-medium"},sr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-yellow-50/30"},ar={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-yellow-50/20 text-[9px]"},nr={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-yellow-50/20 text-[9px]"},dr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-yellow-50/30 text-[9px] font-medium"},br={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-yellow-50/30"},cr={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-yellow-50/20 text-[9px]"},ir={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-yellow-50/20 text-[9px]"},ur={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-yellow-50/30 text-[9px] font-medium"},pr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-yellow-50/30"},xr={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-yellow-50/20 text-[9px]"},mr={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-yellow-50/20 text-[9px]"},gr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-yellow-50/30 text-[9px] font-medium"},_r={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-yellow-50/30"},hr={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-yellow-50/20 text-[9px]"},fr={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-yellow-50/20 text-[9px]"},yr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-yellow-50/30 text-[9px] font-medium"},Mr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-purple-50/30"},Ar={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-purple-50/20 text-[9px]"},Fr={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-purple-50/20 text-[9px]"},Sr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-purple-50/30 text-[9px] font-medium"},Cr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-purple-50/30"},Ir={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-purple-50/20 text-[9px]"},Tr={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-purple-50/20 text-[9px]"},Rr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-purple-50/30 text-[9px] font-medium"},wr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-purple-50/30"},vr={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-purple-50/20 text-[9px]"},Er={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-purple-50/20 text-[9px]"},Nr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r-2 border-slate-300 bg-purple-50/30 text-[9px] font-medium"},Lr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-orange-50/30"},Dr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-orange-50/30"},Ur={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-orange-50/30"},kr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-orange-50/30"},Or={class:"px-1 py-2 text-center text-slate-600 tabular-nums bg-orange-50/30"},Br={key:0,class:"sticky bottom-0 z-20 bg-slate-100"},Vr={class:"font-semibold text-slate-700"},Xr={class:"px-2 py-2.5 text-center border-r-2 border-slate-300 border-t-2 border-t-slate-300 sticky left-0 bg-slate-100 z-10"},Pr={class:"ml-1 text-slate-700"},$r={class:"px-1 py-2.5 text-center text-emerald-600 font-semibold tabular-nums border-r-2 border-slate-300 border-t-2 border-t-slate-300"},Gr={class:"px-1 py-2.5 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},Hr={class:"px-1 py-2.5 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},zr={class:"px-1 py-2.5 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},jr={class:"px-1 py-2.5 text-center tabular-nums border-r-2 border-slate-300 border-t-2 border-t-slate-300"},Qr={class:"px-1 py-2.5 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},Jr={class:"px-1 py-2.5 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},Wr={class:"px-1 py-2.5 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},Zr={class:"px-1 py-2.5 text-center tabular-nums border-r-2 border-slate-300 border-t-2 border-t-slate-300"},qr={class:"px-1 py-2.5 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},Kr={class:"px-1 py-2.5 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},Yr={class:"px-1 py-2.5 text-center tabular-nums border-r-2 border-slate-300 border-t-2 border-t-slate-300"},el={key:0,class:"flex items-center justify-center h-64 bg-white"},tl={key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-2"},rl={class:"bg-white rounded-xl shadow-2xl max-w-7xl w-full max-h-[95vh] flex flex-col"},ll={class:"flex items-center justify-between px-6 py-2 border-b border-slate-200 flex-shrink-0"},ol={class:"flex items-center gap-4"},sl={class:"px-3 py-1 bg-blue-100 rounded-lg"},al={class:"text-sm font-mono font-semibold text-blue-700"},nl={key:0,class:"px-3 py-1 bg-slate-100 rounded-lg"},dl={class:"text-sm font-mono font-semibold text-slate-700"},bl={class:"text-xs text-slate-400"},cl={class:"flex items-center gap-2"},il=["disabled"],ul=["disabled"],pl={class:"flex-1 overflow-auto p-2"},xl={key:0,class:"flex items-center justify-center h-64"},ml={key:1},gl={class:"overflow-x-auto"},_l={class:"w-full border-collapse text-sm"},hl={class:"bg-slate-100"},fl={class:"hover:bg-slate-50"},yl={class:"flex justify-center items-center h-full"},Ml={class:"text-xs text-slate-600",style:{"writing-mode":"vertical-rl",transform:"rotate(180deg)","white-space":"nowrap"}},Al={class:"hover:bg-slate-50"},Fl=["onMouseenter"],Sl={key:2,class:"flex items-center justify-center h-64"},Cl={class:"mb-3 pb-2 border-b border-slate-200"},Il={class:"text-sm font-semibold text-slate-700"},Tl={class:"relative"},Rl={width:"100%",height:"160",class:"overflow-visible"},wl={x:"25",y:"15","text-anchor":"end",class:"text-[10px] fill-slate-600"},vl={x:"25",y:"72","text-anchor":"end",class:"text-[10px] fill-slate-600"},El={x:"25",y:"133","text-anchor":"end",class:"text-[10px] fill-slate-600"},Nl=["points"],Ll=["cx","cy"],Dl=["x"],Ul=["x","y"],kl={class:"mt-2 pt-2 border-t border-slate-200 flex justify-between text-xs text-slate-600"},Ol={__name:"SeguimientoRoladasFibra",setup(Bl){const v=y(!1),C=y([]),g=y(null),Y=y({}),P=y(""),$=y(""),le=y(!1),k=y(null),ee=y(null),F=y(0),S=y(null),O=y(null),oe=y({x:0,y:0}),B=K(()=>{const a=new Set;return C.value.forEach(o=>{o.MISTURA&&String(o.MISTURA).split(",").map(b=>b.trim()).forEach(b=>a.add(b))}),Array.from(a).sort((o,t)=>o.localeCompare(t))}),Ae=y(null),Fe=y(null),Se=y(null),ie="".replace(/\/$/,""),se=ie?`${ie}/api`:"/api",n=(a,o=0)=>{if(a==null||a==="")return"-";const t=parseFloat(a);return isNaN(t)?"-":t.toLocaleString("es-ES",{minimumFractionDigits:o,maximumFractionDigits:o})},ae=a=>{if(a==null||a==="")return"-";const o=parseFloat(a);return isNaN(o)?"-":o>=1e3?o.toLocaleString("de-DE",{minimumFractionDigits:0,maximumFractionDigits:0}):Math.round(o).toString()},W=a=>{if(a==null||a==="")return"-";const o=parseFloat(a);return isNaN(o)||o===0?"-":o.toLocaleString("es-ES",{minimumFractionDigits:1,maximumFractionDigits:1})},Ce=a=>a||"-",ue=(a,o,t)=>{if(!a||!o||!t)return"-";const b=parseFloat(a),c=parseFloat(o),m=parseFloat(t);return isNaN(b)||isNaN(c)||isNaN(m)||c===0||m===0?"-":(b*1e6/(c*m)).toFixed(2).replace(".",",")},Ie=(a,o,t)=>{if(!a||!o||!t)return null;const b=parseFloat(a),c=parseFloat(o),m=parseFloat(t);return isNaN(b)||isNaN(c)||isNaN(m)||c===0||m===0?null:b*1e6/(c*m)},pe=(a,o)=>{if(!a||!o)return"-";const t=parseFloat(a),b=parseFloat(o);return isNaN(t)||isNaN(b)||b===0?"-":(t*1e5/b).toFixed(1).replace(".",",")},Te=(a,o)=>{if(!a||!o)return null;const t=parseFloat(a),b=parseFloat(o);return isNaN(t)||isNaN(b)||b===0?null:t*1e5/b},Re=async()=>{if(!P.value||!$.value){alert("Seleccione fecha de inicio y fin");return}v.value=!0;try{const a=`${se}/seguimiento-roladas-fibra?fechaInicio=${P.value}&fechaFin=${$.value}`,o=await fetch(a);if(!o.ok)throw new Error(`Error: ${o.status}`);const t=await o.json();C.value=t.datos||[],g.value=t.totales||null;const b=`${se}/hvi-estadisticas-mezcla?fechaInicio=${P.value}&fechaFin=${$.value}`,c=await fetch(b);if(c.ok){const m=await c.json();Y.value=m.stats||{},console.log("üìä Estad√≠sticas HVI cargadas:",Object.keys(Y.value).length,"mezclas")}else console.warn("‚ö†Ô∏è No se pudieron cargar estad√≠sticas HVI"),Y.value={}}catch(a){console.error("Error cargando datos:",a),alert("Error al cargar datos: "+a.message)}finally{v.value=!1}},Z=K(()=>{var a;return(a=S.value)!=null&&a.seqs?[...S.value.seqs].sort((o,t)=>{const b=parseInt(o.SEQ)||0,c=parseInt(t.SEQ)||0;return b-c}):[]}),xe=a=>a?String(a).replace(/^0+/,"")||"0":"",we=a=>{if(!a)return"-";const o=a.split("/");if(o.length===3){const t=o[0].padStart(2,"0"),b=o[1].padStart(2,"0"),c=o[2].slice(-2);return`${t}/${b}/${c}`}return a},ne=async a=>{if(a)try{const o=`${se}/calidad-fibra-mistura?mistura=${a}`,t=await fetch(o);if(!t.ok)throw new Error(`Error: ${t.status}`);const b=await t.json();S.value=b,console.log("üî¨ Datos de MISTURA cargados:",a,b)}catch(o){console.error("Error cargando datos de mistura:",o),alert("Error al cargar datos de mistura: "+o.message),S.value=null}},ve=async(a,o=null)=>{if(!a){console.warn("‚ö†Ô∏è No se puede abrir modal: mistura vac√≠a");return}const t=String(a).split(",")[0].trim();console.log("üîç Abriendo modal para MISTURA:",t),console.log("üìã Lista de misturas disponibles:",B.value),console.log("üì¶ LOTE_FIAC:",o);const b=B.value.indexOf(t);if(b===-1){console.warn("‚ö†Ô∏è MISTURA no encontrada en lista:",t);return}F.value=b,k.value=t,ee.value=o,le.value=!0,console.log("‚úÖ Modal abierto, cargando datos..."),await ne(t)},Ee=async()=>{F.value>0&&(F.value--,k.value=B.value[F.value],await ne(k.value))},Ne=async()=>{F.value<B.value.length-1&&(F.value++,k.value=B.value[F.value],await ne(k.value))},Le=()=>{le.value=!1,k.value=null,ee.value=null,S.value=null},De=(a,o)=>{O.value=a;const t=o.target.getBoundingClientRect(),b=760,c=240,m=window.innerWidth,E=window.innerHeight;let N=t.right+10;N+b>m&&(N=t.left-b-10,N<0&&(N=(m-b)/2));let L=t.top;L+c>E&&(L=E-c-10,L<10&&(L=10)),oe.value={x:N,y:L}},Ue=()=>{O.value=null},I=K(()=>{var b;if(!O.value||!((b=S.value)!=null&&b.seqs))return[];const a=O.value,o=a==="+b"?"PLUS_B":a;return Z.value.map(c=>{const m=parseFloat(c[o]),E=Math.round(m*100)/100;return{seq:xe(c.SEQ),valor:E}}).filter(c=>!isNaN(c.valor)&&c.valor!==null&&c.valor!==void 0)}),M=K(()=>{if(I.value.length===0)return{min:0,max:100};const a=I.value.map(c=>c.valor),o=Math.min(...a),t=Math.max(...a);let b=t-o;if(b===0){const c=o!==0?Math.abs(o)*.1:1;return{min:o-c,max:t+c}}return{min:o-b*.1,max:t+b*.1}}),me=K(()=>{var t;if(!O.value||!((t=S.value)!=null&&t.totales))return null;const a=O.value,o=a==="+b"?"PLUS_B":a;return S.value.totales[o]}),ke=async()=>{if(C.value.length!==0){v.value=!0;try{await new Promise(r=>setTimeout(r,100));const a=new We.Workbook,o=a.addWorksheet("Roladas + Fibra HVI");o.pageSetup={paperSize:9,orientation:"landscape",fitToPage:!0,fitToWidth:1,fitToHeight:0,margins:{left:.1968,right:.1968,top:.3937,bottom:.3937,header:.1968,footer:.1968}},o.addRow(["Rolada","URDIDORA","","","√çNDIGO","","","","","","","","TEJEDUR√çA","","","","CALIDAD","","","FIBRA HVI","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]);const t=C.value.length,b=6,c=b+t-1,m={4:"D",8:"H",9:"I",10:"J",11:"K",12:"L",13:"M",14:"N",15:"O",16:"P",17:"Q",18:"R",19:"S",22:"V",26:"Z",30:"AD",34:"AH",38:"AL",42:"AP",46:"AT",50:"AX",54:"BB",58:"BF",62:"BJ",66:"BN",70:"BR",74:"BV"},E={23:"W",27:"AA",31:"AE",35:"AI",39:"AM",43:"AQ",47:"AU",51:"AY",55:"BC",59:"BG",63:"BK",67:"BO",71:"BS",75:"BW"},N={24:"X",28:"AB",32:"AF",36:"AJ",40:"AN",44:"AR",48:"AV",52:"AZ",56:"BD",60:"BH",64:"BL",68:"BP",72:"BT",76:"BX"},L={25:"Y",29:"AC",33:"AG",37:"AK",41:"AO",45:"AS",49:"AW",53:"BA",57:"BE",61:"BI",65:"BM",69:"BQ",73:"BU",77:"BY"},de={78:"BZ",79:"CA",80:"CB",81:"CC",82:"CD"},be=[10,11,12],T=o.addRow([]);T.height=18,T.font={bold:!0,size:9,color:{argb:"FFDC2626"}},T.alignment={vertical:"middle",horizontal:"center"},T.getCell(1).value="MAX",T.getCell(1).font={bold:!0,size:9,color:{argb:"FFDC2626"}};for(const[r,d]of Object.entries(m)){const l=T.getCell(parseInt(r));l.value={formula:`SUBTOTAL(104,${d}${b}:${d}${c})`},[8,13,17].includes(parseInt(r))?l.numFmt="#,##0":l.numFmt=be.includes(parseInt(r))?"0.0":"0.00"}for(const[r,d]of Object.entries(E)){const l=T.getCell(parseInt(r));l.value={formula:`SUBTOTAL(104,${d}${b}:${d}${c})`},l.numFmt="0"}for(const[r,d]of Object.entries(N)){const l=T.getCell(parseInt(r));l.value={formula:`SUBTOTAL(104,${d}${b}:${d}${c})`},l.numFmt="0"}for(const[r,d]of Object.entries(L)){const l=T.getCell(parseInt(r));l.value={formula:`SUBTOTAL(104,${d}${b}:${d}${c})`},l.numFmt="0.00"}for(const[r,d]of Object.entries(de)){const l=T.getCell(parseInt(r));l.value={formula:`IFERROR(SUBTOTAL(104,${d}${b}:${d}${c}),"")`},l.numFmt="0.0"}const R=o.addRow([]);R.height=18,R.font={bold:!0,size:9,color:{argb:"FF1E40AF"}},R.alignment={vertical:"middle",horizontal:"center"},R.getCell(1).value="PROM",R.getCell(1).font={bold:!0,size:9,color:{argb:"FF1E40AF"}};for(const[r,d]of Object.entries(m)){const l=R.getCell(parseInt(r)),A=[8,13,17].includes(parseInt(r))?109:101;l.value={formula:`SUBTOTAL(${A},${d}${b}:${d}${c})`},[8,13,17].includes(parseInt(r))?l.numFmt="#,##0":l.numFmt=be.includes(parseInt(r))?"0.0":"0.00"}for(const[r,d]of Object.entries(E)){const l=R.getCell(parseInt(r));l.value={formula:`SUBTOTAL(101,${d}${b}:${d}${c})`},l.numFmt="0.00"}for(const[r,d]of Object.entries(N)){const l=R.getCell(parseInt(r));l.value={formula:`SUBTOTAL(101,${d}${b}:${d}${c})`},l.numFmt=parseInt(r)===24?"0.0":"0.00"}for(const[r,d]of Object.entries(L)){const l=R.getCell(parseInt(r));l.value={formula:`SUBTOTAL(101,${d}${b}:${d}${c})`},l.numFmt="0.00"}for(const[r,d]of Object.entries(de)){const l=R.getCell(parseInt(r));l.value={formula:`IFERROR(SUBTOTAL(101,${d}${b}:${d}${c}),"")`},l.numFmt="0.0"}const w=o.addRow([]);w.height=18,w.font={bold:!0,size:9,color:{argb:"FF059669"}},w.alignment={vertical:"middle",horizontal:"center"},w.getCell(1).value="MIN",w.getCell(1).font={bold:!0,size:9,color:{argb:"FF059669"}};for(const[r,d]of Object.entries(m)){const l=w.getCell(parseInt(r));l.value={formula:`SUBTOTAL(105,${d}${b}:${d}${c})`},[8,13,17].includes(parseInt(r))?l.numFmt="#,##0":l.numFmt=be.includes(parseInt(r))?"0.0":"0.00"}for(const[r,d]of Object.entries(E)){const l=w.getCell(parseInt(r));l.value={formula:`SUBTOTAL(105,${d}${b}:${d}${c})`},l.numFmt="0"}for(const[r,d]of Object.entries(N)){const l=w.getCell(parseInt(r));l.value={formula:`SUBTOTAL(105,${d}${b}:${d}${c})`},l.numFmt="0"}for(const[r,d]of Object.entries(L)){const l=w.getCell(parseInt(r));l.value={formula:`SUBTOTAL(105,${d}${b}:${d}${c})`},l.numFmt="0.00"}for(const[r,d]of Object.entries(de)){const l=w.getCell(parseInt(r));l.value={formula:`IFERROR(SUBTOTAL(105,${d}${b}:${d}${c}),"")`},l.numFmt="0.0"}o.addRow(["","Maq. OE","Lote","Rot 10‚Å∂","Fecha","Base","Color","Metros","R10¬≥","Cav 10‚Åµ","Vel.Nom","Vel.Prom","Metros","Efic.%","RU10‚Åµ","RT10‚Åµ","Metros","Cal.%","Pts/100m¬≤","Mezcla","F.Ingreso","SCI","MIN","MAX","œÉ","MST","MIN","MAX","œÉ","MIC","MIN","MAX","œÉ","MAT","MIN","MAX","œÉ","UHML","MIN","MAX","œÉ","UI","MIN","MAX","œÉ","SF","MIN","MAX","œÉ","STR","MIN","MAX","œÉ","ELG","MIN","MAX","œÉ","RD","MIN","MAX","œÉ","+b","MIN","MAX","œÉ","TrCNT","MIN","MAX","œÉ","TrAR","MIN","MAX","œÉ","TRID","MIN","MAX","œÉ","BCO%","GRI%","LG%","AMA%","LA%"]),o.mergeCells("B1:D1"),o.mergeCells("E1:L1"),o.mergeCells("M1:P1"),o.mergeCells("Q1:S1"),o.mergeCells("T1:CD1");const z=[1,4,12,16,19,82],j=[21,25,29,33,37,41,45,49,53,57,61,65,69,73,77],h=o.getRow(1);h.height=20,h.font={bold:!0,size:10},h.alignment={vertical:"middle",horizontal:"center"},h.getCell(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF1F5F9"}},h.getCell(1).value="Rolada",h.getCell(2).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFDCFCE7"}},h.getCell(2).value="URDIDORA",h.getCell(5).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFDBEAFE"}},h.getCell(5).value="√çNDIGO",h.getCell(13).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF3E8FF"}},h.getCell(13).value="TEJEDUR√çA",h.getCell(17).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFEF3C7"}},h.getCell(17).value="CALIDAD",h.getCell(20).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFEF9C3"}},h.getCell(20).value="FIBRA HVI";for(let r=1;r<=82;r++){const d=h.getCell(r);let l={style:"thin",color:{argb:"FFE2E8F0"}};z.includes(r)?l={style:"medium",color:{argb:"FF64748B"}}:j.includes(r)&&(l={style:"medium",color:{argb:"FFD4A574"}}),d.border={right:l,bottom:{style:"thin",color:{argb:"FFCBD5E1"}}}}const Oe=o.getRow(2);for(let r=1;r<=82;r++){const d=Oe.getCell(r);d.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFECACA"}};let l={style:"thin",color:{argb:"FFE2E8F0"}};z.includes(r)?l={style:"medium",color:{argb:"FF64748B"}}:j.includes(r)&&(l={style:"medium",color:{argb:"FFD4A574"}}),d.border={right:l,bottom:{style:"thin",color:{argb:"FFFCA5A5"}}}}const Be=o.getRow(3);for(let r=1;r<=82;r++){const d=Be.getCell(r);d.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFDBEAFE"}};let l={style:"thin",color:{argb:"FFE2E8F0"}};z.includes(r)?l={style:"medium",color:{argb:"FF64748B"}}:j.includes(r)&&(l={style:"medium",color:{argb:"FFD4A574"}}),d.border={right:l,bottom:{style:"thin",color:{argb:"FF93C5FD"}}}}const Ve=o.getRow(4);for(let r=1;r<=82;r++){const d=Ve.getCell(r);d.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFD1FAE5"}};let l={style:"thin",color:{argb:"FFE2E8F0"}};z.includes(r)?l={style:"medium",color:{argb:"FF64748B"}}:j.includes(r)&&(l={style:"medium",color:{argb:"FFD4A574"}}),d.border={right:l,bottom:{style:"thin",color:{argb:"FF6EE7B7"}}}}const te=o.getRow(5);te.height=30,te.font={bold:!1,size:9},te.alignment={vertical:"top",horizontal:"center",wrapText:!0};for(let r=1;r<=82;r++){const d=te.getCell(r);r>=20&&r<=82?d.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFBEB"}}:d.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF8FAFC"}};let l={style:"thin",color:{argb:"FFE2E8F0"}};z.includes(r)?l={style:"medium",color:{argb:"FF64748B"}}:j.includes(r)&&(l={style:"medium",color:{argb:"FFD4A574"}}),d.border={right:l,bottom:{style:"medium",color:{argb:"FF94A3B8"}}}}o.columns=[{key:"ROLADA",width:7},{key:"MAQ_OE",width:10},{key:"LOTE",width:10},{key:"ROT_106",width:8},{key:"FECHA",width:10},{key:"BASE",width:12},{key:"COLOR",width:7},{key:"MTS_IND",width:9},{key:"R103",width:7},{key:"CAV",width:4},{key:"VEL_NOM",width:7},{key:"VEL_PROM",width:7},{key:"MTS_CRUDOS",width:9},{key:"EFI_TEJ",width:7},{key:"RU105",width:8},{key:"RT105",width:8},{key:"MTS_CAL",width:9},{key:"CAL_PERCENT",width:7},{key:"PTS_100M2",width:8},{key:"MEZCLA",width:28},{key:"F_INGRESO",width:10},{key:"SCI",width:6},{key:"SCI_MIN",width:5},{key:"SCI_MAX",width:5},{key:"SCI_DESV",width:5},{key:"MST",width:6},{key:"MST_MIN",width:5},{key:"MST_MAX",width:5},{key:"MST_DESV",width:5},{key:"MIC",width:6},{key:"MIC_MIN",width:5},{key:"MIC_MAX",width:5},{key:"MIC_DESV",width:5},{key:"MAT",width:6},{key:"MAT_MIN",width:5},{key:"MAT_MAX",width:5},{key:"MAT_DESV",width:5},{key:"UHML",width:7},{key:"UHML_MIN",width:5},{key:"UHML_MAX",width:5},{key:"UHML_DESV",width:5},{key:"UI",width:6},{key:"UI_MIN",width:5},{key:"UI_MAX",width:5},{key:"UI_DESV",width:5},{key:"SF",width:6},{key:"SF_MIN",width:5},{key:"SF_MAX",width:5},{key:"SF_DESV",width:5},{key:"STR",width:6},{key:"STR_MIN",width:5},{key:"STR_MAX",width:5},{key:"STR_DESV",width:5},{key:"ELG",width:6},{key:"ELG_MIN",width:5},{key:"ELG_MAX",width:5},{key:"ELG_DESV",width:5},{key:"RD",width:6},{key:"RD_MIN",width:5},{key:"RD_MAX",width:5},{key:"RD_DESV",width:5},{key:"PLUS_B",width:6},{key:"PLUS_B_MIN",width:5},{key:"PLUS_B_MAX",width:5},{key:"PLUS_B_DESV",width:5},{key:"TrCNT",width:6},{key:"TrCNT_MIN",width:5},{key:"TrCNT_MAX",width:5},{key:"TrCNT_DESV",width:5},{key:"TrAR",width:6},{key:"TrAR_MIN",width:5},{key:"TrAR_MAX",width:5},{key:"TrAR_DESV",width:5},{key:"TRID",width:6},{key:"TRID_MIN",width:5},{key:"TRID_MAX",width:5},{key:"TRID_DESV",width:5},{key:"BCO",width:6},{key:"GRI",width:6},{key:"LG",width:6},{key:"AMA",width:6},{key:"LA",width:6}];const i=(r,d,l)=>{var U,V;if(!r)return"";const A=String(r).split(",").map(x=>x.trim());for(const x of A){const _=(V=(U=Y.value[x])==null?void 0:U[d])==null?void 0:V[l];if(_!=null)return _}return""};C.value.forEach(r=>{let d=null;if(r.FECHA){const x=r.FECHA.split("/");x.length===3&&(d=new Date(parseInt(x[2]),parseInt(x[1])-1,parseInt(x[0])))}const l=o.addRow({ROLADA:r.ROLADA,MAQ_OE:r.MAQ_OE||"",LOTE:r.LOTE||"",ROT_106:Ie(r.URDIDORA_ROTURAS,r.URDIDORA_METROS,r.NUM_FIOS),FECHA:d||"",BASE:r.BASE||"",COLOR:r.COLOR||"",MTS_IND:r.MTS_IND||"",R103:r.R103||"",CAV:Te(r.CAV,r.MTS_IND),VEL_NOM:r.VEL_NOM||"",VEL_PROM:r.VEL_PROM||"",MTS_CRUDOS:r.MTS_CRUDOS||"",EFI_TEJ:r.EFI_TEJ||"",RU105:r.RU105||"",RT105:r.RT105||"",MTS_CAL:r.MTS_CAL||"",CAL_PERCENT:r.CAL_PERCENT||"",PTS_100M2:r.PTS_100M2||"",MEZCLA:r.MISTURA||"",F_INGRESO:r.FECHA_INGRESO||"",SCI:r.SCI||"",SCI_MIN:i(r.MISTURA,"SCI","MIN"),SCI_MAX:i(r.MISTURA,"SCI","MAX"),SCI_DESV:i(r.MISTURA,"SCI","DESV"),MST:r.MST||"",MST_MIN:i(r.MISTURA,"MST","MIN"),MST_MAX:i(r.MISTURA,"MST","MAX"),MST_DESV:i(r.MISTURA,"MST","DESV"),MIC:r.MIC||"",MIC_MIN:i(r.MISTURA,"MIC","MIN"),MIC_MAX:i(r.MISTURA,"MIC","MAX"),MIC_DESV:i(r.MISTURA,"MIC","DESV"),MAT:r.MAT||"",MAT_MIN:i(r.MISTURA,"MAT","MIN"),MAT_MAX:i(r.MISTURA,"MAT","MAX"),MAT_DESV:i(r.MISTURA,"MAT","DESV"),UHML:r.UHML||"",UHML_MIN:i(r.MISTURA,"UHML","MIN"),UHML_MAX:i(r.MISTURA,"UHML","MAX"),UHML_DESV:i(r.MISTURA,"UHML","DESV"),UI:r.UI||"",UI_MIN:i(r.MISTURA,"UI","MIN"),UI_MAX:i(r.MISTURA,"UI","MAX"),UI_DESV:i(r.MISTURA,"UI","DESV"),SF:r.SF||"",SF_MIN:i(r.MISTURA,"SF","MIN"),SF_MAX:i(r.MISTURA,"SF","MAX"),SF_DESV:i(r.MISTURA,"SF","DESV"),STR:r.STR||"",STR_MIN:i(r.MISTURA,"STR","MIN"),STR_MAX:i(r.MISTURA,"STR","MAX"),STR_DESV:i(r.MISTURA,"STR","DESV"),ELG:r.ELG||"",ELG_MIN:i(r.MISTURA,"ELG","MIN"),ELG_MAX:i(r.MISTURA,"ELG","MAX"),ELG_DESV:i(r.MISTURA,"ELG","DESV"),RD:r.RD||"",RD_MIN:i(r.MISTURA,"RD","MIN"),RD_MAX:i(r.MISTURA,"RD","MAX"),RD_DESV:i(r.MISTURA,"RD","DESV"),PLUS_B:r.PLUS_B||"",PLUS_B_MIN:i(r.MISTURA,"PLUS_B","MIN"),PLUS_B_MAX:i(r.MISTURA,"PLUS_B","MAX"),PLUS_B_DESV:i(r.MISTURA,"PLUS_B","DESV"),TrCNT:r.TrCNT||"",TrCNT_MIN:i(r.MISTURA,"TrCNT","MIN"),TrCNT_MAX:i(r.MISTURA,"TrCNT","MAX"),TrCNT_DESV:i(r.MISTURA,"TrCNT","DESV"),TrAR:r.TrAR||"",TrAR_MIN:i(r.MISTURA,"TrAR","MIN"),TrAR_MAX:i(r.MISTURA,"TrAR","MAX"),TrAR_DESV:i(r.MISTURA,"TrAR","DESV"),TRID:r.TRID||"",TRID_MIN:i(r.MISTURA,"TRID","MIN"),TRID_MAX:i(r.MISTURA,"TRID","MAX"),TRID_DESV:i(r.MISTURA,"TRID","DESV"),BCO:r.COLOR_BCO_PCT||"",GRI:r.COLOR_GRI_PCT||"",LG:r.COLOR_LG_PCT||"",AMA:r.COLOR_AMA_PCT||"",LA:r.COLOR_LA_PCT||""});l.height=16,l.alignment={vertical:"middle",horizontal:"center"},l.font={size:9};const A=l.number,U=A%2===1?"FFFFFFFF":"FFF8FAFC",V=A%2===1?"FFFFFEF8":"FFFFFBEB";for(let x=1;x<=82;x++){const _=l.getCell(x);x>=20?_.fill={type:"pattern",pattern:"solid",fgColor:{argb:V}}:_.fill={type:"pattern",pattern:"solid",fgColor:{argb:U}};let f={style:"thin",color:{argb:"FFE2E8F0"}};z.includes(x)?f={style:"medium",color:{argb:"FF64748B"}}:j.includes(x)&&(f={style:"medium",color:{argb:"FFD4A574"}}),_.border={right:f,bottom:{style:"thin",color:{argb:"FFE2E8F0"}}}}l.getCell(1).font={bold:!0,size:9},l.getCell("FECHA").numFmt="dd/mm/yyyy",l.getCell("MTS_IND").numFmt="#,##0",l.getCell("R103").numFmt="0.00",l.getCell("VEL_NOM").numFmt="0",l.getCell("VEL_PROM").numFmt="0",l.getCell("MTS_CRUDOS").numFmt="#,##0",l.getCell("EFI_TEJ").numFmt="0.0",l.getCell("RU105").numFmt="0.0",l.getCell("RT105").numFmt="0.0",l.getCell("MTS_CAL").numFmt="#,##0",l.getCell("CAL_PERCENT").numFmt="0.0",l.getCell("PTS_100M2").numFmt="0.0",l.getCell("ROT_106").numFmt="0.00",l.getCell("CAV").numFmt="0.0",l.getCell("SCI").numFmt="0.0",l.getCell("SCI_MIN").numFmt="0",l.getCell("SCI_MAX").numFmt="0",l.getCell("SCI_DESV").numFmt="0.00",l.getCell("MST").numFmt="0.0",l.getCell("MST_MIN").numFmt="0.0",l.getCell("MST_MAX").numFmt="0.0",l.getCell("MST_DESV").numFmt="0.00",l.getCell("MIC").numFmt="0.00",l.getCell("MIC_MIN").numFmt="0.00",l.getCell("MIC_MAX").numFmt="0.00",l.getCell("MIC_DESV").numFmt="0.00",l.getCell("MAT").numFmt="0.00",l.getCell("MAT_MIN").numFmt="0.00",l.getCell("MAT_MAX").numFmt="0.00",l.getCell("MAT_DESV").numFmt="0.00",l.getCell("UHML").numFmt="0.00",l.getCell("UHML_MIN").numFmt="0.00",l.getCell("UHML_MAX").numFmt="0.00",l.getCell("UHML_DESV").numFmt="0.00",l.getCell("UI").numFmt="0.0",l.getCell("UI_MIN").numFmt="0.0",l.getCell("UI_MAX").numFmt="0.0",l.getCell("UI_DESV").numFmt="0.00",l.getCell("SF").numFmt="0.0",l.getCell("SF_MIN").numFmt="0.0",l.getCell("SF_MAX").numFmt="0.0",l.getCell("SF_DESV").numFmt="0.00",l.getCell("STR").numFmt="0.0",l.getCell("STR_MIN").numFmt="0.0",l.getCell("STR_MAX").numFmt="0.0",l.getCell("STR_DESV").numFmt="0.00",l.getCell("ELG").numFmt="0.0",l.getCell("ELG_MIN").numFmt="0.0",l.getCell("ELG_MAX").numFmt="0.0",l.getCell("ELG_DESV").numFmt="0.00",l.getCell("RD").numFmt="0.0",l.getCell("RD_MIN").numFmt="0.0",l.getCell("RD_MAX").numFmt="0.0",l.getCell("RD_DESV").numFmt="0.00",l.getCell("PLUS_B").numFmt="0.0",l.getCell("PLUS_B_MIN").numFmt="0.0",l.getCell("PLUS_B_MAX").numFmt="0.0",l.getCell("PLUS_B_DESV").numFmt="0.00",l.getCell("TrCNT").numFmt="0",l.getCell("TrCNT_MIN").numFmt="0",l.getCell("TrCNT_MAX").numFmt="0",l.getCell("TrCNT_DESV").numFmt="0.00",l.getCell("TrAR").numFmt="0.00",l.getCell("TrAR_MIN").numFmt="0.00",l.getCell("TrAR_MAX").numFmt="0.00",l.getCell("TrAR_DESV").numFmt="0.00",l.getCell("TRID").numFmt="0",l.getCell("TRID_MIN").numFmt="0",l.getCell("TRID_MAX").numFmt="0",l.getCell("TRID_DESV").numFmt="0.00",l.getCell("BCO").numFmt="0.0",l.getCell("GRI").numFmt="0.0",l.getCell("LG").numFmt="0.0",l.getCell("AMA").numFmt="0.0",l.getCell("LA").numFmt="0.0",l.getCell("ROT_106").font={size:9,color:{argb:"FF059669"},bold:!0},l.getCell("R103").font={size:9,color:{argb:"FF2563EB"},bold:!0},l.getCell("EFI_TEJ").font={size:9,color:{argb:"FF7C3AED"},bold:!0},l.getCell("CAL_PERCENT").font={size:9,color:{argb:"FFB45309"},bold:!0},l.getCell("SCI").font={size:9,color:{argb:"FF0369A1"},bold:!0},l.getCell("MEZCLA").font={size:9,color:{argb:"FFB45309"},bold:!0}});const Xe=o.rowCount;o.autoFilter={from:{row:5,column:1},to:{row:Xe,column:82}},o.views=[{state:"frozen",xSplit:1,ySplit:5,topLeftCell:"B6",activeCell:"B6"}];const D=a.addWorksheet("An√°lisis HVI por Mezcla"),Q={};C.value.forEach(r=>{const d=r.MISTURA||"Sin Mezcla";Q[d]||(Q[d]=[]),Q[d].push(r)});const Pe=[{key:"SCI",nombre:"SCI"},{key:"MST",nombre:"MST"},{key:"MIC",nombre:"MIC"},{key:"MAT",nombre:"MAT"},{key:"UHML",nombre:"UHML"},{key:"UI",nombre:"UI"},{key:"SF",nombre:"SF"},{key:"STR",nombre:"STR"},{key:"ELG",nombre:"ELG"},{key:"RD",nombre:"RD"},{key:"PLUS_B",nombre:"+b"},{key:"TrCNT",nombre:"TrCNT"},{key:"TrAR",nombre:"TrAR"},{key:"TRID",nombre:"TRID"},{key:"BCO",nombre:"BCO%"},{key:"GRI",nombre:"GRI%"},{key:"LG",nombre:"LG%"},{key:"AMA",nombre:"AMA%"},{key:"LA",nombre:"LA%"}],$e=r=>{const d=r.filter(f=>f!=null&&f!==""&&!isNaN(parseFloat(f)));if(d.length===0)return{min:null,max:null,desv:null,count:0};const l=d.map(f=>parseFloat(f)),A=Math.min(...l),U=Math.max(...l),V=l.reduce((f,X)=>f+X,0)/l.length,x=l.reduce((f,X)=>f+Math.pow(X-V,2),0)/l.length,_=Math.sqrt(x);return{min:A,max:U,desv:_,count:l.length}};D.addRow(["AN√ÅLISIS ESTAD√çSTICO HVI POR MEZCLA"]),D.addRow([]);const re=D.addRow(["Mezcla","Variable","N","MIN","MAX","Desv.Est."]);D.getRow(1).font={bold:!0,size:14,color:{argb:"FF1E40AF"}},D.getRow(1).alignment={horizontal:"center"},D.mergeCells("A1:F1"),re.font={bold:!0,size:10},re.alignment={horizontal:"center",vertical:"middle"},re.height=25,re.eachCell(r=>{r.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF3B82F6"}},r.font={bold:!0,size:10,color:{argb:"FFFFFFFF"}},r.border={top:{style:"thin"},bottom:{style:"medium"},left:{style:"thin"},right:{style:"thin"}}});let ge=4;Object.keys(Q).sort().forEach((r,d)=>{const l=Q[r];if(Pe.forEach((A,U)=>{const V=l.map(X=>X[A.key]),x=$e(V),_=D.addRow([U===0?r:"",A.nombre,x.count,x.min,x.max,x.desv]);_.alignment={horizontal:"center",vertical:"middle"},_.height=18,_.getCell(4).numFmt="0.00",_.getCell(5).numFmt="0.00",_.getCell(6).numFmt="0.00";const f=d%2===0?"FFFFFFFF":"FFF8FAFC";_.eachCell(X=>{X.fill={type:"pattern",pattern:"solid",fgColor:{argb:f}},X.border={top:{style:"thin",color:{argb:"FFE2E8F0"}},bottom:{style:"thin",color:{argb:"FFE2E8F0"}},left:{style:"thin",color:{argb:"FFE2E8F0"}},right:{style:"thin",color:{argb:"FFE2E8F0"}}}}),U===0&&(_.getCell(1).font={bold:!0,size:10,color:{argb:"FF1E40AF"}}),ge++}),d<Object.keys(Q).length-1){const A=D.addRow([""]);A.height=5,ge++}}),D.columns=[{width:20},{width:12},{width:8},{width:12},{width:12},{width:12}];const Ge=await a.xlsx.writeBuffer(),He=new Blob([Ge],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),_e=window.URL.createObjectURL(He),ce=document.createElement("a");ce.href=_e;const ze=new Date().toTimeString().slice(0,8).replace(/:/g,"");ce.download=`Roladas_Fibra_HVI_${P.value}_${$.value}_${ze}.xlsx`,ce.click(),window.URL.revokeObjectURL(_e)}catch(a){console.error("Error exportando a Excel:",a),alert("Error al exportar: "+a.message)}finally{v.value=!1}}};return je(()=>{const a=new Date,o=new Date;o.setDate(a.getDate()-30),$.value=a.toISOString().split("T")[0],P.value=o.toISOString().split("T")[0]}),(a,o)=>(u(),p("div",qe,[v.value?(u(),p("div",Ke,[...o[2]||(o[2]=[he('<div class="flex flex-col items-center gap-4 bg-white/90 px-10 py-8 rounded-2xl shadow-2xl border border-blue-100" data-v-6ea6cfb8><div class="relative" data-v-6ea6cfb8><div class="animate-spin rounded-full h-16 w-16 border-4 border-blue-50 border-t-blue-600" data-v-6ea6cfb8></div><div class="absolute inset-0 flex items-center justify-center" data-v-6ea6cfb8><div class="h-8 w-8 bg-blue-600 rounded-full animate-pulse opacity-10" data-v-6ea6cfb8></div></div></div><div class="flex flex-col items-center gap-1" data-v-6ea6cfb8><span class="text-slate-500 font-medium tracking-wider uppercase text-[10px]" data-v-6ea6cfb8>Cargando</span><span class="text-xl text-slate-800 font-bold" data-v-6ea6cfb8>Roladas + Fibra HVI</span></div></div>',1)])])):J("",!0),e("main",{ref_key:"mainContentRef",ref:Ae,class:"w-full flex-1 min-h-0 bg-white rounded-xl shadow-sm px-4 py-3 border border-slate-200/60 flex flex-col relative"},[e("div",Ye,[e("div",et,[o[4]||(o[4]=e("img",{src:Je,alt:"Santana Textiles",class:"h-9 w-auto object-contain opacity-90"},null,-1)),o[5]||(o[5]=e("div",null,[e("h3",{class:"text-base font-semibold text-slate-800 tracking-tight"},"Seguimiento de Roladas + Fibra HVI"),e("p",{class:"text-xs text-slate-400 mt-0.5"},"Producci√≥n √çNDIGO con An√°lisis de Calidad de Fibra")],-1)),e("div",tt,[o[3]||(o[3]=e("span",{class:"text-xs text-slate-500"},"Registros:",-1)),e("span",rt,s(C.value.length),1)])]),e("div",lt,[e("div",ot,[o[6]||(o[6]=e("label",{for:"fecha-inicio",class:"text-xs font-medium text-slate-500"},"Desde:",-1)),fe(e("input",{type:"date",id:"fecha-inicio","onUpdate:modelValue":o[0]||(o[0]=t=>P.value=t),class:"px-2.5 py-1.5 border border-slate-200 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-blue-500 text-sm bg-white text-slate-700"},null,512),[[ye,P.value]])]),e("div",st,[o[7]||(o[7]=e("label",{for:"fecha-fin",class:"text-xs font-medium text-slate-500"},"Hasta:",-1)),fe(e("input",{type:"date",id:"fecha-fin","onUpdate:modelValue":o[1]||(o[1]=t=>$.value=t),class:"px-2.5 py-1.5 border border-slate-200 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-blue-500 text-sm bg-white text-slate-700"},null,512),[[ye,$.value]])]),e("button",{onClick:Re,disabled:v.value,class:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white text-sm font-medium rounded-md transition-colors"},[v.value?(u(),p("svg",dt,[...o[9]||(o[9]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(u(),p("svg",nt,[...o[8]||(o[8]=[e("circle",{cx:"11",cy:"11",r:"8"},null,-1),e("path",{d:"m21 21-4.35-4.35"},null,-1)])])),e("span",null,s(v.value?"Cargando...":"Buscar"),1)],8,at),e("button",{onClick:ke,disabled:C.value.length===0,class:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-green-600 hover:bg-green-700 disabled:bg-slate-400 text-white text-sm font-medium rounded-md transition-colors"},[...o[10]||(o[10]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M12.9,14.5L15.8,19H14L12,15.6L10,19H8.2L11.1,14.5L8.2,10H10L12,13.4L14,10H15.8L12.9,14.5Z"})],-1),e("span",null,"Excel",-1)])],8,bt)])]),e("div",{class:"overflow-auto relative bg-white rounded-lg shadow-sm border border-slate-300 flex-1",ref_key:"tablaRef",ref:Fe},[e("table",{ref_key:"tableElementRef",ref:Se,class:"w-full text-[11px] text-slate-700 border-separate border-spacing-0"},[o[16]||(o[16]=e("thead",{class:"sticky top-0 z-20"},[e("tr",{class:"text-slate-500 text-[10px] uppercase tracking-wider"},[e("th",{scope:"col",rowspan:"3",class:"px-2 py-2 font-semibold text-center border-r-2 border-slate-300 border-b-2 border-b-slate-300 text-slate-700 bg-slate-50 sticky left-0 z-30 min-w-[55px]"},"Rolada"),e("th",{scope:"col",colspan:"3",class:"px-2 py-1.5 font-semibold text-center border-r-2 border-slate-300 border-b border-b-slate-300 text-slate-700 bg-slate-50"},"Urdidora"),e("th",{scope:"col",colspan:"8",class:"px-2 py-1.5 font-semibold text-center border-r-2 border-slate-300 border-b border-b-slate-300 text-slate-700 bg-slate-50"},"√çndigo"),e("th",{scope:"col",colspan:"4",class:"px-2 py-1.5 font-semibold text-center border-r-2 border-slate-300 border-b border-b-slate-300 text-slate-700 bg-slate-50"},"Tejedur√≠a"),e("th",{scope:"col",colspan:"3",class:"px-2 py-1.5 font-semibold text-center border-r-2 border-slate-300 border-b border-b-slate-300 text-slate-700 bg-slate-50"},"Calidad"),e("th",{scope:"col",colspan:"63",class:"px-2 py-1.5 font-semibold text-center border-b border-b-slate-300 text-slate-700 bg-amber-50"},"Fibra HVI")]),e("tr",{class:"text-slate-600 text-[10px] bg-slate-50"},[e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-[40px]"},"Maq"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-[35px]"},"Lote"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r-2 border-slate-300 border-b-2 border-b-slate-300 min-w-[40px]"},"R10‚Å∂"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-[70px]"},"Fecha"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-[75px]"},"Base"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-[35px]"},"Color"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-[50px]"},"Metros"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-[35px]"},"R10¬≥"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-[30px]"},[e("span",{class:"block leading-tight"},[q("Cav"),e("br"),q("10‚Åµ")])]),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-[35px]"},"VNom"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r-2 border-slate-300 border-b-2 border-b-slate-300 min-w-[35px]"},"VPro"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-[50px]"},"Metros"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-[40px]"},"Efi%"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-[40px]"},"RU10‚Åµ"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r-2 border-slate-300 border-b-2 border-b-slate-300 min-w-[40px]"},"RT10‚Åµ"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-[50px]"},"Metros"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-[40px]"},"Cal%"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r-2 border-slate-300 border-b-2 border-b-slate-300 min-w-[50px]"},"Pts100"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-[40px] bg-amber-50"},"Mezc"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-[70px] bg-amber-50"},"F.Ingr"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b border-slate-300 bg-blue-50",title:"√çndice de Color"},"SCI"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b border-slate-300 bg-blue-50",title:"Humedad"},"MST"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b border-slate-300 bg-blue-50",title:"Micronaire"},"MIC"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b border-slate-300 bg-blue-50",title:"Madurez"},"MAT"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b border-slate-300 bg-green-50",title:"Longitud media"},"UHML"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b border-slate-300 bg-green-50",title:"Uniformidad"},"UI"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b border-slate-300 bg-green-50",title:"Fibras cortas"},"SF"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b border-slate-300 bg-yellow-50",title:"Resistencia"},"STR"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b border-slate-300 bg-yellow-50",title:"Elongaci√≥n"},"ELG"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b border-slate-300 bg-yellow-50",title:"Reflectancia"},"RD"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b border-slate-300 bg-yellow-50",title:"Amarillez"},"+b"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b border-slate-300 bg-purple-50"},"TrCNT"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b border-slate-300 bg-purple-50"},"TrAR"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r-2 border-slate-300 border-b border-slate-300 bg-purple-50"},"TRID"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-[35px] bg-orange-50"},"BCO"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-[35px] bg-orange-50"},"GRI"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-[35px] bg-orange-50"},"LG"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-[35px] bg-orange-50"},"AMA"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-b-2 border-b-slate-300 min-w-[35px] bg-orange-50"},"LA")]),e("tr",{class:"text-slate-600 text-[9px] bg-slate-50"},[e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-green-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-green-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-green-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-green-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-green-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-green-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-green-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-green-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-green-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-green-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-green-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-green-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-purple-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-purple-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-purple-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-purple-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-purple-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-purple-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-purple-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-purple-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-purple-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-purple-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-purple-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r-2 border-slate-300 border-b-2 border-b-slate-300 bg-purple-50/50"},"œÉ")])],-1)),e("tbody",null,[(u(!0),p(G,null,H(C.value,(t,b)=>(u(),p("tr",{key:t.ROLADA,class:"border-b border-slate-200 hover:bg-slate-50/80 transition-colors"},[e("td",ct,s(t.ROLADA),1),e("td",it,s(t.MAQ_OE||"-"),1),e("td",ut,s(t.LOTE||"-"),1),e("td",pt,s(ue(t.URDIDORA_ROTURAS,t.URDIDORA_METROS,t.NUM_FIOS)),1),e("td",xt,s(t.FECHA||"-"),1),e("td",mt,s(t.BASE||"-"),1),e("td",gt,s(t.COLOR||"-"),1),e("td",_t,s(ae(t.MTS_IND)),1),e("td",ht,s(n(t.R103,2)),1),e("td",ft,s(pe(t.CAV,t.MTS_IND)),1),e("td",yt,s(n(t.VEL_NOM,0)),1),e("td",Mt,s(n(t.VEL_PROM,0)),1),e("td",At,s(ae(t.MTS_CRUDOS)),1),e("td",Ft,s(n(t.EFI_TEJ,1)),1),e("td",St,s(n(t.RU105,1)),1),e("td",Ct,s(n(t.RT105,1)),1),e("td",It,s(ae(t.MTS_CAL)),1),e("td",Tt,s(n(t.CAL_PERCENT,1)),1),e("td",Rt,s(n(t.PTS_100M2,1)),1),e("td",{onClick:c=>ve(t.MISTURA,t.LOTE),class:"px-1 py-2 text-center text-amber-700 font-semibold tabular-nums border-r border-slate-200 bg-amber-50/30 cursor-pointer hover:bg-amber-100/50 transition-colors",title:"Click para ver detalles de MISTURA "+t.MISTURA},s(t.MISTURA||"-"),9,wt),e("td",vt,s(Ce(t.FECHA_INGRESO)),1),e("td",Et,s(n(t.SCI,1)),1),e("td",Nt,s(n(t.SCI_MIN,1)),1),e("td",Lt,s(n(t.SCI_MAX,1)),1),e("td",Dt,s(n(t.SCI_SIGMA,2)),1),e("td",Ut,s(n(t.MST,1)),1),e("td",kt,s(n(t.MST_MIN,1)),1),e("td",Ot,s(n(t.MST_MAX,1)),1),e("td",Bt,s(n(t.MST_SIGMA,2)),1),e("td",Vt,s(n(t.MIC,2)),1),e("td",Xt,s(n(t.MIC_MIN,2)),1),e("td",Pt,s(n(t.MIC_MAX,2)),1),e("td",$t,s(n(t.MIC_SIGMA,2)),1),e("td",Gt,s(n(t.MAT,2)),1),e("td",Ht,s(n(t.MAT_MIN,2)),1),e("td",zt,s(n(t.MAT_MAX,2)),1),e("td",jt,s(n(t.MAT_SIGMA,2)),1),e("td",Qt,s(n(t.UHML,2)),1),e("td",Jt,s(n(t.UHML_MIN,2)),1),e("td",Wt,s(n(t.UHML_MAX,2)),1),e("td",Zt,s(n(t.UHML_SIGMA,2)),1),e("td",qt,s(n(t.UI,1)),1),e("td",Kt,s(n(t.UI_MIN,1)),1),e("td",Yt,s(n(t.UI_MAX,1)),1),e("td",er,s(n(t.UI_SIGMA,2)),1),e("td",tr,s(n(t.SF,1)),1),e("td",rr,s(n(t.SF_MIN,1)),1),e("td",lr,s(n(t.SF_MAX,1)),1),e("td",or,s(n(t.SF_SIGMA,2)),1),e("td",sr,s(n(t.STR,1)),1),e("td",ar,s(n(t.STR_MIN,1)),1),e("td",nr,s(n(t.STR_MAX,1)),1),e("td",dr,s(n(t.STR_SIGMA,2)),1),e("td",br,s(n(t.ELG,1)),1),e("td",cr,s(n(t.ELG_MIN,1)),1),e("td",ir,s(n(t.ELG_MAX,1)),1),e("td",ur,s(n(t.ELG_SIGMA,2)),1),e("td",pr,s(n(t.RD,1)),1),e("td",xr,s(n(t.RD_MIN,1)),1),e("td",mr,s(n(t.RD_MAX,1)),1),e("td",gr,s(n(t.RD_SIGMA,2)),1),e("td",_r,s(n(t.PLUS_B,1)),1),e("td",hr,s(n(t.PLUS_B_MIN,1)),1),e("td",fr,s(n(t.PLUS_B_MAX,1)),1),e("td",yr,s(n(t.PLUS_B_SIGMA,2)),1),e("td",Mr,s(n(t.TrCNT,0)),1),e("td",Ar,s(n(t.TrCNT_MIN,0)),1),e("td",Fr,s(n(t.TrCNT_MAX,0)),1),e("td",Sr,s(n(t.TrCNT_SIGMA,2)),1),e("td",Cr,s(n(t.TrAR,2)),1),e("td",Ir,s(n(t.TrAR_MIN,2)),1),e("td",Tr,s(n(t.TrAR_MAX,2)),1),e("td",Rr,s(n(t.TrAR_SIGMA,2)),1),e("td",wr,s(n(t.TRID,0)),1),e("td",vr,s(n(t.TRID_MIN,0)),1),e("td",Er,s(n(t.TRID_MAX,0)),1),e("td",Nr,s(n(t.TRID_SIGMA,2)),1),e("td",Lr,s(W(t.COLOR_BCO_PCT)),1),e("td",Dr,s(W(t.COLOR_GRI_PCT)),1),e("td",Ur,s(W(t.COLOR_LG_PCT)),1),e("td",kr,s(W(t.COLOR_AMA_PCT)),1),e("td",Or,s(W(t.COLOR_LA_PCT)),1)]))),128))]),g.value&&C.value.length>0?(u(),p("tfoot",Br,[e("tr",Vr,[e("td",Xr,[o[11]||(o[11]=e("span",{class:"text-xs uppercase tracking-wide text-slate-500"},"Total:",-1)),e("span",Pr,s(g.value.TOTAL_ROLADAS),1)]),o[12]||(o[12]=e("td",{class:"px-1 py-2.5 text-center text-slate-400 border-r border-slate-200 border-t-2 border-t-slate-300",colspan:"2"},"-",-1)),e("td",$r,s(ue(g.value.URDIDORA_ROTURAS,g.value.URDIDORA_METROS,g.value.NUM_FIOS)),1),o[13]||(o[13]=e("td",{class:"px-1 py-2.5 text-center text-slate-400 border-r border-slate-200 border-t-2 border-t-slate-300",colspan:"3"},"-",-1)),e("td",Gr,s(n(g.value.MTS_IND,0)),1),e("td",Hr,s(n(g.value.R103,2)),1),e("td",zr,s(pe(g.value.CAV,g.value.MTS_IND)),1),o[14]||(o[14]=e("td",{class:"px-1 py-2.5 text-center tabular-nums text-slate-400 border-r border-slate-200 border-t-2 border-t-slate-300"},"-",-1)),e("td",jr,s(n(g.value.VEL_PROM,0)),1),e("td",Qr,s(n(g.value.MTS_CRUDOS,0)),1),e("td",Jr,s(n(g.value.EFI_TEJ,1)),1),e("td",Wr,s(n(g.value.RU105,1)),1),e("td",Zr,s(n(g.value.RT105,1)),1),e("td",qr,s(n(g.value.MTS_CAL,0)),1),e("td",Kr,s(n(g.value.CAL_PERCENT,1)),1),e("td",Yr,s(n(g.value.PTS_100M2,1)),1),o[15]||(o[15]=e("td",{class:"px-1 py-2.5 text-center text-slate-400 border-t-2 border-t-slate-300 bg-amber-50/20",colspan:"63"},"-",-1))])])):J("",!0)],512),!v.value&&C.value.length===0?(u(),p("div",el,[...o[17]||(o[17]=[he('<div class="text-center" data-v-6ea6cfb8><svg class="mx-auto h-10 w-10 text-slate-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-6ea6cfb8><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" data-v-6ea6cfb8></path></svg><h3 class="mt-3 text-sm font-medium text-slate-700" data-v-6ea6cfb8>No hay datos disponibles</h3><p class="mt-1 text-xs text-slate-400" data-v-6ea6cfb8>Seleccione un rango de fechas y haga clic en Buscar</p></div>',1)])])):J("",!0)],512)],512),le.value?(u(),p("div",tl,[e("div",rl,[e("div",ll,[e("div",ol,[o[19]||(o[19]=e("h3",{class:"text-lg font-semibold text-slate-800"},"Detalle de MISTURA",-1)),e("div",sl,[e("span",al,s(k.value),1)]),ee.value?(u(),p("div",nl,[o[18]||(o[18]=e("span",{class:"text-xs text-slate-500 mr-1"},"Lote:",-1)),e("span",dl,s(ee.value),1)])):J("",!0),e("div",bl,s(F.value+1)+" de "+s(B.value.length),1)]),e("div",cl,[e("button",{onClick:Ee,disabled:F.value===0,class:Me(["px-3 py-1.5 rounded-lg transition-all text-sm font-medium",F.value===0?"bg-slate-100 text-slate-300 cursor-not-allowed":"bg-slate-100 hover:bg-slate-200 text-slate-700"])}," ‚óÑ Anterior ",10,il),e("button",{onClick:Ne,disabled:F.value===B.value.length-1,class:Me(["px-3 py-1.5 rounded-lg transition-all text-sm font-medium",F.value===B.value.length-1?"bg-slate-100 text-slate-300 cursor-not-allowed":"bg-slate-100 hover:bg-slate-200 text-slate-700"])}," Siguiente ‚ñ∫ ",10,ul),e("button",{onClick:Le,class:"ml-2 px-3 py-1.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg transition-all text-sm font-medium"}," ‚úï Cerrar ")])]),e("div",pl,[S.value?S.value&&S.value.seqs&&S.value.seqs.length>0?(u(),p("div",ml,[e("div",gl,[e("table",_l,[e("thead",null,[e("tr",hl,[o[21]||(o[21]=e("th",{class:"px-3 py-1 text-left font-semibold text-slate-700 border border-slate-300 sticky left-0 bg-slate-100 z-10"},"Variable",-1)),(u(!0),p(G,null,H(Z.value,t=>(u(),p("th",{key:t.SEQ,class:"px-2 py-1 text-center font-semibold text-slate-700 border border-slate-300 min-w-[40px]"},s(xe(t.SEQ)),1))),128))])]),e("tbody",null,[e("tr",fl,[o[22]||(o[22]=e("td",{class:"px-3 py-1 font-medium text-slate-700 border border-slate-300 sticky left-0 bg-white"},"Fecha",-1)),(u(!0),p(G,null,H(Z.value,t=>(u(),p("td",{key:t.SEQ,class:"px-1 py-2 border border-slate-300"},[e("div",yl,[e("div",Ml,s(we(t.DT_ENTRADA_PROD)),1)])]))),128))]),e("tr",Al,[o[23]||(o[23]=e("td",{class:"px-3 py-1 font-medium text-slate-700 border border-slate-300 sticky left-0 bg-white"},"Hora",-1)),(u(!0),p(G,null,H(Z.value,t=>(u(),p("td",{key:t.SEQ,class:"px-2 py-1 text-center border border-slate-300 text-slate-600 text-xs"},s(t.HR_ENTRADA_PROD||"-"),1))),128))]),o[24]||(o[24]=e("tr",{class:"bg-slate-50"},[e("td",{colspan:"100",class:"px-3 py-1 text-xs font-semibold text-slate-500 border border-slate-300"},"Promedios Ponderados HVI")],-1)),(u(),p(G,null,H(["SCI","MST","MIC","MAT","UHML","UI","SF","STR","ELG","RD","+b","TrCNT","TrAR","TRID"],t=>e("tr",{key:t,class:"hover:bg-slate-50"},[e("td",{class:"px-3 py-1 font-medium text-slate-700 border border-slate-300 sticky left-0 bg-white cursor-help transition-colors hover:bg-blue-50",onMouseenter:b=>De(t,b),onMouseleave:Ue},s(t),41,Fl),(u(!0),p(G,null,H(Z.value,b=>(u(),p("td",{key:b.SEQ,class:"px-2 py-1 text-center border border-slate-300 tabular-nums text-slate-600 text-xs"},s(b[t==="+b"?"PLUS_B":t]!==null&&b[t==="+b"?"PLUS_B":t]!==void 0?Number(b[t==="+b"?"PLUS_B":t]).toFixed(2):"-"),1))),128))])),64))])])])])):(u(),p("div",Sl,[...o[25]||(o[25]=[e("div",{class:"text-center"},[e("p",{class:"text-slate-500"},"No hay datos disponibles para esta MISTURA")],-1)])])):(u(),p("div",xl,[...o[20]||(o[20]=[e("div",{class:"flex flex-col items-center gap-3"},[e("div",{class:"animate-spin rounded-full h-8 w-8 border-2 border-slate-200 border-t-slate-600"}),e("span",{class:"text-sm text-slate-500"},"Cargando datos...")],-1)])]))])])])):J("",!0),O.value&&I.value.length>0?(u(),p("div",{key:2,class:"fixed bg-white rounded-lg shadow-2xl border border-slate-300 p-4 z-[60] pointer-events-none",style:Qe({left:oe.value.x+"px",top:oe.value.y+"px",width:"760px"})},[e("div",Cl,[e("h4",Il,s(O.value)+" - MISTURA "+s(k.value),1)]),e("div",Tl,[(u(),p("svg",Rl,[o[26]||(o[26]=e("line",{x1:"30",y1:"10",x2:"30",y2:"130",stroke:"#cbd5e1","stroke-width":"1.5"},null,-1)),o[27]||(o[27]=e("line",{x1:"30",y1:"130",x2:"730",y2:"130",stroke:"#cbd5e1","stroke-width":"1.5"},null,-1)),e("text",wl,s(M.value.max.toFixed(1)),1),e("text",vl,s(((M.value.max+M.value.min)/2).toFixed(1)),1),e("text",El,s(M.value.min.toFixed(1)),1),o[28]||(o[28]=e("line",{x1:"30",y1:"70",x2:"730",y2:"70",stroke:"#e2e8f0","stroke-width":"1","stroke-dasharray":"3,3"},null,-1)),e("polyline",{points:I.value.map((t,b)=>{const c=40+b*(690/(I.value.length-1||1)),m=130-(t.valor-M.value.min)/(M.value.max-M.value.min)*120;return c+","+m}).join(" "),fill:"none",stroke:"#3b82f6","stroke-width":"2.5",class:"transition-all duration-300"},null,8,Nl),(u(!0),p(G,null,H(I.value,(t,b)=>(u(),p("g",{key:t.seq},[e("circle",{cx:40+b*(690/(I.value.length-1||1)),cy:130-(t.valor-M.value.min)/(M.value.max-M.value.min)*120,r:"4",fill:"#3b82f6",stroke:"white","stroke-width":"2",class:"transition-all duration-300"},null,8,Ll),e("text",{x:40+b*(690/(I.value.length-1||1)),y:"145","text-anchor":"middle",class:"text-[10px] fill-slate-600 font-medium"},s(t.seq),9,Dl),e("text",{x:40+b*(690/(I.value.length-1||1)),y:130-(t.valor-M.value.min)/(M.value.max-M.value.min)*120-8,"text-anchor":"middle",class:"text-[9px] fill-slate-700 font-mono font-semibold"},s(Number(t.valor).toFixed(2)),9,Ul)]))),128))]))]),e("div",kl,[e("span",null,[o[29]||(o[29]=q("M√≠n: ",-1)),e("strong",null,s(Math.min(...I.value.map(t=>t.valor)).toFixed(2)),1)]),e("span",null,[o[30]||(o[30]=q("Prom Ponderado: ",-1)),e("strong",null,s(me.value!==null?Number(me.value).toFixed(2):"-"),1)]),e("span",null,[o[31]||(o[31]=q("M√°x: ",-1)),e("strong",null,s(Math.max(...I.value.map(t=>t.valor)).toFixed(2)),1)])])],4)):J("",!0)]))}},Hl=Ze(Ol,[["__scopeId","data-v-6ea6cfb8"]]);export{Hl as default};
