import{_ as Ve,o as Xe,a as i,c as p,A as pe,e as $,b as e,t as s,f as xe,g as me,d as j,F as O,r as U,n as ge,k as $e,m as f,p as Q}from"./index-DOrYTJc_.js";import{_ as Ge}from"./LogoSantana-C2JneU89.js";import{e as Pe}from"./exceljs.min-DtXTVuKQ.js";const He={class:"w-full h-screen flex flex-col p-1 relative"},ze={key:0,class:"fixed inset-0 bg-white/40 backdrop-blur-xs flex items-center justify-center z-9999 transition-all duration-300"},je={class:"flex items-center justify-between gap-4 shrink-0 mb-3 pb-3 border-b border-slate-100"},Qe={class:"flex items-center gap-5"},Je={class:"flex items-center gap-1.5 px-2.5 py-1 bg-slate-100 rounded-md ml-2"},We={class:"text-sm font-semibold text-slate-700 tabular-nums"},Ze={class:"flex items-center gap-2"},qe={class:"flex items-center gap-1.5"},Ke={class:"flex items-center gap-1.5"},Ye=["disabled"],et={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},tt={key:1,class:"h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},rt=["disabled"],lt={class:"px-2 py-2 font-semibold text-slate-800 text-center tabular-nums border-r-2 border-slate-300 bg-slate-50/50 sticky left-0 z-10"},ot={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200"},st={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200"},at={class:"px-1 py-2 text-center text-emerald-600 font-semibold tabular-nums border-r-2 border-slate-300"},nt={class:"px-1 py-2 text-center text-slate-500 text-xs border-r border-slate-200"},dt={class:"px-1 py-2 text-center text-slate-700 border-r border-slate-200 text-xs"},bt={class:"px-1 py-2 text-center text-slate-600 border-r border-slate-200"},ct={class:"px-1 py-2 text-center text-slate-700 font-medium tabular-nums border-r border-slate-200"},ut={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200"},it={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200"},pt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200"},xt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r-2 border-slate-300"},mt={class:"px-1 py-2 text-center text-slate-700 font-medium tabular-nums border-r border-slate-200"},gt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200"},_t={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200"},ft={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r-2 border-slate-300"},ht={class:"px-1 py-2 text-center text-slate-700 font-medium tabular-nums border-r border-slate-200"},yt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200"},Mt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r-2 border-slate-300"},At=["onClick","title"],Ct={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-amber-50/30 text-xs"},Ft={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-blue-50/30"},It={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-blue-50/20 text-[9px]"},St={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-blue-50/20 text-[9px]"},wt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-blue-50/30 text-[9px] font-medium"},vt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-blue-50/30"},Tt={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-blue-50/20 text-[9px]"},Rt={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-blue-50/20 text-[9px]"},Et={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-blue-50/30 text-[9px] font-medium"},Nt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-blue-50/30"},Lt={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-blue-50/20 text-[9px]"},Dt={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-blue-50/20 text-[9px]"},kt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-blue-50/30 text-[9px] font-medium"},Ot={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-blue-50/30"},Ut={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-blue-50/20 text-[9px]"},Bt={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-blue-50/20 text-[9px]"},Vt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-blue-50/30 text-[9px] font-medium"},Xt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-green-50/30"},$t={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-green-50/20 text-[9px]"},Gt={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-green-50/20 text-[9px]"},Pt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-green-50/30 text-[9px] font-medium"},Ht={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-green-50/30"},zt={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-green-50/20 text-[9px]"},jt={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-green-50/20 text-[9px]"},Qt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-green-50/30 text-[9px] font-medium"},Jt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-green-50/30"},Wt={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-green-50/20 text-[9px]"},Zt={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-green-50/20 text-[9px]"},qt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-green-50/30 text-[9px] font-medium"},Kt={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-yellow-50/30"},Yt={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-yellow-50/20 text-[9px]"},er={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-yellow-50/20 text-[9px]"},tr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-yellow-50/30 text-[9px] font-medium"},rr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-yellow-50/30"},lr={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-yellow-50/20 text-[9px]"},or={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-yellow-50/20 text-[9px]"},sr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-yellow-50/30 text-[9px] font-medium"},ar={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-yellow-50/30"},nr={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-yellow-50/20 text-[9px]"},dr={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-yellow-50/20 text-[9px]"},br={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-yellow-50/30 text-[9px] font-medium"},cr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-yellow-50/30"},ur={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-yellow-50/20 text-[9px]"},ir={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-yellow-50/20 text-[9px]"},pr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-yellow-50/30 text-[9px] font-medium"},xr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-purple-50/30"},mr={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-purple-50/20 text-[9px]"},gr={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-purple-50/20 text-[9px]"},_r={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-purple-50/30 text-[9px] font-medium"},fr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-purple-50/30"},hr={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-purple-50/20 text-[9px]"},yr={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-purple-50/20 text-[9px]"},Mr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-purple-50/30 text-[9px] font-medium"},Ar={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-purple-50/30"},Cr={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-purple-50/20 text-[9px]"},Fr={class:"px-1 py-2 text-center text-slate-500 tabular-nums border-r border-slate-200 bg-purple-50/20 text-[9px]"},Ir={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r-2 border-slate-300 bg-purple-50/30 text-[9px] font-medium"},Sr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-orange-50/30"},wr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-orange-50/30"},vr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-orange-50/30"},Tr={class:"px-1 py-2 text-center text-slate-600 tabular-nums border-r border-slate-200 bg-orange-50/30"},Rr={class:"px-1 py-2 text-center text-slate-600 tabular-nums bg-orange-50/30"},Er={key:0,class:"sticky bottom-0 z-20 bg-slate-100"},Nr={class:"font-semibold text-slate-700"},Lr={class:"px-2 py-2.5 text-center border-r-2 border-slate-300 border-t-2 border-t-slate-300 sticky left-0 bg-slate-100 z-10"},Dr={class:"ml-1 text-slate-700"},kr={class:"px-1 py-2.5 text-center text-emerald-600 font-semibold tabular-nums border-r-2 border-slate-300 border-t-2 border-t-slate-300"},Or={class:"px-1 py-2.5 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},Ur={class:"px-1 py-2.5 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},Br={class:"px-1 py-2.5 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},Vr={class:"px-1 py-2.5 text-center tabular-nums border-r-2 border-slate-300 border-t-2 border-t-slate-300"},Xr={class:"px-1 py-2.5 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},$r={class:"px-1 py-2.5 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},Gr={class:"px-1 py-2.5 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},Pr={class:"px-1 py-2.5 text-center tabular-nums border-r-2 border-slate-300 border-t-2 border-t-slate-300"},Hr={class:"px-1 py-2.5 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},zr={class:"px-1 py-2.5 text-center tabular-nums border-r border-slate-200 border-t-2 border-t-slate-300"},jr={class:"px-1 py-2.5 text-center tabular-nums border-r-2 border-slate-300 border-t-2 border-t-slate-300"},Qr={key:0,class:"flex items-center justify-center h-64 bg-white"},Jr={key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-2"},Wr={class:"bg-white rounded-xl shadow-2xl max-w-7xl w-full max-h-[95vh] flex flex-col"},Zr={class:"flex items-center justify-between px-6 py-2 border-b border-slate-200 shrink-0"},qr={class:"flex items-center gap-4"},Kr={class:"px-3 py-1 bg-blue-100 rounded-lg"},Yr={class:"text-sm font-mono font-semibold text-blue-700"},el={key:0,class:"px-3 py-1 bg-slate-100 rounded-lg"},tl={class:"text-sm font-mono font-semibold text-slate-700"},rl={class:"text-xs text-slate-400"},ll={class:"flex items-center gap-2"},ol=["disabled"],sl=["disabled"],al={class:"flex-1 overflow-auto p-2"},nl={key:0,class:"flex items-center justify-center h-64"},dl={key:1},bl={class:"overflow-x-auto"},cl={class:"w-full border-collapse text-sm"},ul={class:"bg-slate-100"},il={class:"hover:bg-slate-50"},pl={class:"flex justify-center items-center h-full"},xl={class:"text-xs text-slate-600",style:{"writing-mode":"vertical-rl",transform:"rotate(180deg)","white-space":"nowrap"}},ml={class:"hover:bg-slate-50"},gl=["onMouseenter"],_l={key:2,class:"flex items-center justify-center h-64"},fl={class:"mb-3 pb-2 border-b border-slate-200"},hl={class:"text-sm font-semibold text-slate-700"},yl={class:"relative"},Ml={width:"100%",height:"160",class:"overflow-visible"},Al={x:"25",y:"15","text-anchor":"end",class:"text-[10px] fill-slate-600"},Cl={x:"25",y:"72","text-anchor":"end",class:"text-[10px] fill-slate-600"},Fl={x:"25",y:"133","text-anchor":"end",class:"text-[10px] fill-slate-600"},Il=["points"],Sl=["cx","cy"],wl=["x"],vl=["x","y"],Tl={class:"mt-2 pt-2 border-t border-slate-200 flex justify-between text-xs text-slate-600"},Rl={__name:"SeguimientoRoladasFibra",setup(El){const w=f(!1),C=f([]),g=f(null),J=f({}),D=f(""),k=f(""),K=f(!1),E=f(null),W=f(null),y=f(0),M=f(null),N=f(null),Y=f({x:0,y:0}),L=Q(()=>{const n=new Set;return C.value.forEach(l=>{l.MISTURA&&String(l.MISTURA).split(",").map(b=>b.trim()).forEach(b=>n.add(b))}),Array.from(n).sort((l,t)=>l.localeCompare(t))}),_e=f(null),fe=f(null),he=f(null),ne="".replace(/\/$/,""),ee=ne?`${ne}/api`:"/api",d=(n,l=0)=>{if(n==null||n==="")return"-";const t=parseFloat(n);return isNaN(t)?"-":t.toLocaleString("es-ES",{minimumFractionDigits:l,maximumFractionDigits:l})},te=n=>{if(n==null||n==="")return"-";const l=parseFloat(n);return isNaN(l)?"-":l>=1e3?l.toLocaleString("de-DE",{minimumFractionDigits:0,maximumFractionDigits:0}):Math.round(l).toString()},G=n=>{if(n==null||n==="")return"-";const l=parseFloat(n);return isNaN(l)||l===0?"-":l.toLocaleString("es-ES",{minimumFractionDigits:1,maximumFractionDigits:1})},ye=n=>n||"-",de=(n,l,t)=>{if(!n||!l||!t)return"-";const b=parseFloat(n),u=parseFloat(l),x=parseFloat(t);return isNaN(b)||isNaN(u)||isNaN(x)||u===0||x===0?"-":(b*1e6/(u*x)).toFixed(2).replace(".",",")},Me=(n,l,t)=>{if(!n||!l||!t)return null;const b=parseFloat(n),u=parseFloat(l),x=parseFloat(t);return isNaN(b)||isNaN(u)||isNaN(x)||u===0||x===0?null:b*1e6/(u*x)},be=(n,l)=>{if(!n||!l)return"-";const t=parseFloat(n),b=parseFloat(l);return isNaN(t)||isNaN(b)||b===0?"-":(t*1e5/b).toFixed(1).replace(".",",")},Ae=(n,l)=>{if(!n||!l)return null;const t=parseFloat(n),b=parseFloat(l);return isNaN(t)||isNaN(b)||b===0?null:t*1e5/b},Ce=async()=>{if(!D.value||!k.value){alert("Seleccione fecha de inicio y fin");return}w.value=!0;try{const n=`${ee}/seguimiento-roladas-fibra?fechaInicio=${D.value}&fechaFin=${k.value}`,l=await fetch(n);if(!l.ok)throw new Error(`Error: ${l.status}`);const t=await l.json();C.value=t.datos||[],g.value=t.totales||null;const b=`${ee}/hvi-estadisticas-mezcla?fechaInicio=${D.value}&fechaFin=${k.value}`,u=await fetch(b);if(u.ok){const x=await u.json();J.value=x.stats||{},console.log("üìä Estad√≠sticas HVI cargadas:",Object.keys(J.value).length,"mezclas")}else console.warn("‚ö†Ô∏è No se pudieron cargar estad√≠sticas HVI"),J.value={}}catch(n){console.error("Error cargando datos:",n),alert("Error al cargar datos: "+n.message)}finally{w.value=!1}},P=Q(()=>{var n;return(n=M.value)!=null&&n.seqs?[...M.value.seqs].sort((l,t)=>{const b=parseInt(l.SEQ)||0,u=parseInt(t.SEQ)||0;return b-u}):[]}),ce=n=>n?String(n).replace(/^0+/,"")||"0":"",Fe=n=>{if(!n)return"-";const l=n.split("/");if(l.length===3){const t=l[0].padStart(2,"0"),b=l[1].padStart(2,"0"),u=l[2].slice(-2);return`${t}/${b}/${u}`}return n},re=async n=>{if(n)try{const l=`${ee}/calidad-fibra-mistura?mistura=${n}`,t=await fetch(l);if(!t.ok)throw new Error(`Error: ${t.status}`);const b=await t.json();M.value=b,console.log("üî¨ Datos de MISTURA cargados:",n,b)}catch(l){console.error("Error cargando datos de mistura:",l),alert("Error al cargar datos de mistura: "+l.message),M.value=null}},Ie=async(n,l=null)=>{if(!n){console.warn("‚ö†Ô∏è No se puede abrir modal: mistura vac√≠a");return}const t=String(n).split(",")[0].trim();console.log("üîç Abriendo modal para MISTURA:",t),console.log("üìã Lista de misturas disponibles:",L.value),console.log("üì¶ LOTE_FIAC:",l);const b=L.value.indexOf(t);if(b===-1){console.warn("‚ö†Ô∏è MISTURA no encontrada en lista:",t);return}y.value=b,E.value=t,W.value=l,K.value=!0,console.log("‚úÖ Modal abierto, cargando datos..."),await re(t)},Se=async()=>{y.value>0&&(y.value--,E.value=L.value[y.value],await re(E.value))},we=async()=>{y.value<L.value.length-1&&(y.value++,E.value=L.value[y.value],await re(E.value))},ve=()=>{K.value=!1,E.value=null,W.value=null,M.value=null},Te=(n,l)=>{N.value=n;const t=l.target.getBoundingClientRect(),b=760,u=240,x=window.innerWidth,v=window.innerHeight;let T=t.right+10;T+b>x&&(T=t.left-b-10,T<0&&(T=(x-b)/2));let R=t.top;R+u>v&&(R=v-u-10,R<10&&(R=10)),Y.value={x:T,y:R}},Re=()=>{N.value=null},A=Q(()=>{var b;if(!N.value||!((b=M.value)!=null&&b.seqs))return[];const n=N.value,l=n==="+b"?"PLUS_B":n;return P.value.map(u=>{const x=parseFloat(u[l]),v=Math.round(x*100)/100;return{seq:ce(u.SEQ),valor:v}}).filter(u=>!isNaN(u.valor)&&u.valor!==null&&u.valor!==void 0)}),h=Q(()=>{if(A.value.length===0)return{min:0,max:100};const n=A.value.map(u=>u.valor),l=Math.min(...n),t=Math.max(...n);let b=t-l;if(b===0){const u=l!==0?Math.abs(l)*.1:1;return{min:l-u,max:t+u}}return{min:l-b*.1,max:t+b*.1}}),ue=Q(()=>{var t;if(!N.value||!((t=M.value)!=null&&t.totales))return null;const n=N.value,l=n==="+b"?"PLUS_B":n;return M.value.totales[l]}),Ee=async()=>{if(C.value.length!==0){w.value=!0;try{await new Promise(r=>setTimeout(r,100));const n=new Pe.Workbook,l=n.addWorksheet("Roladas + Fibra HVI");l.pageSetup={paperSize:9,orientation:"landscape",fitToPage:!0,fitToWidth:1,fitToHeight:0,margins:{left:.1968,right:.1968,top:.3937,bottom:.3937,header:.1968,footer:.1968}},l.addRow(["Rolada","URDIDORA","","","√çNDIGO","","","","","","","","TEJEDUR√çA","","","","CALIDAD","","","FIBRA HVI","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]);const t=C.value.length,b=6,u=b+t-1,x={4:"D",8:"H",9:"I",10:"J",11:"K",12:"L",13:"M",14:"N",15:"O",16:"P",17:"Q",18:"R",19:"S",22:"V",26:"Z",30:"AD",34:"AH",38:"AL",42:"AP",46:"AT",50:"AX",54:"BB",58:"BF",62:"BJ",66:"BN",70:"BR",74:"BV"},v={23:"W",27:"AA",31:"AE",35:"AI",39:"AM",43:"AQ",47:"AU",51:"AY",55:"BC",59:"BG",63:"BK",67:"BO",71:"BS",75:"BW"},T={24:"X",28:"AB",32:"AF",36:"AJ",40:"AN",44:"AR",48:"AV",52:"AZ",56:"BD",60:"BH",64:"BL",68:"BP",72:"BT",76:"BX"},R={25:"Y",29:"AC",33:"AG",37:"AK",41:"AO",45:"AS",49:"AW",53:"BA",57:"BE",61:"BI",65:"BM",69:"BQ",73:"BU",77:"BY"},le={78:"BZ",79:"CA",80:"CB",81:"CC",82:"CD"},oe=[10,11,12],F=l.addRow([]);F.height=18,F.font={bold:!0,size:9,color:{argb:"FFDC2626"}},F.alignment={vertical:"middle",horizontal:"center"},F.getCell(1).value="MAX",F.getCell(1).font={bold:!0,size:9,color:{argb:"FFDC2626"}};for(const[r,c]of Object.entries(x)){const o=F.getCell(parseInt(r));o.value={formula:`SUBTOTAL(104,${c}${b}:${c}${u})`},[8,13,17].includes(parseInt(r))?o.numFmt="#,##0":o.numFmt=oe.includes(parseInt(r))?"0.0":"0.00"}for(const[r,c]of Object.entries(v)){const o=F.getCell(parseInt(r));o.value={formula:`SUBTOTAL(104,${c}${b}:${c}${u})`},o.numFmt="0"}for(const[r,c]of Object.entries(T)){const o=F.getCell(parseInt(r));o.value={formula:`SUBTOTAL(104,${c}${b}:${c}${u})`},o.numFmt="0"}for(const[r,c]of Object.entries(R)){const o=F.getCell(parseInt(r));o.value={formula:`SUBTOTAL(104,${c}${b}:${c}${u})`},o.numFmt="0.00"}for(const[r,c]of Object.entries(le)){const o=F.getCell(parseInt(r));o.value={formula:`IFERROR(SUBTOTAL(104,${c}${b}:${c}${u}),"")`},o.numFmt="0.0"}const I=l.addRow([]);I.height=18,I.font={bold:!0,size:9,color:{argb:"FF1E40AF"}},I.alignment={vertical:"middle",horizontal:"center"},I.getCell(1).value="PROM",I.getCell(1).font={bold:!0,size:9,color:{argb:"FF1E40AF"}};for(const[r,c]of Object.entries(x)){const o=I.getCell(parseInt(r)),a=[8,13,17].includes(parseInt(r))?109:101;o.value={formula:`SUBTOTAL(${a},${c}${b}:${c}${u})`},[8,13,17].includes(parseInt(r))?o.numFmt="#,##0":o.numFmt=oe.includes(parseInt(r))?"0.0":"0.00"}for(const[r,c]of Object.entries(v)){const o=I.getCell(parseInt(r));o.value={formula:`SUBTOTAL(101,${c}${b}:${c}${u})`},o.numFmt="0.00"}for(const[r,c]of Object.entries(T)){const o=I.getCell(parseInt(r));o.value={formula:`SUBTOTAL(101,${c}${b}:${c}${u})`},o.numFmt=parseInt(r)===24?"0.0":"0.00"}for(const[r,c]of Object.entries(R)){const o=I.getCell(parseInt(r));o.value={formula:`SUBTOTAL(101,${c}${b}:${c}${u})`},o.numFmt="0.00"}for(const[r,c]of Object.entries(le)){const o=I.getCell(parseInt(r));o.value={formula:`IFERROR(SUBTOTAL(101,${c}${b}:${c}${u}),"")`},o.numFmt="0.0"}const S=l.addRow([]);S.height=18,S.font={bold:!0,size:9,color:{argb:"FF059669"}},S.alignment={vertical:"middle",horizontal:"center"},S.getCell(1).value="MIN",S.getCell(1).font={bold:!0,size:9,color:{argb:"FF059669"}};for(const[r,c]of Object.entries(x)){const o=S.getCell(parseInt(r));o.value={formula:`SUBTOTAL(105,${c}${b}:${c}${u})`},[8,13,17].includes(parseInt(r))?o.numFmt="#,##0":o.numFmt=oe.includes(parseInt(r))?"0.0":"0.00"}for(const[r,c]of Object.entries(v)){const o=S.getCell(parseInt(r));o.value={formula:`SUBTOTAL(105,${c}${b}:${c}${u})`},o.numFmt="0"}for(const[r,c]of Object.entries(T)){const o=S.getCell(parseInt(r));o.value={formula:`SUBTOTAL(105,${c}${b}:${c}${u})`},o.numFmt="0"}for(const[r,c]of Object.entries(R)){const o=S.getCell(parseInt(r));o.value={formula:`SUBTOTAL(105,${c}${b}:${c}${u})`},o.numFmt="0.00"}for(const[r,c]of Object.entries(le)){const o=S.getCell(parseInt(r));o.value={formula:`IFERROR(SUBTOTAL(105,${c}${b}:${c}${u}),"")`},o.numFmt="0.0"}l.addRow(["","Maq. OE","Lote","Rot 10‚Å∂","Fecha","Base","Color","Metros","R10¬≥","Cav 10‚Åµ","Vel.Nom","Vel.Prom","Metros","Efic.%","RU10‚Åµ","RT10‚Åµ","Metros","Cal.%","Pts/100m¬≤","Mezcla","F.Ingreso","SCI","MIN","MAX","œÉ","MST","MIN","MAX","œÉ","MIC","MIN","MAX","œÉ","MAT","MIN","MAX","œÉ","UHML","MIN","MAX","œÉ","UI","MIN","MAX","œÉ","SF","MIN","MAX","œÉ","STR","MIN","MAX","œÉ","ELG","MIN","MAX","œÉ","RD","MIN","MAX","œÉ","+b","MIN","MAX","œÉ","TrCNT","MIN","MAX","œÉ","TrAR","MIN","MAX","œÉ","TRID","MIN","MAX","œÉ","BCO%","GRI%","LG%","AMA%","LA%"]),l.mergeCells("B1:D1"),l.mergeCells("E1:L1"),l.mergeCells("M1:P1"),l.mergeCells("Q1:S1"),l.mergeCells("T1:CD1");const B=[1,4,12,16,19,82],V=[21,25,29,33,37,41,45,49,53,57,61,65,69,73,77],_=l.getRow(1);_.height=20,_.font={bold:!0,size:10},_.alignment={vertical:"middle",horizontal:"center"},_.getCell(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF1F5F9"}},_.getCell(1).value="Rolada",_.getCell(2).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFDCFCE7"}},_.getCell(2).value="URDIDORA",_.getCell(5).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFDBEAFE"}},_.getCell(5).value="√çNDIGO",_.getCell(13).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF3E8FF"}},_.getCell(13).value="TEJEDUR√çA",_.getCell(17).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFEF3C7"}},_.getCell(17).value="CALIDAD",_.getCell(20).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFEF9C3"}},_.getCell(20).value="FIBRA HVI";for(let r=1;r<=82;r++){const c=_.getCell(r);let o={style:"thin",color:{argb:"FFE2E8F0"}};B.includes(r)?o={style:"medium",color:{argb:"FF64748B"}}:V.includes(r)&&(o={style:"medium",color:{argb:"FFD4A574"}}),c.border={right:o,bottom:{style:"thin",color:{argb:"FFCBD5E1"}}}}const Ne=l.getRow(2);for(let r=1;r<=82;r++){const c=Ne.getCell(r);c.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFECACA"}};let o={style:"thin",color:{argb:"FFE2E8F0"}};B.includes(r)?o={style:"medium",color:{argb:"FF64748B"}}:V.includes(r)&&(o={style:"medium",color:{argb:"FFD4A574"}}),c.border={right:o,bottom:{style:"thin",color:{argb:"FFFCA5A5"}}}}const Le=l.getRow(3);for(let r=1;r<=82;r++){const c=Le.getCell(r);c.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFDBEAFE"}};let o={style:"thin",color:{argb:"FFE2E8F0"}};B.includes(r)?o={style:"medium",color:{argb:"FF64748B"}}:V.includes(r)&&(o={style:"medium",color:{argb:"FFD4A574"}}),c.border={right:o,bottom:{style:"thin",color:{argb:"FF93C5FD"}}}}const De=l.getRow(4);for(let r=1;r<=82;r++){const c=De.getCell(r);c.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFD1FAE5"}};let o={style:"thin",color:{argb:"FFE2E8F0"}};B.includes(r)?o={style:"medium",color:{argb:"FF64748B"}}:V.includes(r)&&(o={style:"medium",color:{argb:"FFD4A574"}}),c.border={right:o,bottom:{style:"thin",color:{argb:"FF6EE7B7"}}}}const Z=l.getRow(5);Z.height=30,Z.font={bold:!1,size:9},Z.alignment={vertical:"top",horizontal:"center",wrapText:!0};for(let r=1;r<=82;r++){const c=Z.getCell(r);r>=20&&r<=82?c.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFBEB"}}:c.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF8FAFC"}};let o={style:"thin",color:{argb:"FFE2E8F0"}};B.includes(r)?o={style:"medium",color:{argb:"FF64748B"}}:V.includes(r)&&(o={style:"medium",color:{argb:"FFD4A574"}}),c.border={right:o,bottom:{style:"medium",color:{argb:"FF94A3B8"}}}}l.columns=[{key:"ROLADA",width:7},{key:"MAQ_OE",width:10},{key:"LOTE",width:10},{key:"ROT_106",width:8},{key:"FECHA",width:10},{key:"BASE",width:12},{key:"COLOR",width:7},{key:"MTS_IND",width:9},{key:"R103",width:7},{key:"CAV",width:4},{key:"VEL_NOM",width:7},{key:"VEL_PROM",width:7},{key:"MTS_CRUDOS",width:9},{key:"EFI_TEJ",width:7},{key:"RU105",width:8},{key:"RT105",width:8},{key:"MTS_CAL",width:9},{key:"CAL_PERCENT",width:7},{key:"PTS_100M2",width:8},{key:"MEZCLA",width:28},{key:"F_INGRESO",width:10},{key:"SCI",width:6},{key:"SCI_MIN",width:5},{key:"SCI_MAX",width:5},{key:"SCI_DESV",width:5},{key:"MST",width:6},{key:"MST_MIN",width:5},{key:"MST_MAX",width:5},{key:"MST_DESV",width:5},{key:"MIC",width:6},{key:"MIC_MIN",width:5},{key:"MIC_MAX",width:5},{key:"MIC_DESV",width:5},{key:"MAT",width:6},{key:"MAT_MIN",width:5},{key:"MAT_MAX",width:5},{key:"MAT_DESV",width:5},{key:"UHML",width:7},{key:"UHML_MIN",width:5},{key:"UHML_MAX",width:5},{key:"UHML_DESV",width:5},{key:"UI",width:6},{key:"UI_MIN",width:5},{key:"UI_MAX",width:5},{key:"UI_DESV",width:5},{key:"SF",width:6},{key:"SF_MIN",width:5},{key:"SF_MAX",width:5},{key:"SF_DESV",width:5},{key:"STR",width:6},{key:"STR_MIN",width:5},{key:"STR_MAX",width:5},{key:"STR_DESV",width:5},{key:"ELG",width:6},{key:"ELG_MIN",width:5},{key:"ELG_MAX",width:5},{key:"ELG_DESV",width:5},{key:"RD",width:6},{key:"RD_MIN",width:5},{key:"RD_MAX",width:5},{key:"RD_DESV",width:5},{key:"PLUS_B",width:6},{key:"PLUS_B_MIN",width:5},{key:"PLUS_B_MAX",width:5},{key:"PLUS_B_DESV",width:5},{key:"TrCNT",width:6},{key:"TrCNT_MIN",width:5},{key:"TrCNT_MAX",width:5},{key:"TrCNT_DESV",width:5},{key:"TrAR",width:6},{key:"TrAR_MIN",width:5},{key:"TrAR_MAX",width:5},{key:"TrAR_DESV",width:5},{key:"TRID",width:6},{key:"TRID_MIN",width:5},{key:"TRID_MAX",width:5},{key:"TRID_DESV",width:5},{key:"BCO",width:6},{key:"GRI",width:6},{key:"LG",width:6},{key:"AMA",width:6},{key:"LA",width:6}];const Nl=(r,c,o)=>{var H,q;if(!r)return"";const a=String(r).split(",").map(z=>z.trim());for(const z of a){const m=(q=(H=J.value[z])==null?void 0:H[c])==null?void 0:q[o];if(m!=null)return m}return""};C.value.forEach(r=>{let c=null;if(r.FECHA){const m=r.FECHA.split("/");m.length===3&&(c=new Date(parseInt(m[2]),parseInt(m[1])-1,parseInt(m[0])))}const o=m=>{if(m==null||m==="")return null;const X=parseFloat(m);return isNaN(X)?null:X},a=l.addRow({ROLADA:o(r.ROLADA),MAQ_OE:r.MAQ_OE||"",LOTE:r.LOTE||"",ROT_106:Me(r.URDIDORA_ROTURAS,r.URDIDORA_METROS,r.NUM_FIOS),FECHA:c||"",BASE:r.BASE||"",COLOR:r.COLOR||"",MTS_IND:o(r.MTS_IND),R103:o(r.R103),CAV:Ae(r.CAV,r.MTS_IND),VEL_NOM:o(r.VEL_NOM),VEL_PROM:o(r.VEL_PROM),MTS_CRUDOS:o(r.MTS_CRUDOS),EFI_TEJ:o(r.EFI_TEJ),RU105:o(r.RU105),RT105:o(r.RT105),MTS_CAL:o(r.MTS_CAL),CAL_PERCENT:o(r.CAL_PERCENT),PTS_100M2:o(r.PTS_100M2),MEZCLA:r.MISTURA||"",F_INGRESO:r.FECHA_INGRESO||"",SCI:o(r.SCI),SCI_MIN:o(r.SCI_MIN),SCI_MAX:o(r.SCI_MAX),SCI_DESV:o(r.SCI_SIGMA),MST:o(r.MST),MST_MIN:o(r.MST_MIN),MST_MAX:o(r.MST_MAX),MST_DESV:o(r.MST_SIGMA),MIC:o(r.MIC),MIC_MIN:o(r.MIC_MIN),MIC_MAX:o(r.MIC_MAX),MIC_DESV:o(r.MIC_SIGMA),MAT:o(r.MAT),MAT_MIN:o(r.MAT_MIN),MAT_MAX:o(r.MAT_MAX),MAT_DESV:o(r.MAT_SIGMA),UHML:o(r.UHML),UHML_MIN:o(r.UHML_MIN),UHML_MAX:o(r.UHML_MAX),UHML_DESV:o(r.UHML_SIGMA),UI:o(r.UI),UI_MIN:o(r.UI_MIN),UI_MAX:o(r.UI_MAX),UI_DESV:o(r.UI_SIGMA),SF:o(r.SF),SF_MIN:o(r.SF_MIN),SF_MAX:o(r.SF_MAX),SF_DESV:o(r.SF_SIGMA),STR:o(r.STR),STR_MIN:o(r.STR_MIN),STR_MAX:o(r.STR_MAX),STR_DESV:o(r.STR_SIGMA),ELG:o(r.ELG),ELG_MIN:o(r.ELG_MIN),ELG_MAX:o(r.ELG_MAX),ELG_DESV:o(r.ELG_SIGMA),RD:o(r.RD),RD_MIN:o(r.RD_MIN),RD_MAX:o(r.RD_MAX),RD_DESV:o(r.RD_SIGMA),PLUS_B:o(r.PLUS_B),PLUS_B_MIN:o(r.PLUS_B_MIN),PLUS_B_MAX:o(r.PLUS_B_MAX),PLUS_B_DESV:o(r.PLUS_B_SIGMA),TrCNT:o(r.TrCNT),TrCNT_MIN:o(r.TrCNT_MIN),TrCNT_MAX:o(r.TrCNT_MAX),TrCNT_DESV:o(r.TrCNT_SIGMA),TrAR:o(r.TrAR),TrAR_MIN:o(r.TrAR_MIN),TrAR_MAX:o(r.TrAR_MAX),TrAR_DESV:o(r.TrAR_SIGMA),TRID:o(r.TRID),TRID_MIN:o(r.TRID_MIN),TRID_MAX:o(r.TRID_MAX),TRID_DESV:o(r.TRID_SIGMA),BCO:o(r.COLOR_BCO_PCT),GRI:o(r.COLOR_GRI_PCT),LG:o(r.COLOR_LG_PCT),AMA:o(r.COLOR_AMA_PCT),LA:o(r.COLOR_LA_PCT)});a.height=16,a.alignment={vertical:"middle",horizontal:"center"},a.font={size:9};const H=a.number,q=H%2===1?"FFFFFFFF":"FFF8FAFC",z=H%2===1?"FFFFFEF8":"FFFFFBEB";for(let m=1;m<=82;m++){const X=a.getCell(m);m>=20?X.fill={type:"pattern",pattern:"solid",fgColor:{argb:z}}:X.fill={type:"pattern",pattern:"solid",fgColor:{argb:q}};let ae={style:"thin",color:{argb:"FFE2E8F0"}};B.includes(m)?ae={style:"medium",color:{argb:"FF64748B"}}:V.includes(m)&&(ae={style:"medium",color:{argb:"FFD4A574"}}),X.border={right:ae,bottom:{style:"thin",color:{argb:"FFE2E8F0"}}}}a.getCell(1).font={bold:!0,size:9},a.getCell("FECHA").numFmt="dd/mm/yyyy",a.getCell("ROLADA").numFmt="0",a.getCell("MTS_IND").numFmt="#,##0",a.getCell("R103").numFmt="#,##0.00",a.getCell("CAV").numFmt="#,##0.0",a.getCell("VEL_NOM").numFmt="#,##0",a.getCell("VEL_PROM").numFmt="#,##0.0",a.getCell("MTS_CRUDOS").numFmt="#,##0",a.getCell("EFI_TEJ").numFmt="#,##0.0",a.getCell("RU105").numFmt="#,##0.00",a.getCell("RT105").numFmt="#,##0.00",a.getCell("MTS_CAL").numFmt="#,##0",a.getCell("CAL_PERCENT").numFmt="#,##0.0",a.getCell("PTS_100M2").numFmt="#,##0.0",a.getCell("ROT_106").numFmt="0.00",a.getCell("SCI").numFmt="0.0",a.getCell("SCI_MIN").numFmt="0",a.getCell("SCI_MAX").numFmt="0",a.getCell("SCI_DESV").numFmt="0.00",a.getCell("MST").numFmt="0.0",a.getCell("MST_MIN").numFmt="0.0",a.getCell("MST_MAX").numFmt="0.0",a.getCell("MST_DESV").numFmt="0.00",a.getCell("MIC").numFmt="0.00",a.getCell("MIC_MIN").numFmt="0.00",a.getCell("MIC_MAX").numFmt="0.00",a.getCell("MIC_DESV").numFmt="0.00",a.getCell("MAT").numFmt="0.00",a.getCell("MAT_MIN").numFmt="0.00",a.getCell("MAT_MAX").numFmt="0.00",a.getCell("MAT_DESV").numFmt="0.00",a.getCell("UHML").numFmt="0.00",a.getCell("UHML_MIN").numFmt="0.00",a.getCell("UHML_MAX").numFmt="0.00",a.getCell("UHML_DESV").numFmt="0.00",a.getCell("UI").numFmt="0.0",a.getCell("UI_MIN").numFmt="0.0",a.getCell("UI_MAX").numFmt="0.0",a.getCell("UI_DESV").numFmt="0.00",a.getCell("SF").numFmt="0.0",a.getCell("SF_MIN").numFmt="0.0",a.getCell("SF_MAX").numFmt="0.0",a.getCell("SF_DESV").numFmt="0.00",a.getCell("STR").numFmt="0.0",a.getCell("STR_MIN").numFmt="0.0",a.getCell("STR_MAX").numFmt="0.0",a.getCell("STR_DESV").numFmt="0.00",a.getCell("ELG").numFmt="0.0",a.getCell("ELG_MIN").numFmt="0.0",a.getCell("ELG_MAX").numFmt="0.0",a.getCell("ELG_DESV").numFmt="0.00",a.getCell("RD").numFmt="0.0",a.getCell("RD_MIN").numFmt="0.0",a.getCell("RD_MAX").numFmt="0.0",a.getCell("RD_DESV").numFmt="0.00",a.getCell("PLUS_B").numFmt="0.0",a.getCell("PLUS_B_MIN").numFmt="0.0",a.getCell("PLUS_B_MAX").numFmt="0.0",a.getCell("PLUS_B_DESV").numFmt="0.00",a.getCell("TrCNT").numFmt="0",a.getCell("TrCNT_MIN").numFmt="0",a.getCell("TrCNT_MAX").numFmt="0",a.getCell("TrCNT_DESV").numFmt="0.00",a.getCell("TrAR").numFmt="0.00",a.getCell("TrAR_MIN").numFmt="0.00",a.getCell("TrAR_MAX").numFmt="0.00",a.getCell("TrAR_DESV").numFmt="0.00",a.getCell("TRID").numFmt="0",a.getCell("TRID_MIN").numFmt="0",a.getCell("TRID_MAX").numFmt="0",a.getCell("TRID_DESV").numFmt="0.00",a.getCell("BCO").numFmt="0.0",a.getCell("GRI").numFmt="0.0",a.getCell("LG").numFmt="0.0",a.getCell("AMA").numFmt="0.0",a.getCell("LA").numFmt="0.0",a.getCell("ROT_106").font={size:9,color:{argb:"FF059669"},bold:!0},a.getCell("R103").font={size:9,color:{argb:"FF2563EB"},bold:!0},a.getCell("EFI_TEJ").font={size:9,color:{argb:"FF7C3AED"},bold:!0},a.getCell("CAL_PERCENT").font={size:9,color:{argb:"FFB45309"},bold:!0},a.getCell("SCI").font={size:9,color:{argb:"FF0369A1"},bold:!0},a.getCell("MEZCLA").font={size:9,color:{argb:"FFB45309"},bold:!0}});const ke=l.rowCount;l.autoFilter={from:{row:5,column:1},to:{row:ke,column:82}},l.views=[{state:"frozen",xSplit:1,ySplit:5,topLeftCell:"B6",activeCell:"B6"}];const Oe=await n.xlsx.writeBuffer(),Ue=new Blob([Oe],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),ie=window.URL.createObjectURL(Ue),se=document.createElement("a");se.href=ie;const Be=new Date().toTimeString().slice(0,8).replace(/:/g,"");se.download=`Roladas_Fibra_HVI_${D.value}_${k.value}_${Be}.xlsx`,se.click(),window.URL.revokeObjectURL(ie)}catch(n){console.error("Error exportando a Excel:",n),alert("Error al exportar: "+n.message)}finally{w.value=!1}}};return Xe(()=>{const n=new Date,l=new Date;l.setDate(n.getDate()-30),k.value=n.toISOString().split("T")[0],D.value=l.toISOString().split("T")[0]}),(n,l)=>(i(),p("div",He,[w.value?(i(),p("div",ze,[...l[2]||(l[2]=[pe('<div class="flex flex-col items-center gap-4 bg-white/90 px-10 py-8 rounded-2xl shadow-2xl border border-blue-100" data-v-ce2e83f2><div class="relative" data-v-ce2e83f2><div class="animate-spin rounded-full h-16 w-16 border-4 border-blue-50 border-t-blue-600" data-v-ce2e83f2></div><div class="absolute inset-0 flex items-center justify-center" data-v-ce2e83f2><div class="h-8 w-8 bg-blue-600 rounded-full animate-pulse opacity-10" data-v-ce2e83f2></div></div></div><div class="flex flex-col items-center gap-1" data-v-ce2e83f2><span class="text-slate-500 font-medium tracking-wider uppercase text-[10px]" data-v-ce2e83f2>Cargando</span><span class="text-xl text-slate-800 font-bold" data-v-ce2e83f2>Roladas + Fibra HVI</span></div></div>',1)])])):$("",!0),e("main",{ref_key:"mainContentRef",ref:_e,class:"w-full flex-1 min-h-0 bg-white rounded-xl shadow-sm px-4 py-3 border border-slate-200/60 flex flex-col relative"},[e("div",je,[e("div",Qe,[l[4]||(l[4]=e("img",{src:Ge,alt:"Santana Textiles",class:"h-9 w-auto object-contain opacity-90"},null,-1)),l[5]||(l[5]=e("div",null,[e("h3",{class:"text-base font-semibold text-slate-800 tracking-tight"},"Seguimiento de Roladas + Fibra HVI"),e("p",{class:"text-xs text-slate-400 mt-0.5"},"Producci√≥n √çNDIGO con An√°lisis de Calidad de Fibra")],-1)),e("div",Je,[l[3]||(l[3]=e("span",{class:"text-xs text-slate-500"},"Registros:",-1)),e("span",We,s(C.value.length),1)])]),e("div",Ze,[e("div",qe,[l[6]||(l[6]=e("label",{for:"fecha-inicio",class:"text-xs font-medium text-slate-500"},"Desde:",-1)),xe(e("input",{type:"date",id:"fecha-inicio","onUpdate:modelValue":l[0]||(l[0]=t=>D.value=t),class:"px-2.5 py-1.5 border border-slate-200 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-blue-500 text-sm bg-white text-slate-700"},null,512),[[me,D.value]])]),e("div",Ke,[l[7]||(l[7]=e("label",{for:"fecha-fin",class:"text-xs font-medium text-slate-500"},"Hasta:",-1)),xe(e("input",{type:"date",id:"fecha-fin","onUpdate:modelValue":l[1]||(l[1]=t=>k.value=t),class:"px-2.5 py-1.5 border border-slate-200 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-blue-500 text-sm bg-white text-slate-700"},null,512),[[me,k.value]])]),e("button",{onClick:Ce,disabled:w.value,class:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white text-sm font-medium rounded-md transition-colors"},[w.value?(i(),p("svg",tt,[...l[9]||(l[9]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(i(),p("svg",et,[...l[8]||(l[8]=[e("circle",{cx:"11",cy:"11",r:"8"},null,-1),e("path",{d:"m21 21-4.35-4.35"},null,-1)])])),e("span",null,s(w.value?"Cargando...":"Buscar"),1)],8,Ye),e("button",{onClick:Ee,disabled:C.value.length===0,class:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-green-600 hover:bg-green-700 disabled:bg-slate-400 text-white text-sm font-medium rounded-md transition-colors"},[...l[10]||(l[10]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M12.9,14.5L15.8,19H14L12,15.6L10,19H8.2L11.1,14.5L8.2,10H10L12,13.4L14,10H15.8L12.9,14.5Z"})],-1),e("span",null,"Excel",-1)])],8,rt)])]),e("div",{class:"overflow-auto relative bg-white rounded-lg shadow-sm border border-slate-300 flex-1",ref_key:"tablaRef",ref:fe},[e("table",{ref_key:"tableElementRef",ref:he,class:"w-full text-[11px] text-slate-700 border-separate border-spacing-0"},[l[16]||(l[16]=e("thead",{class:"sticky top-0 z-20"},[e("tr",{class:"text-slate-500 text-[10px] uppercase tracking-wider"},[e("th",{scope:"col",rowspan:"3",class:"px-2 py-2 font-semibold text-center border-r-2 border-slate-300 border-b-2 border-b-slate-300 text-slate-700 bg-slate-50 sticky left-0 z-30 min-w-13.75"},"Rolada"),e("th",{scope:"col",colspan:"3",class:"px-2 py-1.5 font-semibold text-center border-r-2 border-slate-300 border-b border-b-slate-300 text-slate-700 bg-slate-50"},"Urdidora"),e("th",{scope:"col",colspan:"8",class:"px-2 py-1.5 font-semibold text-center border-r-2 border-slate-300 border-b border-b-slate-300 text-slate-700 bg-slate-50"},"√çndigo"),e("th",{scope:"col",colspan:"4",class:"px-2 py-1.5 font-semibold text-center border-r-2 border-slate-300 border-b border-b-slate-300 text-slate-700 bg-slate-50"},"Tejedur√≠a"),e("th",{scope:"col",colspan:"3",class:"px-2 py-1.5 font-semibold text-center border-r-2 border-slate-300 border-b border-b-slate-300 text-slate-700 bg-slate-50"},"Calidad"),e("th",{scope:"col",colspan:"63",class:"px-2 py-1.5 font-semibold text-center border-b border-b-slate-300 text-slate-700 bg-amber-50"},"Fibra HVI")]),e("tr",{class:"text-slate-600 text-[10px] bg-slate-50"},[e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-10"},"Maq"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-8.75"},"Lote"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r-2 border-slate-300 border-b-2 border-b-slate-300 min-w-10"},"R10‚Å∂"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-17.5"},"Fecha"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-18.75"},"Base"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-8.75"},"Color"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-12.5"},"Metros"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-8.75"},"R10¬≥"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-7.5"},[e("span",{class:"block leading-tight"},[j("Cav"),e("br"),j("10‚Åµ")])]),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-8.75"},"VNom"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r-2 border-slate-300 border-b-2 border-b-slate-300 min-w-8.75"},"VPro"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-12.5"},"Metros"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-10"},"Efi%"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-10"},"RU10‚Åµ"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r-2 border-slate-300 border-b-2 border-b-slate-300 min-w-10"},"RT10‚Åµ"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-12.5"},"Metros"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-10"},"Cal%"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r-2 border-slate-300 border-b-2 border-b-slate-300 min-w-12.5"},"Pts100"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-10 bg-amber-50"},"Mezc"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-17.5 bg-amber-50"},"F.Ingr"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-r-slate-200 border-b border-b-slate-300 bg-blue-50",title:"√çndice de Color"},"SCI"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-r-slate-200 border-b border-b-slate-300 bg-blue-50",title:"Humedad"},"MST"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-r-slate-200 border-b border-b-slate-300 bg-blue-50",title:"Micronaire"},"MIC"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-r-slate-200 border-b border-b-slate-300 bg-blue-50",title:"Madurez"},"MAT"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-r-slate-200 border-b border-b-slate-300 bg-green-50",title:"Longitud media"},"UHML"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-r-slate-200 border-b border-b-slate-300 bg-green-50",title:"Uniformidad"},"UI"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-r-slate-200 border-b border-b-slate-300 bg-green-50",title:"Fibras cortas"},"SF"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-r-slate-200 border-b border-b-slate-300 bg-yellow-50",title:"Resistencia"},"STR"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-r-slate-200 border-b border-b-slate-300 bg-yellow-50",title:"Elongaci√≥n"},"ELG"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-r-slate-200 border-b border-b-slate-300 bg-yellow-50",title:"Reflectancia"},"RD"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-r-slate-200 border-b border-b-slate-300 bg-yellow-50",title:"Amarillez"},"+b"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-r-slate-200 border-b border-b-slate-300 bg-purple-50"},"TrCNT"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r border-r-slate-200 border-b border-b-slate-300 bg-purple-50"},"TrAR"),e("th",{scope:"col",colspan:"4",class:"px-1 py-1.5 font-medium text-center border-r-2 border-b border-slate-300 bg-purple-50"},"TRID"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-8.75 bg-orange-50"},"BCO"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-8.75 bg-orange-50"},"GRI"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-8.75 bg-orange-50"},"LG"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-r border-slate-200 border-b-2 border-b-slate-300 min-w-8.75 bg-orange-50"},"AMA"),e("th",{scope:"col",rowspan:"2",class:"px-1 py-1.5 font-medium text-center border-b-2 border-b-slate-300 min-w-8.75 bg-orange-50"},"LA")]),e("tr",{class:"text-slate-600 text-[9px] bg-slate-50"},[e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-blue-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-green-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-green-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-green-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-green-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-green-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-green-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-green-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-green-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-green-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-green-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-green-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-green-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-yellow-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-purple-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-purple-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-purple-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-purple-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-purple-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-purple-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-purple-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-purple-50/50"},"œÉ"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-purple-50/50"},"Avg"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-purple-50/50"},"Min"),e("th",{class:"px-1 py-1 font-normal text-center border-r border-slate-200 border-b-2 border-b-slate-300 bg-purple-50/50"},"Max"),e("th",{class:"px-1 py-1 font-normal text-center border-r-2 border-slate-300 border-b-2 border-b-slate-300 bg-purple-50/50"},"œÉ")])],-1)),e("tbody",null,[(i(!0),p(O,null,U(C.value,(t,b)=>(i(),p("tr",{key:t.ROLADA,class:"border-b border-slate-200 hover:bg-slate-50/80 transition-colors"},[e("td",lt,s(t.ROLADA),1),e("td",ot,s(t.MAQ_OE||"-"),1),e("td",st,s(t.LOTE||"-"),1),e("td",at,s(de(t.URDIDORA_ROTURAS,t.URDIDORA_METROS,t.NUM_FIOS)),1),e("td",nt,s(t.FECHA||"-"),1),e("td",dt,s(t.BASE||"-"),1),e("td",bt,s(t.COLOR||"-"),1),e("td",ct,s(te(t.MTS_IND)),1),e("td",ut,s(d(t.R103,2)),1),e("td",it,s(be(t.CAV,t.MTS_IND)),1),e("td",pt,s(d(t.VEL_NOM,0)),1),e("td",xt,s(d(t.VEL_PROM,0)),1),e("td",mt,s(te(t.MTS_CRUDOS)),1),e("td",gt,s(d(t.EFI_TEJ,1)),1),e("td",_t,s(d(t.RU105,1)),1),e("td",ft,s(d(t.RT105,1)),1),e("td",ht,s(te(t.MTS_CAL)),1),e("td",yt,s(d(t.CAL_PERCENT,1)),1),e("td",Mt,s(d(t.PTS_100M2,1)),1),e("td",{onClick:u=>Ie(t.MISTURA,t.LOTE),class:"px-1 py-2 text-center text-amber-700 font-semibold tabular-nums border-r border-slate-200 bg-amber-50/30 cursor-pointer hover:bg-amber-100/50 transition-colors",title:"Click para ver detalles de MISTURA "+t.MISTURA},s(t.MISTURA||"-"),9,At),e("td",Ct,s(ye(t.FECHA_INGRESO)),1),e("td",Ft,s(d(t.SCI,1)),1),e("td",It,s(d(t.SCI_MIN,1)),1),e("td",St,s(d(t.SCI_MAX,1)),1),e("td",wt,s(d(t.SCI_SIGMA,2)),1),e("td",vt,s(d(t.MST,1)),1),e("td",Tt,s(d(t.MST_MIN,1)),1),e("td",Rt,s(d(t.MST_MAX,1)),1),e("td",Et,s(d(t.MST_SIGMA,2)),1),e("td",Nt,s(d(t.MIC,2)),1),e("td",Lt,s(d(t.MIC_MIN,2)),1),e("td",Dt,s(d(t.MIC_MAX,2)),1),e("td",kt,s(d(t.MIC_SIGMA,2)),1),e("td",Ot,s(d(t.MAT,2)),1),e("td",Ut,s(d(t.MAT_MIN,2)),1),e("td",Bt,s(d(t.MAT_MAX,2)),1),e("td",Vt,s(d(t.MAT_SIGMA,2)),1),e("td",Xt,s(d(t.UHML,2)),1),e("td",$t,s(d(t.UHML_MIN,2)),1),e("td",Gt,s(d(t.UHML_MAX,2)),1),e("td",Pt,s(d(t.UHML_SIGMA,2)),1),e("td",Ht,s(d(t.UI,1)),1),e("td",zt,s(d(t.UI_MIN,1)),1),e("td",jt,s(d(t.UI_MAX,1)),1),e("td",Qt,s(d(t.UI_SIGMA,2)),1),e("td",Jt,s(d(t.SF,1)),1),e("td",Wt,s(d(t.SF_MIN,1)),1),e("td",Zt,s(d(t.SF_MAX,1)),1),e("td",qt,s(d(t.SF_SIGMA,2)),1),e("td",Kt,s(d(t.STR,1)),1),e("td",Yt,s(d(t.STR_MIN,1)),1),e("td",er,s(d(t.STR_MAX,1)),1),e("td",tr,s(d(t.STR_SIGMA,2)),1),e("td",rr,s(d(t.ELG,1)),1),e("td",lr,s(d(t.ELG_MIN,1)),1),e("td",or,s(d(t.ELG_MAX,1)),1),e("td",sr,s(d(t.ELG_SIGMA,2)),1),e("td",ar,s(d(t.RD,1)),1),e("td",nr,s(d(t.RD_MIN,1)),1),e("td",dr,s(d(t.RD_MAX,1)),1),e("td",br,s(d(t.RD_SIGMA,2)),1),e("td",cr,s(d(t.PLUS_B,1)),1),e("td",ur,s(d(t.PLUS_B_MIN,1)),1),e("td",ir,s(d(t.PLUS_B_MAX,1)),1),e("td",pr,s(d(t.PLUS_B_SIGMA,2)),1),e("td",xr,s(d(t.TrCNT,0)),1),e("td",mr,s(d(t.TrCNT_MIN,0)),1),e("td",gr,s(d(t.TrCNT_MAX,0)),1),e("td",_r,s(d(t.TrCNT_SIGMA,2)),1),e("td",fr,s(d(t.TrAR,2)),1),e("td",hr,s(d(t.TrAR_MIN,2)),1),e("td",yr,s(d(t.TrAR_MAX,2)),1),e("td",Mr,s(d(t.TrAR_SIGMA,2)),1),e("td",Ar,s(d(t.TRID,0)),1),e("td",Cr,s(d(t.TRID_MIN,0)),1),e("td",Fr,s(d(t.TRID_MAX,0)),1),e("td",Ir,s(d(t.TRID_SIGMA,2)),1),e("td",Sr,s(G(t.COLOR_BCO_PCT)),1),e("td",wr,s(G(t.COLOR_GRI_PCT)),1),e("td",vr,s(G(t.COLOR_LG_PCT)),1),e("td",Tr,s(G(t.COLOR_AMA_PCT)),1),e("td",Rr,s(G(t.COLOR_LA_PCT)),1)]))),128))]),g.value&&C.value.length>0?(i(),p("tfoot",Er,[e("tr",Nr,[e("td",Lr,[l[11]||(l[11]=e("span",{class:"text-xs uppercase tracking-wide text-slate-500"},"Total:",-1)),e("span",Dr,s(g.value.TOTAL_ROLADAS),1)]),l[12]||(l[12]=e("td",{class:"px-1 py-2.5 text-center text-slate-400 border-r border-slate-200 border-t-2 border-t-slate-300",colspan:"2"},"-",-1)),e("td",kr,s(de(g.value.URDIDORA_ROTURAS,g.value.URDIDORA_METROS,g.value.NUM_FIOS)),1),l[13]||(l[13]=e("td",{class:"px-1 py-2.5 text-center text-slate-400 border-r border-slate-200 border-t-2 border-t-slate-300",colspan:"3"},"-",-1)),e("td",Or,s(d(g.value.MTS_IND,0)),1),e("td",Ur,s(d(g.value.R103,2)),1),e("td",Br,s(be(g.value.CAV,g.value.MTS_IND)),1),l[14]||(l[14]=e("td",{class:"px-1 py-2.5 text-center tabular-nums text-slate-400 border-r border-slate-200 border-t-2 border-t-slate-300"},"-",-1)),e("td",Vr,s(d(g.value.VEL_PROM,0)),1),e("td",Xr,s(d(g.value.MTS_CRUDOS,0)),1),e("td",$r,s(d(g.value.EFI_TEJ,1)),1),e("td",Gr,s(d(g.value.RU105,1)),1),e("td",Pr,s(d(g.value.RT105,1)),1),e("td",Hr,s(d(g.value.MTS_CAL,0)),1),e("td",zr,s(d(g.value.CAL_PERCENT,1)),1),e("td",jr,s(d(g.value.PTS_100M2,1)),1),l[15]||(l[15]=e("td",{class:"px-1 py-2.5 text-center text-slate-400 border-t-2 border-t-slate-300 bg-amber-50/20",colspan:"63"},"-",-1))])])):$("",!0)],512),!w.value&&C.value.length===0?(i(),p("div",Qr,[...l[17]||(l[17]=[pe('<div class="text-center" data-v-ce2e83f2><svg class="mx-auto h-10 w-10 text-slate-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-ce2e83f2><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" data-v-ce2e83f2></path></svg><h3 class="mt-3 text-sm font-medium text-slate-700" data-v-ce2e83f2>No hay datos disponibles</h3><p class="mt-1 text-xs text-slate-400" data-v-ce2e83f2>Seleccione un rango de fechas y haga clic en Buscar</p></div>',1)])])):$("",!0)],512)],512),K.value?(i(),p("div",Jr,[e("div",Wr,[e("div",Zr,[e("div",qr,[l[19]||(l[19]=e("h3",{class:"text-lg font-semibold text-slate-800"},"Detalle de MISTURA",-1)),e("div",Kr,[e("span",Yr,s(E.value),1)]),W.value?(i(),p("div",el,[l[18]||(l[18]=e("span",{class:"text-xs text-slate-500 mr-1"},"Lote:",-1)),e("span",tl,s(W.value),1)])):$("",!0),e("div",rl,s(y.value+1)+" de "+s(L.value.length),1)]),e("div",ll,[e("button",{onClick:Se,disabled:y.value===0,class:ge(["px-3 py-1.5 rounded-lg transition-all text-sm font-medium",y.value===0?"bg-slate-100 text-slate-300 cursor-not-allowed":"bg-slate-100 hover:bg-slate-200 text-slate-700"])}," ‚óÑ Anterior ",10,ol),e("button",{onClick:we,disabled:y.value===L.value.length-1,class:ge(["px-3 py-1.5 rounded-lg transition-all text-sm font-medium",y.value===L.value.length-1?"bg-slate-100 text-slate-300 cursor-not-allowed":"bg-slate-100 hover:bg-slate-200 text-slate-700"])}," Siguiente ‚ñ∫ ",10,sl),e("button",{onClick:ve,class:"ml-2 px-3 py-1.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg transition-all text-sm font-medium"}," ‚úï Cerrar ")])]),e("div",al,[M.value?M.value&&M.value.seqs&&M.value.seqs.length>0?(i(),p("div",dl,[e("div",bl,[e("table",cl,[e("thead",null,[e("tr",ul,[l[21]||(l[21]=e("th",{class:"px-3 py-1 text-left font-semibold text-slate-700 border border-slate-300 sticky left-0 bg-slate-100 z-10"},"Variable",-1)),(i(!0),p(O,null,U(P.value,t=>(i(),p("th",{key:t.SEQ,class:"px-2 py-1 text-center font-semibold text-slate-700 border border-slate-300 min-w-10"},s(ce(t.SEQ)),1))),128))])]),e("tbody",null,[e("tr",il,[l[22]||(l[22]=e("td",{class:"px-3 py-1 font-medium text-slate-700 border border-slate-300 sticky left-0 bg-white"},"Fecha",-1)),(i(!0),p(O,null,U(P.value,t=>(i(),p("td",{key:t.SEQ,class:"px-1 py-2 border border-slate-300"},[e("div",pl,[e("div",xl,s(Fe(t.DT_ENTRADA_PROD)),1)])]))),128))]),e("tr",ml,[l[23]||(l[23]=e("td",{class:"px-3 py-1 font-medium text-slate-700 border border-slate-300 sticky left-0 bg-white"},"Hora",-1)),(i(!0),p(O,null,U(P.value,t=>(i(),p("td",{key:t.SEQ,class:"px-2 py-1 text-center border border-slate-300 text-slate-600 text-xs"},s(t.HR_ENTRADA_PROD||"-"),1))),128))]),l[24]||(l[24]=e("tr",{class:"bg-slate-50"},[e("td",{colspan:"100",class:"px-3 py-1 text-xs font-semibold text-slate-500 border border-slate-300"},"Promedios Ponderados HVI")],-1)),(i(),p(O,null,U(["SCI","MST","MIC","MAT","UHML","UI","SF","STR","ELG","RD","+b","TrCNT","TrAR","TRID"],t=>e("tr",{key:t,class:"hover:bg-slate-50"},[e("td",{class:"px-3 py-1 font-medium text-slate-700 border border-slate-300 sticky left-0 bg-white cursor-help transition-colors hover:bg-blue-50",onMouseenter:b=>Te(t,b),onMouseleave:Re},s(t),41,gl),(i(!0),p(O,null,U(P.value,b=>(i(),p("td",{key:b.SEQ,class:"px-2 py-1 text-center border border-slate-300 tabular-nums text-slate-600 text-xs"},s(b[t==="+b"?"PLUS_B":t]!==null&&b[t==="+b"?"PLUS_B":t]!==void 0?Number(b[t==="+b"?"PLUS_B":t]).toFixed(2):"-"),1))),128))])),64))])])])])):(i(),p("div",_l,[...l[25]||(l[25]=[e("div",{class:"text-center"},[e("p",{class:"text-slate-500"},"No hay datos disponibles para esta MISTURA")],-1)])])):(i(),p("div",nl,[...l[20]||(l[20]=[e("div",{class:"flex flex-col items-center gap-3"},[e("div",{class:"animate-spin rounded-full h-8 w-8 border-2 border-slate-200 border-t-slate-600"}),e("span",{class:"text-sm text-slate-500"},"Cargando datos...")],-1)])]))])])])):$("",!0),N.value&&A.value.length>0?(i(),p("div",{key:2,class:"fixed bg-white rounded-lg shadow-2xl border border-slate-300 p-4 z-60 pointer-events-none",style:$e({left:Y.value.x+"px",top:Y.value.y+"px",width:"760px"})},[e("div",fl,[e("h4",hl,s(N.value)+" - MISTURA "+s(E.value),1)]),e("div",yl,[(i(),p("svg",Ml,[l[26]||(l[26]=e("line",{x1:"30",y1:"10",x2:"30",y2:"130",stroke:"#cbd5e1","stroke-width":"1.5"},null,-1)),l[27]||(l[27]=e("line",{x1:"30",y1:"130",x2:"730",y2:"130",stroke:"#cbd5e1","stroke-width":"1.5"},null,-1)),e("text",Al,s(h.value.max.toFixed(1)),1),e("text",Cl,s(((h.value.max+h.value.min)/2).toFixed(1)),1),e("text",Fl,s(h.value.min.toFixed(1)),1),l[28]||(l[28]=e("line",{x1:"30",y1:"70",x2:"730",y2:"70",stroke:"#e2e8f0","stroke-width":"1","stroke-dasharray":"3,3"},null,-1)),e("polyline",{points:A.value.map((t,b)=>{const u=40+b*(690/(A.value.length-1||1)),x=130-(t.valor-h.value.min)/(h.value.max-h.value.min)*120;return u+","+x}).join(" "),fill:"none",stroke:"#3b82f6","stroke-width":"2.5",class:"transition-all duration-300"},null,8,Il),(i(!0),p(O,null,U(A.value,(t,b)=>(i(),p("g",{key:t.seq},[e("circle",{cx:40+b*(690/(A.value.length-1||1)),cy:130-(t.valor-h.value.min)/(h.value.max-h.value.min)*120,r:"4",fill:"#3b82f6",stroke:"white","stroke-width":"2",class:"transition-all duration-300"},null,8,Sl),e("text",{x:40+b*(690/(A.value.length-1||1)),y:"145","text-anchor":"middle",class:"text-[10px] fill-slate-600 font-medium"},s(t.seq),9,wl),e("text",{x:40+b*(690/(A.value.length-1||1)),y:130-(t.valor-h.value.min)/(h.value.max-h.value.min)*120-8,"text-anchor":"middle",class:"text-[9px] fill-slate-700 font-mono font-semibold"},s(Number(t.valor).toFixed(2)),9,vl)]))),128))]))]),e("div",Tl,[e("span",null,[l[29]||(l[29]=j("M√≠n: ",-1)),e("strong",null,s(Math.min(...A.value.map(t=>t.valor)).toFixed(2)),1)]),e("span",null,[l[30]||(l[30]=j("Prom Ponderado: ",-1)),e("strong",null,s(ue.value!==null?Number(ue.value).toFixed(2):"-"),1)]),e("span",null,[l[31]||(l[31]=j("M√°x: ",-1)),e("strong",null,s(Math.max(...A.value.map(t=>t.valor)).toFixed(2)),1)])])],4)):$("",!0)]))}},Ul=Ve(Rl,[["__scopeId","data-v-ce2e83f2"]]);export{Ul as default};
