import{p as q,m as _,D as St,o as kt,a as d,c,b as t,f as W,g as $t,h as Rt,i as F,F as Y,r as B,e as K,d as z,q as Ut,t as o,z as It,n as it}from"./index-Bb3aArA6.js";import{S as dt}from"./sweetalert2.esm.all-AlKuj1Cq.js";import{_ as Lt}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ot="http://localhost:3001/api/produccion";function Ft(){const b=_(!1),w=_(null),p=async(r,i={})=>{b.value=!0,w.value=null;try{const $=await fetch(`${Ot}${r}`,{headers:{"Content-Type":"application/json",...i.headers},...i});if(!$.ok)throw new Error(`HTTP error! status: ${$.status}`);return await $.json()}catch($){throw w.value=$.message,$}finally{b.value=!1}},V=async()=>await p("/status"),N=async(r={})=>{const i=new URLSearchParams(r).toString();return await p(`/produccion?${i}`)},m=async(r,i)=>{const $=new URLSearchParams({startDate:r,endDate:i}).toString();return await p(`/produccion/summary?${$}`)},S=async(r={})=>{const i=new URLSearchParams(r).toString();return await p(`/calidad?${i}`)},y=async(r={})=>{const i=new URLSearchParams(r).toString();return await p(`/calidad/revision-cq?${i}`)},C=async()=>await p("/calidad/available-dates"),P=async(r={})=>{const i=new URLSearchParams(r).toString();return await p(`/calidad/revisor-detalle?${i}`)},Q=async(r={})=>{const i=new URLSearchParams(r).toString();return await p(`/calidad/partida-detalle?${i}`)},O=async r=>await p(`/calidad/defectos-detalle?etiqueta=${r}`),M=async(r={})=>{const i=new URLSearchParams(r).toString();return await p(`/calidad/historico-revisores?${i}`)},k=async(r={})=>{const i=new URLSearchParams(r).toString();return await p(`/calidad/mesa-test?${i}`)},G=async(r={})=>{const i=new URLSearchParams(r).toString();return await p(`/calidad/metros-sector?${i}`)},E=async(r={})=>{const i=new URLSearchParams(r).toString();return await p(`/calidad/fibra?${i}`)},x=async(r={})=>{const i=new URLSearchParams(r).toString();return await p(`/paradas?${i}`)},H=async(r,i)=>{const $=new URLSearchParams({startDate:r,endDate:i}).toString();return await p(`/paradas/top-motivos?${$}`)},T=async(r="")=>{const i=new URLSearchParams({search:r}).toString();return await p(`/fichas?${i}`)},A=async r=>await p(`/fichas/${r}`),Z=async(r={})=>{const i=new URLSearchParams(r).toString();return await p(`/testes?${i}`)},tt=async()=>await p("/residuos/indigo"),ut=async()=>await p("/residuos/sector"),pt=async()=>await p("/costos/items"),et=async(r=24)=>{const i=new URLSearchParams({limite:String(r)}).toString();return await p(`/costos/mensual?${i}`)},xt=async r=>await p("/costos/mensual",{method:"PUT",body:JSON.stringify({rows:r})});return{loading:q(()=>b.value),error:q(()=>w.value),getStatus:V,getProduccion:N,getProduccionSummary:m,getCalidad:S,getRevisionCQ:y,getAvailableDates:C,getRevisorDetalle:P,getPartidaDetalle:Q,getDefectosDetalle:O,getHistoricoRevisores:M,getMesaTest:k,getMetrosSector:G,getCalidadFibra:E,getParadas:x,getTopMotivosParada:H,getFichas:T,getFichaByCodigo:A,getTestes:Z,getResiduosIndigo:tt,getResiduosSector:ut,getCostoItems:pt,getCostosMensual:et,saveCostosMensual:xt}}const ct=_(null),X=_([]),qt=50,I={NETWORK:"network",API:"api",VALIDATION:"validation",AUTH:"auth",UNKNOWN:"unknown"},Qt=b=>{var w;return b?b.name==="TypeError"&&((w=b.message)!=null&&w.includes("fetch"))?I.NETWORK:b.status===401||b.status===403?I.AUTH:b.status>=400&&b.status<600?I.API:b.name==="ValidationError"||b.type==="validation"?I.VALIDATION:I.UNKNOWN:I.UNKNOWN},zt=(b,w)=>{const p={[I.NETWORK]:"No se pudo conectar al servidor. Verifica tu conexiÃ³n a internet.",[I.AUTH]:"SesiÃ³n expirada o no autorizado. Por favor, inicia sesiÃ³n nuevamente.",[I.API]:(b==null?void 0:b.message)||"Error al procesar la solicitud en el servidor.",[I.VALIDATION]:(b==null?void 0:b.message)||"Los datos ingresados no son vÃ¡lidos.",[I.UNKNOWN]:"OcurriÃ³ un error inesperado. Por favor, intenta nuevamente."};return p[w]||p[I.UNKNOWN]};function Ht(){const b=(m,S="",y={})=>{const{silent:C=!1,toast:P=!0,logToConsole:Q=!0,duration:O=5e3}=y,M=Qt(m),k=zt(m,M),G=new Date().toISOString(),E={id:Date.now(),type:M,message:k,originalMessage:(m==null?void 0:m.message)||String(m),context:S,timestamp:G,stack:m==null?void 0:m.stack};return ct.value=E,X.value.unshift(E),X.value.length>qt&&X.value.pop(),Q&&console.error(`[${S||"Error"}]`,{type:M,message:k,original:m}),C||(P?dt.fire({icon:"error",title:S||"Error",text:k,toast:!0,position:"top-end",timer:O,timerProgressBar:!0,showConfirmButton:!1,didOpen:x=>{x.addEventListener("mouseenter",dt.stopTimer),x.addEventListener("mouseleave",dt.resumeTimer)}}):dt.fire({icon:"error",title:S||"Error",text:k,confirmButtonText:"Entendido",confirmButtonColor:"#3085d6"})),E},w=async(m,S="",y={})=>{try{return await m()}catch(C){return b(C,S,y),null}},p=()=>{ct.value=null},V=()=>{X.value=[],ct.value=null},N=m=>X.value.filter(S=>S.type===m);return{globalError:St(ct),errorHistory:St(X),handleError:b,tryCatch:w,clearError:p,clearHistory:V,getErrorsByType:N,ErrorTypes:I}}const Yt={class:"w-full flex-1 min-h-0 bg-white rounded-2xl shadow-xl px-4 py-3 border border-slate-200 flex flex-col overflow-y-auto"},Bt={class:"flex items-center justify-between gap-4 mb-3"},Kt={class:"flex items-center gap-4"},Vt={class:"filter-inline fecha-nav"},Gt={class:"fecha-controls"},Wt={key:0,class:"calendar-dropdown"},jt={class:"calendar-header"},Jt={class:"calendar-selects"},Xt=["value"],Zt=["value"],te=["value"],ee=["value"],se={class:"calendar-weekdays"},ae={class:"calendar-days"},oe=["onClick","disabled"],le={class:"flex gap-1.5"},re=["disabled"],ne=["disabled"],ie={class:"filter-inline"},de={class:"grid grid-cols-1 lg:grid-cols-[450px_1fr] gap-4"},ce={class:"flex flex-col gap-2"},ue={class:"text-sm font-semibold text-slate-700"},pe={class:"overflow-auto w-full rounded-xl border border-slate-200 max-h-[500px]"},xe={class:"min-w-full w-full table-auto divide-y divide-slate-200 text-xs tabla-resumen"},me=["onClick"],ve={class:"col-revisor px-2 py-[0.3rem] text-center font-medium text-slate-700"},be={class:"col-metros px-2 py-[0.3rem] text-center font-bold text-slate-700"},fe={class:"col-calidad px-2 py-[0.3rem] text-center text-slate-700"},ye={class:"col-pts px-2 py-[0.3rem] text-center text-slate-700"},he={class:"col-rollos px-2 py-[0.3rem] text-center text-slate-700"},ge={class:"col-sin-pts-un px-2 py-[0.3rem] text-center text-slate-700"},_e={class:"col-sin-pts-perc px-2 py-[0.3rem] text-center text-slate-700"},Pe={key:0,class:"bg-slate-100 font-bold border-t-2 border-slate-300"},Se={class:"col-metros px-2 py-[0.3rem] text-center text-slate-800"},Re={class:"col-calidad px-2 py-[0.3rem] text-center text-slate-800"},De={class:"col-pts px-2 py-[0.3rem] text-center text-slate-800"},we={class:"col-rollos px-2 py-[0.3rem] text-center text-slate-800"},Te={class:"col-sin-pts-un px-2 py-[0.3rem] text-center text-slate-800"},Ee={class:"col-sin-pts-perc px-2 py-[0.3rem] text-center text-slate-800"},Ne={class:"flex flex-col gap-2"},Ce={class:"text-sm font-semibold text-slate-700"},Ae={key:0,class:"overflow-auto w-full rounded-xl border border-slate-200 max-h-[500px]"},Me={class:"min-w-full w-full table-auto divide-y divide-slate-200 text-xs tabla-detalle"},ke=["onClick"],$e={class:"px-2 py-[0.3rem] text-center text-slate-700"},Ue={class:"px-2 py-[0.3rem] text-center text-slate-700"},Ie={class:"px-2 py-[0.3rem] text-center text-slate-700"},Le={class:"px-2 py-[0.3rem] text-center text-slate-700"},Oe={class:"px-2 py-[0.3rem] text-center text-slate-700"},Fe={class:"px-2 py-[0.3rem] text-center text-slate-700"},qe={class:"px-2 py-[0.3rem] text-center text-slate-700"},Qe={class:"px-2 py-[0.3rem] text-center text-slate-700"},ze={class:"px-2 py-[0.3rem] text-center text-slate-700"},He={class:"px-2 py-[0.3rem] text-center text-slate-700"},Ye={class:"px-2 py-[0.3rem] text-center text-slate-700"},Be={class:"px-2 py-[0.3rem] text-center text-slate-700"},Ke={class:"px-2 py-[0.3rem] text-center text-slate-700"},Ve={key:0,class:"bg-slate-100 font-bold border-t-2 border-slate-300"},Ge={class:"px-2 py-[0.3rem] text-center text-slate-800"},We={class:"px-2 py-[0.3rem] text-center text-slate-800"},je={class:"px-2 py-[0.3rem] text-center text-slate-800"},Je={class:"px-2 py-[0.3rem] text-center text-slate-800"},Xe={class:"px-2 py-[0.3rem] text-center text-slate-800"},Ze={class:"px-2 py-[0.3rem] text-center text-slate-800"},ts={class:"px-2 py-[0.3rem] text-center text-slate-800"},es={class:"px-2 py-[0.3rem] text-center text-slate-800"},ss={class:"px-2 py-[0.3rem] text-center text-slate-800"},as={class:"px-2 py-[0.3rem] text-center text-slate-800"},os={key:1,class:"empty-state-detail"},ls={key:0,class:"mt-4 flex flex-col gap-2"},rs={class:"text-sm text-slate-700"},ns={class:"ml-1 font-bold text-slate-900 text-base"},is={class:"ml-1 font-bold text-slate-900 text-base"},ds={class:"ml-1 font-bold text-slate-900 text-base"},cs={class:"ml-1 font-bold text-slate-900 text-base"},us={class:"ml-1 font-bold text-slate-900 text-base"},ps={class:"overflow-auto w-full rounded-xl border border-slate-200 max-h-[400px]"},xs={class:"min-w-full w-full table-auto divide-y divide-slate-200 text-xs"},ms=["onClick"],vs={class:"px-2 py-[0.3rem] text-center text-slate-700"},bs={class:"px-2 py-[0.3rem] text-center text-slate-700"},fs={class:"px-2 py-[0.3rem] text-center text-slate-700"},ys={class:"px-2 py-[0.3rem] text-center text-slate-700"},hs={class:"px-2 py-[0.3rem] text-center text-slate-700"},gs={class:"px-2 py-[0.3rem] text-center text-slate-700"},_s={class:"px-2 py-[0.3rem] text-center text-slate-700"},Ps={class:"px-2 py-[0.3rem] text-center text-slate-700"},Ss={class:"px-2 py-[0.3rem] text-center text-slate-700"},Rs={class:"px-2 py-[0.3rem] text-center text-slate-700"},Ds={class:"px-2 py-[0.3rem] text-center text-slate-700"},ws={key:1,class:"loading-overlay"},Ts={key:2,class:"error-message"},Es={key:3,class:"empty-state"},Ns={class:"modal-content",style:{"max-width":"1200px","max-height":"80vh"}},Cs={class:"modal-header"},As={class:"modal-header-title"},Ms={class:"text-xs text-slate-500 ml-2"},ks={class:"flex items-center gap-1.5"},$s=["disabled"],Us=["disabled"],Is={class:"modal-body",style:{"overflow-y":"auto","max-height":"calc(80vh - 90px)"}},Ls={key:0,class:"text-center py-8"},Os={key:1,class:"text-center py-8 text-slate-500"},Fs={key:2},qs={class:"mb-3 p-2 bg-slate-50 rounded-lg border border-slate-200"},Qs={class:"grid grid-cols-2 gap-x-6 gap-y-1 text-sm"},zs={class:"text-slate-900"},Hs={class:"text-slate-900"},Ys={class:"text-slate-900"},Bs={class:"text-slate-900 font-bold"},Ks={class:"overflow-auto rounded-lg border border-slate-200"},Vs={class:"min-w-full divide-y divide-slate-200 text-xs"},Gs={class:"bg-white divide-y divide-slate-100"},Ws={class:"px-3 py-2 text-slate-600"},js={class:"px-3 py-2 text-slate-700"},Js={class:"px-3 py-2 text-slate-700"},Xs={class:"px-3 py-2 text-slate-700"},Zs={class:"px-3 py-2 text-slate-700 font-mono"},ta={class:"px-3 py-2 text-slate-700"},ea={class:"px-3 py-2 text-center text-slate-700 font-semibold"},sa={class:"px-3 py-2 text-center"},aa={class:"px-3 py-2 text-center text-slate-700"},oa={__name:"RevisionCQ",setup(b){const w=Ft(),{handleError:p,tryCatch:V}=Ht(),N=_([]),m=_({Mts_Total:0,Calidad_Perc:0,Pts_100m2:0,Rollos_1era:0,Rollos_Sin_Pts:0,Perc_Sin_Pts:0}),S=_(null),y=_([]),C=_(null),P=_([]),Q=_(!1),O=_(null),M=_(-1),k=_([]),G=_(!1),E=q(()=>{if(y.value.length===0)return{MetrosRevisados:0,CalidadPct:0,Pts100m2:0,TotalRollos:0,SinPuntos:0,SinPuntosPct:0,Telar:0,EficienciaPct:0,RU105:0,RT105:0};const s=y.value.reduce((l,v)=>l+Number(v.MetrosRevisados||0),0),e=y.value.reduce((l,v)=>l+Number(v.TotalRollos||0),0),n=y.value.reduce((l,v)=>l+Number(v.SinPuntos||0),0),h=new Set(y.value.map(l=>l.Telar).filter(l=>Number(l)>0)).size,D=s>0?y.value.reduce((l,v)=>l+Number(v.CalidadPct||0)*Number(v.MetrosRevisados||0),0)/s:0,g=s>0?y.value.reduce((l,v)=>l+Number(v.Pts100m2||0)*Number(v.MetrosRevisados||0),0)/s:0,f=s>0?y.value.reduce((l,v)=>l+Number(v.EficienciaPct||0)*Number(v.MetrosRevisados||0),0)/s:0,L=s>0?y.value.reduce((l,v)=>l+Number(v.RU105||0)*Number(v.MetrosRevisados||0),0)/s:0,J=s>0?y.value.reduce((l,v)=>l+Number(v.RT105||0)*Number(v.MetrosRevisados||0),0)/s:0;return{MetrosRevisados:s,CalidadPct:D,Pts100m2:g,TotalRollos:e,SinPuntos:n,SinPuntosPct:e>0?n/e*100:0,Telar:h,EficienciaPct:f,RU105:L,RT105:J}}),x=_({fecha:"",tramas:"Todas"}),H=_(!1),T=_(new Date().getMonth()),A=_(new Date().getFullYear()),Z=_(null),tt=q(()=>{if(!x.value.fecha)return"";const[s,e,n]=x.value.fecha.split("-").map(Number),u=new Date(s,e-1,n),D=["dom","lun","mar","miÃ©","jue","vie","sÃ¡b"][u.getDay()],g=u.getDate().toString().padStart(2,"0"),f=(u.getMonth()+1).toString().padStart(2,"0"),L=u.getFullYear();return`${D} ${g}/${f}/${L}`}),ut=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],pt=q(()=>{const s=new Date().getFullYear(),e=2020,n=[];for(let u=e;u<=s+1;u++)n.push(u);return n}),et=q(()=>new Date(A.value,T.value));function xt(s){T.value=parseInt(s.target.value)}function r(s){A.value=parseInt(s.target.value)}const i=q(()=>{const s=[],e=new Date(A.value,T.value,1),n=new Date(A.value,T.value+1,0),u=new Date(A.value,T.value,0),h=e.getDay(),D=n.getDate(),g=u.getDate();for(let l=h-1;l>=0;l--)s.push({day:g-l,otherMonth:!0,key:`prev-${g-l}`});const f=new Date,L=x.value.fecha?new Date(x.value.fecha+"T00:00:00"):null;for(let l=1;l<=D;l++){const v=new Date(A.value,T.value,l);s.push({day:l,otherMonth:!1,selected:L&&L.getDate()===l&&L.getMonth()===T.value&&L.getFullYear()===A.value,today:f.getDate()===l&&f.getMonth()===T.value&&f.getFullYear()===A.value,key:`current-${l}`,date:v})}const J=42-s.length;for(let l=1;l<=J;l++)s.push({day:l,otherMonth:!0,key:`next-${l}`});return s});function $(){if(H.value=!H.value,H.value&&x.value.fecha){const[s,e]=x.value.fecha.split("-").map(Number);T.value=e-1,A.value=s}}function mt(s){T.value+=s,T.value>11?(T.value=0,A.value++):T.value<0&&(T.value=11,A.value--)}function Dt(s){if(s.otherMonth)return;const e=A.value,n=(T.value+1).toString().padStart(2,"0"),u=s.day.toString().padStart(2,"0");x.value.fecha=`${e}-${n}-${u}`,H.value=!1,at()}function wt(s){setTimeout(()=>{var e;(e=Z.value)!=null&&e.contains(document.activeElement)||(H.value=!1)},200)}const vt=_(null),st=q(()=>w.loading.value),yt=q(()=>w.error.value),Tt=q(()=>x.value.fecha);function j(s){if(!x.value.fecha)return;const[e,n,u]=x.value.fecha.split("-").map(Number),h=new Date(e,n-1,u);h.setDate(h.getDate()+s);const D=h.getFullYear(),g=(h.getMonth()+1).toString().padStart(2,"0"),f=h.getDate().toString().padStart(2,"0");x.value.fecha=`${D}-${g}-${f}`,at()}function Et(s){Q.value||(s.key==="ArrowLeft"?(s.preventDefault(),j(-1)):s.key==="ArrowRight"&&(s.preventDefault(),j(1)))}kt(async()=>{const s=new Date,e=new Date(s.getFullYear(),s.getMonth(),s.getDate()-1),n=e.getFullYear(),u=(e.getMonth()+1).toString().padStart(2,"0"),h=e.getDate().toString().padStart(2,"0"),D=`${n}-${u}-${h}`;x.value.fecha=D,vt.value&&vt.value.focus(),at()});async function at(){if(!Tt.value)return;S.value=null,y.value=[],C.value=null,P.value=[];const s=await V(async()=>{const e={startDate:x.value.fecha,endDate:x.value.fecha,tramas:x.value.tramas};return await w.getRevisionCQ(e)},"Cargar RevisiÃ³n CQ");N.value=s||[],At()}async function Nt(s){S.value=s,C.value=null,P.value=[];const e=await V(async()=>{const n={startDate:x.value.fecha,endDate:x.value.fecha,revisor:s.Revisor,tramas:x.value.tramas};return await w.getRevisorDetalle(n)},"Cargar detalle revisor",{toast:!0});y.value=e||[]}async function Ct(s){C.value=s;try{const e={fecha:x.value.fecha,partida:s.PARTIDA||s.Partidas,revisor:S.value.Revisor};console.log("ðŸ“¦ Solicitando detalle de partida:",JSON.stringify(e,null,2));const n=await w.getPartidaDetalle(e);console.log("ðŸ“Š Respuesta del servidor:",n),console.log("ðŸ“Š NÃºmero de registros:",(n==null?void 0:n.length)||0),P.value=n||[]}catch(e){p(e,"Cargar detalle partida",{silent:!0}),P.value=[]}}async function ht(s,e=-1){O.value=s,e===-1?M.value=P.value.findIndex(u=>u.ETIQUETA===s.ETIQUETA):M.value=e,Q.value=!0,G.value=!0,k.value=[],window.addEventListener("keydown",gt);const n=await V(async()=>(console.log("ðŸ” [FRONTEND] Pieza completa:",s),console.log("ðŸ” [FRONTEND] Etiqueta:",s.ETIQUETA),await w.getDefectosDetalle(s.ETIQUETA)),"Cargar defectos",{silent:!0});k.value=n||[],G.value=!1}function ot(){Q.value=!1,O.value=null,M.value=-1,k.value=[],window.removeEventListener("keydown",gt)}function lt(s){const e=M.value+s;if(e>=0&&e<P.value.length){const n=P.value[e];ht(n,e)}}function gt(s){if(Q.value)switch(s.key){case"Escape":ot();break;case"ArrowLeft":s.preventDefault(),lt(-1);break;case"ArrowRight":s.preventDefault(),lt(1);break}}function At(){if(N.value.length===0){m.value={Mts_Total:0,Calidad_Perc:0,Pts_100m2:0,Rollos_1era:0,Rollos_Sin_Pts:0,Perc_Sin_Pts:0};return}const s=N.value.reduce((g,f)=>g+Number(f.Mts_Total||0),0),e=N.value.reduce((g,f)=>g+Number(f.Rollos_1era||0),0),n=N.value.reduce((g,f)=>g+Number(f.Rollos_Sin_Pts||0),0);let u=0;s>0&&(u=N.value.reduce((g,f)=>g+Number(f.Calidad_Perc||0)*Number(f.Mts_Total||0),0)/s);let h=0;s>0&&(h=N.value.reduce((g,f)=>g+Number(f.Pts_100m2||0)*Number(f.Mts_Total||0),0)/s);let D=0;e>0&&(D=n/e*100),m.value={Mts_Total:s,Calidad_Perc:u,Pts_100m2:h,Rollos_1era:e,Rollos_Sin_Pts:n,Perc_Sin_Pts:D}}function R(s){if(s==null)return"-";const e=Number(s);return Number.isNaN(e)?"-":new Intl.NumberFormat("es-ES",{minimumFractionDigits:1,maximumFractionDigits:1}).format(e)}function rt(s){if(s==null)return"-";const e=Number(s);if(Number.isNaN(e))return"-";const u=Math.round(e).toString().replace(/\B(?=(\d{3})+(?!\d))/g,".");return e<0?`-${u.replace("-","")}`:u}function _t(s){if(!s)return"-";const e=s.toString().padStart(4,"0");return e.slice(0,2)+":"+e.slice(2,4)}function bt(s){if(!s)return"-";const e=s.toString().padStart(7,"0");return e.slice(0,1)+"-"+e.slice(1,5)+"."+e.slice(5,7)}function ft(s){if(!s)return"-";const e=s.toString();return e.length<3?e:e.slice(0,-3)+" "+e.slice(-3)}function Mt(s){if(!s)return"-";const n=s.toString().split(" ")[0],[u,h,D]=n.split("-");return!u||!h||!D?s:`${D}/${h}/${u}`}return(s,e)=>{var u,h,D,g,f,L,J,l,v,Pt;const n=It("tippy");return d(),c("div",{class:"w-full h-screen flex flex-col p-1",onKeydown:Et,tabindex:"0",ref_key:"containerRef",ref:vt},[t("main",Yt,[t("div",Bt,[t("div",Kt,[t("div",Vt,[e[16]||(e[16]=t("label",{class:"sr-only"},"Fecha:",-1)),t("div",Gt,[t("div",{class:"custom-datepicker",ref_key:"datepickerRef",ref:Z},[W(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>tt.value=a),class:"filter-input datepicker-input",placeholder:"Selecciona una fecha",onClick:$,onKeydown:[e[1]||(e[1]=Rt(F(a=>j(-1),["prevent"]),["left"])),e[2]||(e[2]=Rt(F(a=>j(1),["prevent"]),["right"]))],onBlur:wt,readonly:""},null,544),[[$t,tt.value]]),t("span",{class:"calendar-icon",onClick:$},"ðŸ“…"),H.value?(d(),c("div",Wt,[t("div",jt,[t("button",{class:"calendar-nav-btn",onClick:e[3]||(e[3]=F(a=>mt(-1),["stop"]))},"<"),t("div",Jt,[t("select",{value:et.value.getMonth(),onChange:xt,onClick:e[4]||(e[4]=F(()=>{},["stop"])),class:"calendar-select"},[(d(),c(Y,null,B(ut,(a,U)=>t("option",{key:U,value:U},o(a),9,Zt)),64))],40,Xt),t("select",{value:et.value.getFullYear(),onChange:r,onClick:e[5]||(e[5]=F(()=>{},["stop"])),class:"calendar-select"},[(d(!0),c(Y,null,B(pt.value,a=>(d(),c("option",{key:a,value:a},o(a),9,ee))),128))],40,te)]),t("button",{class:"calendar-nav-btn",onClick:e[6]||(e[6]=F(a=>mt(1),["stop"]))},">")]),t("div",se,[(d(),c(Y,null,B(["Dom","Lun","Mar","MiÃ©","Jue","Vie","SÃ¡b"],a=>t("span",{key:a},o(a),1)),64))]),t("div",ae,[(d(!0),c(Y,null,B(i.value,a=>(d(),c("button",{key:a.key,class:it(["calendar-day",{"other-month":a.otherMonth,selected:a.selected,today:a.today}]),onClick:F(U=>Dt(a),["stop"]),disabled:a.otherMonth},o(a.day),11,oe))),128))])])):K("",!0)],512),t("div",le,[W((d(),c("button",{class:"inline-flex items-center justify-center px-2 py-1 border border-slate-200 bg-white text-slate-700 rounded-md text-sm font-medium hover:bg-slate-50 transition-colors duration-150 shadow-sm",onClick:e[7]||(e[7]=a=>j(-1)),onMousedown:e[8]||(e[8]=F(()=>{},["prevent"])),tabindex:"-1",disabled:st.value},[...e[14]||(e[14]=[z("<",-1)])],40,re)),[[n,"DÃ­a anterior (â†)"]]),W((d(),c("button",{class:"inline-flex items-center justify-center px-2 py-1 border border-slate-200 bg-white text-slate-700 rounded-md text-sm font-medium hover:bg-slate-50 transition-colors duration-150 shadow-sm",onClick:e[9]||(e[9]=a=>j(1)),onMousedown:e[10]||(e[10]=F(()=>{},["prevent"])),tabindex:"-1",disabled:st.value},[...e[15]||(e[15]=[z(">",-1)])],40,ne)),[[n,"DÃ­a siguiente (â†’)"]])])])]),t("div",ie,[e[18]||(e[18]=t("label",{class:"filter-label"},"Trama:",-1)),W(t("select",{"aria-label":"Tramas","onUpdate:modelValue":e[11]||(e[11]=a=>x.value.tramas=a),class:"filter-input",onChange:at},[...e[17]||(e[17]=[t("option",{value:"Todas"},"Todas",-1),t("option",{value:"ALG 100%"},"ALG 100%",-1),t("option",{value:"P + E"},"P + E",-1),t("option",{value:"POL 100%"},"POL 100%",-1)])],544),[[Ut,x.value.tramas]])])]),e[19]||(e[19]=t("div",{class:"flex items-center gap-3"},[t("span",{class:"text-lg font-bold text-slate-700"},"Informe detallado de revisiÃ³n de calidad")],-1))]),t("div",de,[t("div",ce,[t("span",ue,o(N.value.length)+" revisores",1),t("div",pe,[t("table",xe,[e[21]||(e[21]=t("thead",{class:"bg-gradient-to-r from-slate-50 to-slate-100 sticky top-0 z-20"},[t("tr",null,[t("th",{class:"col-revisor px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Revisor"),t("th",{class:"col-metros px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Metros DÃ­a"),t("th",{class:"col-calidad px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Calidad %"),t("th",{class:"col-pts px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Pts 100 mÂ²"),t("th",{class:"col-rollos px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Rollos 1era"),t("th",{class:"col-sin-pts-un px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Sin Pts [un]"),t("th",{class:"col-sin-pts-perc px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Sin Pts [%]")])],-1)),t("tbody",null,[(d(!0),c(Y,null,B(N.value,a=>{var U;return d(),c("tr",{key:a.Revisor,onClick:nt=>Nt(a),class:it([{"selected-row":((U=S.value)==null?void 0:U.Revisor)===a.Revisor},"border-t border-slate-100 hover:bg-blue-50/30 transition-colors duration-150 cursor-pointer"])},[t("td",ve,o(a.Revisor),1),t("td",be,o(rt(a.Mts_Total)),1),t("td",fe,o(R(a.Calidad_Perc)),1),t("td",ye,o(R(a.Pts_100m2)),1),t("td",he,o(a.Rollos_1era),1),t("td",ge,o(a.Rollos_Sin_Pts),1),t("td",_e,o(R(a.Perc_Sin_Pts)),1)],10,me)}),128)),N.value.length>0?(d(),c("tr",Pe,[e[20]||(e[20]=t("td",{class:"col-revisor px-2 py-[0.3rem] text-center text-slate-800"},"Total",-1)),t("td",Se,o(rt(m.value.Mts_Total)),1),t("td",Re,o(R(m.value.Calidad_Perc)),1),t("td",De,o(R(m.value.Pts_100m2)),1),t("td",we,o(m.value.Rollos_1era),1),t("td",Te,o(m.value.Rollos_Sin_Pts),1),t("td",Ee,o(R(m.value.Perc_Sin_Pts)),1)])):K("",!0)])])])]),t("div",Ne,[t("span",Ce,o(S.value?`Detalle - ${S.value.Revisor}`:"Seleccione un revisor"),1),S.value&&y.value.length>0?(d(),c("div",Ae,[t("table",Me,[e[24]||(e[24]=t("thead",{class:"bg-gradient-to-r from-slate-50 to-slate-100 sticky top-0 z-20"},[t("tr",null,[t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Hora"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Nombre ArtÃ­culo"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Partidas"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Metros Revisados"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Cal. %"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Pts 100mÂ²"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Total [un]"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Sin Pts [un]"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Sin Pts [%]"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Telar"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Efic. %"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"RU 105"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"RT 105")])],-1)),t("tbody",null,[(d(!0),c(Y,null,B(y.value,(a,U)=>{var nt;return d(),c("tr",{key:U,onClick:la=>Ct(a),class:it([{"bg-blue-100":((nt=C.value)==null?void 0:nt.Partidas)===a.Partidas},"border-t border-slate-100 hover:bg-blue-50/30 transition-colors duration-150 cursor-pointer"])},[t("td",$e,o(_t(a.HoraInicio)),1),t("td",Ue,o(a.NombreArticulo),1),t("td",Ie,o(bt(a.Partidas)),1),t("td",Le,o(rt(a.MetrosRevisados)),1),t("td",Oe,o(R(a.CalidadPct)),1),t("td",Fe,o(R(a.Pts100m2)),1),t("td",qe,o(a.TotalRollos),1),t("td",Qe,o(a.SinPuntos),1),t("td",ze,o(R(a.SinPuntosPct)),1),t("td",He,o(a.Telar),1),t("td",Ye,o(R(a.EficienciaPct)),1),t("td",Be,o(R(a.RU105)),1),t("td",Ke,o(R(a.RT105)),1)],10,ke)}),128)),y.value.length>0?(d(),c("tr",Ve,[e[22]||(e[22]=t("td",{class:"px-2 py-[0.3rem]"},null,-1)),e[23]||(e[23]=t("td",{colspan:"2",class:"px-2 py-[0.3rem] text-center text-slate-800"},"Total",-1)),t("td",Ge,o(rt(E.value.MetrosRevisados)),1),t("td",We,o(R(E.value.CalidadPct)),1),t("td",je,o(R(E.value.Pts100m2)),1),t("td",Je,o(E.value.TotalRollos),1),t("td",Xe,o(E.value.SinPuntos),1),t("td",Ze,o(R(E.value.SinPuntosPct)),1),t("td",ts,o(E.value.Telar),1),t("td",es,o(R(E.value.EficienciaPct)),1),t("td",ss,o(R(E.value.RU105)),1),t("td",as,o(R(E.value.RT105)),1)])):K("",!0)])])])):(d(),c("div",os,[...e[25]||(e[25]=[t("p",null,"ðŸ‘† Haz clic en un revisor para ver el detalle de su producciÃ³n",-1)])]))])]),C.value&&P.value.length>0?(d(),c("div",ls,[t("div",rs,[e[26]||(e[26]=t("span",{class:"text-slate-600"},"Detalle de Partida:",-1)),t("span",ns,o(bt(C.value.Partidas)),1),e[27]||(e[27]=t("span",{class:"mx-2 text-slate-600"},"-",-1)),e[28]||(e[28]=t("span",{class:"text-slate-600"},"ArtÃ­culo:",-1)),t("span",is,o(((h=(u=P.value[0])==null?void 0:u.ARTIGO)==null?void 0:h.substring(0,10))||"N/A"),1),e[29]||(e[29]=t("span",{class:"mx-2 text-slate-600"},"-",-1)),e[30]||(e[30]=t("span",{class:"text-slate-600"},"Color:",-1)),t("span",ds,o(((D=P.value[0])==null?void 0:D.COR)||"N/A"),1),e[31]||(e[31]=t("span",{class:"mx-2 text-slate-600"},"-",-1)),e[32]||(e[32]=t("span",{class:"text-slate-600"},"Nombre:",-1)),t("span",cs,o(((g=P.value[0])==null?void 0:g.NM_MERC)||C.value.NombreArticulo),1),e[33]||(e[33]=t("span",{class:"mx-2 text-slate-600"},"-",-1)),e[34]||(e[34]=t("span",{class:"text-slate-600"},"Trama:",-1)),t("span",us,o(((f=P.value[0])==null?void 0:f.TRAMA)||"N/A"),1)]),t("div",ps,[t("table",xs,[e[35]||(e[35]=t("thead",{class:"bg-gradient-to-r from-slate-50 to-slate-100 sticky top-0 z-20"},[t("tr",null,[t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Grupo"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"CÃ³digo"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Defecto"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Metraje"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Calidad"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Hora"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Emendas"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Pieza"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Etiqueta"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"Ancho"),t("th",{class:"px-2 py-[0.3rem] text-center font-semibold text-slate-700 border-b border-slate-200"},"PuntuaciÃ³n")])],-1)),t("tbody",null,[(d(!0),c(Y,null,B(P.value,(a,U)=>W((d(),c("tr",{key:U,class:"border-t border-slate-100 hover:bg-blue-50/30 transition-colors duration-150 cursor-pointer",onClick:nt=>ht(a)},[t("td",vs,o(a.GRP_DEF),1),t("td",bs,o(a.COD_DE),1),t("td",fs,o(a.DEFEITO),1),t("td",ys,o(a.METRAGEM),1),t("td",hs,o(a.QUALIDADE),1),t("td",gs,o(_t(a.HORA)),1),t("td",_s,o(a.EMENDAS),1),t("td",Ps,o(ft(a.PEÃ‡A)),1),t("td",Ss,o(a.ETIQUETA),1),t("td",Rs,o(a.LARGURA),1),t("td",Ds,o(a.PONTUACAO),1)],8,ms)),[[n,"Clic para ver defectos detallados"]])),128))])])])])):K("",!0),st.value?(d(),c("div",ws,[...e[36]||(e[36]=[t("div",{class:"spinner"},null,-1),t("p",null,"Cargando datos...",-1)])])):K("",!0),yt.value?(d(),c("div",Ts," âš ï¸ Error: "+o(yt.value),1)):K("",!0),!st.value&&N.value.length===0?(d(),c("div",Es,[...e[37]||(e[37]=[t("div",{class:"empty-icon"},"ðŸ“‹",-1),t("p",{class:"empty-message"},"No hay datos de calidad disponibles",-1),t("p",{class:"empty-hint"},"Intenta ajustar los filtros o verifica la importaciÃ³n",-1)])])):K("",!0),Q.value?(d(),c("div",{key:4,class:"modal-overlay",onClick:F(ot,["self"])},[t("div",Ns,[t("div",Cs,[t("h3",As,[z(" ðŸ” Defectos Detallados - Pieza "+o((L=O.value)==null?void 0:L.ETIQUETA)+" ",1),t("span",Ms,"("+o(M.value+1)+" / "+o(P.value.length)+")",1)]),t("div",ks,[W((d(),c("button",{onClick:e[12]||(e[12]=a=>lt(-1)),disabled:M.value<=0,class:"nav-btn"},[...e[38]||(e[38]=[z(" â€¹ ",-1)])],8,$s)),[[n,"Pieza anterior (â†)"]]),W((d(),c("button",{onClick:e[13]||(e[13]=a=>lt(1)),disabled:M.value>=P.value.length-1,class:"nav-btn"},[...e[39]||(e[39]=[z(" â€º ",-1)])],8,Us)),[[n,"Pieza siguiente (â†’)"]]),t("button",{onClick:ot,class:"modal-close-btn"},"Ã—")])]),t("div",Is,[G.value?(d(),c("div",Ls,[...e[40]||(e[40]=[t("div",{class:"spinner mx-auto mb-3"},null,-1),t("p",{class:"text-slate-600"},"Cargando defectos...",-1)])])):k.value.length===0?(d(),c("div",Os,[...e[41]||(e[41]=[t("p",{class:"text-lg"},"ðŸ“‹ No se encontraron defectos para esta pieza",-1)])])):(d(),c("div",Fs,[t("div",qs,[t("div",Qs,[t("div",null,[e[42]||(e[42]=t("span",{class:"font-semibold text-slate-700"},"Partida:",-1)),e[43]||(e[43]=z()),t("span",zs,o(((J=O.value)==null?void 0:J.PARTIDA)||bt((l=C.value)==null?void 0:l.Partidas)),1)]),t("div",null,[e[44]||(e[44]=t("span",{class:"font-semibold text-slate-700"},"Pieza:",-1)),e[45]||(e[45]=z()),t("span",Hs,o(ft((v=O.value)==null?void 0:v.PEÃ‡A)),1)]),t("div",null,[e[46]||(e[46]=t("span",{class:"font-semibold text-slate-700"},"Etiqueta:",-1)),e[47]||(e[47]=z()),t("span",Ys,o((Pt=O.value)==null?void 0:Pt.ETIQUETA),1)]),t("div",null,[e[48]||(e[48]=t("span",{class:"font-semibold text-slate-700"},"Total Defectos:",-1)),e[49]||(e[49]=z()),t("span",Bs,o(k.value.length),1)])])]),t("div",Ks,[t("table",Vs,[e[50]||(e[50]=t("thead",{class:"bg-gradient-to-r from-slate-50 to-slate-100 sticky top-0"},[t("tr",null,[t("th",{class:"px-3 py-2 text-left font-semibold text-slate-700 border-b border-slate-200"},"#"),t("th",{class:"px-3 py-2 text-left font-semibold text-slate-700 border-b border-slate-200"},"Partida"),t("th",{class:"px-3 py-2 text-left font-semibold text-slate-700 border-b border-slate-200"},"Pieza"),t("th",{class:"px-3 py-2 text-left font-semibold text-slate-700 border-b border-slate-200"},"Etiqueta"),t("th",{class:"px-3 py-2 text-left font-semibold text-slate-700 border-b border-slate-200"},"CÃ³d. Defecto"),t("th",{class:"px-3 py-2 text-left font-semibold text-slate-700 border-b border-slate-200"},"DescripciÃ³n"),t("th",{class:"px-3 py-2 text-center font-semibold text-slate-700 border-b border-slate-200"},"Puntos"),t("th",{class:"px-3 py-2 text-center font-semibold text-slate-700 border-b border-slate-200"},"Calidad"),t("th",{class:"px-3 py-2 text-center font-semibold text-slate-700 border-b border-slate-200"},"Fecha Prod.")])],-1)),t("tbody",Gs,[(d(!0),c(Y,null,B(k.value,(a,U)=>(d(),c("tr",{key:U,class:"hover:bg-slate-50 transition-colors"},[t("td",Ws,o(U+1),1),t("td",js,o(a.PARTIDA),1),t("td",Js,o(ft(a.PECA)),1),t("td",Xs,o(a.ETIQUETA),1),t("td",Zs,o(a.COD_DEF),1),t("td",ta,o(a.DESC_DEFEITO),1),t("td",ea,o(a.PONTOS),1),t("td",sa,[t("span",{class:it({"px-2 py-1 rounded text-xs font-medium":!0,"bg-green-100 text-green-800":a.QUALIDADE==="PRIMEIRA","bg-yellow-100 text-yellow-800":a.QUALIDADE==="SEGUNDA","bg-red-100 text-red-800":a.QUALIDADE==="TERCEIRA"})},o(a.QUALIDADE),3)]),t("td",aa,o(Mt(a.DATA_PROD)),1)]))),128))])])])]))]),t("div",{class:"modal-footer"},[t("button",{onClick:ot,class:"btn-secondary"},"Cerrar")])])])):K("",!0)])],544)}}},da=Lt(oa,[["__scopeId","data-v-24c74e56"]]);export{da as default};
