import{_ as Ce}from"./LogoSantana-C2JneU89.js";import{C as De}from"./CustomDatepicker-CvHj9gtp.js";import{B as Q}from"./index-DjJVNzjF.js";import{C as Ie,c as Ee,p as Ae,b as Te,B as Me,d as Le,L as je}from"./chart-W6hu_GvM.js";import{p as ze}from"./chartjs-plugin-datalabels.esm-Cif2J1bz.js";import{S as Z}from"./sweetalert2.esm.all-AlKuj1Cq.js";import{_ as Oe,m as N,o as Ne,a as b,c as A,b as f,f as re,A as ve,u as Pe,e as G,B as ee,C as te,p as k,z as Be}from"./index-DOrYTJc_.js";const Fe={class:"w-full h-screen flex flex-col p-1"},Ke={class:"w-full flex-1 min-h-0 bg-white rounded-2xl shadow-xl px-4 py-3 border border-slate-200 flex flex-col relative"},Ve={class:"flex items-center justify-between gap-4 flex-shrink-0 mb-4"},We={class:"flex items-center gap-2"},He={key:0,class:"absolute inset-0 bg-white/50 backdrop-blur-sm flex items-center justify-center z-10"},Ue={class:"flex-1 flex gap-4 min-w-0"},qe={class:"flex-[3] h-full p-4 border border-slate-200 rounded-lg min-w-0 overflow-hidden"},Ye={key:1,class:"h-full flex items-center justify-center text-slate-400"},Ze={class:"flex-[1] h-full p-4 border border-slate-200 rounded-lg min-w-0 overflow-hidden"},Ge={key:1,class:"h-full flex items-center justify-center text-slate-400"},Xe={class:"flex-[1.3] h-full px-2 py-4 border border-slate-200 rounded-lg min-w-0 overflow-hidden"},Je={key:1,class:"h-full flex items-center justify-center text-slate-400"},Qe={class:"flex-1 flex gap-4 min-w-0"},et={class:"flex-[3] h-full p-4 border border-slate-200 rounded-lg min-w-0 overflow-hidden"},tt={key:1,class:"h-full flex items-center justify-center text-slate-400"},at={class:"flex-[1] h-full p-4 border border-slate-200 rounded-lg min-w-0 overflow-hidden"},ot={key:1,class:"h-full flex items-center justify-center text-slate-400"},st={class:"flex-[1.3] h-full px-2 py-4 border border-slate-200 rounded-lg min-w-0 overflow-hidden"},nt={key:1,class:"h-full flex items-center justify-center text-slate-400"},it={__name:"AnalisisResiduosIndigo",setup(rt){Ie.register(Ee,Ae,Te,Me,Le,je,ze);const le="".replace(/\/$/,""),X=le?`${le}/api`:"/api",z=N(!1),S=N([]),_=N([]),C=N([]),D=N([]),T=N([]),P=N([]),H=N(null),U=N((()=>{const t=new Date;t.setDate(t.getDate()-1);const e=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0");return`${e}-${a}-${l}`})()),c=t=>{if(typeof t=="number")return Number.isFinite(t)?t:0;if(t==null)return 0;let e=String(t).trim().replace(/\s+/g,"");if(!e)return 0;const a=e.includes(","),l=e.includes(".");a&&l?e.lastIndexOf(",")>e.lastIndexOf(".")?e=e.replace(/\./g,"").replace(",","."):e=e.replace(/,/g,""):a?/^-?\d{1,3}(,\d{3})+$/.test(e)?e=e.replace(/,/g,""):e=e.replace(",","."):l&&/^-?\d{1,3}(\.\d{3})+$/.test(e)&&(e=e.replace(/\./g,""));const p=Number(e);return Number.isFinite(p)?p:0},ce=async()=>{z.value=!0;try{const[t,e,a]=U.value.split("-"),l=`01/${e}/${t}`,p=`${a}/${e}/${t}`,r=`${a}/${e}/${t}`,[s,o,n,g,$,I]=await Promise.all([fetch(`${X}/residuos-indigo-analisis?fecha_inicio=${l}&fecha_fin=${p}`),fetch(`${X}/produccion-indigo-resumen?fecha_inicio=${l}&fecha_fin=${p}`),fetch(`${X}/residuos-indigo-analisis?fecha_inicio=${r}&fecha_fin=${r}`),fetch(`${X}/produccion-indigo-resumen?fecha_inicio=${r}&fecha_fin=${r}`),fetch(`${X}/residuos-indigo-estopa-por-mes`),fetch(`${X}/residuos-indigo-estopa-por-dia?fecha_inicio=${l}&fecha_fin=${p}`)]);if(!s.ok||!o.ok||!n.ok||!g.ok||!$.ok||!I.ok)throw new Error("Error al cargar datos");S.value=await s.json();const B=await o.json();_.value=B.s_valores||[],C.value=await n.json();const q=await g.json();D.value=q.s_valores||[],T.value=await $.json(),P.value=await I.json()}catch(t){console.error("Error:",t),S.value=[],_.value=[],C.value=[],D.value=[],T.value=[],P.value=[]}finally{z.value=!1}},de=k(()=>{if(S.value.length===0)return null;const t=(a,l=10)=>{const p=a.split(" "),r=[];let s="";return p.forEach(o=>{(s+" "+o).trim().length<=l?s=s?s+" "+o:o:(s&&r.push(s),s=o)}),s&&r.push(s),r},e=Math.max(...S.value.map(a=>c(a.TotalKg)));return{labels:S.value.map(a=>t(a.DESC_MOTIVO)),datasets:[{label:"Kg Residuos",data:S.value.map(a=>c(a.TotalKg)),backgroundColor:S.value.map((a,l)=>c(a.TotalKg)===e?"#dc2626":l%2===0?"#0f172a":"#3b82f6"),borderRadius:4}]}}),be=k(()=>{const[t,e,a]=U.value.split("-"),l=S.value.reduce((o,n)=>o+c(n.TotalKg),0),p=(o,n,g)=>`${o}-${["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"][parseInt(n)-1]}-${g.slice(2)}`,r=p("01",e,t),s=p(a,e,t);return{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:`Residuos por Motivo del Periodo ${r} a ${s}`,font:{size:24,weight:"bold"},padding:{bottom:30},color:"#000"},datalabels:{anchor:"end",align:"top",formatter:o=>{const n=l>0?(o/l*100).toFixed(1):"0.0";return`${Math.round(o).toLocaleString()}
(${n}%)`},font:{weight:"bold",size:11},color:"#000"}},scales:{y:{beginAtZero:!0,grid:{display:!1},ticks:{display:!1},border:{display:!1}},x:{grid:{display:!1},ticks:{font:{weight:"bold",size:10},color:"#000",maxRotation:0,minRotation:0,autoSkip:!1,padding:5,callback:function(o,n){const g=this.getLabelForValue(o);return Array.isArray(g)?g:[g]}}}}}}),ue=k(()=>{if(_.value.length===0)return null;const t=Math.max(..._.value.map(a=>c(a.count))),e=["#10b981","#3b82f6","#f59e0b","#ef4444","#8b5cf6"];return{labels:_.value.map(a=>a.S),datasets:[{label:"Cantidad de Registros",data:_.value.map(a=>c(a.count)),backgroundColor:_.value.map((a,l)=>c(a.count)===t?"#dc2626":e[l%e.length]),borderRadius:4}]}}),we=k(()=>{const t=_.value.reduce((e,a)=>e+c(a.count),0);return{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:"Producci√≥n √çNDIGO por Tipo",font:{size:16,weight:"bold"},padding:{top:10,bottom:30},color:"#000"},datalabels:{anchor:"end",align:"end",offset:4,formatter:e=>{const a=t>0?(e/t*100).toFixed(1):"0.0";return`${e.toLocaleString()}
(${a}%)`},font:{weight:"bold",size:11},color:"#000"}},scales:{y:{beginAtZero:!0,grid:{display:!1},ticks:{display:!1},border:{display:!1}},x:{grid:{display:!1},ticks:{font:{weight:"bold",size:10},color:"#000"}}}}}),pe=k(()=>{if(C.value.length===0)return null;const t=(a,l=10)=>{const p=a.split(" "),r=[];let s="";return p.forEach(o=>{(s+" "+o).trim().length<=l?s=s?s+" "+o:o:(s&&r.push(s),s=o)}),s&&r.push(s),r},e=Math.max(...C.value.map(a=>c(a.TotalKg)));return{labels:C.value.map(a=>t(a.DESC_MOTIVO)),datasets:[{label:"Kg Residuos",data:C.value.map(a=>c(a.TotalKg)),backgroundColor:C.value.map((a,l)=>c(a.TotalKg)===e?"#dc2626":l%2===0?"#0f172a":"#3b82f6"),borderRadius:4}]}}),ye=k(()=>{const[t,e,a]=U.value.split("-"),l=C.value.reduce((s,o)=>s+c(o.TotalKg),0),r=((s,o,n)=>`${s}-${["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"][parseInt(o)-1]}-${n.slice(2)}`)(a,e,t);return{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:`Residuos por Motivo del D√≠a ${r}`,font:{size:24,weight:"bold"},padding:{bottom:30},color:"#000"},datalabels:{anchor:"end",align:"top",formatter:s=>{const o=l>0?(s/l*100).toFixed(1):"0.0";return`${Math.round(s).toLocaleString()}
(${o}%)`},font:{weight:"bold",size:11},color:"#000"}},scales:{y:{beginAtZero:!0,grid:{display:!1},ticks:{display:!1},border:{display:!1}},x:{grid:{display:!1},ticks:{font:{weight:"bold",size:10},color:"#000",maxRotation:0,minRotation:0,autoSkip:!1,padding:5,callback:function(s,o){const n=this.getLabelForValue(s);return Array.isArray(n)?n:[n]}}}}}}),ge=k(()=>{if(D.value.length===0)return null;const t=Math.max(...D.value.map(a=>c(a.count))),e=["#10b981","#3b82f6","#f59e0b","#ef4444","#8b5cf6"];return{labels:D.value.map(a=>a.S),datasets:[{label:"Cantidad de Registros",data:D.value.map(a=>c(a.count)),backgroundColor:D.value.map((a,l)=>c(a.count)===t?"#dc2626":e[l%e.length]),borderRadius:4}]}}),xe=k(()=>{const t=D.value.reduce((e,a)=>e+c(a.count),0);return{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:"Producci√≥n √çNDIGO por Tipo",font:{size:16,weight:"bold"},padding:{top:10,bottom:30},color:"#000"},datalabels:{anchor:"end",align:"end",offset:4,formatter:e=>{const a=t>0?(e/t*100).toFixed(1):"0.0";return`${e.toLocaleString()}
(${a}%)`},font:{weight:"bold",size:11},color:"#000"}},scales:{y:{beginAtZero:!0,grid:{display:!1},ticks:{display:!1},border:{display:!1}},x:{grid:{display:!1},ticks:{font:{weight:"bold",size:10},color:"#000"}}}}}),he=k(()=>{if(T.value.length===0)return null;const t=Math.max(...T.value.map(e=>c(e.KgResiduo)));return{labels:T.value.map(e=>{const[a,l]=e.Mes.split("-");return`${["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"][parseInt(l)-1]}-${a.slice(2)}`}),datasets:[{label:"Kg de Estopa Azul",data:T.value.map(e=>c(e.KgResiduo)),backgroundColor:T.value.map(e=>c(e.KgResiduo)===t?"#dc2626":"#3b82f6"),borderRadius:4}]}}),$e=k(()=>{const t=T.value.reduce((e,a)=>e+c(a.KgResiduo),0);return T.value.length>0&&(t/T.value.length).toFixed(0),{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:"Estopa Azul por Mes (√öltimos 12 Meses)",font:{size:14,weight:"bold"},padding:{top:5,bottom:20},color:"#000"},datalabels:{display:!1},tooltip:{callbacks:{afterLabel:e=>{const a=e.raw;return`${t>0?(a/t*100).toFixed(1):"0.0"}% del total`}}}},scales:{y:{beginAtZero:!0,grid:{display:!0,color:"#e5e7eb"},ticks:{callback:function(e){return Math.round(e).toLocaleString()+" kg"},font:{size:9},color:"#666"},border:{display:!1}},x:{grid:{display:!1},ticks:{font:{weight:"bold",size:9},color:"#000",maxRotation:90,minRotation:90,autoSkip:!1,padding:5}}}}}),fe=k(()=>{if(P.value.length===0)return null;const t=Math.max(...P.value.map(e=>c(e.KgResiduo)));return{labels:P.value.map(e=>{const[a]=e.Fecha.split("/");return a}),datasets:[{label:"Kg de Estopa Azul",data:P.value.map(e=>c(e.KgResiduo)),backgroundColor:P.value.map(e=>c(e.KgResiduo)===t?"#dc2626":"#10b981"),borderRadius:4}]}}),Re=k(()=>{const t=P.value.reduce((o,n)=>o+c(n.KgResiduo),0),[e,a,l]=U.value.split("-"),p=(o,n,g)=>`${o}-${["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"][parseInt(n)-1]}-${g.slice(2)}`,r=p("01",a,e),s=p(l,a,e);return{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:`Estopa Azul por D√≠a del Periodo ${r} a ${s}`,font:{size:14,weight:"bold"},padding:{top:5,bottom:20},color:"#000"},datalabels:{display:!1},tooltip:{callbacks:{afterLabel:o=>{const n=o.raw;return`${t>0?(n/t*100).toFixed(1):"0.0"}% del total del mes`}}}},scales:{y:{beginAtZero:!0,grid:{display:!0,color:"#e5e7eb"},ticks:{callback:function(o){return Math.round(o).toLocaleString()+" kg"},font:{size:9},color:"#666"},border:{display:!1}},x:{grid:{display:!1},ticks:{font:{weight:"bold",size:9},color:"#000",maxRotation:90,minRotation:90,autoSkip:!1,padding:5}}}}}),ke=async()=>{try{const[t,e,a]=U.value.split("-"),p=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][parseInt(e)-1];let r=`üìä *AN√ÅLISIS RESIDUOS DE √çNDIGO*
`;if(r+=`üìÖ Per√≠odo: 01/${e}/${t} - ${a}/${e}/${t}
`,r+=`‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

`,S.value.length>0){const s=S.value.reduce((o,n)=>o+c(n.TotalKg),0);r+=`üì¶ *RESIDUOS DEL PERIODO (${p})*
`,r+=`Total: *${Math.round(s).toLocaleString()} kg*

`,S.value.forEach(o=>{const n=s>0?(c(o.TotalKg)/s*100).toFixed(1):"0.0";r+=`‚Ä¢ ${o.DESC_MOTIVO}: ${Math.round(c(o.TotalKg)).toLocaleString()} kg (${n}%)
`}),r+=`
`}if(_.value.length>0){const s=_.value.reduce((o,n)=>o+c(n.count),0);r+=`üè≠ *PRODUCCI√ìN √çNDIGO DEL PERIODO*
`,r+=`Total registros: *${s.toLocaleString()}*

`,_.value.forEach(o=>{const n=s>0?(c(o.count)/s*100).toFixed(1):"0.0";r+=`‚Ä¢ ${o.S}: ${c(o.count).toLocaleString()} (${n}%)
`}),r+=`
`}if(C.value.length>0){const s=C.value.reduce((o,n)=>o+c(n.TotalKg),0);r+=`‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
`,r+=`üì¶ *RESIDUOS DEL D√çA ${a}/${e}/${t}*
`,r+=`Total: *${Math.round(s).toLocaleString()} kg*

`,C.value.forEach(o=>{const n=s>0?(c(o.TotalKg)/s*100).toFixed(1):"0.0";r+=`‚Ä¢ ${o.DESC_MOTIVO}: ${Math.round(c(o.TotalKg)).toLocaleString()} kg (${n}%)
`}),r+=`
`}if(D.value.length>0){const s=D.value.reduce((o,n)=>o+c(n.count),0);r+=`üè≠ *PRODUCCI√ìN √çNDIGO DEL D√çA*
`,r+=`Total registros: *${s.toLocaleString()}*

`,D.value.forEach(o=>{const n=s>0?(c(o.count)/s*100).toFixed(1):"0.0";r+=`‚Ä¢ ${o.S}: ${c(o.count).toLocaleString()} (${n}%)
`})}r+=`
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
`,r+=`üìä Reporte generado: ${new Date().toLocaleString("es-ES")}`,await navigator.clipboard.writeText(r),Z.fire({toast:!0,position:"top-end",icon:"success",title:"Copiado al portapapeles",text:"Presiona Ctrl+V para pegar en WhatsApp",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}catch(t){console.error("Error al copiar:",t),Z.fire({toast:!0,position:"top-end",icon:"error",title:"Error al copiar",text:"No se pudo copiar el mensaje",showConfirmButton:!1,timer:3e3})}},Se=async()=>{if(H.value)try{const t=Math.max(1,window.devicePixelRatio||1)*2,e=30,a=40,l=e,r=l+a+e,s=H.value.getBoundingClientRect(),o=Array.from(H.value.querySelectorAll("canvas"));if(o.length===0)throw new Error("No hay canvases para copiar");let n=1/0,g=1/0,$=-1/0,I=-1/0;const B=o.map(i=>i.getBoundingClientRect());B.forEach(i=>{const y=i.left-s.left,v=i.top-s.top;n=Math.min(n,y),g=Math.min(g,v),$=Math.max($,y+i.width),I=Math.max(I,v+i.height)});const q=Math.ceil($-n),F=Math.ceil(I-g),oe=Math.round((q+e*2)*t),se=Math.round((r+F+e)*t),M=document.createElement("canvas");M.width=oe,M.height=se;const E=M.getContext("2d");E.fillStyle="#ffffff",E.fillRect(0,0,M.width,M.height);const R=document.querySelector('main img[alt="Santana Textiles"]');let u=e;const L=40;if(R)try{if(R.complete){const i=R.getBoundingClientRect(),y=i.width&&i.height?i.width/i.height:1,v=L*y;E.drawImage(R,u*t,l*t,v*t,L*t),u+=v+16}else{const i=new Image;i.src=R.src,await new Promise(x=>{i.onload=x,i.onerror=x});const y=i.width&&i.height?i.width/i.height:1,v=L*y;E.drawImage(i,u*t,l*t,v*t,L*t),u+=v+16}}catch{}E.fillStyle="#0f172a",E.font=`${16*t}px sans-serif`,E.fillText("An√°lisis Residuos de √çndigo",u*t,(l+26)*t),o.forEach((i,y)=>{const v=B[y],x=v.left-s.left,ne=v.top-s.top,J=(e+(x-n))*t,d=(r+(ne-g))*t,O=v.width*t,m=v.height*t;try{const j=i.width||v.width*(window.devicePixelRatio||1),Y=i.height||v.height*(window.devicePixelRatio||1);E.drawImage(i,0,0,j,Y,J,d,O,m)}catch{try{const Y=i.toDataURL("image/png"),h=new Image;h.src=Y,h.onload=()=>{E.drawImage(h,J,d,O,m)}}catch(Y){console.warn("No se pudo dibujar canvas:",Y)}}}),await new Promise(i=>setTimeout(i,50));const K=await new Promise(i=>M.toBlob(i,"image/png",1));if(!K)throw new Error("No se pudo generar la imagen");try{await navigator.clipboard.write([new ClipboardItem({"image/png":K})]),Z.fire({toast:!0,position:"top-end",icon:"success",title:"Imagen copiada al portapapeles",text:"Presiona Ctrl+V para pegar",showConfirmButton:!1,timer:3e3,timerProgressBar:!0});return}catch(i){console.warn("Escritura de imagen en portapapeles fall√≥, intentando fallback:",i)}try{const i=M.toDataURL("image/png");await navigator.clipboard.writeText(i),Z.fire({toast:!0,position:"top-end",icon:"success",title:"DataURL copiado al portapapeles",text:"Algunos destinos no pegar√°n esta entrada como imagen; guarda la imagen manualmente si es necesario.",showConfirmButton:!1,timer:3500,timerProgressBar:!0});return}catch(i){console.warn("Fallback writeText fall√≥:",i)}try{const i=M.toDataURL("image/png"),y=window.open("","_blank");if(y){y.document.write(`<html><head><title>Imagen</title></head><body style="margin:0"><img src="${i}" style="max-width:100%;height:auto;display:block;margin:0 auto;"/></body></html>`),y.document.close(),Z.fire({toast:!0,position:"top-end",icon:"info",title:"Imagen abierta en nueva pesta√±a",text:"Gu√°rdala o c√≥piala manualmente.",showConfirmButton:!1,timer:3500,timerProgressBar:!0});return}}catch(i){console.warn("Abrir nueva pesta√±a fall√≥:",i)}throw new Error("No se pudo copiar la imagen ni realizar fallbacks")}catch(t){console.error("Error al copiar imagen:",t),Z.fire({toast:!0,position:"top-end",icon:"error",title:"Error al generar imagen",text:t.message||"No se pudo crear la imagen",showConfirmButton:!1,timer:3e3})}};async function _e(){if(!H.value){window.print();return}try{const t=Math.max(1,window.devicePixelRatio||1)*2,e=20,a=16,l=35,p=e,s=p+l+e,o=H.value.getBoundingClientRect(),n=Array.from(H.value.querySelectorAll("canvas"));if(n.length===0)throw new Error("No hay canvases para imprimir");const g=n.map(d=>d.getBoundingClientRect());let $=1/0,I=1/0,B=-1/0,q=-1/0;g.forEach((d,O)=>{const m=d.left-o.left,j=d.top-o.top;$=Math.min($,m),I=Math.min(I,j),B=Math.max(B,m+d.width),q=Math.max(q,j+d.height)});const F=1.2,oe=Math.ceil((B-$)*F),se=Math.ceil((q-I)*F),M=Math.round((oe+e*2)*t),E=Math.round((s+se+e)*t),R=document.createElement("canvas");R.width=M,R.height=E;const u=R.getContext("2d");u.fillStyle="#ffffff",u.fillRect(0,0,R.width,R.height);const L=document.querySelector('main img[alt="Santana Textiles"]');let K=e;const i=35;if(L)try{if(L.complete){const d=L.getBoundingClientRect(),O=d.width&&d.height?d.width/d.height:1,m=i*O;u.drawImage(L,K*t,p*t,m*t,i*t),K+=m+16}else{const d=new Image;d.src=L.src,await new Promise(j=>{d.onload=j,d.onerror=j});const O=d.width&&d.height?d.width/d.height:1,m=i*O;u.drawImage(d,K*t,p*t,m*t,i*t),K+=m+16}}catch{}u.fillStyle="#0f172a",u.font=`bold ${16*t}px sans-serif`,u.fillText("An√°lisis Residuos de √çndigo",K*t,(p+24)*t);const y="rgb(226, 232, 240)",v=1*t,x=4*t;n.forEach((d,O)=>{const m=g[O],j=m.left-o.left,Y=m.top-o.top,h=(e+(j-$)*F)*t,w=(s+(Y-I)*F)*t,V=m.width*F*t,W=m.height*F*t;try{const me=d.width||m.width*(window.devicePixelRatio||1),ae=d.height||m.height*(window.devicePixelRatio||1);u.drawImage(d,0,0,me,ae,h,w,V,W)}catch{try{const ae=d.toDataURL("image/png"),ie=new Image;ie.src=ae,ie.onload=()=>{u.drawImage(ie,h,w,V,W)}}catch(ae){console.warn("No se pudo dibujar canvas:",ae)}}u.strokeStyle=y,u.lineWidth=v,u.beginPath(),u.moveTo(h+x,w),u.lineTo(h+V-x,w),u.quadraticCurveTo(h+V,w,h+V,w+x),u.lineTo(h+V,w+W-x),u.quadraticCurveTo(h+V,w+W,h+V-x,w+W),u.lineTo(h+x,w+W),u.quadraticCurveTo(h,w+W,h,w+W-x),u.lineTo(h,w+x),u.quadraticCurveTo(h,w,h+x,w),u.closePath(),u.stroke()}),await new Promise(d=>setTimeout(d,50));const ne=R.toDataURL("image/png",1),J=window.open("","_blank","width=1200,height=800");if(!J)throw new Error("No se pudo abrir la ventana de impresi√≥n. Verifica que los pop-ups est√©n permitidos.");J.document.write(`
      <!DOCTYPE html>
      <html>
      <head>
        <title>An√°lisis Residuos √çndigo - Impresi√≥n</title>
        <style>
          @page {
            size: landscape;
            margin: 5mm 5mm 10mm 5mm;
          }
          body {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: flex-start;
          }
          img {
            max-width: 100%;
            max-height: 100vh;
            object-fit: contain;
          }
          @media print {
            body {
              -webkit-print-color-adjust: exact;
              print-color-adjust: exact;
            }
          }
        </style>
      </head>
      <body>
        <img src="${ne}" onload="setTimeout(function() { window.print(); window.close(); }, 200);" />
      </body>
      </html>
    `),J.document.close()}catch(t){console.error("Error al imprimir:",t),Z.fire({toast:!0,position:"top-end",icon:"error",title:"Error al preparar impresi√≥n",text:t.message||"No se pudo generar la imagen para imprimir",showConfirmButton:!1,timer:3e3})}}return Ne(()=>{ce()}),(t,e)=>{const a=Be("tippy");return b(),A("div",Fe,[f("main",Ke,[f("div",Ve,[e[4]||(e[4]=f("div",{class:"flex items-center gap-6"},[f("img",{src:Ce,alt:"Santana Textiles",class:"h-10 w-auto object-contain"}),f("h3",{class:"text-lg font-semibold text-slate-800"},"An√°lisis Residuos de √çndigo")],-1)),f("div",We,[re((b(),A("button",{onClick:_e,class:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-md transition-colors shadow-sm"},[...e[1]||(e[1]=[ve('<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-34c24df8><polyline points="6 9 6 2 18 2 18 9" data-v-34c24df8></polyline><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2" data-v-34c24df8></path><rect x="6" y="14" width="12" height="8" data-v-34c24df8></rect></svg><span class="text-sm" data-v-34c24df8>Imprimir</span>',2)])])),[[a,{content:"Imprimir p√°gina en orientaci√≥n apaisada",placement:"bottom"}]]),re((b(),A("button",{onClick:Se,class:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors shadow-sm"},[...e[2]||(e[2]=[ve('<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-34c24df8><rect x="3" y="3" width="18" height="18" rx="2" ry="2" data-v-34c24df8></rect><circle cx="8.5" cy="8.5" r="1.5" data-v-34c24df8></circle><polyline points="21 15 16 10 5 21" data-v-34c24df8></polyline></svg><span class="text-sm" data-v-34c24df8>Imagen</span>',2)])])),[[a,{content:"Copiar gr√°ficos como imagen",placement:"bottom"}]]),re((b(),A("button",{onClick:ke,class:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-green-600 hover:bg-green-700 text-white font-medium rounded-md transition-colors shadow-sm"},[...e[3]||(e[3]=[f("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor"},[f("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"})],-1),f("span",{class:"text-sm"},"WhatsApp",-1)])])),[[a,{content:"Copiar resumen de an√°lisis para WhatsApp",placement:"bottom"}]]),Pe(De,{modelValue:U.value,"onUpdate:modelValue":e[0]||(e[0]=l=>U.value=l),label:"Hasta:","show-buttons":!0,onChange:ce},null,8,["modelValue"])])]),f("div",{ref_key:"chartsContainer",ref:H,class:"flex-1 min-h-0 relative flex flex-col gap-4"},[z.value?(b(),A("div",He,[...e[5]||(e[5]=[f("div",{class:"animate-spin rounded-full h-12 w-12 border-4 border-blue-600 border-t-transparent"},null,-1)])])):G("",!0),f("div",Ue,[f("div",qe,[de.value?(b(),ee(te(Q),{key:0,data:de.value,options:be.value},null,8,["data","options"])):z.value?G("",!0):(b(),A("div",Ye," No hay datos para el per√≠odo seleccionado "))]),f("div",Ze,[ue.value?(b(),ee(te(Q),{key:0,data:ue.value,options:we.value},null,8,["data","options"])):z.value?G("",!0):(b(),A("div",Ge," No hay datos disponibles "))]),f("div",Xe,[he.value?(b(),ee(te(Q),{key:0,data:he.value,options:$e.value},null,8,["data","options"])):z.value?G("",!0):(b(),A("div",Je," No hay datos disponibles "))])]),f("div",Qe,[f("div",et,[pe.value?(b(),ee(te(Q),{key:0,data:pe.value,options:ye.value},null,8,["data","options"])):z.value?G("",!0):(b(),A("div",tt," No hay datos para el d√≠a seleccionado "))]),f("div",at,[ge.value?(b(),ee(te(Q),{key:0,data:ge.value,options:xe.value},null,8,["data","options"])):z.value?G("",!0):(b(),A("div",ot," No hay datos disponibles "))]),f("div",st,[fe.value?(b(),ee(te(Q),{key:0,data:fe.value,options:Re.value},null,8,["data","options"])):z.value?G("",!0):(b(),A("div",nt," No hay datos disponibles "))])])],512)])])}}},mt=Oe(it,[["__scopeId","data-v-34c24df8"]]);export{mt as default};
