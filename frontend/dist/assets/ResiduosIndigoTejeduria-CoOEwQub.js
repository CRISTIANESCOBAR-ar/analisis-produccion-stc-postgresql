import{_ as We}from"./LogoSantana-C2JneU89.js";import{C as ut}from"./CustomDatepicker-T-NwqAgo.js";import{_ as Ge,m as k,w as ze,z as Je,a as b,B as qe,x as Ye,c as m,i as De,b as t,f as xe,d as he,F as ie,r as de,t as l,n as ce,e as be,T as Ze,p as V,o as Qe,u as Ve}from"./index-Bya99iyG.js";import{d as Xe}from"./index-DU49Dbn9.js";import{E as He}from"./exceljs.min-DtXTVuKQ.js";import{S as W}from"./sweetalert2.esm.all-AlKuj1Cq.js";import{u as pt}from"./useDatabase-BBnNwozE.js";const gt={class:"modal-container bg-white rounded-xl shadow-2xl w-full max-w-7xl max-h-[90vh] flex flex-col"},ft={class:"modal-header px-6 py-4 border-b border-slate-200 flex items-center justify-between flex-shrink-0"},ht={class:"flex items-center gap-4"},xt={class:"flex items-center gap-2"},bt=["value"],vt={class:"flex items-center gap-3"},mt={key:0,class:"absolute top-20 left-1/2 -translate-x-1/2 bg-white border border-slate-200 rounded-lg shadow-xl p-3 z-50"},yt={class:"calendar-header flex justify-between items-center mb-3"},wt={class:"calendar-selects flex gap-1"},_t=["value"],Ft=["value"],Ct=["value"],Tt=["value"],Et={class:"grid grid-cols-7 gap-1 mb-2"},Dt={class:"grid grid-cols-7 gap-1"},At=["onClick","disabled"],Rt={class:"modal-body flex-1 overflow-auto p-6"},kt={key:0,class:"flex items-center justify-center py-12"},jt={key:1,class:"flex items-center justify-center py-12"},St={key:2},$t={class:"flex items-center gap-4 mb-4 flex-wrap"},Kt=["checked","onChange"],It={class:"text-slate-500"},Pt={class:"text-xs text-slate-600 font-medium ml-auto"},Mt={class:"border border-slate-200 rounded-lg overflow-hidden"},Ot={class:"overflow-auto max-h-96"},Bt={class:"divide-y divide-slate-100"},Lt={class:"px-3 py-2 text-slate-900 whitespace-nowrap w-[100px]"},Ut={class:"px-3 py-2 text-center font-semibold w-[60px]"},Nt={class:"px-3 py-2 text-slate-700 font-mono text-xs w-[100px]"},Vt={class:"px-3 py-2 text-slate-700 w-[140px]"},zt={class:"px-3 py-2 text-right font-mono text-slate-600 w-[80px]"},Ht={class:"px-3 py-2 text-right font-mono font-semibold text-blue-700 w-[120px]"},Wt={class:"px-3 py-2 text-right font-mono text-slate-600 w-[80px]"},Gt={class:"px-3 py-2 text-right font-mono text-slate-600 w-[80px]"},Jt={class:"px-3 py-2 text-center text-slate-600 w-[70px]"},qt={class:"px-3 py-2 text-slate-700 text-xs w-[150px]"},Yt={class:"px-3 py-2 text-slate-700 font-mono text-xs w-[120px]"},Zt={class:"px-3 py-2 text-center text-slate-600 w-[90px]"},Qt={class:"px-3 py-2 text-center text-slate-600 w-[70px]"},Xt={class:"px-3 py-2 text-slate-600 text-xs"},eo={class:"bg-slate-100 border-t-2 border-slate-300"},to={class:"px-3 py-2 text-right font-mono font-bold text-blue-800 w-[120px]"},oo={key:3,class:"mt-6 pt-6 border-t-2 border-slate-300"},so={class:"flex items-center gap-4 mb-4 flex-wrap"},ro=["checked","onChange"],ao={class:"text-slate-500"},lo={class:"text-xs text-slate-600 font-medium ml-auto"},no={class:"border border-slate-200 rounded-lg overflow-hidden"},io={class:"overflow-auto max-h-64"},co={class:"divide-y divide-slate-100"},uo={class:"px-3 py-2 text-slate-900 whitespace-nowrap w-[100px]"},po={class:"px-3 py-2 text-center font-semibold w-[60px]"},go={class:"px-3 py-2 text-slate-700 font-mono text-xs w-[120px]"},fo={class:"px-3 py-2 text-slate-700"},ho={class:"px-3 py-2 text-right font-mono text-slate-600 w-[100px]"},xo={class:"px-3 py-2 text-right font-mono font-semibold text-blue-700 w-[140px]"},bo={class:"px-3 py-2 text-slate-600 text-xs w-[150px]"},vo={class:"bg-slate-100 border-t-2 border-slate-300"},mo={class:"px-3 py-2 text-right font-mono font-bold text-blue-800 w-[140px]"},yo={__name:"DetalleResiduosModal",props:{show:{type:Boolean,default:!1},fechaInicial:{type:String,default:""}},emits:["close"],setup(we,{emit:_e}){const Y=we,ve=_e,N="".replace(/\/$/,""),Q=N?`${N}/api`:"/api",X=k(!1),P=k([]),G=k([]),U=k(""),J=k(!1),ee=k(null),te=k(null),oe=k(["ESTOPA AZUL"]),T=k(["ESTOPA AZUL TEJEDUR√çA"]),B=V(()=>{const s=new Set;return P.value.forEach(e=>{e.DESCRICAO&&s.add(e.DESCRICAO)}),Array.from(s).sort()}),ke=V(()=>{const s=new Set;return G.value.forEach(e=>{e.DESCRICAO&&s.add(e.DESCRICAO)}),Array.from(s).sort()}),M=V(()=>{const s={};return P.value.forEach(e=>{e.DESCRICAO&&(s[e.DESCRICAO]=(s[e.DESCRICAO]||0)+1)}),s}),se=V(()=>{const s={};return G.value.forEach(e=>{e.DESCRICAO&&(s[e.DESCRICAO]=(s[e.DESCRICAO]||0)+1)}),s}),le=V(()=>oe.value.length===0?P.value:P.value.filter(s=>oe.value.includes(s.DESCRICAO))),ue=V(()=>T.value.length===0?G.value:G.value.filter(s=>T.value.includes(s.DESCRICAO))),re=V(()=>le.value.reduce((s,e)=>{const r=parseFloat(e["PESO LIQUIDO (KG)"])||0;return s+r},0)),a=V(()=>ue.value.reduce((s,e)=>{const r=parseFloat(e["PESO LIQUIDO (KG)"])||0;return s+r},0)),p=s=>{const e=oe.value.indexOf(s);e>-1?oe.value.splice(e,1):oe.value.push(s)},F=s=>{const e=T.value.indexOf(s);e>-1?T.value.splice(e,1):T.value.push(s)},C=k(new Date().getMonth()),I=k(new Date().getFullYear()),ne=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],me=V(()=>{const s=new Date().getFullYear(),e=[];for(let r=2020;r<=s+1;r++)e.push(r);return e}),ae=V(()=>{if(!U.value)return"";const[s,e,r]=U.value.split("-");return`${r}/${e}/${s}`}),Me=V(()=>{const s=[],e=new Date(I.value,C.value,1),r=new Date(I.value,C.value+1,0),o=new Date(I.value,C.value,0),n=e.getDay(),x=r.getDate(),_=o.getDate();for(let v=n-1;v>=0;v--)s.push({dia:_-v,otroMes:!0,key:`prev-${_-v}`});const g=U.value?new Date(U.value+"T00:00:00"):null;for(let v=1;v<=x;v++)s.push({dia:v,otroMes:!1,seleccionado:g&&g.getDate()===v&&g.getMonth()===C.value&&g.getFullYear()===I.value,key:`current-${v}`});const i=42-s.length;for(let v=1;v<=i;v++)s.push({dia:v,otroMes:!0,key:`next-${v}`});return s});ze(()=>Y.show,s=>{if(s&&Y.fechaInicial){U.value=Y.fechaInicial;const[e,r]=Y.fechaInicial.split("-");C.value=parseInt(r)-1,I.value=parseInt(e),Fe()}});const je=s=>{s.key==="Escape"&&Y.show&&Re()};ze(()=>Y.show,s=>{s?document.addEventListener("keydown",je):(document.removeEventListener("keydown",je),J.value=!1)});const Fe=async()=>{if(U.value){X.value=!0;try{const[s,e,r]=U.value.split("-"),o=`${r}/${e}/${s}`,[n,x]=await Promise.all([fetch(`${Q}/detalle-residuos?fecha=${o}`),fetch(`${Q}/detalle-residuos-sector?fecha=${o}`)]);if(!n.ok||!x.ok)throw new Error("Error al cargar datos");P.value=await n.json(),G.value=await x.json()}catch(s){console.error("Error:",s),P.value=[],G.value=[]}finally{X.value=!1}}},Ce=s=>{if(!U.value)return;const[e,r,o]=U.value.split("-"),n=new Date(parseInt(e),parseInt(r)-1,parseInt(o));n.setDate(n.getDate()+s);const x=n.getFullYear(),_=String(n.getMonth()+1).padStart(2,"0"),g=String(n.getDate()).padStart(2,"0");U.value=`${x}-${_}-${g}`,C.value=n.getMonth(),I.value=n.getFullYear(),Fe()},Se=s=>{C.value+=s,C.value>11?(C.value=0,I.value++):C.value<0&&(C.value=11,I.value--)},Ae=s=>{if(s.otroMes)return;const e=I.value,r=String(C.value+1).padStart(2,"0"),o=String(s.dia).padStart(2,"0");U.value=`${e}-${r}-${o}`,J.value=!1,Fe()},Re=()=>{ve("close")},Te=s=>{if(!s)return"";const e=typeof s=="string"?s.replace(".","").replace(",","."):s;return new Intl.NumberFormat("es-AR",{minimumFractionDigits:0,maximumFractionDigits:2}).format(parseFloat(e))},Oe=async()=>{var s;if(ee.value)try{await new Promise(f=>setTimeout(f,100)),(s=document.fonts)!=null&&s.ready&&await document.fonts.ready;const e=document.createElement("div");e.style.position="fixed",e.style.left="0",e.style.top="0",e.style.zIndex="-1",e.style.opacity="1",e.style.visibility="hidden",e.style.pointerEvents="none",e.style.background="#ffffff",e.style.padding="20px",e.style.boxSizing="border-box",e.style.overflow="visible";const r=document.createElement("div");r.style.display="flex",r.style.alignItems="center",r.style.justifyContent="space-between",r.style.marginBottom="16px",r.style.width="100%";const o=document.createElement("div");o.style.display="flex",o.style.alignItems="center",o.style.gap="16px";const n=document.createElement("img");n.src="/LogoSantana.jpg",n.style.height="32px",n.style.width="auto",n.style.marginLeft="4px",o.appendChild(n);const x=document.createElement("h2");x.textContent="Detalle de Residuos",x.className="text-xl font-bold text-slate-800",o.appendChild(x);const _=document.createElement("div");_.className="text-sm font-semibold text-slate-700",_.textContent=`Fecha: ${ae.value}`,_.style.paddingRight="4px",r.appendChild(o),r.appendChild(_),e.appendChild(r);const g=ee.value.cloneNode(!0);g.style.width=`${ee.value.scrollWidth}px`,g.style.maxWidth="none",g.style.overflow="visible",g.style.borderCollapse="collapse",e.appendChild(g);let i=null;if(te.value&&G.value.length>0){const f=document.createElement("div");f.style.marginTop="24px",f.style.marginBottom="16px",f.style.borderTop="2px solid #cbd5e1",e.appendChild(f);const E=document.createElement("h3");E.textContent="Residuos por Sector",E.style.fontSize="0.875rem",E.style.fontWeight="bold",E.style.color="#1e293b",E.style.marginBottom="12px",e.appendChild(E),i=te.value.cloneNode(!0),i.style.width=`${te.value.scrollWidth}px`,i.style.maxWidth="none",i.style.overflow="visible",i.style.borderCollapse="collapse",e.appendChild(i),Array.from(i.querySelectorAll(".sticky")).forEach(A=>{A.classList.remove("sticky","top-0","z-10"),A.style.position="static",A.style.top="auto",A.style.zIndex="auto"})}Array.from(g.querySelectorAll(".sticky")).forEach(f=>{f.classList.remove("sticky","top-0","z-10"),f.style.position="static",f.style.top="auto",f.style.zIndex="auto"}),document.body.appendChild(e);const j=Array.from(e.querySelectorAll("img"));await Promise.all(j.map(f=>f.complete&&f.naturalWidth>0?Promise.resolve():new Promise(E=>{const S=()=>E();f.addEventListener("load",S,{once:!0}),f.addEventListener("error",S,{once:!0})})));const w=20*2,D=20*2,O=Math.max(r.scrollWidth,g.scrollWidth,i?i.scrollWidth:0);let z=r.scrollHeight+g.scrollHeight+16;i&&(z+=42+i.scrollHeight),r.style.width=`${O}px`,e.style.width=`${O+w+40}px`,e.style.height=`${z+D}px`,e.getBoundingClientRect(),e.style.visibility="visible",await new Promise(requestAnimationFrame);let H;try{H=await Xe(e,{scale:2,backgroundColor:"#ffffff",width:O+w+40,height:z+D})}finally{e.isConnected&&document.body.removeChild(e)}const pe=await(await fetch(H)).blob();try{await navigator.clipboard.write([new ClipboardItem({"image/png":pe})]),W.fire({toast:!0,position:"top-end",icon:"success",title:"Imagen copiada al portapapeles",text:"Presiona Ctrl+V para pegar en WhatsApp o correo",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}catch(f){console.warn("No se pudo copiar al portapapeles, descargando archivo:",f);const E=`Detalle_Residuos_${ae.value.replace(/\//g,"-")}.png`,S=URL.createObjectURL(pe),A=document.createElement("a");A.href=S,A.download=E,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(S),W.fire({toast:!0,position:"top-end",icon:"info",title:"Imagen descargada",text:"Guardada en tu carpeta de Descargas",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}}catch(e){console.error("Error al exportar:",e),W.fire({toast:!0,position:"top-end",icon:"error",title:"Error al exportar",text:e.message,showConfirmButton:!1,timer:4e3,timerProgressBar:!0})}},Be=async()=>{try{const s=new He.Workbook,e=s.addWorksheet("√çNDIGO");e.columns=[{header:"Fecha",key:"fecha",width:12},{header:"Turno",key:"turno",width:8},{header:"Sub-producto",key:"subproducto",width:15},{header:"Tipo",key:"tipo",width:20},{header:"ID",key:"id",width:10},{header:"Peso L√≠quido (KG)",key:"peso",width:18},{header:"Partida",key:"partida",width:10},{header:"Rolada",key:"rolada",width:10},{header:"Motivo",key:"motivo",width:10},{header:"Descripci√≥n Motivo",key:"desc_motivo",width:25},{header:"Base",key:"base",width:20},{header:"PE DE ROLO",key:"pe_rolo",width:12},{header:"GAIOLA",key:"gaiola",width:10},{header:"OBS",key:"obs",width:30}];const r=e.getRow(1);r.height=30;for(let i=1;i<=14;i++){const v=r.getCell(i);v.font={bold:!0,color:{argb:"FF334155"}},v.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF8FAFC"}},v.alignment={horizontal:"center",vertical:"middle"},v.border={top:{style:"thin",color:{argb:"FFE2E8F0"}},bottom:{style:"medium",color:{argb:"FFCBD5E1"}},left:{style:"thin",color:{argb:"FFE2E8F0"}},right:{style:"thin",color:{argb:"FFE2E8F0"}}}}le.value.forEach(i=>{e.addRow({fecha:i.DT_MOV,turno:i.TURNO,subproducto:i.SUBPRODUTO||i.subproduto||i.Subproducto,tipo:i.DESCRICAO,id:i.ID,peso:parseFloat(i["PESO LIQUIDO (KG)"])||0,partida:i.PARTIDA,rolada:i.ROLADA,motivo:i.MOTIVO,desc_motivo:i.DESC_MOTIVO,base:i.URDUME,pe_rolo:i["PE DE ROLO"],gaiola:i.GAIOLA,obs:i.OBS})});const o=e.addRow({tipo:"TOTAL",peso:re.value});if(o.height=25,e.eachRow((i,v)=>{if(v===1)return;const j=v===e.rowCount;for(let w=1;w<=14;w++){const D=i.getCell(w);D.border={top:{style:j?"medium":"thin",color:{argb:j?"FFCBD5E1":"FFE2E8F0"}},bottom:{style:"thin",color:{argb:"FFE2E8F0"}},left:{style:"thin",color:{argb:"FFE2E8F0"}},right:{style:"thin",color:{argb:"FFE2E8F0"}}},D.alignment={horizontal:"center",vertical:"middle"},j&&(D.font={bold:!0,color:{argb:"FF1E293B"}},D.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF1F5F9"}})}i.getCell("peso").numFmt="#,##0",j&&(i.getCell("peso").font={bold:!0,color:{argb:"FF1D4ED8"}})}),e.pageSetup={orientation:"landscape",fitToPage:!0,fitToWidth:1,fitToHeight:0,printArea:`A1:N${e.rowCount}`,margins:{left:.196850393700787,right:.196850393700787,top:.196850393700787,bottom:.393700787401575,header:.196850393700787,footer:.196850393700787}},G.value.length>0){const i=s.addWorksheet("TEJEDUR√çA");i.columns=[{header:"Fecha",key:"fecha",width:12},{header:"Turno",key:"turno",width:8},{header:"Sub-producto",key:"subproducto",width:15},{header:"Descripci√≥n",key:"descripcion",width:30},{header:"ID",key:"id",width:10},{header:"Peso L√≠quido (KG)",key:"peso",width:18},{header:"OBS",key:"obs",width:30}];const v=i.getRow(1);v.height=30;for(let w=1;w<=7;w++){const D=v.getCell(w);D.font={bold:!0,color:{argb:"FF334155"}},D.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF8FAFC"}},D.alignment={horizontal:"center",vertical:"middle"},D.border={top:{style:"thin",color:{argb:"FFE2E8F0"}},bottom:{style:"medium",color:{argb:"FFCBD5E1"}},left:{style:"thin",color:{argb:"FFE2E8F0"}},right:{style:"thin",color:{argb:"FFE2E8F0"}}}}ue.value.forEach(w=>{i.addRow({fecha:w.DT_MOV,turno:w.TURNO,subproducto:w.SUBPRODUTO||w.subproduto||w.Subproducto,descripcion:w.DESCRICAO,id:w.ID,peso:parseFloat(w["PESO LIQUIDO (KG)"])||0,obs:w.OBS})});const j=i.addRow({descripcion:"TOTAL",peso:a.value});j.height=25,i.eachRow((w,D)=>{if(D===1)return;const O=D===i.rowCount;for(let z=1;z<=7;z++){const H=w.getCell(z);H.border={top:{style:O?"medium":"thin",color:{argb:O?"FFCBD5E1":"FFE2E8F0"}},bottom:{style:"thin",color:{argb:"FFE2E8F0"}},left:{style:"thin",color:{argb:"FFE2E8F0"}},right:{style:"thin",color:{argb:"FFE2E8F0"}}},H.alignment={horizontal:"center",vertical:"middle"},O&&(H.font={bold:!0,color:{argb:"FF1E293B"}},H.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF1F5F9"}})}w.getCell("peso").numFmt="#,##0",O&&(w.getCell("peso").font={bold:!0,color:{argb:"FFBE123C"}})}),i.pageSetup={orientation:"landscape",fitToPage:!0,fitToWidth:1,fitToHeight:0,printArea:`A1:G${i.rowCount}`,margins:{left:.196850393700787,right:.196850393700787,top:.196850393700787,bottom:.393700787401575,header:.196850393700787,footer:.196850393700787}}}const n=await s.xlsx.writeBuffer(),x=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),_=URL.createObjectURL(x),g=document.createElement("a");g.href=_,g.download=`Detalle_Residuos_${ae.value.replace(/\//g,"-")}.xlsx`,g.click(),URL.revokeObjectURL(_),W.fire({toast:!0,position:"top-end",icon:"success",title:"Excel generado",showConfirmButton:!1,timer:2e3})}catch(s){console.error("Error al exportar Excel:",s),W.fire("Error","No se pudo generar el archivo Excel","error")}};return(s,e)=>{const r=Je("tippy");return b(),qe(Ze,{name:"modal"},{default:Ye(()=>[we.show?(b(),m("div",{key:0,class:"modal-overlay fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:De(Re,["self"])},[t("div",gt,[t("div",ft,[t("div",ht,[e[11]||(e[11]=t("img",{src:We,alt:"Santana Textiles",class:"h-8 w-auto object-contain"},null,-1)),e[12]||(e[12]=t("h2",{class:"text-xl font-bold text-slate-800"},"Detalle de Residuos",-1)),t("div",xt,[xe((b(),m("button",{class:"inline-flex items-center justify-center w-8 h-8 border border-slate-200 bg-white text-slate-700 rounded-md hover:bg-slate-50 transition-colors",onClick:e[0]||(e[0]=o=>Ce(-1))},[...e[9]||(e[9]=[he("<",-1)])])),[[r,{content:"D√≠a anterior",placement:"bottom"}]]),t("input",{type:"text",value:ae.value,class:"w-28 px-3 py-1.5 border border-slate-300 rounded-md text-sm text-center focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 cursor-pointer bg-white",onClick:e[1]||(e[1]=o=>J.value=!J.value),readonly:""},null,8,bt),xe((b(),m("button",{class:"inline-flex items-center justify-center w-8 h-8 border border-slate-200 bg-white text-slate-700 rounded-md hover:bg-slate-50 transition-colors",onClick:e[2]||(e[2]=o=>Ce(1))},[...e[10]||(e[10]=[he(">",-1)])])),[[r,{content:"D√≠a siguiente",placement:"bottom"}]])])]),t("div",vt,[xe((b(),m("button",{onClick:Oe,class:"inline-flex items-center gap-2 px-4 py-0 h-[34px] bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-colors shadow-sm"},[...e[13]||(e[13]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M12.04 2c-5.46 0-9.91 4.45-9.91 9.91 0 1.75.46 3.45 1.32 4.95L2.05 22l5.25-1.38c1.45.79 3.08 1.21 4.74 1.21 5.46 0 9.91-4.45 9.91-9.91 0-2.65-1.03-5.14-2.9-7.01C17.18 3.03 14.69 2 12.04 2m.01 1.67c2.2 0 4.26.86 5.82 2.42a8.225 8.225 0 0 1 2.41 5.83c0 4.54-3.7 8.23-8.24 8.23-1.48 0-2.93-.39-4.19-1.15l-.3-.17-3.12.82.83-3.04-.2-.32a8.188 8.188 0 0 1-1.26-4.38c.01-4.54 3.7-8.24 8.25-8.24M8.53 7.33c-.16 0-.43.06-.66.31-.22.25-.87.85-.87 2.07 0 1.22.89 2.39 1 2.56.14.17 1.76 2.67 4.25 3.73.59.27 1.05.42 1.41.53.59.19 1.13.16 1.56.1.48-.07 1.46-.6 1.67-1.18.21-.58.21-1.07.15-1.18-.07-.1-.23-.16-.48-.27-.25-.14-1.47-.74-1.69-.82-.23-.08-.37-.12-.56.12-.16.25-.64.81-.78.97-.15.17-.29.19-.53.07-.26-.13-1.06-.39-2-1.23-.74-.66-1.23-1.47-1.38-1.72-.12-.24-.01-.39.11-.5.11-.11.27-.29.37-.44.13-.14.17-.25.25-.41.08-.17.04-.31-.02-.43-.06-.11-.56-1.35-.77-1.84-.2-.48-.4-.42-.56-.43-.14 0-.3-.01-.47-.01z"})],-1),he(" WhatsApp ",-1)])])),[[r,{content:"Copiar tabla al portapapeles (WhatsApp o correo)",placement:"bottom"}]]),xe((b(),m("button",{onClick:Be,class:"inline-flex items-center gap-2 px-4 py-0 h-[34px] bg-emerald-600 hover:bg-emerald-700 text-white font-medium rounded-lg transition-colors shadow-sm"},[...e[14]||(e[14]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M12.9,14.5L15.8,19H14L12,15.6L10,19H8.2L11.1,14.5L8.2,10H10L12,13.4L14,10H15.8L12.9,14.5Z"})],-1),he(" Excel ",-1)])])),[[r,{content:"Exportar detalle a Excel (hojas separadas)",placement:"bottom"}]]),xe((b(),m("button",{class:"text-slate-400 hover:text-slate-600 transition-colors",onClick:Re},[...e[15]||(e[15]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])),[[r,{content:"Cerrar (Esc)",placement:"bottom"}]])])]),J.value?(b(),m("div",mt,[t("div",yt,[t("button",{class:"w-8 h-8 flex items-center justify-center border border-slate-200 rounded bg-white text-blue-600 hover:bg-blue-600 hover:text-white transition-colors",onClick:e[3]||(e[3]=De(o=>Se(-1),["stop"]))},"<"),t("div",wt,[t("select",{value:C.value,onChange:e[4]||(e[4]=o=>C.value=parseInt(o.target.value)),onClick:e[5]||(e[5]=De(()=>{},["stop"])),class:"text-sm font-semibold text-slate-700 bg-transparent border-none cursor-pointer hover:bg-slate-100 rounded px-1"},[(b(),m(ie,null,de(ne,(o,n)=>t("option",{key:n,value:n},l(o),9,Ft)),64))],40,_t),t("select",{value:I.value,onChange:e[6]||(e[6]=o=>I.value=parseInt(o.target.value)),onClick:e[7]||(e[7]=De(()=>{},["stop"])),class:"text-sm font-semibold text-slate-700 bg-transparent border-none cursor-pointer hover:bg-slate-100 rounded px-1"},[(b(!0),m(ie,null,de(me.value,o=>(b(),m("option",{key:o,value:o},l(o),9,Tt))),128))],40,Ct)]),t("button",{class:"w-8 h-8 flex items-center justify-center border border-slate-200 rounded bg-white text-blue-600 hover:bg-blue-600 hover:text-white transition-colors",onClick:e[8]||(e[8]=De(o=>Se(1),["stop"]))},">")]),t("div",Et,[(b(),m(ie,null,de(["D","L","M","M","J","V","S"],o=>t("span",{key:o,class:"text-center text-xs font-semibold text-slate-500 w-8"},l(o),1)),64))]),t("div",Dt,[(b(!0),m(ie,null,de(Me.value,o=>(b(),m("button",{key:o.key,class:ce(["w-8 h-8 flex items-center justify-center text-sm rounded transition-colors",{"text-slate-300 cursor-default":o.otroMes,"bg-blue-600 text-white font-semibold":o.seleccionado,"bg-white text-slate-700 hover:bg-blue-50":!o.seleccionado&&!o.otroMes}]),onClick:De(n=>Ae(o),["stop"]),disabled:o.otroMes},l(o.dia),11,At))),128))])])):be("",!0),t("div",Rt,[X.value?(b(),m("div",kt,[...e[16]||(e[16]=[t("div",{class:"flex flex-col items-center gap-3"},[t("div",{class:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600"}),t("span",{class:"text-sm text-slate-600"},"Cargando datos...")],-1)])])):P.value.length===0?(b(),m("div",jt,[...e[17]||(e[17]=[t("div",{class:"text-center"},[t("svg",{class:"w-16 h-16 text-slate-300 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})]),t("p",{class:"text-slate-500 text-sm"},"No hay registros para esta fecha")],-1)])])):(b(),m("div",St,[t("div",$t,[e[18]||(e[18]=t("h3",{class:"text-sm font-bold text-slate-800"},"√çNDIGO",-1)),(b(!0),m(ie,null,de(B.value,o=>(b(),m("label",{key:o,class:"flex items-center gap-1.5 text-xs text-slate-700 cursor-pointer hover:text-blue-600 transition-colors"},[t("input",{type:"checkbox",checked:oe.value.includes(o),onChange:n=>p(o),class:"w-3.5 h-3.5 text-blue-600 border-slate-300 rounded focus:ring-blue-500 cursor-pointer"},null,40,Kt),t("span",null,[he(l(o)+" ",1),t("span",It,"("+l(M.value[o]||0)+")",1)])]))),128)),t("span",Pt,l(le.value.length)+" registros",1)]),t("div",Mt,[e[21]||(e[21]=t("div",{class:"bg-slate-50 border-b-2 border-slate-300 overflow-hidden"},[t("table",{class:"w-full text-sm"},[t("thead",{class:"text-xs text-slate-700"},[t("tr",null,[t("th",{class:"px-3 py-2 font-bold text-left w-[100px]"},"Fecha"),t("th",{class:"px-3 py-2 font-bold text-center w-[60px]"},"Turno"),t("th",{class:"px-3 py-2 font-bold text-left w-[100px]"},"Sub-producto"),t("th",{class:"px-3 py-2 font-bold text-left w-[140px]"},"Tipo"),t("th",{class:"px-3 py-2 font-bold text-right w-[80px]"},"ID"),t("th",{class:"px-3 py-2 font-bold text-right w-[120px]"},"Peso L√≠quido (KG)"),t("th",{class:"px-3 py-2 font-bold text-right w-[80px]"},"Partida"),t("th",{class:"px-3 py-2 font-bold text-right w-[80px]"},"Rolada"),t("th",{class:"px-3 py-2 font-bold text-center w-[70px]"},"Motivo"),t("th",{class:"px-3 py-2 font-bold text-left w-[150px]"},"Descripci√≥n"),t("th",{class:"px-3 py-2 font-bold text-left w-[120px]"},"Base"),t("th",{class:"px-3 py-2 font-bold text-center w-[90px]"},"PE DE ROLO"),t("th",{class:"px-3 py-2 font-bold text-center w-[70px]"},"GAIOLA"),t("th",{class:"px-3 py-2 font-bold text-left flex-1"},"OBS")])])])],-1)),t("div",Ot,[t("table",{ref_key:"tablaDetalleRef",ref:ee,class:"w-full text-sm"},[t("tbody",Bt,[(b(!0),m(ie,null,de(le.value,(o,n)=>(b(),m("tr",{key:n,class:ce([n%2===0?"bg-white":"bg-slate-50","hover:bg-blue-50 transition-colors"])},[t("td",Lt,l(o.DT_MOV),1),t("td",Ut,l(o.TURNO),1),t("td",Nt,l(o.SUBPRODUTO||o.subproduto||o.Subproduto),1),t("td",Vt,l(o.DESCRICAO),1),t("td",zt,l(o.ID),1),t("td",Ht,l(Te(o["PESO LIQUIDO (KG)"])),1),t("td",Wt,l(o.PARTIDA),1),t("td",Gt,l(o.ROLADA),1),t("td",Jt,l(o.MOTIVO),1),t("td",qt,l(o.DESC_MOTIVO),1),t("td",Yt,l(o.URDUME),1),t("td",Zt,l(o["PE DE ROLO"]),1),t("td",Qt,l(o.GAIOLA),1),t("td",Xt,l(o.OBS),1)],2))),128)),t("tr",eo,[e[19]||(e[19]=t("td",{colspan:"5",class:"px-3 py-2 text-right font-bold text-slate-800"},"TOTAL:",-1)),t("td",to,l(Te(re.value)),1),e[20]||(e[20]=t("td",{colspan:"8"},null,-1))])])],512)])])])),G.value.length>0?(b(),m("div",oo,[t("div",so,[e[22]||(e[22]=t("h3",{class:"text-sm font-bold text-slate-800"},"TEJEDUR√çA",-1)),(b(!0),m(ie,null,de(ke.value,o=>(b(),m("label",{key:o,class:"flex items-center gap-1.5 text-xs text-slate-700 cursor-pointer hover:text-blue-600 transition-colors"},[t("input",{type:"checkbox",checked:T.value.includes(o),onChange:n=>F(o),class:"w-3.5 h-3.5 text-blue-600 border-slate-300 rounded focus:ring-blue-500 cursor-pointer"},null,40,ro),t("span",null,[he(l(o)+" ",1),t("span",ao,"("+l(se.value[o]||0)+")",1)])]))),128)),t("span",lo,l(ue.value.length)+" registros",1)]),t("div",no,[e[25]||(e[25]=t("div",{class:"bg-slate-50 border-b-2 border-slate-300 overflow-hidden"},[t("table",{class:"w-full text-sm"},[t("thead",{class:"text-xs text-slate-700"},[t("tr",null,[t("th",{class:"px-3 py-2 font-bold text-left w-[100px]"},"Fecha"),t("th",{class:"px-3 py-2 font-bold text-center w-[60px]"},"Turno"),t("th",{class:"px-3 py-2 font-bold text-left w-[120px]"},"Sub-producto"),t("th",{class:"px-3 py-2 font-bold text-left flex-1"},"Descripci√≥n"),t("th",{class:"px-3 py-2 font-bold text-right w-[100px]"},"ID"),t("th",{class:"px-3 py-2 font-bold text-right w-[140px]"},"Peso L√≠quido (KG)"),t("th",{class:"px-3 py-2 font-bold text-left w-[150px]"},"OBS")])])])],-1)),t("div",io,[t("table",{ref_key:"tablaSectorRef",ref:te,class:"w-full text-sm"},[t("tbody",co,[(b(!0),m(ie,null,de(ue.value,(o,n)=>(b(),m("tr",{key:n,class:ce([n%2===0?"bg-white":"bg-slate-50","hover:bg-blue-50 transition-colors"])},[t("td",uo,l(o.DT_MOV),1),t("td",po,l(o.TURNO),1),t("td",go,l(o.SUBPRODUTO||o.subproduto||o.Subproducto),1),t("td",fo,l(o.DESCRICAO),1),t("td",ho,l(o.ID),1),t("td",xo,l(Te(o["PESO LIQUIDO (KG)"])),1),t("td",bo,l(o.OBS),1)],2))),128)),t("tr",vo,[e[23]||(e[23]=t("td",{colspan:"5",class:"px-3 py-2 text-right font-bold text-slate-800"},"TOTAL:",-1)),t("td",mo,l(Te(a.value)),1),e[24]||(e[24]=t("td",null,null,-1))])])],512)])])])):be("",!0)])])])):be("",!0)]),_:1})}}},wo=Ge(yo,[["__scopeId","data-v-13a2ffe1"]]),_o={key:0,class:"fixed inset-0 z-[60] flex items-center justify-center p-4"},Fo={class:"relative bg-white rounded-2xl shadow-2xl w-full max-w-4xl overflow-hidden flex flex-col max-h-[90vh] border border-slate-200"},Co={class:"px-6 py-2 bg-slate-50 border-b border-slate-200 flex justify-between items-center"},To={class:"flex items-center gap-2"},Eo=["disabled"],Do={class:"flex-1 overflow-auto p-4"},Ao={key:0,class:"mb-4 bg-amber-50 border border-amber-200 rounded-xl p-3 flex items-start gap-3"},Ro={class:"flex-1"},ko={class:"text-[10px] text-amber-700 mt-0.5"},jo=["disabled"],So={key:0,class:"animate-spin"},$o={key:1},Ko={class:"border border-slate-200 rounded-xl overflow-hidden shadow-sm"},Io={class:"w-full text-sm text-left"},Po={class:"divide-y divide-slate-100"},Mo={class:"px-4 py-1.5"},Oo={class:"font-medium text-slate-800 text-xs"},Bo={class:"text-[9px] text-slate-400 uppercase tracking-wider"},Lo={class:"px-4 py-1.5 text-center"},Uo={key:0,class:"space-y-1"},No={class:"px-4 py-1.5 text-[10px] text-slate-500"},Vo={class:"px-4 py-1.5 text-[10px] text-slate-500"},zo={class:"px-4 py-1.5 text-right"},Ho=["onClick","disabled"],Wo={class:"px-6 py-2 bg-slate-50 border-t border-slate-200 flex justify-between items-center"},Go={class:"text-[9px] text-slate-400 font-medium"},Jo={class:"text-slate-600"},qo={__name:"UpdateResiduosModal",props:{show:{type:Boolean,default:!1}},emits:["close","updated"],setup(we,{emit:_e}){const Y=we,ve=_e,N="".replace(/\/$/,""),Q=N?`${N}/api`:"/api",X=k(!1),P=k(!1),G=k([]),U=k(null),J=k(localStorage.getItem("csvFolder")||"C:\\STC"),ee=["tb_FICHAS","tb_RESIDUOS_INDIGO","tb_RESIDUOS_POR_SECTOR","tb_PARADAS","tb_PRODUCCION","tb_CALIDAD"],te=V(()=>G.value.filter(a=>ee.includes(a.table)).sort((a,p)=>ee.indexOf(a.table)-ee.indexOf(p.table))),oe=V(()=>te.value.filter(a=>a.status==="OUTDATED"||a.status==="NOT_IMPORTED"||a.status==="MISSING_FILE").length),T=async()=>{X.value=!0;try{const a=J.value?`?csvFolder=${encodeURIComponent(J.value)}`:"",p=await fetch(`${Q}/import-status${a}`);if(!p.ok)throw new Error("Error al obtener estado");G.value=await p.json()}catch(a){console.error("Error:",a)}finally{X.value=!1}},B=async()=>{var F;const a=te.value.filter(C=>C.status==="OUTDATED"||C.status==="NOT_IMPORTED"||C.status==="MISSING_FILE").map(C=>C.table);if(a.length===0)return;P.value=!0;const p=performance.now();try{U.value=a[0];const C=await fetch(`${Q}/import/update-outdated`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tables:a,csvFolder:J.value})});if(!C.ok)throw new Error("Error en la actualizaci√≥n");const I=await C.json();if(I.success){const me=(Math.round(performance.now()-p)/1e3).toFixed(2),ae=(((F=I.timings)==null?void 0:F.totalMs)/1e3).toFixed(2);await T(),W.fire({icon:"success",title:"‚úì Actualizaci√≥n Completa",html:`
          <div style="text-align: left; padding: 10px;">
            <div style="font-size: 1.1em; margin-bottom: 15px;">
              <strong>${a.length} tabla(s)</strong> actualizadas correctamente.
            </div>
            <div style="background: #f3f4f6; padding: 12px; border-radius: 8px; font-family: monospace;">
              <div style="margin-bottom: 8px;">
                <span style="color: #059669; font-weight: bold;">‚è±Ô∏è Servidor:</span> 
                <span style="font-size: 1.2em; font-weight: bold;">${ae}s</span>
              </div>
              <div>
                <span style="color: #3b82f6; font-weight: bold;">üñ•Ô∏è UI:</span> 
                <span style="font-size: 1.2em; font-weight: bold;">${me}s</span>
              </div>
            </div>
          </div>
        `,confirmButtonText:"Entendido",confirmButtonColor:"#059669"}),ve("updated")}}catch(C){console.error("Error:",C),W.fire("Error","No se pudo completar la actualizaci√≥n","error")}finally{P.value=!1,U.value=null}},ke=async a=>{var C;if(!(await W.fire({title:"¬øForzar importaci√≥n?",text:`Se re-importar√° la tabla ${a.table} desde el archivo CSV.`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#ea580c",confirmButtonText:"S√≠, forzar",cancelButtonText:"Cancelar"})).isConfirmed)return;P.value=!0,U.value=a.table;const F=performance.now();try{const I=await fetch(`${Q}/import/force-table`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({table:a.table,csvFolder:J.value})});if(!I.ok)throw new Error("Error en la importaci√≥n");const ne=await I.json();if(ne.success){const ae=(Math.round(performance.now()-F)/1e3).toFixed(2);await T(),W.fire({toast:!0,position:"top-end",icon:"success",title:`${a.table} actualizada`,text:`${((C=ne.rows)==null?void 0:C.toLocaleString())||0} filas ‚Ä¢ ${ae}s`,showConfirmButton:!1,timer:3e3}),ve("updated")}}catch(I){console.error("Error:",I),W.fire("Error","No se pudo completar la importaci√≥n","error")}finally{P.value=!1,U.value=null}},M=()=>{P.value||ve("close")},se=a=>a?a.split("\\").pop().split("/").pop():"-",le=a=>a?new Date(a).toLocaleString("es-AR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-",ue=a=>{switch(a){case"UP_TO_DATE":return"Actualizado";case"OUTDATED":return"Desactualizado";case"NOT_IMPORTED":return"Pendiente";case"MISSING_FILE":return"No encontrado";default:return a}},re=a=>{switch(a){case"UP_TO_DATE":return"bg-green-100 text-green-700";case"OUTDATED":return"bg-amber-100 text-amber-700";case"NOT_IMPORTED":return"bg-blue-100 text-blue-700";case"MISSING_FILE":return"bg-red-100 text-red-700";default:return"bg-slate-100 text-slate-700"}};return ze(()=>Y.show,a=>{a&&T()}),Qe(()=>{Y.show&&T()}),(a,p)=>(b(),qe(Ze,{name:"modal"},{default:Ye(()=>[we.show?(b(),m("div",_o,[t("div",{class:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm",onClick:M}),t("div",Fo,[t("div",Co,[p[1]||(p[1]=t("div",{class:"flex items-center gap-3"},[t("div",{class:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center text-white shadow-lg shadow-blue-200"},[t("span",{class:"text-lg"},"üîÑ")]),t("div",null,[t("h2",{class:"text-lg font-bold text-slate-800"},"Actualizar Datos de Residuos"),t("p",{class:"text-[10px] text-slate-500 font-medium"},"Sincronizaci√≥n con archivos CSV de origen")])],-1)),t("div",To,[t("button",{onClick:T,class:"p-1.5 hover:bg-slate-200 rounded-lg text-slate-600 transition-colors",title:"Refrescar estado",disabled:X.value||P.value},[t("span",{class:ce({"animate-spin inline-block":X.value})},"‚Üª",2)],8,Eo),t("button",{onClick:M,class:"p-1.5 hover:bg-slate-200 rounded-lg text-slate-400 hover:text-slate-600 transition-colors"},[...p[0]||(p[0]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),t("div",Do,[oe.value>0?(b(),m("div",Ao,[p[4]||(p[4]=t("span",{class:"text-lg"},"‚ö†Ô∏è",-1)),t("div",Ro,[p[2]||(p[2]=t("h3",{class:"text-xs font-bold text-amber-800"},"Archivos desactualizados detectados",-1)),t("p",ko,"Hay "+l(oe.value)+" archivo(s) con cambios recientes que no han sido importados.",1)]),t("button",{onClick:B,class:"px-3 py-1.5 bg-amber-600 text-white text-[10px] font-bold rounded-lg hover:bg-amber-700 transition-colors shadow-sm flex items-center gap-2",disabled:P.value},[P.value?(b(),m("span",So,"‚öôÔ∏è")):(b(),m("span",$o,"üöÄ")),p[3]||(p[3]=he(" Actualizar Todo ",-1))],8,jo)])):be("",!0),t("div",Ko,[t("table",Io,[p[7]||(p[7]=t("thead",{class:"bg-slate-50 text-slate-600 font-bold border-b border-slate-200"},[t("tr",null,[t("th",{class:"px-4 py-1.5"},"Archivo Origen"),t("th",{class:"px-4 py-1.5 text-center"},"Estado"),t("th",{class:"px-4 py-1.5"},"√öltima Modif."),t("th",{class:"px-4 py-1.5"},"√öltima Import."),t("th",{class:"px-4 py-1.5 text-right"},"Acciones")])],-1)),t("tbody",Po,[(b(!0),m(ie,null,de(te.value,F=>(b(),m("tr",{key:F.table,class:"hover:bg-slate-50 transition-colors"},[t("td",Mo,[t("div",Oo,l(se(F.file)),1),t("div",Bo,"Hoja: "+l(F.sheet),1)]),t("td",Lo,[P.value&&U.value===F.table?(b(),m("div",Uo,[...p[5]||(p[5]=[t("div",{class:"flex items-center justify-center gap-1.5 text-blue-600 font-bold text-[9px]"},[t("span",{class:"animate-spin"},"‚öôÔ∏è"),t("span",null,"IMPORTANDO...")],-1),t("div",{class:"w-full bg-slate-100 rounded-full h-1 overflow-hidden border border-slate-200"},[t("div",{class:"bg-blue-500 h-full rounded-full animate-pulse",style:{width:"100%"}})],-1)])])):(b(),m("span",{key:1,class:ce([re(F.status),"px-2 py-0.5 rounded-full text-[9px] font-bold uppercase tracking-tighter"])},l(ue(F.status)),3))]),t("td",No,l(le(F.file_modified)),1),t("td",Vo,l(le(F.last_import_date)),1),t("td",zo,[t("button",{onClick:C=>ke(F),class:"px-2 py-1 bg-orange-50 text-orange-600 hover:bg-orange-600 hover:text-white rounded-lg text-[9px] font-bold transition-all border border-orange-200 flex items-center gap-1 ml-auto disabled:opacity-50",disabled:P.value||X.value},[...p[6]||(p[6]=[t("span",null,"‚ö°",-1),he(" Forzar ",-1)])],8,Ho)])]))),128))])])])]),t("div",Wo,[t("div",Go,[p[8]||(p[8]=he(" Carpeta de origen: ",-1)),t("span",Jo,l(J.value),1)]),t("button",{onClick:M,class:"px-4 py-1.5 bg-white border border-slate-300 text-slate-700 font-bold rounded-lg hover:bg-slate-50 transition-colors text-xs"}," Cerrar ")])])])):be("",!0)]),_:1}))}},Yo=Ge(qo,[["__scopeId","data-v-2bad275e"]]),Zo={class:"w-full h-screen flex flex-col p-1"},Qo={key:0,class:"absolute inset-0 bg-white/40 backdrop-blur-[2px] flex items-center justify-center z-50 rounded-2xl transition-all duration-300"},Xo={class:"flex flex-col items-center gap-4 bg-white/90 px-10 py-8 rounded-2xl shadow-2xl border border-blue-100"},es={class:"flex flex-col items-center gap-1"},ts={class:"text-xl text-slate-800 font-bold"},os={class:"flex items-center justify-between gap-4 flex-shrink-0 mb-4"},ss={class:"flex items-center gap-6"},rs={class:"flex items-center gap-2 px-3 py-1.5 bg-blue-50 border border-blue-200 rounded-lg"},as={class:"text-sm font-bold text-blue-700"},ls={class:"flex items-center gap-2"},ns={class:"divide-y divide-slate-200"},is=["onDblclick"],ds={class:"pl-2 pr-2 py-0 font-medium text-slate-900 whitespace-nowrap"},cs={class:"px-2 py-0 text-right font-[Verdana] border-l-2 border-slate-200"},us={class:"px-2 py-0 text-right font-[Verdana] text-blue-700"},ps={class:"px-2 py-0 text-right font-[Verdana] text-blue-700"},gs={class:"px-2 py-0 text-right font-[Verdana] text-slate-600"},fs={class:"px-2 py-0 text-right font-[Verdana] font-semibold text-red-600"},hs={class:"px-2 py-0 text-right font-[Verdana] font-semibold text-red-600"},xs={class:"px-2 py-0 text-right font-[Verdana] font-semibold text-red-600"},bs={class:"px-2 py-0 text-right font-[Verdana] border-l-2 border-slate-200"},vs={class:"px-2 py-0 text-right font-[Verdana] text-cyan-700"},ms={class:"px-2 py-0 text-right font-[Verdana] text-rose-700"},ys={class:"px-2 py-0 text-right font-[Verdana] text-slate-600"},ws={class:"px-2 py-0 text-right font-[Verdana] font-semibold text-red-600"},_s={class:"px-2 py-0 text-right font-[Verdana] font-semibold text-red-600"},Fs={class:"px-2 py-0 text-right font-[Verdana] text-amber-600"},Cs={class:"px-2 py-0 text-right font-[Verdana] text-emerald-600"},Ts={class:"px-2 py-0 text-right font-[Verdana] font-semibold text-red-600"},Es={class:"px-2 py-0 text-right font-[Verdana] text-blue-600 border-l-2 border-slate-200"},Ds={class:"px-2 py-0 text-right font-[Verdana] text-green-600"},As={class:"px-2 py-0 text-right font-[Verdana] text-red-500"},Rs={key:0},ks={key:0,class:"bg-slate-100 font-bold text-slate-800 sticky bottom-0 shadow-inner"},js={class:"px-2 py-1 text-right font-mono border-l-2 border-slate-200"},Ss={class:"px-2 py-1 text-right font-mono text-blue-800"},$s={class:"px-2 py-1 text-right font-mono text-blue-800"},Ks={class:"px-2 py-1 text-right font-mono text-slate-700"},Is={class:"px-2 py-1 text-right font-mono font-semibold text-red-700"},Ps={class:"px-2 py-1 text-right font-mono font-semibold text-red-700"},Ms={class:"px-2 py-1 text-right font-mono font-semibold text-red-700"},Os={class:"px-2 py-1 text-right font-[Verdana] border-l-2 border-slate-200"},Bs={class:"px-2 py-1 text-right font-[Verdana] text-cyan-800"},Ls={class:"px-2 py-1 text-right font-[Verdana] text-rose-800"},Us={class:"px-2 py-1 text-right font-[Verdana] text-slate-700"},Ns={class:"px-2 py-1 text-right font-[Verdana] font-semibold text-red-700"},Vs={class:"px-2 py-1 text-right font-[Verdana] font-semibold text-red-700"},zs={class:"px-2 py-1 text-right font-[Verdana] text-amber-700"},Hs={class:"px-2 py-1 text-right font-[Verdana] text-emerald-700"},Ws={class:"px-2 py-1 text-right font-[Verdana] text-green-800"},Gs={class:"px-2 py-1 text-right font-[Verdana] text-blue-700 border-l-2 border-slate-200"},Js={class:"px-2 py-1 text-right font-[Verdana] text-green-700"},qs={class:"px-2 py-1 text-right font-[Verdana] text-red-600"},sr={__name:"ResiduosIndigoTejeduria",setup(we){const{getCostosMensual:_e}=pt(),Y=k([]),ve=k([]),N=k(0),Q=k(!1),X=k(null),P=k(null),G=k(null),U=k(!1),J=k(!1),ee=k(""),te="".replace(/\/$/,""),oe=te?`${te}/api`:"/api",T=k(1.8),B=k(.3),M=k((()=>{const s=new Date;s.setDate(s.getDate()-1);const e=s.getFullYear(),r=String(s.getMonth()+1).padStart(2,"0"),o=String(s.getDate()).padStart(2,"0");return`${e}-${r}-${o}`})()),se=V(()=>{if(!M.value)return"";const[s,e]=M.value.split("-");return`${["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][parseInt(e)-1]} ${s}`}),le=V(()=>{if(!M.value)return"";const[s,e]=M.value.split("-");return`${s}-${e}-01`}),ue=V(()=>{if(!M.value)return"";const[s,e]=M.value.split("-"),r=new Date(s,e,0).getDate();return`${s}-${e}-${r}`}),re=V(()=>{if(!M.value)return[];const[s,e,r]=M.value.split("-"),o=parseInt(r,10),n=new Date(s,e,0).getDate(),x=[],_=new Map;Y.value.forEach(g=>{_.set(g.DT_BASE_PRODUCAO,g)});for(let g=1;g<=n;g++){const v=`${g.toString().padStart(2,"0")}/${e}/${s}`;if(g<=o)if(_.has(v)){const j=_.get(v),w=Number(j.ResiduosKg)||0,D=Number(j.ResiduosTejeduriaKg)||0,O=Number(j.ResiduosPrensadaKg)||0,z=w+D,H=O-z;x.push({...j,EstopaAzulProducida:z,DiferenciaEstopa:H})}else x.push({DT_BASE_PRODUCAO:v,TotalMetros:0,TotalKg:0,ResiduosKg:0,TejeduriaMetros:0,TejeduriaKg:0,ResiduosTejeduriaKg:0,AnudadosCount:0,ResiduosPrensadaKg:0,EstopaAzulProducida:0,DiferenciaEstopa:0});else x.push({DT_BASE_PRODUCAO:v,TotalMetros:null,TotalKg:null,ResiduosKg:null,TejeduriaMetros:null,TejeduriaKg:null,ResiduosTejeduriaKg:null,AnudadosCount:null,ResiduosPrensadaKg:null,EstopaAzulProducida:null,DiferenciaEstopa:null})}return x}),a=V(()=>re.value.reduce((s,e)=>{if(s.metros+=Number(e.TotalMetros)||0,s.kg+=Number(e.TotalKg)||0,s.residuos+=Number(e.ResiduosKg)||0,s.tejeduriaMetros+=Number(e.TejeduriaMetros)||0,s.tejeduriaKg+=Number(e.TejeduriaKg)||0,s.residuosTejeduriaKg+=Number(e.ResiduosTejeduriaKg)||0,s.anudadosCount+=Number(e.AnudadosCount)||0,s.residuosPrensadaKg+=Number(e.ResiduosPrensadaKg)||0,s.estopaAzulProducida+=Number(e.EstopaAzulProducida)||0,s.diferenciaEstopa+=Number(e.DiferenciaEstopa)||0,e.TotalKg>0){const o=(e.ResiduosKg/e.TotalKg*100-T.value)*e.TotalKg/100;if(o>0){s.desvioKg+=o;const n=e.TotalMetros/e.TotalKg*o;s.desvioMetros+=n,N.value>0&&(s.desvioIndigoPesos+=n*N.value)}}if(e.TejeduriaKg>0){const o=(e.ResiduosTejeduriaKg/e.TejeduriaKg*100-B.value)*e.TejeduriaKg/100;if(o>0){s.desvioTejeduriaKg+=o;const n=e.TejeduriaMetros/e.TejeduriaKg*o;s.desvioTejeduriaMetros+=n,N.value>0&&(s.desvioTejeduriaPesos+=n*N.value)}}return s},{metros:0,kg:0,residuos:0,desvioKg:0,desvioMetros:0,desvioIndigoPesos:0,tejeduriaMetros:0,tejeduriaKg:0,residuosTejeduriaKg:0,desvioTejeduriaKg:0,desvioTejeduriaMetros:0,desvioTejeduriaPesos:0,anudadosCount:0,residuosPrensadaKg:0,estopaAzulProducida:0,diferenciaEstopa:0})),p=s=>s==null||s===""?"":new Intl.NumberFormat("es-AR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(s),F=s=>{if(s==null||s==="")return null;const e=Number(s);return Number.isFinite(e)?e:null},C=s=>s&&typeof s=="object"&&"value"in s?F(s.value):F(s),I=(s,e)=>{const r=F(e);if(r===null)return"";if(r===0)return"0,0";const n=(F(s)||0)/r*100;return new Intl.NumberFormat("es-AR",{minimumFractionDigits:1,maximumFractionDigits:1}).format(n)},ne=s=>{const e=F(s);return e===null?"":new Intl.NumberFormat("es-AR",{minimumFractionDigits:1,maximumFractionDigits:1}).format(e)},me=(s,e,r=T.value)=>{const o=F(e);if(!o)return"";const n=F(s)||0,x=C(r);if(x===null)return"";const g=(n/o*100-x)*o/100;return!Number.isFinite(g)||g<=0?"":new Intl.NumberFormat("es-AR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(g)},ae=(s,e,r,o=T.value)=>{const n=F(e);if(!n)return"";const x=F(r)||0,_=C(o);if(_===null)return"";const i=(x/n*100-_)*n/100;if(!Number.isFinite(i)||i<=0)return"";const v=F(s);if(!v)return"";const j=v/n*i;return new Intl.NumberFormat("es-AR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(j)},Me=(s,e)=>{const r=F(s),o=F(e);if(!r||r===0||!o||o===0)return"";const n=r/o;return new Intl.NumberFormat("es-AR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(n)},je=(s,e)=>{const r=F(s),o=F(e);if(!r||r<=0||!o||o===0)return"";const n=r/o;return new Intl.NumberFormat("es-AR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(n)},Fe=(s,e,r,o,n)=>{const x=F(e);if(!x)return"";const _=C(n);if(!_)return"";const g=F(r)||0,i=C(o);if(i===null)return"";const j=(g/x*100-i)*x/100;if(!Number.isFinite(j)||j<=0)return"";const w=F(s);if(!w)return"";const O=w/x*j*_;return new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:0,maximumFractionDigits:0}).format(O)},Ce=s=>!s||s<=0?"":new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:0,maximumFractionDigits:0}).format(s),Se=async()=>{if(M.value)try{const[s,e]=M.value.split("-"),r=`${s}-${e}`,o=await _e(3),n=(o==null?void 0:o.rows)||[];ve.value=n;let x=n.find(_=>_.yyyymm===r&&_.codigo==="URDIDO_TENIDO");if(!x){console.log(`üîç Mes ${r} no est√° en los √∫ltimos 3 meses, consultando...`);const _=await _e(100);x=((_==null?void 0:_.rows)||[]).find(i=>i.yyyymm===r&&i.codigo==="URDIDO_TENIDO"),x?console.log(`‚úÖ Costo encontrado para ${r}: $${x.ars_por_unidad}`):console.warn(`‚ö†Ô∏è No se encontr√≥ costo para ${r}`)}N.value=x&&Number(x.ars_por_unidad)||0}catch(s){console.error("Error al cargar costos:",s),N.value=0}},Ae=async()=>{if(M.value){Q.value=!0,console.log(`üìÖ Cargando datos para el mes: ${se.value}`),console.log(`üîç Rango: ${le.value} a ${ue.value}`);try{await Se();const s=`${oe}/residuos-indigo-tejeduria?fecha_inicio=${le.value}&fecha_fin=${ue.value}`;console.log(`üåê Consultando: ${s}`);const e=await fetch(s);if(!e.ok)throw new Error("Error al cargar datos");const r=await e.json();Y.value=r,console.log(`‚úÖ Datos cargados: ${r.length} registros para ${se.value}`)}catch(s){console.error("‚ùå Error:",s),alert("Error al cargar los datos: "+s.message)}finally{Q.value=!1}}},Re=async()=>{try{const s=new He.Workbook,e=s.addWorksheet("Residuos",{views:[{state:"frozen",xSplit:0,ySplit:1}],pageSetup:{paperSize:5,orientation:"landscape",fitToPage:!0,fitToWidth:1,fitToHeight:0,margins:{left:.196850393700787,right:.196850393700787,top:.196850393700787,bottom:.393700787401575,header:.196850393700787,footer:.196850393700787},horizontalCentered:!0,verticalCentered:!1}});e.columns=[{header:"Fecha",key:"fecha",width:10.86},{header:"Producci√≥n √çndigo Metros",key:"prod_ind_m",width:9.43},{header:"Producci√≥n √çndigo Kg",key:"prod_ind_kg",width:9.29},{header:"Residuos √çndigo Kg",key:"res_ind_kg",width:8.43},{header:"Residuos √çndigo en %",key:"res_ind_pct",width:8.43},{header:"Meta √çndigo %",key:"meta_ind",width:6.43},{header:"Desv√≠o √çndigo en Kg",key:"desv_ind_kg",width:7},{header:"Desv√≠o √çndigo en Metros",key:"desv_ind_m",width:9.29},{header:"Desv√≠o √çndigo en $ (ARS)",key:"desv_ind_ars",width:11.71},{header:"Tejedur√≠a Metros",key:"tej_m",width:7.71},{header:"Tejedur√≠a Kg",key:"tej_kg",width:7.71},{header:"Residuos Tejedur√≠a Kg",key:"res_tej_kg",width:9.57},{header:"Residuos Tejedur√≠a en %",key:"res_tej_pct",width:8.43},{header:"Meta Tejedur√≠a %",key:"meta_tej",width:7.71},{header:"Desv√≠o Tejedur√≠a en Kg",key:"desv_tej_kg",width:7.71},{header:"Desv√≠o Tejedur√≠a en Metros",key:"desv_tej_m",width:10},{header:"Anudados",key:"anudados",width:4.14},{header:"Promedio x Anudado Kg",key:"prom_anud",width:10.57},{header:"Desv√≠o Tejedur√≠a en $ (ARS)",key:"desv_tej_ars",width:10.57},{header:"ESTOPA AZUL PRODUCIDA",key:"estopa_prod",width:12.57},{header:"ESTOPA AZUL PRENSADA",key:"estopa_prens",width:11.29},{header:"Diferencia",key:"diferencia",width:6.14}],e.getRow(1).height=55;for(let d=1;d<=22;d++){const u=e.getRow(1).getCell(d);u.font={bold:!0,color:{argb:"FF334155"}},u.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF8FAFC"}},u.alignment={horizontal:"center",vertical:"middle",wrapText:!0},u.border={top:{style:"thin",color:{argb:"FFE2E8F0"}},bottom:{style:"medium",color:{argb:"FFCBD5E1"}},left:{style:"thin",color:{argb:"FFE2E8F0"}},right:{style:"thin",color:{argb:"FFE2E8F0"}}},(d===2||d===10||d===20)&&(u.border.left={style:"medium",color:{argb:"FF94A3B8"}})}const r=d=>{const u=F(d);return u===null?null:Math.round(u)},o=d=>{const u=F(d);return u===null?null:Number(u.toFixed(2))},n=(d,u,y)=>{if(!u||u===0)return null;const K=(d/u*100-y)*u/100;return K>0?K:null},x=(d,u,y,h)=>{if(!u||u===0)return null;const K=n(y,u,h);return K?d/u*K:null},_=(d,u,y,h,K)=>{if(!K||K===0)return null;const L=x(d,u,y,h);return L?L*K:null};re.value.forEach(d=>{let u=null;if(d.DT_BASE_PRODUCAO){const[it,dt,ct]=d.DT_BASE_PRODUCAO.split("/");u=new Date(parseInt(ct),parseInt(dt)-1,parseInt(it))}const y=r(d.TotalMetros),h=r(d.TotalKg),K=r(d.ResiduosKg),L=r(d.TejeduriaMetros),q=r(d.TejeduriaKg),Z=r(d.ResiduosTejeduriaKg),Ue=r(d.ResiduosPrensadaKg),Ne=r(d.EstopaAzulProducida),et=r(d.DiferenciaEstopa),Pe=r(d.AnudadosCount),tt=n(K,h,T.value),ot=x(y,h,K,T.value),st=_(d.TotalMetros,d.TotalKg,d.ResiduosKg,T.value,N.value),rt=n(Z,q,B.value),at=x(L,q,Z,B.value),lt=_(d.TejeduriaMetros,d.TejeduriaKg,d.ResiduosTejeduriaKg,B.value,N.value),nt=Z&&Pe&&Pe>0?o(Z/Pe):null;e.addRow({fecha:u,prod_ind_m:y,prod_ind_kg:h,res_ind_kg:K,res_ind_pct:h?K/h:null,meta_ind:T.value/100,desv_ind_kg:tt,desv_ind_m:ot,desv_ind_ars:st,tej_m:L,tej_kg:q,res_tej_kg:Z,res_tej_pct:q?Z/q:null,meta_tej:B.value/100,desv_tej_kg:rt,desv_tej_m:at,anudados:Pe,prom_anud:nt,desv_tej_ars:lt,estopa_prod:Ne,estopa_prens:Ue,diferencia:et})});const g=r(a.value.metros),i=r(a.value.kg),v=r(a.value.residuos),j=r(a.value.tejeduriaMetros),w=r(a.value.tejeduriaKg),D=r(a.value.residuosTejeduriaKg),O=r(a.value.anudadosCount),z=r(a.value.estopaAzulProducida),H=r(a.value.residuosPrensadaKg),Ee=r(a.value.diferenciaEstopa),pe=D&&O>0?o(D/O):null,f=e.addRow({fecha:"TOTAL",prod_ind_m:g,prod_ind_kg:i,res_ind_kg:v,res_ind_pct:i?v/i:null,meta_ind:T.value/100,desv_ind_kg:a.value.desvioKg>0?a.value.desvioKg:null,desv_ind_m:a.value.desvioMetros>0?a.value.desvioMetros:null,desv_ind_ars:a.value.desvioIndigoPesos>0?a.value.desvioIndigoPesos:null,tej_m:j,tej_kg:w,res_tej_kg:D,res_tej_pct:w?D/w:null,meta_tej:B.value/100,desv_tej_kg:a.value.desvioTejeduriaKg>0?a.value.desvioTejeduriaKg:null,desv_tej_m:a.value.desvioTejeduriaMetros>0?a.value.desvioTejeduriaMetros:null,anudados:O,prom_anud:pe,desv_tej_ars:a.value.desvioTejeduriaPesos>0?a.value.desvioTejeduriaPesos:null,estopa_prod:z,estopa_prens:H,diferencia:Ee});f.height=25;for(let d=1;d<=22;d++){const u=f.getCell(d);u.font={bold:!0,color:{argb:"FF1E293B"}},u.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF1F5F9"}},u.alignment={horizontal:"center",vertical:"middle"}}const E={1:"dd/mm/yyyy",2:"#,##0",3:"#,##0",4:"#,##0",5:"0.0%",6:"0.0%",7:"#,##0",8:"#,##0",9:'"$"#,##0',10:"#,##0",11:"#,##0",12:"#,##0",13:"0.0%",14:"0.0%",15:"#,##0",16:"#,##0",17:"#,##0",18:"#,##0.00",19:'"$"#,##0',20:"#,##0",21:"#,##0",22:"#,##0"};e.eachRow((d,u)=>{if(u===1)return;const y=u===e.rowCount;for(let h=1;h<=22;h++){const K=d.getCell(h);K.border={top:{style:y?"medium":"thin",color:{argb:y?"FFCBD5E1":"FFE2E8F0"}},bottom:{style:"thin",color:{argb:"FFE2E8F0"}},left:{style:"thin",color:{argb:"FFE2E8F0"}},right:{style:"thin",color:{argb:"FFE2E8F0"}}},(h===2||h===10||h===20)&&(K.border.left={style:"medium",color:{argb:"FF94A3B8"}}),K.alignment={horizontal:"center",vertical:"middle"},E[h]&&(K.numFmt=E[h]);let L=null;const q=K.value;if(h===3||h===4)L=y?"FF1E40AF":"FF1D4ED8";else if(h===5){const Z=d.getCell(6).value;L=q>Z?"FFDC2626":"FF16A34A"}else if(h===7||h===8||h===9)q>0&&(L="FFDC2626");else if(h===11)L=y?"FF155E75":"FF0E7490";else if(h===12)L=y?"FF9F1239":"FFBE123C";else if(h===13){const Z=d.getCell(14).value;L=q>Z?"FFDC2626":"FF16A34A"}else h===15||h===16||h===19?q>0&&(L="FFDC2626"):h===17?L=y?"FFB45309":"FFD97706":h===18?L=y?"FF047857":"FF059669":h===20?L=y?"FF1D4ED8":"FF2563EB":h===21?L=y?"FF15803D":"FF16A34A":h===22&&q!==0&&q!==null&&(L="FFEF4444");L?K.font={...K.font,color:{argb:L},bold:!0}:y&&(K.font={bold:!0,color:{argb:"FF1E293B"}})}});const S=e.rowCount;e.pageSetup.printArea=`A1:V${S}`;const A=new Date,ge=A.getDate().toString().padStart(2,"0"),fe=(A.getMonth()+1).toString().padStart(2,"0"),$e=A.getFullYear(),Ke=A.getHours().toString().padStart(2,"0"),Le=A.getMinutes().toString().padStart(2,"0"),Ie=`Residuos_${se.value.replace(" ","_")}_${ge}-${fe}-${$e}_${Ke}${Le}.xlsx`,ye=await s.xlsx.writeBuffer(),c=new Blob([ye],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),R=URL.createObjectURL(c),$=document.createElement("a");$.href=R,$.download=Ie,document.body.appendChild($),$.click(),document.body.removeChild($),URL.revokeObjectURL(R),W.fire({toast:!0,position:"top-end",icon:"success",title:"Excel generado",text:"Archivo descargado exitosamente",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}catch(s){console.error("Error al exportar a Excel:",s),W.fire({toast:!0,position:"top-end",icon:"error",title:"Error al exportar",text:s.message,showConfirmButton:!1,timer:4e3,timerProgressBar:!0})}},Te=async()=>{try{const s=new He.Workbook,e=s.addWorksheet("Residuos",{views:[{state:"frozen",xSplit:0,ySplit:6}],pageSetup:{paperSize:5,orientation:"landscape",fitToPage:!0,fitToWidth:1,fitToHeight:0,margins:{left:.196850393700787,right:.196850393700787,top:.196850393700787,bottom:.393700787401575,header:.196850393700787,footer:.196850393700787},horizontalCentered:!0,verticalCentered:!1}});e.columns=[{key:"col_a",width:.86},{key:"col_b",width:14.14},{key:"col_c",width:13.29},{key:"col_d",width:11.43},{key:"col_e",width:8.71},{key:"col_f",width:5.71},{key:"col_g",width:13},{key:"col_h",width:8.43},{key:"col_i",width:9.29},{key:"col_j",width:14.86},{key:"col_k",width:11.71},{key:"col_l",width:11.43},{key:"col_m",width:8.71},{key:"col_n",width:5.71},{key:"col_o",width:13},{key:"col_p",width:8.43},{key:"col_q",width:9.29},{key:"col_r",width:7.71},{key:"col_s",width:8.71},{key:"col_t",width:14.71},{key:"col_u",width:12.71},{key:"col_v",width:13},{key:"col_w",width:10.29}],e.getRow(1).height=4.5,e.getRow(2).height=20.1,e.mergeCells("B2:B3");const r=e.getCell("B2");r.alignment={horizontal:"center",vertical:"middle"};try{const $=await(await(await fetch("/LogoSantana.jpg")).blob()).arrayBuffer(),d=btoa(new Uint8Array($).reduce((y,h)=>y+String.fromCharCode(h),"")),u=s.addImage({base64:d,extension:"jpeg"});e.addImage(u,{tl:{col:1.1,row:1.2},ext:{width:100,height:35}})}catch(c){console.warn("No se pudo cargar el logo:",c)}e.mergeCells("C2:T2");const o=e.getCell("C2");o.value="SANTANA TEXTIL CHACO S.A. - UNIDAD V",o.font={name:"Tahoma",size:10,bold:!0},o.alignment={horizontal:"center",vertical:"middle"},e.mergeCells("U2:W2");const n=e.getCell("U2");n.value="Mes",n.font={name:"Tahoma",size:10},n.alignment={horizontal:"center",vertical:"middle"},e.getRow(3).height=20.1,e.mergeCells("C3:T3");const x=e.getCell("C3");x.value='"SEGUIMIENTO de RESIDUOS ESTOPA TE√ëIDA de √çNDIGO y TEJEDUR√çA"',x.font={name:"Tahoma",size:10},x.alignment={horizontal:"center",vertical:"middle"},e.mergeCells("U3:W3");const _=e.getCell("U3");if(M.value){const[c,R,$]=M.value.split("-");_.value=`${se.value}`,_.alignment={horizontal:"center",vertical:"middle"}}e.getRow(5).height=20.1,e.mergeCells("C5:J5");const g=e.getCell("C5");g.value="√çNDIGO",g.font={name:"Tahoma",size:10,bold:!0},g.alignment={horizontal:"center",vertical:"middle"},e.mergeCells("K5:T5");const i=e.getCell("K5");i.value="TEJEDUR√çA",i.font={name:"Tahoma",size:10,bold:!0},i.alignment={horizontal:"center",vertical:"middle"},e.mergeCells("U5:W5");const v=e.getCell("U5");v.value="BALANCE",v.font={name:"Tahoma",size:10,bold:!0},v.alignment={horizontal:"center",vertical:"middle"},e.getRow(6).height=39.95;const j=["","Fecha","Producci√≥n Metros","Producci√≥n Kg","Residuos Kg","Resid en %","Meta %","Desvi√≥ en Kg","Desvi√≥ en Metros","Desvi√≥ en $","Producci√≥n Metros","Producci√≥n Kg","Residuos Kg","Resid en %","Meta %","Desvi√≥ en Kg","Desvi√≥ en Metros","Cant. Anudados","Prom. x Anudado","Desvi√≥ en $","ESTOPA AZUL PRODUCIDA","ESTOPA AZUL PRENSADA","Diferencia"];for(let c=1;c<=j.length;c++){const R=e.getRow(6).getCell(c);R.value=j[c-1],R.font={name:"Tahoma",size:10},R.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFEA7E6C"}},R.alignment={horizontal:"center",vertical:"middle",wrapText:!0}}const w=(c,R,$)=>{if(!R||R===0)return null;const u=(c/R*100-$)*R/100;return u>0?u:null},D=(c,R,$,d)=>{if(!R||R===0)return null;const u=w($,R,d);return u?c/R*u:null},O=(c,R,$,d,u)=>{if(!u||u===0)return null;const y=D(c,R,$,d);return y?y*u:null};re.value.forEach(c=>{let R=null;if(c.DT_BASE_PRODUCAO){const[Z,Ue,Ne]=c.DT_BASE_PRODUCAO.split("/");R=new Date(parseInt(Ne),parseInt(Ue)-1,parseInt(Z))}const $=w(c.ResiduosKg,c.TotalKg,T.value),d=D(c.TotalMetros,c.TotalKg,c.ResiduosKg,T.value),u=O(c.TotalMetros,c.TotalKg,c.ResiduosKg,T.value,N.value),y=w(c.ResiduosTejeduriaKg,c.TejeduriaKg,B.value),h=D(c.TejeduriaMetros,c.TejeduriaKg,c.ResiduosTejeduriaKg,B.value),K=O(c.TejeduriaMetros,c.TejeduriaKg,c.ResiduosTejeduriaKg,B.value,N.value),L=c.ResiduosTejeduriaKg&&c.AnudadosCount&&c.AnudadosCount>0?c.ResiduosTejeduriaKg/c.AnudadosCount:null,q=e.addRow(["",R,c.TotalMetros??null,c.TotalKg??null,c.ResiduosKg??null,c.TotalKg?c.ResiduosKg/c.TotalKg:null,T.value/100,$,d,u,c.TejeduriaMetros??null,c.TejeduriaKg??null,c.ResiduosTejeduriaKg??null,c.TejeduriaKg?c.ResiduosTejeduriaKg/c.TejeduriaKg:null,B.value/100,y,h,c.AnudadosCount??null,L,K,c.EstopaAzulProducida??null,c.ResiduosPrensadaKg??null,c.DiferenciaEstopa??null]);q.height=20.1});const z=a.value.residuosTejeduriaKg&&a.value.anudadosCount>0?a.value.residuosTejeduriaKg/a.value.anudadosCount:null,H=e.addRow(["",null,a.value.metros,a.value.kg,a.value.residuos,a.value.kg?a.value.residuos/a.value.kg:null,T.value/100,a.value.desvioKg>0?a.value.desvioKg:null,a.value.desvioMetros>0?a.value.desvioMetros:null,a.value.desvioIndigoPesos>0?a.value.desvioIndigoPesos:null,a.value.tejeduriaMetros,a.value.tejeduriaKg,a.value.residuosTejeduriaKg,a.value.tejeduriaKg?a.value.residuosTejeduriaKg/a.value.tejeduriaKg:null,B.value/100,a.value.desvioTejeduriaKg>0?a.value.desvioTejeduriaKg:null,a.value.desvioTejeduriaMetros>0?a.value.desvioTejeduriaMetros:null,a.value.anudadosCount,z,a.value.desvioTejeduriaPesos>0?a.value.desvioTejeduriaPesos:null,a.value.estopaAzulProducida,a.value.residuosPrensadaKg,a.value.diferenciaEstopa]);H.height=24.95;for(let c=1;c<=23;c++){const R=H.getCell(c);R.font={name:"Tahoma",size:10,bold:!0},R.alignment={horizontal:"center",vertical:"middle"}}const Ee={2:"mm-dd-yy",3:"#,##0",4:"#,##0",5:"#,##0",6:"0.0%",7:"0.0%",8:"#,##0",9:"#,##0",10:"#,##0",11:"#,##0",12:"#,##0",13:"#,##0",14:"0.0%",15:"0.0%",16:"#,##0",17:"#,##0",18:"#,##0",19:"#,##0.00",20:"#,##0",21:"#,##0",22:"#,##0",23:"#,##0"};e.eachRow((c,R)=>{if(R<=6)return;const $=R===e.rowCount;for(let d=1;d<=23;d++){const u=c.getCell(d);u.alignment={horizontal:"center",vertical:"middle"},Ee[d]&&(u.numFmt=Ee[d]);let y=null;const h=u.value;d===4||d===5?y=$?"FF1E40AF":"FF1D4ED8":d===6?y=h>c.getCell(7).value?"FFDC2626":"FF16A34A":d===8||d===9||d===10?h>0&&(y="FFDC2626"):d===12?y=$?"FF155E75":"FF0E7490":d===13?y=$?"FF9F1239":"FFBE123C":d===14?y=h>c.getCell(15).value?"FFDC2626":"FF16A34A":d===16||d===17||d===20?h>0&&(y="FFDC2626"):d===18?y=$?"FFB45309":"FFD97706":d===19?y=$?"FF047857":"FF059669":d===21?y=$?"FF1D4ED8":"FF2563EB":d===22?y=$?"FF15803D":"FF16A34A":d===23&&h!==0&&h!==null&&(y="FFEF4444"),y?u.font={name:"Tahoma",size:10,color:{argb:y},bold:!0}:$?u.font={name:"Tahoma",size:10,bold:!0}:u.font={name:"Tahoma",size:10}}});const pe=e.rowCount;e.pageSetup.printArea=`B1:W${pe}`;const f=new Date,E=f.getDate().toString().padStart(2,"0"),S=(f.getMonth()+1).toString().padStart(2,"0"),A=f.getFullYear(),ge=f.getHours().toString().padStart(2,"0"),fe=f.getMinutes().toString().padStart(2,"0"),$e=`Residuos_ProFormat_${se.value.replace(" ","_")}_${E}-${S}-${A}_${ge}${fe}.xlsx`,Ke=await s.xlsx.writeBuffer(),Le=new Blob([Ke],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),Ie=URL.createObjectURL(Le),ye=document.createElement("a");ye.href=Ie,ye.download=$e,document.body.appendChild(ye),ye.click(),document.body.removeChild(ye),URL.revokeObjectURL(Ie),W.fire({toast:!0,position:"top-end",icon:"success",title:"Excel Pro generado",text:"Archivo con formato completo descargado",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}catch(s){console.error("Error al exportar a Excel:",s),W.fire({toast:!0,position:"top-end",icon:"error",title:"Error al exportar",text:s.message,showConfirmButton:!1,timer:4e3,timerProgressBar:!0})}},Oe=async()=>{var s,e;if(!(!P.value||!G.value))try{await new Promise(f=>setTimeout(f,100)),(s=document.fonts)!=null&&s.ready&&await document.fonts.ready;const r=document.createElement("div");r.style.position="fixed",r.style.left="0",r.style.top="0",r.style.zIndex="-1",r.style.opacity="1",r.style.visibility="hidden",r.style.pointerEvents="none",r.style.background="#ffffff",r.style.padding="20px",r.style.boxSizing="border-box",r.style.overflow="visible";const o=G.value.querySelector(".flex.items-center.justify-between");if(!o)throw new Error("No se encontr√≥ el header para exportar");const n=o.cloneNode(!0);n.style.marginBottom="16px",n.style.width="100%",n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="space-between";const x=n.querySelector("img");x&&(x.style.marginLeft="4px");const _=()=>{if(!M.value)return null;const[f,E,S]=M.value.split("-"),A=f,ge=String(E||"").padStart(2,"0"),fe=String(S||"").padStart(2,"0");return{mesYAnio:`${["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"][(parseInt(ge,10)||1)-1]||""} de ${A}`,desde:`01-${ge}-${A}`,hasta:`${fe}-${ge}-${A}`}},g=(e=n.children)==null?void 0:e[1];if(g){g.innerHTML="",g.style.display="flex",g.style.alignItems="center",g.style.justifyContent="flex-end",g.style.gap="0",g.style.paddingRight="4px";const f=_();if(f){const E=document.createElement("div");E.className="text-sm flex items-center gap-1 whitespace-nowrap";const S=(A,ge)=>{const fe=document.createElement("span");return fe.className=ge,fe.textContent=A,fe};E.appendChild(S("Mes:","text-slate-600 font-medium")),E.appendChild(S(f.mesYAnio,"text-slate-800 font-bold")),E.appendChild(S("-","text-slate-600 font-medium")),E.appendChild(S("desde","text-slate-600 font-medium")),E.appendChild(S(f.desde,"text-slate-800 font-bold")),E.appendChild(S("a","text-slate-600 font-medium")),E.appendChild(S(f.hasta,"text-slate-800 font-bold")),g.appendChild(E)}}r.appendChild(n);const i=P.value.cloneNode(!0);i.style.width=`${P.value.scrollWidth}px`,i.style.maxWidth="none",i.style.overflow="visible",i.style.borderCollapse="collapse",r.appendChild(i),Array.from(i.querySelectorAll(".sticky")).forEach(f=>{f.classList.remove("sticky","top-0","bottom-0","z-10","shadow-sm","shadow-inner"),f.style.position="static",f.style.top="auto",f.style.bottom="auto",f.style.zIndex="auto",f.style.boxShadow="none"}),document.body.appendChild(r);const j=Array.from(r.querySelectorAll("img"));await Promise.all(j.map(f=>f.complete&&f.naturalWidth>0?Promise.resolve():new Promise(E=>{const S=()=>E();f.addEventListener("load",S,{once:!0}),f.addEventListener("error",S,{once:!0})})));const w=20*2,D=20*2,O=i.scrollWidth,z=n.scrollHeight+i.scrollHeight+16;n.style.width=`${O}px`,r.style.width=`${O+w+40}px`,r.style.height=`${z+D}px`,r.getBoundingClientRect(),r.style.visibility="visible",await new Promise(requestAnimationFrame);let H;try{H=await Xe(r,{scale:2,backgroundColor:"#ffffff",width:O+w+40,height:z+D})}finally{r.isConnected&&document.body.removeChild(r)}const pe=await(await fetch(H)).blob();try{await navigator.clipboard.write([new ClipboardItem({"image/png":pe})]),W.fire({toast:!0,position:"top-end",icon:"success",title:"Imagen copiada al portapapeles",text:"Presiona Ctrl+V para pegar en WhatsApp o correo",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}catch(f){console.warn("No se pudo copiar al portapapeles, descargando archivo:",f);const E=`Residuos_INDIGO_TEJEDURIA_${se.value.replace(" ","_")}.png`,S=URL.createObjectURL(pe),A=document.createElement("a");A.href=S,A.download=E,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(S),W.fire({toast:!0,position:"top-end",icon:"info",title:"Imagen descargada",text:"Guardada en tu carpeta de Descargas",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}}catch(r){console.error("Error al exportar:",r),W.fire({toast:!0,position:"top-end",icon:"error",title:"Error al exportar",text:r.message,showConfirmButton:!1,timer:4e3,timerProgressBar:!0})}},Be=s=>{if(!s||s===null||s===void 0)return;const[e,r,o]=s.split("/");ee.value=`${o}-${r}-${e}`,U.value=!0};return Qe(()=>{Ae()}),(s,e)=>{const r=Je("tippy");return b(),m("div",Zo,[t("main",{ref_key:"mainContentRef",ref:G,class:"w-full flex-1 min-h-0 bg-white rounded-2xl shadow-xl px-4 py-3 border border-slate-200 flex flex-col relative"},[Q.value?(b(),m("div",Qo,[t("div",Xo,[e[5]||(e[5]=t("div",{class:"relative"},[t("div",{class:"animate-spin rounded-full h-16 w-16 border-4 border-blue-50 border-t-blue-600"}),t("div",{class:"absolute inset-0 flex items-center justify-center"},[t("div",{class:"h-8 w-8 bg-blue-600 rounded-full animate-pulse opacity-10"})])],-1)),t("div",es,[e[4]||(e[4]=t("span",{class:"text-slate-500 font-medium tracking-wider uppercase text-[10px]"},"Cargando datos de",-1)),t("span",ts,l(se.value),1)])])])):be("",!0),t("div",os,[t("div",ss,[e[7]||(e[7]=t("img",{src:We,alt:"Santana Textiles",class:"h-10 w-auto object-contain"},null,-1)),e[8]||(e[8]=t("h3",{class:"text-lg font-semibold text-slate-800"},"Residuos de INDIGO y TEJEDURIA",-1)),t("div",rs,[e[6]||(e[6]=t("span",{class:"text-sm font-medium text-slate-600"},"Costo URDIMBRE TE√ëIDA:",-1)),t("span",as,l(Ce(N.value)),1)])]),t("div",ls,[xe((b(),m("button",{onClick:e[0]||(e[0]=o=>J.value=!0),class:"inline-flex items-center justify-center w-[34px] h-[34px] bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors shadow-sm"},[...e[9]||(e[9]=[t("span",{class:"text-lg"},"üîÑ",-1)])])),[[r,{content:"Actualizar datos desde archivos CSV",placement:"bottom"}]]),xe((b(),m("button",{onClick:Re,class:"inline-flex items-center gap-1 px-2 py-0 h-[34px] bg-emerald-600 hover:bg-emerald-700 text-white font-medium rounded-lg transition-colors shadow-sm"},[...e[10]||(e[10]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M12.9,14.5L15.8,19H14L12,15.6L10,19H8.2L11.1,14.5L8.2,10H10L12,13.4L14,10H15.8L12.9,14.5Z"})],-1),t("span",{class:"text-sm"},"Excel",-1)])])),[[r,{content:"Exportar a Excel (formato simple)",placement:"bottom"}]]),xe((b(),m("button",{onClick:Te,class:"inline-flex items-center gap-1 px-2 py-0 h-[34px] bg-indigo-600 hover:bg-indigo-700 text-white font-medium rounded-lg transition-colors shadow-sm"},[...e[11]||(e[11]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M15,18V16H13V18H15M15,14V12H13V14H15M10,18V16H8V18H10M10,14V12H8V14H10M15,10V8H13V10H15Z"})],-1),t("span",{class:"text-sm"},"Excel Pro",-1)])])),[[r,{content:"Exportar a Excel con formato completo (con logo y estructura)",placement:"bottom"}]]),xe((b(),m("button",{onClick:Oe,class:"inline-flex items-center gap-1 px-2 py-0 h-[34px] bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-colors shadow-sm"},[...e[12]||(e[12]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M12.04 2c-5.46 0-9.91 4.45-9.91 9.91 0 1.75.46 3.45 1.32 4.95L2.05 22l5.25-1.38c1.45.79 3.08 1.21 4.74 1.21 5.46 0 9.91-4.45 9.91-9.91 0-2.65-1.03-5.14-2.9-7.01C17.18 3.03 14.69 2 12.04 2m.01 1.67c2.2 0 4.26.86 5.82 2.42a8.225 8.225 0 0 1 2.41 5.83c0 4.54-3.7 8.23-8.24 8.23-1.48 0-2.93-.39-4.19-1.15l-.3-.17-3.12.82.83-3.04-.2-.32a8.188 8.188 0 0 1-1.26-4.38c.01-4.54 3.7-8.24 8.25-8.24M8.53 7.33c-.16 0-.43.06-.66.31-.22.25-.87.85-.87 2.07 0 1.22.89 2.39 1 2.56.14.17 1.76 2.67 4.25 3.73.59.27 1.05.42 1.41.53.59.19 1.13.16 1.56.1.48-.07 1.46-.6 1.67-1.18.21-.58.21-1.07.15-1.18-.07-.1-.23-.16-.48-.27-.25-.14-1.47-.74-1.69-.82-.23-.08-.37-.12-.56.12-.16.25-.64.81-.78.97-.15.17-.29.19-.53.07-.26-.13-1.06-.39-2-1.23-.74-.66-1.23-1.47-1.38-1.72-.12-.24-.01-.39.11-.5.11-.11.27-.29.37-.44.13-.14.17-.25.25-.41.08-.17.04-.31-.02-.43-.06-.11-.56-1.35-.77-1.84-.2-.48-.4-.42-.56-.43-.14 0-.3-.01-.47-.01z"})],-1),t("span",{class:"text-sm"},"WhatsApp",-1)])])),[[r,{content:"Copiar tabla completa al portapapeles (lista para pegar en WhatsApp o correo electr√≥nico)",placement:"bottom"}]]),Ve(ut,{modelValue:M.value,"onUpdate:modelValue":e[1]||(e[1]=o=>M.value=o),label:"Fecha:","show-buttons":!0,onChange:Ae},null,8,["modelValue"])])]),t("div",{class:"flex-1 overflow-auto min-h-0 border border-slate-200 rounded-lg relative",ref_key:"tablaRef",ref:X},[t("table",{ref_key:"tableElementRef",ref:P,class:"w-full text-sm text-left text-slate-600 font-[Verdana]"},[e[15]||(e[15]=t("thead",{class:"text-xs text-slate-700 bg-slate-50 sticky top-0 z-10 shadow-sm"},[t("tr",null,[t("th",{scope:"col",class:"pl-2 pr-2 py-1 font-bold border-b border-slate-200 text-center"},"Fecha"),t("th",{scope:"col",class:"px-2 py-1 font-bold border-b border-slate-200 border-l-2 text-right"},"Producci√≥n √çndigo Metros"),t("th",{scope:"col",class:"px-2 py-1 font-bold border-b border-slate-200 text-right"},"Producci√≥n √çndigo Kg"),t("th",{scope:"col",class:"px-2 py-1 font-bold border-b border-slate-200 text-right"},"Residuos √çndigo Kg"),t("th",{scope:"col",class:"px-2 py-1 font-bold border-b border-slate-200 text-right"},"Residuos √çndigo en %"),t("th",{scope:"col",class:"px-2 py-1 font-bold border-b border-slate-200 text-right"},"Meta √çndigo %"),t("th",{scope:"col",class:"px-2 py-1 font-bold border-b border-slate-200 text-right"},"Desv√≠o √çndigo en Kg"),t("th",{scope:"col",class:"px-2 py-1 font-bold border-b border-slate-200 text-right"},"Desv√≠o √çndigo en Metros"),t("th",{scope:"col",class:"px-2 py-1 font-bold border-b border-slate-200 text-right"},"Desv√≠o √çndigo en $ (ARS)"),t("th",{scope:"col",class:"px-2 py-1 font-bold border-b border-slate-200 border-l-2 text-right"},"Tejedur√≠a Metros"),t("th",{scope:"col",class:"px-2 py-1 font-bold border-b border-slate-200 text-right"},"Tejedur√≠a Kg"),t("th",{scope:"col",class:"px-2 py-1 font-bold border-b border-slate-200 text-right"},"Residuos Tejedur√≠a Kg"),t("th",{scope:"col",class:"px-2 py-1 font-bold border-b border-slate-200 text-right"},"Residuos Tejedur√≠a en %"),t("th",{scope:"col",class:"px-2 py-1 font-bold border-b border-slate-200 text-right"},"Meta Tejedur√≠a %"),t("th",{scope:"col",class:"px-2 py-1 font-bold border-b border-slate-200 text-right"},"Desv√≠o Tejedur√≠a en Kg"),t("th",{scope:"col",class:"px-2 py-1 font-bold border-b border-slate-200 text-right"},"Desv√≠o Tejedur√≠a en Metros"),t("th",{scope:"col",class:"px-2 py-1 font-bold border-b border-slate-200 text-right"},"Anudados"),t("th",{scope:"col",class:"px-2 py-1 font-bold border-b border-slate-200 text-right"},"Promedio x Anudado Kg"),t("th",{scope:"col",class:"px-2 py-1 font-bold border-b border-slate-200 text-right"},"Desv√≠o Tejedur√≠a en $ (ARS)"),t("th",{scope:"col",class:"px-2 py-1 font-bold border-b border-slate-200 border-l-2 text-right"},"ESTOPA AZUL PRODUCIDA"),t("th",{scope:"col",class:"px-2 py-1 font-bold border-b border-slate-200 text-right"},"ESTOPA AZUL PRENSADA"),t("th",{scope:"col",class:"px-2 py-1 font-bold border-b border-slate-200 text-right"},"Diferencia")])],-1)),t("tbody",ns,[(b(!0),m(ie,null,de(re.value,(o,n)=>(b(),m("tr",{key:n,class:ce([n%2===0?"bg-white hover:bg-slate-50":"bg-slate-50 hover:bg-slate-100","transition-colors cursor-pointer"]),onDblclick:x=>Be(o.DT_BASE_PRODUCAO)},[t("td",ds,l(o.DT_BASE_PRODUCAO),1),t("td",cs,l(p(o.TotalMetros)),1),t("td",us,l(p(o.TotalKg)),1),t("td",ps,l(p(o.ResiduosKg)),1),t("td",{class:ce(["px-2 py-0 text-right font-[Verdana] font-semibold",o.TotalKg>0&&o.ResiduosKg/o.TotalKg*100>T.value?"text-red-600":"text-green-600"])},l(I(o.ResiduosKg,o.TotalKg)),3),t("td",gs,l(ne(T.value)),1),t("td",fs,l(me(o.ResiduosKg,o.TotalKg,T.value)),1),t("td",hs,l(ae(o.TotalMetros,o.TotalKg,o.ResiduosKg,T.value)),1),t("td",xs,l(Fe(o.TotalMetros,o.TotalKg,o.ResiduosKg,T.value,N.value)),1),t("td",bs,l(p(o.TejeduriaMetros)),1),t("td",vs,l(p(o.TejeduriaKg)),1),t("td",ms,l(p(o.ResiduosTejeduriaKg)),1),t("td",{class:ce(["px-2 py-0 text-right font-[Verdana] font-semibold",o.TejeduriaKg>0&&o.ResiduosTejeduriaKg/o.TejeduriaKg*100>B.value?"text-red-600":"text-green-600"])},l(I(o.ResiduosTejeduriaKg,o.TejeduriaKg)),3),t("td",ys,l(ne(B.value)),1),t("td",ws,l(me(o.ResiduosTejeduriaKg,o.TejeduriaKg,B.value)),1),t("td",_s,l(ae(o.TejeduriaMetros,o.TejeduriaKg,o.ResiduosTejeduriaKg,B.value)),1),t("td",Fs,l(p(o.AnudadosCount)),1),t("td",Cs,l(Me(o.ResiduosTejeduriaKg,o.AnudadosCount)),1),t("td",Ts,l(Fe(o.TejeduriaMetros,o.TejeduriaKg,o.ResiduosTejeduriaKg,B.value,N.value)),1),t("td",Es,l(p(o.EstopaAzulProducida)),1),t("td",Ds,l(p(o.ResiduosPrensadaKg)),1),t("td",As,l(p(o.DiferenciaEstopa)),1)],42,is))),128)),re.value.length===0&&!Q.value?(b(),m("tr",Rs,[...e[13]||(e[13]=[t("td",{colspan:"22",class:"px-6 py-8 text-center text-slate-500"}," No se encontraron datos para el per√≠odo seleccionado. ",-1)])])):be("",!0)]),re.value.length>0?(b(),m("tfoot",ks,[t("tr",null,[e[14]||(e[14]=t("td",{class:"pl-2 pr-2 py-1 text-center"},"TOTAL",-1)),t("td",js,l(p(a.value.metros)),1),t("td",Ss,l(p(a.value.kg)),1),t("td",$s,l(p(a.value.residuos)),1),t("td",{class:ce(["px-2 py-1 text-right font-mono font-semibold",a.value.kg>0&&a.value.residuos/a.value.kg*100>T.value?"text-red-700":"text-green-700"])},l(I(a.value.residuos,a.value.kg)),3),t("td",Ks,l(ne(T.value)),1),t("td",Is,l(a.value.desvioKg>0?p(a.value.desvioKg):""),1),t("td",Ps,l(a.value.desvioMetros>0?p(a.value.desvioMetros):""),1),t("td",Ms,l(a.value.desvioIndigoPesos>0?Ce(a.value.desvioIndigoPesos):""),1),t("td",Os,l(p(a.value.tejeduriaMetros)),1),t("td",Bs,l(p(a.value.tejeduriaKg)),1),t("td",Ls,l(p(a.value.residuosTejeduriaKg)),1),t("td",{class:ce(["px-2 py-1 text-right font-[Verdana] font-semibold",a.value.tejeduriaKg>0&&a.value.residuosTejeduriaKg/a.value.tejeduriaKg*100>B.value?"text-red-700":"text-green-700"])},l(I(a.value.residuosTejeduriaKg,a.value.tejeduriaKg)),3),t("td",Us,l(ne(B.value)),1),t("td",Ns,l(a.value.desvioTejeduriaKg>0?p(a.value.desvioTejeduriaKg):""),1),t("td",Vs,l(a.value.desvioTejeduriaMetros>0?p(a.value.desvioTejeduriaMetros):""),1),t("td",zs,l(p(a.value.anudadosCount)),1),t("td",Hs,l(je(a.value.residuosTejeduriaKg,a.value.anudadosCount)),1),t("td",Ws,l(a.value.desvioTejeduriaPesos>0?Ce(a.value.desvioTejeduriaPesos):""),1),t("td",Gs,l(p(a.value.estopaAzulProducida)),1),t("td",Js,l(p(a.value.residuosPrensadaKg)),1),t("td",qs,l(p(a.value.diferenciaEstopa)),1)])])):be("",!0)],512)],512)],512),Ve(wo,{show:U.value,"fecha-inicial":ee.value,onClose:e[2]||(e[2]=o=>U.value=!1)},null,8,["show","fecha-inicial"]),Ve(Yo,{show:J.value,onClose:e[3]||(e[3]=o=>J.value=!1),onUpdated:Ae},null,8,["show"])])}}};export{sr as default};
