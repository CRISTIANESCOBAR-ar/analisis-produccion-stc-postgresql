import{m as V,w as Tn,o as Fn,l as zo,E as Mn,a as pe,c as fe,b as D,t as We,e as to,h as Uo,i as Oe,F as tt,r as ct,f as On,q as kn,p as He,n as oo,k as jo}from"./index-DYTbJAB1.js";import{C as no,r as Pn}from"./chart-zkXOqXAa.js";import{p as Rn}from"./chartjs-plugin-datalabels.esm-C5Rd3EbC.js";import{S as ro}from"./sweetalert2.esm.all-AlKuj1Cq.js";import{h as $n}from"./html2canvas.esm-BfYXEYrK.js";import"./exceljs.min-DtXTVuKQ.js";import{_ as Bn}from"./_plugin-vue_export-helper-DlAUqK2U.js";var we="top",$e="bottom",Be="right",ge="left",mo="auto",Ot=[we,$e,Be,ge],wt="start",Ft="end",Nn="clippingParents",sn="viewport",Et="popper",Ln="reference",Wo=Ot.reduce(function(e,t){return e.concat([t+"-"+wt,t+"-"+Ft])},[]),dn=[].concat(Ot,[mo]).reduce(function(e,t){return e.concat([t,t+"-"+wt,t+"-"+Ft])},[]),zn="beforeRead",Un="read",jn="afterRead",Wn="beforeMain",Hn="main",Vn="afterMain",_n="beforeWrite",Gn="write",Yn="afterWrite",qn=[zn,Un,jn,Wn,Hn,Vn,_n,Gn,Yn];function Ge(e){return e?(e.nodeName||"").toLowerCase():null}function Ce(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function ft(e){var t=Ce(e).Element;return e instanceof t||e instanceof Element}function Re(e){var t=Ce(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function vo(e){if(typeof ShadowRoot>"u")return!1;var t=Ce(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function Jn(e){var t=e.state;Object.keys(t.elements).forEach(function(o){var n=t.styles[o]||{},r=t.attributes[o]||{},a=t.elements[o];!Re(a)||!Ge(a)||(Object.assign(a.style,n),Object.keys(r).forEach(function(f){var u=r[f];u===!1?a.removeAttribute(f):a.setAttribute(f,u===!0?"":u)}))})}function Xn(e){var t=e.state,o={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,o.popper),t.styles=o,t.elements.arrow&&Object.assign(t.elements.arrow.style,o.arrow),function(){Object.keys(t.elements).forEach(function(n){var r=t.elements[n],a=t.attributes[n]||{},f=Object.keys(t.styles.hasOwnProperty(n)?t.styles[n]:o[n]),u=f.reduce(function(p,h){return p[h]="",p},{});!Re(r)||!Ge(r)||(Object.assign(r.style,u),Object.keys(a).forEach(function(p){r.removeAttribute(p)}))})}}const cn={name:"applyStyles",enabled:!0,phase:"write",fn:Jn,effect:Xn,requires:["computeStyles"]};function _e(e){return e.split("-")[0]}var pt=Math.max,Gt=Math.min,gt=Math.round;function co(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function un(){return!/^((?!chrome|android).)*safari/i.test(co())}function bt(e,t,o){t===void 0&&(t=!1),o===void 0&&(o=!1);var n=e.getBoundingClientRect(),r=1,a=1;t&&Re(e)&&(r=e.offsetWidth>0&&gt(n.width)/e.offsetWidth||1,a=e.offsetHeight>0&&gt(n.height)/e.offsetHeight||1);var f=ft(e)?Ce(e):window,u=f.visualViewport,p=!un()&&o,h=(n.left+(p&&u?u.offsetLeft:0))/r,d=(n.top+(p&&u?u.offsetTop:0))/a,g=n.width/r,k=n.height/a;return{width:g,height:k,top:d,right:h+g,bottom:d+k,left:h,x:h,y:d}}function xo(e){var t=bt(e),o=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-o)<=1&&(o=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:o,height:n}}function pn(e,t){var o=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(o&&vo(o)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function Qe(e){return Ce(e).getComputedStyle(e)}function Kn(e){return["table","td","th"].indexOf(Ge(e))>=0}function nt(e){return((ft(e)?e.ownerDocument:e.document)||window.document).documentElement}function qt(e){return Ge(e)==="html"?e:e.assignedSlot||e.parentNode||(vo(e)?e.host:null)||nt(e)}function Ho(e){return!Re(e)||Qe(e).position==="fixed"?null:e.offsetParent}function Qn(e){var t=/firefox/i.test(co()),o=/Trident/i.test(co());if(o&&Re(e)){var n=Qe(e);if(n.position==="fixed")return null}var r=qt(e);for(vo(r)&&(r=r.host);Re(r)&&["html","body"].indexOf(Ge(r))<0;){var a=Qe(r);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||t&&a.willChange==="filter"||t&&a.filter&&a.filter!=="none")return r;r=r.parentNode}return null}function kt(e){for(var t=Ce(e),o=Ho(e);o&&Kn(o)&&Qe(o).position==="static";)o=Ho(o);return o&&(Ge(o)==="html"||Ge(o)==="body"&&Qe(o).position==="static")?t:o||Qn(e)||t}function ho(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Dt(e,t,o){return pt(e,Gt(t,o))}function Zn(e,t,o){var n=Dt(e,t,o);return n>o?o:n}function fn(){return{top:0,right:0,bottom:0,left:0}}function mn(e){return Object.assign({},fn(),e)}function vn(e,t){return t.reduce(function(o,n){return o[n]=e,o},{})}var er=function(t,o){return t=typeof t=="function"?t(Object.assign({},o.rects,{placement:o.placement})):t,mn(typeof t!="number"?t:vn(t,Ot))};function tr(e){var t,o=e.state,n=e.name,r=e.options,a=o.elements.arrow,f=o.modifiersData.popperOffsets,u=_e(o.placement),p=ho(u),h=[ge,Be].indexOf(u)>=0,d=h?"height":"width";if(!(!a||!f)){var g=er(r.padding,o),k=xo(a),C=p==="y"?we:ge,S=p==="y"?$e:Be,T=o.rects.reference[d]+o.rects.reference[p]-f[p]-o.rects.popper[d],F=f[p]-o.rects.reference[p],$=kt(a),B=$?p==="y"?$.clientHeight||0:$.clientWidth||0:0,_=T/2-F/2,i=g[C],N=B-k[d]-g[S],y=B/2-k[d]/2+_,Y=Dt(i,y,N),oe=p;o.modifiersData[n]=(t={},t[oe]=Y,t.centerOffset=Y-y,t)}}function or(e){var t=e.state,o=e.options,n=o.element,r=n===void 0?"[data-popper-arrow]":n;r!=null&&(typeof r=="string"&&(r=t.elements.popper.querySelector(r),!r)||pn(t.elements.popper,r)&&(t.elements.arrow=r))}const nr={name:"arrow",enabled:!0,phase:"main",fn:tr,effect:or,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function St(e){return e.split("-")[1]}var rr={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ar(e,t){var o=e.x,n=e.y,r=t.devicePixelRatio||1;return{x:gt(o*r)/r||0,y:gt(n*r)/r||0}}function Vo(e){var t,o=e.popper,n=e.popperRect,r=e.placement,a=e.variation,f=e.offsets,u=e.position,p=e.gpuAcceleration,h=e.adaptive,d=e.roundOffsets,g=e.isFixed,k=f.x,C=k===void 0?0:k,S=f.y,T=S===void 0?0:S,F=typeof d=="function"?d({x:C,y:T}):{x:C,y:T};C=F.x,T=F.y;var $=f.hasOwnProperty("x"),B=f.hasOwnProperty("y"),_=ge,i=we,N=window;if(h){var y=kt(o),Y="clientHeight",oe="clientWidth";if(y===Ce(o)&&(y=nt(o),Qe(y).position!=="static"&&u==="absolute"&&(Y="scrollHeight",oe="scrollWidth")),y=y,r===we||(r===ge||r===Be)&&a===Ft){i=$e;var ee=g&&y===N&&N.visualViewport?N.visualViewport.height:y[Y];T-=ee-n.height,T*=p?1:-1}if(r===ge||(r===we||r===$e)&&a===Ft){_=Be;var G=g&&y===N&&N.visualViewport?N.visualViewport.width:y[oe];C-=G-n.width,C*=p?1:-1}}var L=Object.assign({position:u},h&&rr),z=d===!0?ar({x:C,y:T},Ce(o)):{x:C,y:T};if(C=z.x,T=z.y,p){var q;return Object.assign({},L,(q={},q[i]=B?"0":"",q[_]=$?"0":"",q.transform=(N.devicePixelRatio||1)<=1?"translate("+C+"px, "+T+"px)":"translate3d("+C+"px, "+T+"px, 0)",q))}return Object.assign({},L,(t={},t[i]=B?T+"px":"",t[_]=$?C+"px":"",t.transform="",t))}function ir(e){var t=e.state,o=e.options,n=o.gpuAcceleration,r=n===void 0?!0:n,a=o.adaptive,f=a===void 0?!0:a,u=o.roundOffsets,p=u===void 0?!0:u,h={placement:_e(t.placement),variation:St(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:r,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,Vo(Object.assign({},h,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:f,roundOffsets:p})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,Vo(Object.assign({},h,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:p})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const lr={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:ir,data:{}};var Ht={passive:!0};function sr(e){var t=e.state,o=e.instance,n=e.options,r=n.scroll,a=r===void 0?!0:r,f=n.resize,u=f===void 0?!0:f,p=Ce(t.elements.popper),h=[].concat(t.scrollParents.reference,t.scrollParents.popper);return a&&h.forEach(function(d){d.addEventListener("scroll",o.update,Ht)}),u&&p.addEventListener("resize",o.update,Ht),function(){a&&h.forEach(function(d){d.removeEventListener("scroll",o.update,Ht)}),u&&p.removeEventListener("resize",o.update,Ht)}}const dr={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:sr,data:{}};var cr={left:"right",right:"left",bottom:"top",top:"bottom"};function _t(e){return e.replace(/left|right|bottom|top/g,function(t){return cr[t]})}var ur={start:"end",end:"start"};function _o(e){return e.replace(/start|end/g,function(t){return ur[t]})}function wo(e){var t=Ce(e),o=t.pageXOffset,n=t.pageYOffset;return{scrollLeft:o,scrollTop:n}}function go(e){return bt(nt(e)).left+wo(e).scrollLeft}function pr(e,t){var o=Ce(e),n=nt(e),r=o.visualViewport,a=n.clientWidth,f=n.clientHeight,u=0,p=0;if(r){a=r.width,f=r.height;var h=un();(h||!h&&t==="fixed")&&(u=r.offsetLeft,p=r.offsetTop)}return{width:a,height:f,x:u+go(e),y:p}}function fr(e){var t,o=nt(e),n=wo(e),r=(t=e.ownerDocument)==null?void 0:t.body,a=pt(o.scrollWidth,o.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),f=pt(o.scrollHeight,o.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),u=-n.scrollLeft+go(e),p=-n.scrollTop;return Qe(r||o).direction==="rtl"&&(u+=pt(o.clientWidth,r?r.clientWidth:0)-a),{width:a,height:f,x:u,y:p}}function bo(e){var t=Qe(e),o=t.overflow,n=t.overflowX,r=t.overflowY;return/auto|scroll|overlay|hidden/.test(o+r+n)}function xn(e){return["html","body","#document"].indexOf(Ge(e))>=0?e.ownerDocument.body:Re(e)&&bo(e)?e:xn(qt(e))}function At(e,t){var o;t===void 0&&(t=[]);var n=xn(e),r=n===((o=e.ownerDocument)==null?void 0:o.body),a=Ce(n),f=r?[a].concat(a.visualViewport||[],bo(n)?n:[]):n,u=t.concat(f);return r?u:u.concat(At(qt(f)))}function uo(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function mr(e,t){var o=bt(e,!1,t==="fixed");return o.top=o.top+e.clientTop,o.left=o.left+e.clientLeft,o.bottom=o.top+e.clientHeight,o.right=o.left+e.clientWidth,o.width=e.clientWidth,o.height=e.clientHeight,o.x=o.left,o.y=o.top,o}function Go(e,t,o){return t===sn?uo(pr(e,o)):ft(t)?mr(t,o):uo(fr(nt(e)))}function vr(e){var t=At(qt(e)),o=["absolute","fixed"].indexOf(Qe(e).position)>=0,n=o&&Re(e)?kt(e):e;return ft(n)?t.filter(function(r){return ft(r)&&pn(r,n)&&Ge(r)!=="body"}):[]}function xr(e,t,o,n){var r=t==="clippingParents"?vr(e):[].concat(t),a=[].concat(r,[o]),f=a[0],u=a.reduce(function(p,h){var d=Go(e,h,n);return p.top=pt(d.top,p.top),p.right=Gt(d.right,p.right),p.bottom=Gt(d.bottom,p.bottom),p.left=pt(d.left,p.left),p},Go(e,f,n));return u.width=u.right-u.left,u.height=u.bottom-u.top,u.x=u.left,u.y=u.top,u}function hn(e){var t=e.reference,o=e.element,n=e.placement,r=n?_e(n):null,a=n?St(n):null,f=t.x+t.width/2-o.width/2,u=t.y+t.height/2-o.height/2,p;switch(r){case we:p={x:f,y:t.y-o.height};break;case $e:p={x:f,y:t.y+t.height};break;case Be:p={x:t.x+t.width,y:u};break;case ge:p={x:t.x-o.width,y:u};break;default:p={x:t.x,y:t.y}}var h=r?ho(r):null;if(h!=null){var d=h==="y"?"height":"width";switch(a){case wt:p[h]=p[h]-(t[d]/2-o[d]/2);break;case Ft:p[h]=p[h]+(t[d]/2-o[d]/2);break}}return p}function Mt(e,t){t===void 0&&(t={});var o=t,n=o.placement,r=n===void 0?e.placement:n,a=o.strategy,f=a===void 0?e.strategy:a,u=o.boundary,p=u===void 0?Nn:u,h=o.rootBoundary,d=h===void 0?sn:h,g=o.elementContext,k=g===void 0?Et:g,C=o.altBoundary,S=C===void 0?!1:C,T=o.padding,F=T===void 0?0:T,$=mn(typeof F!="number"?F:vn(F,Ot)),B=k===Et?Ln:Et,_=e.rects.popper,i=e.elements[S?B:k],N=xr(ft(i)?i:i.contextElement||nt(e.elements.popper),p,d,f),y=bt(e.elements.reference),Y=hn({reference:y,element:_,placement:r}),oe=uo(Object.assign({},_,Y)),ee=k===Et?oe:y,G={top:N.top-ee.top+$.top,bottom:ee.bottom-N.bottom+$.bottom,left:N.left-ee.left+$.left,right:ee.right-N.right+$.right},L=e.modifiersData.offset;if(k===Et&&L){var z=L[r];Object.keys(G).forEach(function(q){var me=[Be,$e].indexOf(q)>=0?1:-1,ve=[we,$e].indexOf(q)>=0?"y":"x";G[q]+=z[ve]*me})}return G}function hr(e,t){t===void 0&&(t={});var o=t,n=o.placement,r=o.boundary,a=o.rootBoundary,f=o.padding,u=o.flipVariations,p=o.allowedAutoPlacements,h=p===void 0?dn:p,d=St(n),g=d?u?Wo:Wo.filter(function(S){return St(S)===d}):Ot,k=g.filter(function(S){return h.indexOf(S)>=0});k.length===0&&(k=g);var C=k.reduce(function(S,T){return S[T]=Mt(e,{placement:T,boundary:r,rootBoundary:a,padding:f})[_e(T)],S},{});return Object.keys(C).sort(function(S,T){return C[S]-C[T]})}function wr(e){if(_e(e)===mo)return[];var t=_t(e);return[_o(e),t,_o(t)]}function gr(e){var t=e.state,o=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var r=o.mainAxis,a=r===void 0?!0:r,f=o.altAxis,u=f===void 0?!0:f,p=o.fallbackPlacements,h=o.padding,d=o.boundary,g=o.rootBoundary,k=o.altBoundary,C=o.flipVariations,S=C===void 0?!0:C,T=o.allowedAutoPlacements,F=t.options.placement,$=_e(F),B=$===F,_=p||(B||!S?[_t(F)]:wr(F)),i=[F].concat(_).reduce(function(Te,Se){return Te.concat(_e(Se)===mo?hr(t,{placement:Se,boundary:d,rootBoundary:g,padding:h,flipVariations:S,allowedAutoPlacements:T}):Se)},[]),N=t.rects.reference,y=t.rects.popper,Y=new Map,oe=!0,ee=i[0],G=0;G<i.length;G++){var L=i[G],z=_e(L),q=St(L)===wt,me=[we,$e].indexOf(z)>=0,ve=me?"width":"height",se=Mt(t,{placement:L,boundary:d,rootBoundary:g,altBoundary:k,padding:h}),de=me?q?Be:ge:q?$e:we;N[ve]>y[ve]&&(de=_t(de));var ie=_t(de),be=[];if(a&&be.push(se[z]<=0),u&&be.push(se[de]<=0,se[ie]<=0),be.every(function(Te){return Te})){ee=L,oe=!1;break}Y.set(L,be)}if(oe)for(var Ee=S?3:1,Ye=function(Se){var Fe=i.find(function(le){var xe=Y.get(le);if(xe)return xe.slice(0,Se).every(function(H){return H})});if(Fe)return ee=Fe,"break"},De=Ee;De>0;De--){var Ae=Ye(De);if(Ae==="break")break}t.placement!==ee&&(t.modifiersData[n]._skip=!0,t.placement=ee,t.reset=!0)}}const br={name:"flip",enabled:!0,phase:"main",fn:gr,requiresIfExists:["offset"],data:{_skip:!1}};function Yo(e,t,o){return o===void 0&&(o={x:0,y:0}),{top:e.top-t.height-o.y,right:e.right-t.width+o.x,bottom:e.bottom-t.height+o.y,left:e.left-t.width-o.x}}function qo(e){return[we,Be,$e,ge].some(function(t){return e[t]>=0})}function Sr(e){var t=e.state,o=e.name,n=t.rects.reference,r=t.rects.popper,a=t.modifiersData.preventOverflow,f=Mt(t,{elementContext:"reference"}),u=Mt(t,{altBoundary:!0}),p=Yo(f,n),h=Yo(u,r,a),d=qo(p),g=qo(h);t.modifiersData[o]={referenceClippingOffsets:p,popperEscapeOffsets:h,isReferenceHidden:d,hasPopperEscaped:g},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":g})}const yr={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Sr};function Ir(e,t,o){var n=_e(e),r=[ge,we].indexOf(n)>=0?-1:1,a=typeof o=="function"?o(Object.assign({},t,{placement:e})):o,f=a[0],u=a[1];return f=f||0,u=(u||0)*r,[ge,Be].indexOf(n)>=0?{x:u,y:f}:{x:f,y:u}}function Cr(e){var t=e.state,o=e.options,n=e.name,r=o.offset,a=r===void 0?[0,0]:r,f=dn.reduce(function(d,g){return d[g]=Ir(g,t.rects,a),d},{}),u=f[t.placement],p=u.x,h=u.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=p,t.modifiersData.popperOffsets.y+=h),t.modifiersData[n]=f}const Er={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Cr};function Dr(e){var t=e.state,o=e.name;t.modifiersData[o]=hn({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}const Ar={name:"popperOffsets",enabled:!0,phase:"read",fn:Dr,data:{}};function Tr(e){return e==="x"?"y":"x"}function Fr(e){var t=e.state,o=e.options,n=e.name,r=o.mainAxis,a=r===void 0?!0:r,f=o.altAxis,u=f===void 0?!1:f,p=o.boundary,h=o.rootBoundary,d=o.altBoundary,g=o.padding,k=o.tether,C=k===void 0?!0:k,S=o.tetherOffset,T=S===void 0?0:S,F=Mt(t,{boundary:p,rootBoundary:h,padding:g,altBoundary:d}),$=_e(t.placement),B=St(t.placement),_=!B,i=ho($),N=Tr(i),y=t.modifiersData.popperOffsets,Y=t.rects.reference,oe=t.rects.popper,ee=typeof T=="function"?T(Object.assign({},t.rects,{placement:t.placement})):T,G=typeof ee=="number"?{mainAxis:ee,altAxis:ee}:Object.assign({mainAxis:0,altAxis:0},ee),L=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,z={x:0,y:0};if(y){if(a){var q,me=i==="y"?we:ge,ve=i==="y"?$e:Be,se=i==="y"?"height":"width",de=y[i],ie=de+F[me],be=de-F[ve],Ee=C?-oe[se]/2:0,Ye=B===wt?Y[se]:oe[se],De=B===wt?-oe[se]:-Y[se],Ae=t.elements.arrow,Te=C&&Ae?xo(Ae):{width:0,height:0},Se=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:fn(),Fe=Se[me],le=Se[ve],xe=Dt(0,Y[se],Te[se]),H=_?Y[se]/2-Ee-xe-Fe-G.mainAxis:Ye-xe-Fe-G.mainAxis,ne=_?-Y[se]/2+Ee+xe+le+G.mainAxis:De+xe+le+G.mainAxis,ce=t.elements.arrow&&kt(t.elements.arrow),b=ce?i==="y"?ce.clientTop||0:ce.clientLeft||0:0,U=(q=L==null?void 0:L[i])!=null?q:0,rt=de+H-U-b,Me=de+ne-U,Ze=Dt(C?Gt(ie,rt):ie,de,C?pt(be,Me):be);y[i]=Ze,z[i]=Ze-de}if(u){var ye,at=i==="x"?we:ge,qe=i==="x"?$e:Be,Ne=y[N],je=N==="y"?"height":"width",et=Ne+F[at],Je=Ne-F[qe],it=[we,ge].indexOf($)!==-1,mt=(ye=L==null?void 0:L[N])!=null?ye:0,lt=it?et:Ne-Y[je]-oe[je]-mt+G.altAxis,vt=it?Ne+Y[je]+oe[je]-mt-G.altAxis:Je,Xe=C&&it?Zn(lt,Ne,vt):Dt(C?lt:et,Ne,C?vt:Je);y[N]=Xe,z[N]=Xe-Ne}t.modifiersData[n]=z}}const Mr={name:"preventOverflow",enabled:!0,phase:"main",fn:Fr,requiresIfExists:["offset"]};function Or(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function kr(e){return e===Ce(e)||!Re(e)?wo(e):Or(e)}function Pr(e){var t=e.getBoundingClientRect(),o=gt(t.width)/e.offsetWidth||1,n=gt(t.height)/e.offsetHeight||1;return o!==1||n!==1}function Rr(e,t,o){o===void 0&&(o=!1);var n=Re(t),r=Re(t)&&Pr(t),a=nt(t),f=bt(e,r,o),u={scrollLeft:0,scrollTop:0},p={x:0,y:0};return(n||!n&&!o)&&((Ge(t)!=="body"||bo(a))&&(u=kr(t)),Re(t)?(p=bt(t,!0),p.x+=t.clientLeft,p.y+=t.clientTop):a&&(p.x=go(a))),{x:f.left+u.scrollLeft-p.x,y:f.top+u.scrollTop-p.y,width:f.width,height:f.height}}function $r(e){var t=new Map,o=new Set,n=[];e.forEach(function(a){t.set(a.name,a)});function r(a){o.add(a.name);var f=[].concat(a.requires||[],a.requiresIfExists||[]);f.forEach(function(u){if(!o.has(u)){var p=t.get(u);p&&r(p)}}),n.push(a)}return e.forEach(function(a){o.has(a.name)||r(a)}),n}function Br(e){var t=$r(e);return qn.reduce(function(o,n){return o.concat(t.filter(function(r){return r.phase===n}))},[])}function Nr(e){var t;return function(){return t||(t=new Promise(function(o){Promise.resolve().then(function(){t=void 0,o(e())})})),t}}function Lr(e){var t=e.reduce(function(o,n){var r=o[n.name];return o[n.name]=r?Object.assign({},r,n,{options:Object.assign({},r.options,n.options),data:Object.assign({},r.data,n.data)}):n,o},{});return Object.keys(t).map(function(o){return t[o]})}var Jo={placement:"bottom",modifiers:[],strategy:"absolute"};function Xo(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return!t.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function zr(e){e===void 0&&(e={});var t=e,o=t.defaultModifiers,n=o===void 0?[]:o,r=t.defaultOptions,a=r===void 0?Jo:r;return function(u,p,h){h===void 0&&(h=a);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},Jo,a),modifiersData:{},elements:{reference:u,popper:p},attributes:{},styles:{}},g=[],k=!1,C={state:d,setOptions:function($){var B=typeof $=="function"?$(d.options):$;T(),d.options=Object.assign({},a,d.options,B),d.scrollParents={reference:ft(u)?At(u):u.contextElement?At(u.contextElement):[],popper:At(p)};var _=Br(Lr([].concat(n,d.options.modifiers)));return d.orderedModifiers=_.filter(function(i){return i.enabled}),S(),C.update()},forceUpdate:function(){if(!k){var $=d.elements,B=$.reference,_=$.popper;if(Xo(B,_)){d.rects={reference:Rr(B,kt(_),d.options.strategy==="fixed"),popper:xo(_)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(G){return d.modifiersData[G.name]=Object.assign({},G.data)});for(var i=0;i<d.orderedModifiers.length;i++){if(d.reset===!0){d.reset=!1,i=-1;continue}var N=d.orderedModifiers[i],y=N.fn,Y=N.options,oe=Y===void 0?{}:Y,ee=N.name;typeof y=="function"&&(d=y({state:d,options:oe,name:ee,instance:C})||d)}}}},update:Nr(function(){return new Promise(function(F){C.forceUpdate(),F(d)})}),destroy:function(){T(),k=!0}};if(!Xo(u,p))return C;C.setOptions(h).then(function(F){!k&&h.onFirstUpdate&&h.onFirstUpdate(F)});function S(){d.orderedModifiers.forEach(function(F){var $=F.name,B=F.options,_=B===void 0?{}:B,i=F.effect;if(typeof i=="function"){var N=i({state:d,name:$,instance:C,options:_}),y=function(){};g.push(N||y)}})}function T(){g.forEach(function(F){return F()}),g=[]}return C}}var Ur=[dr,Ar,lr,cn,Er,br,Mr,nr,yr],jr=zr({defaultModifiers:Ur}),Wr="tippy-box",wn="tippy-content",Hr="tippy-backdrop",gn="tippy-arrow",bn="tippy-svg-arrow",ut={passive:!0,capture:!0},Sn=function(){return document.body};function ao(e,t,o){if(Array.isArray(e)){var n=e[t];return n??(Array.isArray(o)?o[t]:o)}return e}function So(e,t){var o={}.toString.call(e);return o.indexOf("[object")===0&&o.indexOf(t+"]")>-1}function yn(e,t){return typeof e=="function"?e.apply(void 0,t):e}function Ko(e,t){if(t===0)return e;var o;return function(n){clearTimeout(o),o=setTimeout(function(){e(n)},t)}}function Vr(e){return e.split(/\s+/).filter(Boolean)}function ht(e){return[].concat(e)}function Qo(e,t){e.indexOf(t)===-1&&e.push(t)}function _r(e){return e.filter(function(t,o){return e.indexOf(t)===o})}function Gr(e){return e.split("-")[0]}function Yt(e){return[].slice.call(e)}function Zo(e){return Object.keys(e).reduce(function(t,o){return e[o]!==void 0&&(t[o]=e[o]),t},{})}function Tt(){return document.createElement("div")}function Jt(e){return["Element","Fragment"].some(function(t){return So(e,t)})}function Yr(e){return So(e,"NodeList")}function qr(e){return So(e,"MouseEvent")}function Jr(e){return!!(e&&e._tippy&&e._tippy.reference===e)}function Xr(e){return Jt(e)?[e]:Yr(e)?Yt(e):Array.isArray(e)?e:Yt(document.querySelectorAll(e))}function io(e,t){e.forEach(function(o){o&&(o.style.transitionDuration=t+"ms")})}function en(e,t){e.forEach(function(o){o&&o.setAttribute("data-state",t)})}function Kr(e){var t,o=ht(e),n=o[0];return n!=null&&(t=n.ownerDocument)!=null&&t.body?n.ownerDocument:document}function Qr(e,t){var o=t.clientX,n=t.clientY;return e.every(function(r){var a=r.popperRect,f=r.popperState,u=r.props,p=u.interactiveBorder,h=Gr(f.placement),d=f.modifiersData.offset;if(!d)return!0;var g=h==="bottom"?d.top.y:0,k=h==="top"?d.bottom.y:0,C=h==="right"?d.left.x:0,S=h==="left"?d.right.x:0,T=a.top-n+g>p,F=n-a.bottom-k>p,$=a.left-o+C>p,B=o-a.right-S>p;return T||F||$||B})}function lo(e,t,o){var n=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(r){e[n](r,o)})}function tn(e,t){for(var o=t;o;){var n;if(e.contains(o))return!0;o=o.getRootNode==null||(n=o.getRootNode())==null?void 0:n.host}return!1}var Ve={isTouch:!1},on=0;function Zr(){Ve.isTouch||(Ve.isTouch=!0,window.performance&&document.addEventListener("mousemove",In))}function In(){var e=performance.now();e-on<20&&(Ve.isTouch=!1,document.removeEventListener("mousemove",In)),on=e}function ea(){var e=document.activeElement;if(Jr(e)){var t=e._tippy;e.blur&&!t.state.isVisible&&e.blur()}}function ta(){document.addEventListener("touchstart",Zr,ut),window.addEventListener("blur",ea)}var oa=typeof window<"u"&&typeof document<"u",na=oa?!!window.msCrypto:!1,ra={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},aa={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},Ue=Object.assign({appendTo:Sn,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},ra,aa),ia=Object.keys(Ue),la=function(t){var o=Object.keys(t);o.forEach(function(n){Ue[n]=t[n]})};function Cn(e){var t=e.plugins||[],o=t.reduce(function(n,r){var a=r.name,f=r.defaultValue;if(a){var u;n[a]=e[a]!==void 0?e[a]:(u=Ue[a])!=null?u:f}return n},{});return Object.assign({},e,o)}function sa(e,t){var o=t?Object.keys(Cn(Object.assign({},Ue,{plugins:t}))):ia,n=o.reduce(function(r,a){var f=(e.getAttribute("data-tippy-"+a)||"").trim();if(!f)return r;if(a==="content")r[a]=f;else try{r[a]=JSON.parse(f)}catch{r[a]=f}return r},{});return n}function nn(e,t){var o=Object.assign({},t,{content:yn(t.content,[e])},t.ignoreAttributes?{}:sa(e,t.plugins));return o.aria=Object.assign({},Ue.aria,o.aria),o.aria={expanded:o.aria.expanded==="auto"?t.interactive:o.aria.expanded,content:o.aria.content==="auto"?t.interactive?null:"describedby":o.aria.content},o}var da=function(){return"innerHTML"};function po(e,t){e[da()]=t}function rn(e){var t=Tt();return e===!0?t.className=gn:(t.className=bn,Jt(e)?t.appendChild(e):po(t,e)),t}function an(e,t){Jt(t.content)?(po(e,""),e.appendChild(t.content)):typeof t.content!="function"&&(t.allowHTML?po(e,t.content):e.textContent=t.content)}function fo(e){var t=e.firstElementChild,o=Yt(t.children);return{box:t,content:o.find(function(n){return n.classList.contains(wn)}),arrow:o.find(function(n){return n.classList.contains(gn)||n.classList.contains(bn)}),backdrop:o.find(function(n){return n.classList.contains(Hr)})}}function En(e){var t=Tt(),o=Tt();o.className=Wr,o.setAttribute("data-state","hidden"),o.setAttribute("tabindex","-1");var n=Tt();n.className=wn,n.setAttribute("data-state","hidden"),an(n,e.props),t.appendChild(o),o.appendChild(n),r(e.props,e.props);function r(a,f){var u=fo(t),p=u.box,h=u.content,d=u.arrow;f.theme?p.setAttribute("data-theme",f.theme):p.removeAttribute("data-theme"),typeof f.animation=="string"?p.setAttribute("data-animation",f.animation):p.removeAttribute("data-animation"),f.inertia?p.setAttribute("data-inertia",""):p.removeAttribute("data-inertia"),p.style.maxWidth=typeof f.maxWidth=="number"?f.maxWidth+"px":f.maxWidth,f.role?p.setAttribute("role",f.role):p.removeAttribute("role"),(a.content!==f.content||a.allowHTML!==f.allowHTML)&&an(h,e.props),f.arrow?d?a.arrow!==f.arrow&&(p.removeChild(d),p.appendChild(rn(f.arrow))):p.appendChild(rn(f.arrow)):d&&p.removeChild(d)}return{popper:t,onUpdate:r}}En.$$tippy=!0;var ca=1,Vt=[],so=[];function ua(e,t){var o=nn(e,Object.assign({},Ue,Cn(Zo(t)))),n,r,a,f=!1,u=!1,p=!1,h=!1,d,g,k,C=[],S=Ko(rt,o.interactiveDebounce),T,F=ca++,$=null,B=_r(o.plugins),_={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},i={id:F,reference:e,popper:Tt(),popperInstance:$,props:o,state:_,plugins:B,clearDelayTimeouts:lt,setProps:vt,setContent:Xe,show:Pt,hide:Xt,hideWithInteractivity:Le,enable:it,disable:mt,unmount:Kt,destroy:Qt};if(!o.render)return i;var N=o.render(i),y=N.popper,Y=N.onUpdate;y.setAttribute("data-tippy-root",""),y.id="tippy-"+i.id,i.popper=y,e._tippy=i,y._tippy=i;var oe=B.map(function(v){return v.fn(i)}),ee=e.hasAttribute("aria-expanded");return ce(),Ee(),de(),ie("onCreate",[i]),o.showOnCreate&&et(),y.addEventListener("mouseenter",function(){i.props.interactive&&i.state.isVisible&&i.clearDelayTimeouts()}),y.addEventListener("mouseleave",function(){i.props.interactive&&i.props.trigger.indexOf("mouseenter")>=0&&me().addEventListener("mousemove",S)}),i;function G(){var v=i.props.touch;return Array.isArray(v)?v:[v,0]}function L(){return G()[0]==="hold"}function z(){var v;return!!((v=i.props.render)!=null&&v.$$tippy)}function q(){return T||e}function me(){var v=q().parentNode;return v?Kr(v):document}function ve(){return fo(y)}function se(v){return i.state.isMounted&&!i.state.isVisible||Ve.isTouch||d&&d.type==="focus"?0:ao(i.props.delay,v?0:1,Ue.delay)}function de(v){v===void 0&&(v=!1),y.style.pointerEvents=i.props.interactive&&!v?"":"none",y.style.zIndex=""+i.props.zIndex}function ie(v,E,l){if(l===void 0&&(l=!0),oe.forEach(function(c){c[v]&&c[v].apply(c,E)}),l){var s;(s=i.props)[v].apply(s,E)}}function be(){var v=i.props.aria;if(v.content){var E="aria-"+v.content,l=y.id,s=ht(i.props.triggerTarget||e);s.forEach(function(c){var x=c.getAttribute(E);if(i.state.isVisible)c.setAttribute(E,x?x+" "+l:l);else{var I=x&&x.replace(l,"").trim();I?c.setAttribute(E,I):c.removeAttribute(E)}})}}function Ee(){if(!(ee||!i.props.aria.expanded)){var v=ht(i.props.triggerTarget||e);v.forEach(function(E){i.props.interactive?E.setAttribute("aria-expanded",i.state.isVisible&&E===q()?"true":"false"):E.removeAttribute("aria-expanded")})}}function Ye(){me().removeEventListener("mousemove",S),Vt=Vt.filter(function(v){return v!==S})}function De(v){if(!(Ve.isTouch&&(p||v.type==="mousedown"))){var E=v.composedPath&&v.composedPath()[0]||v.target;if(!(i.props.interactive&&tn(y,E))){if(ht(i.props.triggerTarget||e).some(function(l){return tn(l,E)})){if(Ve.isTouch||i.state.isVisible&&i.props.trigger.indexOf("click")>=0)return}else ie("onClickOutside",[i,v]);i.props.hideOnClick===!0&&(i.clearDelayTimeouts(),i.hide(),u=!0,setTimeout(function(){u=!1}),i.state.isMounted||Fe())}}}function Ae(){p=!0}function Te(){p=!1}function Se(){var v=me();v.addEventListener("mousedown",De,!0),v.addEventListener("touchend",De,ut),v.addEventListener("touchstart",Te,ut),v.addEventListener("touchmove",Ae,ut)}function Fe(){var v=me();v.removeEventListener("mousedown",De,!0),v.removeEventListener("touchend",De,ut),v.removeEventListener("touchstart",Te,ut),v.removeEventListener("touchmove",Ae,ut)}function le(v,E){H(v,function(){!i.state.isVisible&&y.parentNode&&y.parentNode.contains(y)&&E()})}function xe(v,E){H(v,E)}function H(v,E){var l=ve().box;function s(c){c.target===l&&(lo(l,"remove",s),E())}if(v===0)return E();lo(l,"remove",g),lo(l,"add",s),g=s}function ne(v,E,l){l===void 0&&(l=!1);var s=ht(i.props.triggerTarget||e);s.forEach(function(c){c.addEventListener(v,E,l),C.push({node:c,eventType:v,handler:E,options:l})})}function ce(){L()&&(ne("touchstart",U,{passive:!0}),ne("touchend",Me,{passive:!0})),Vr(i.props.trigger).forEach(function(v){if(v!=="manual")switch(ne(v,U),v){case"mouseenter":ne("mouseleave",Me);break;case"focus":ne(na?"focusout":"blur",Ze);break;case"focusin":ne("focusout",Ze);break}})}function b(){C.forEach(function(v){var E=v.node,l=v.eventType,s=v.handler,c=v.options;E.removeEventListener(l,s,c)}),C=[]}function U(v){var E,l=!1;if(!(!i.state.isEnabled||ye(v)||u)){var s=((E=d)==null?void 0:E.type)==="focus";d=v,T=v.currentTarget,Ee(),!i.state.isVisible&&qr(v)&&Vt.forEach(function(c){return c(v)}),v.type==="click"&&(i.props.trigger.indexOf("mouseenter")<0||f)&&i.props.hideOnClick!==!1&&i.state.isVisible?l=!0:et(v),v.type==="click"&&(f=!l),l&&!s&&Je(v)}}function rt(v){var E=v.target,l=q().contains(E)||y.contains(E);if(!(v.type==="mousemove"&&l)){var s=je().concat(y).map(function(c){var x,I=c._tippy,O=(x=I.popperInstance)==null?void 0:x.state;return O?{popperRect:c.getBoundingClientRect(),popperState:O,props:o}:null}).filter(Boolean);Qr(s,v)&&(Ye(),Je(v))}}function Me(v){var E=ye(v)||i.props.trigger.indexOf("click")>=0&&f;if(!E){if(i.props.interactive){i.hideWithInteractivity(v);return}Je(v)}}function Ze(v){i.props.trigger.indexOf("focusin")<0&&v.target!==q()||i.props.interactive&&v.relatedTarget&&y.contains(v.relatedTarget)||Je(v)}function ye(v){return Ve.isTouch?L()!==v.type.indexOf("touch")>=0:!1}function at(){qe();var v=i.props,E=v.popperOptions,l=v.placement,s=v.offset,c=v.getReferenceClientRect,x=v.moveTransition,I=z()?fo(y).arrow:null,O=c?{getBoundingClientRect:c,contextElement:c.contextElement||q()}:e,w={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(j){var P=j.state;if(z()){var K=ve(),Q=K.box;["placement","reference-hidden","escaped"].forEach(function(te){te==="placement"?Q.setAttribute("data-placement",P.placement):P.attributes.popper["data-popper-"+te]?Q.setAttribute("data-"+te,""):Q.removeAttribute("data-"+te)}),P.attributes.popper={}}}},M=[{name:"offset",options:{offset:s}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!x}},w];z()&&I&&M.push({name:"arrow",options:{element:I,padding:3}}),M.push.apply(M,(E==null?void 0:E.modifiers)||[]),i.popperInstance=jr(O,y,Object.assign({},E,{placement:l,onFirstUpdate:k,modifiers:M}))}function qe(){i.popperInstance&&(i.popperInstance.destroy(),i.popperInstance=null)}function Ne(){var v=i.props.appendTo,E,l=q();i.props.interactive&&v===Sn||v==="parent"?E=l.parentNode:E=yn(v,[l]),E.contains(y)||E.appendChild(y),i.state.isMounted=!0,at()}function je(){return Yt(y.querySelectorAll("[data-tippy-root]"))}function et(v){i.clearDelayTimeouts(),v&&ie("onTrigger",[i,v]),Se();var E=se(!0),l=G(),s=l[0],c=l[1];Ve.isTouch&&s==="hold"&&c&&(E=c),E?n=setTimeout(function(){i.show()},E):i.show()}function Je(v){if(i.clearDelayTimeouts(),ie("onUntrigger",[i,v]),!i.state.isVisible){Fe();return}if(!(i.props.trigger.indexOf("mouseenter")>=0&&i.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(v.type)>=0&&f)){var E=se(!1);E?r=setTimeout(function(){i.state.isVisible&&i.hide()},E):a=requestAnimationFrame(function(){i.hide()})}}function it(){i.state.isEnabled=!0}function mt(){i.hide(),i.state.isEnabled=!1}function lt(){clearTimeout(n),clearTimeout(r),cancelAnimationFrame(a)}function vt(v){if(!i.state.isDestroyed){ie("onBeforeUpdate",[i,v]),b();var E=i.props,l=nn(e,Object.assign({},E,Zo(v),{ignoreAttributes:!0}));i.props=l,ce(),E.interactiveDebounce!==l.interactiveDebounce&&(Ye(),S=Ko(rt,l.interactiveDebounce)),E.triggerTarget&&!l.triggerTarget?ht(E.triggerTarget).forEach(function(s){s.removeAttribute("aria-expanded")}):l.triggerTarget&&e.removeAttribute("aria-expanded"),Ee(),de(),Y&&Y(E,l),i.popperInstance&&(at(),je().forEach(function(s){requestAnimationFrame(s._tippy.popperInstance.forceUpdate)})),ie("onAfterUpdate",[i,v])}}function Xe(v){i.setProps({content:v})}function Pt(){var v=i.state.isVisible,E=i.state.isDestroyed,l=!i.state.isEnabled,s=Ve.isTouch&&!i.props.touch,c=ao(i.props.duration,0,Ue.duration);if(!(v||E||l||s)&&!q().hasAttribute("disabled")&&(ie("onShow",[i],!1),i.props.onShow(i)!==!1)){if(i.state.isVisible=!0,z()&&(y.style.visibility="visible"),de(),Se(),i.state.isMounted||(y.style.transition="none"),z()){var x=ve(),I=x.box,O=x.content;io([I,O],0)}k=function(){var M;if(!(!i.state.isVisible||h)){if(h=!0,y.offsetHeight,y.style.transition=i.props.moveTransition,z()&&i.props.animation){var W=ve(),j=W.box,P=W.content;io([j,P],c),en([j,P],"visible")}be(),Ee(),Qo(so,i),(M=i.popperInstance)==null||M.forceUpdate(),ie("onMount",[i]),i.props.animation&&z()&&xe(c,function(){i.state.isShown=!0,ie("onShown",[i])})}},Ne()}}function Xt(){var v=!i.state.isVisible,E=i.state.isDestroyed,l=!i.state.isEnabled,s=ao(i.props.duration,1,Ue.duration);if(!(v||E||l)&&(ie("onHide",[i],!1),i.props.onHide(i)!==!1)){if(i.state.isVisible=!1,i.state.isShown=!1,h=!1,f=!1,z()&&(y.style.visibility="hidden"),Ye(),Fe(),de(!0),z()){var c=ve(),x=c.box,I=c.content;i.props.animation&&(io([x,I],s),en([x,I],"hidden"))}be(),Ee(),i.props.animation?z()&&le(s,i.unmount):i.unmount()}}function Le(v){me().addEventListener("mousemove",S),Qo(Vt,S),S(v)}function Kt(){i.state.isVisible&&i.hide(),i.state.isMounted&&(qe(),je().forEach(function(v){v._tippy.unmount()}),y.parentNode&&y.parentNode.removeChild(y),so=so.filter(function(v){return v!==i}),i.state.isMounted=!1,ie("onHidden",[i]))}function Qt(){i.state.isDestroyed||(i.clearDelayTimeouts(),i.unmount(),b(),delete e._tippy,i.state.isDestroyed=!0,ie("onDestroy",[i]))}}function Pe(e,t){t===void 0&&(t={});var o=Ue.plugins.concat(t.plugins||[]);ta();var n=Object.assign({},t,{plugins:o}),r=Xr(e),a=r.reduce(function(f,u){var p=u&&ua(u,n);return p&&f.push(p),f},[]);return Jt(e)?a[0]:a}Pe.defaultProps=Ue;Pe.setDefaultProps=la;Pe.currentInput=Ve;Object.assign({},cn,{effect:function(t){var o=t.state,n={popper:{position:o.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(o.elements.popper.style,n.popper),o.styles=n,o.elements.arrow&&Object.assign(o.elements.arrow.style,n.arrow)}});Pe.setDefaultProps({render:En});const m={headerBg:"#B4C6E7",white:"#FFFFFF",black:"#000000",green:"#3C7D22",red:"#FF0000",borderColor:"#0C769E"},ot={fontSize:10,fontFamily:"Verdana, sans-serif",cellPadding:4},yo=[34,23,44,23,22,22,22,22,22,22,23,23,23,23,23,23],Io=[32,32,31,31,31,31,31,31,33,31,33,31,31,31,31,31,31,31,31,31,31,31];function X(e,t=0){return e==null||isNaN(e)?"0":(t===0?Math.round(e):Number(e.toFixed(t))).toLocaleString("es-AR",{minimumFractionDigits:t,maximumFractionDigits:t})}function ke(e,t=0){if(e==null||isNaN(e))return"0";const o=X(Math.abs(e),t);return e>=0?`+${o}`:`-${o}`}function ln(e){return e==null||isNaN(e)?"0":Math.round(e).toString()}function ze(e){return e==null||isNaN(e)?"0.0":e.toFixed(1)}function J(e){return e==null||isNaN(e)?"0.00":e.toFixed(2)}function pa(e){let t=0;for(let o=0;o<e-1;o++)t+=yo[o]||0;return t}function fa(e){let t=0;for(let o=0;o<e-1;o++)t+=Io[o]||0;return t}function ma(e,t){let o=0;for(let n=e-1;n<e-1+t;n++)o+=yo[n]||0;return o}function va(e,t){let o=0;for(let n=e-1;n<e-1+t;n++)o+=Io[n]||0;return o}function xa(e,t,o,n,r,a){e.fillStyle=a,e.fillRect(t,o,n,r)}function ha(e,t,o,n,r,a,f={}){const{align:u="center",color:p=m.black,bold:h=!1,fontSize:d=ot.fontSize,valign:g="middle"}=f;e.save(),e.fillStyle=p,e.font=`${h?"bold ":""}${d}px ${ot.fontFamily}`,g==="bottom"?e.textBaseline="bottom":g==="top"?e.textBaseline="top":e.textBaseline="middle";let k;u==="left"?(e.textAlign="left",k=o+ot.cellPadding):u==="right"?(e.textAlign="right",k=o+r-ot.cellPadding):(e.textAlign="center",k=o+r/2);const C=String(t).split(`
`);if(C.length>1){const S=d*1.2,T=S*C.length;let F;g==="bottom"?F=n+a-T+S/2:g==="top"?F=n+S/2:F=n+(a-T)/2+S/2,C.forEach(($,B)=>{e.fillText($,k,F+B*S)})}else{let S;g==="bottom"?S=n+a-ot.cellPadding:g==="top"?S=n+ot.cellPadding:S=n+a/2,e.fillText(t,k,S)}e.restore()}function wa(e,t,o,n,r,a,f={}){const{color:u=m.black,fontSize:p=10,bold:h=!1}=f;e.save(),e.fillStyle=u,e.font=`${h?"bold ":""}${p}px ${ot.fontFamily}`,e.textAlign="center",e.textBaseline="middle",e.translate(o+r/2,n+a/2),e.rotate(-Math.PI/2),e.fillText(t,0,0),e.restore()}function ga(e){const{fecha:t,sectores:o,totals:n,metaTargets:r,differences:a,pts100m2:f,indigoData:u,indigoMetas:p,estopaAzulData:h,tecelagemData:d,acabamentoData:g}=e,k=N=>o.find(y=>y.sector===N)||{metrosDia:0,metrosMes:0,percDia:0,percMes:0,metaPct:0},C=k("S/ Def."),S=k("FIACAO"),T=k("INDIGO"),F=k("TECELAGEM"),$=k("ACABMTO"),B=k("GERAL"),_=n.day,i=n.month;return[{rowIndex:1,colIndex:1,colSpan:3,rowSpan:1,text:t,bold:!0,bgColor:"#215C98",color:m.white},{rowIndex:1,colIndex:4,colSpan:7,rowSpan:1,text:"Metros [m]",bold:!0,bgColor:m.headerBg},{rowIndex:1,colIndex:11,colSpan:6,rowSpan:1,text:"Porcentaje [%]",bold:!0,bgColor:m.headerBg},{rowIndex:2,colIndex:1,colSpan:3,rowSpan:1,text:"Sector",bold:!0,bgColor:m.headerBg},{rowIndex:2,colIndex:4,colSpan:3,rowSpan:1,text:"Dia",bold:!0,bgColor:m.headerBg},{rowIndex:2,colIndex:7,colSpan:4,rowSpan:1,text:"Acumulado",bold:!0,bgColor:m.headerBg},{rowIndex:2,colIndex:11,colSpan:2,rowSpan:1,text:"Dia",bold:!0,bgColor:m.headerBg},{rowIndex:2,colIndex:13,colSpan:2,rowSpan:1,text:"Mes",bold:!0,bgColor:m.headerBg},{rowIndex:2,colIndex:15,colSpan:2,rowSpan:1,text:"Meta",bold:!0,bgColor:m.headerBg},{rowIndex:3,colIndex:1,colSpan:3,rowSpan:1,text:C.sector,align:"center",bgColor:"#DAE9F8"},{rowIndex:3,colIndex:4,colSpan:3,rowSpan:1,text:X(C.metrosDia),align:"center",bgColor:"#DAE9F8"},{rowIndex:3,colIndex:7,colSpan:4,rowSpan:1,text:X(C.metrosMes),align:"center",bgColor:"#DAE9F8"},{rowIndex:3,colIndex:11,colSpan:2,rowSpan:1,text:J(C.percDia),bgColor:"#DAE9F8"},{rowIndex:3,colIndex:13,colSpan:2,rowSpan:1,text:J(C.percMes),bgColor:"#DAE9F8"},{rowIndex:3,colIndex:15,colSpan:2,rowSpan:1,text:J(C.metaPct),bgColor:"#DAE9F8"},{rowIndex:4,colIndex:1,colSpan:3,rowSpan:1,text:S.sector,align:"center",bgColor:m.white},{rowIndex:4,colIndex:4,colSpan:3,rowSpan:1,text:X(S.metrosDia),align:"center",bgColor:m.white},{rowIndex:4,colIndex:7,colSpan:4,rowSpan:1,text:X(S.metrosMes),align:"center",bgColor:m.white},{rowIndex:4,colIndex:11,colSpan:2,rowSpan:1,text:J(S.percDia),bgColor:m.white},{rowIndex:4,colIndex:13,colSpan:2,rowSpan:1,text:J(S.percMes),bgColor:m.white},{rowIndex:4,colIndex:15,colSpan:2,rowSpan:1,text:J(S.metaPct),bgColor:m.white},{rowIndex:5,colIndex:1,colSpan:3,rowSpan:1,text:T.sector,align:"center",bgColor:"#DAE9F8"},{rowIndex:5,colIndex:4,colSpan:3,rowSpan:1,text:X(T.metrosDia),align:"center",bgColor:"#DAE9F8"},{rowIndex:5,colIndex:7,colSpan:4,rowSpan:1,text:X(T.metrosMes),align:"center",bgColor:"#DAE9F8"},{rowIndex:5,colIndex:11,colSpan:2,rowSpan:1,text:J(T.percDia),bgColor:"#DAE9F8"},{rowIndex:5,colIndex:13,colSpan:2,rowSpan:1,text:J(T.percMes),bgColor:"#DAE9F8"},{rowIndex:5,colIndex:15,colSpan:2,rowSpan:1,text:J(T.metaPct),bgColor:"#DAE9F8"},{rowIndex:6,colIndex:1,colSpan:3,rowSpan:1,text:F.sector,align:"center",bgColor:m.white},{rowIndex:6,colIndex:4,colSpan:3,rowSpan:1,text:X(F.metrosDia),align:"center",bgColor:m.white},{rowIndex:6,colIndex:7,colSpan:4,rowSpan:1,text:X(F.metrosMes),align:"center",bgColor:m.white},{rowIndex:6,colIndex:11,colSpan:2,rowSpan:1,text:J(F.percDia),bgColor:m.white},{rowIndex:6,colIndex:13,colSpan:2,rowSpan:1,text:J(F.percMes),bgColor:m.white},{rowIndex:6,colIndex:15,colSpan:2,rowSpan:1,text:J(F.metaPct),bgColor:m.white},{rowIndex:7,colIndex:1,colSpan:3,rowSpan:1,text:$.sector,align:"center",bgColor:"#DAE9F8"},{rowIndex:7,colIndex:4,colSpan:3,rowSpan:1,text:X($.metrosDia),align:"center",bgColor:"#DAE9F8"},{rowIndex:7,colIndex:7,colSpan:4,rowSpan:1,text:X($.metrosMes),align:"center",bgColor:"#DAE9F8"},{rowIndex:7,colIndex:11,colSpan:2,rowSpan:1,text:J($.percDia),bgColor:"#DAE9F8"},{rowIndex:7,colIndex:13,colSpan:2,rowSpan:1,text:J($.percMes),bgColor:"#DAE9F8"},{rowIndex:7,colIndex:15,colSpan:2,rowSpan:1,text:J($.metaPct),bgColor:"#DAE9F8"},{rowIndex:8,colIndex:1,colSpan:3,rowSpan:1,text:B.sector,align:"center",bgColor:m.white},{rowIndex:8,colIndex:4,colSpan:3,rowSpan:1,text:X(B.metrosDia),align:"center",bgColor:m.white},{rowIndex:8,colIndex:7,colSpan:4,rowSpan:1,text:X(B.metrosMes),align:"center",bgColor:m.white},{rowIndex:8,colIndex:11,colSpan:2,rowSpan:1,text:J(B.percDia),bgColor:m.white},{rowIndex:8,colIndex:13,colSpan:2,rowSpan:1,text:J(B.percMes),bgColor:m.white},{rowIndex:8,colIndex:15,colSpan:2,rowSpan:1,text:J(B.metaPct),bgColor:m.white},{rowIndex:9,colIndex:1,colSpan:3,rowSpan:1,text:"Revisado",bold:!0,bgColor:m.white},{rowIndex:9,colIndex:4,colSpan:3,rowSpan:1,text:X(_),bold:!0,bgColor:m.white,color:_>=r.day?m.green:m.red},{rowIndex:9,colIndex:7,colSpan:4,rowSpan:1,text:X(i),bold:!0,bgColor:m.white,color:i>=r.month?m.green:m.red},{rowIndex:9,colIndex:11,colSpan:2,rowSpan:1,text:"100",bold:!0,bgColor:m.white},{rowIndex:9,colIndex:13,colSpan:2,rowSpan:1,text:"100",bold:!0,bgColor:m.white},{rowIndex:9,colIndex:15,colSpan:2,rowSpan:1,text:"100",bold:!0,bgColor:m.white},{rowIndex:10,colIndex:1,colSpan:3,rowSpan:1,text:"Meta",bgColor:m.white},{rowIndex:10,colIndex:4,colSpan:3,rowSpan:1,text:X(r.day),bgColor:m.white},{rowIndex:10,colIndex:7,colSpan:4,rowSpan:1,text:X(r.month),bgColor:m.white},{rowIndex:10,colIndex:11,colSpan:2,rowSpan:1,text:"Pts",bgColor:"#B5E6A2",valign:"bottom"},{rowIndex:10,colIndex:13,colSpan:2,rowSpan:1,text:"Dia",bgColor:"#B5E6A2"},{rowIndex:10,colIndex:15,colSpan:2,rowSpan:1,text:"Mes",bgColor:"#B5E6A2"},{rowIndex:11,colIndex:1,colSpan:3,rowSpan:1,text:"Diferencia",bold:!0,bgColor:m.white},{rowIndex:11,colIndex:4,colSpan:3,rowSpan:1,text:ke(a.day),bold:!0,bgColor:m.white,color:a.day>=0?m.green:m.red},{rowIndex:11,colIndex:7,colSpan:4,rowSpan:1,text:ke(a.month),bold:!0,bgColor:m.white,color:a.month>=0?m.green:m.red},{rowIndex:11,colIndex:11,colSpan:2,rowSpan:1,text:"100m²",bgColor:"#B5E6A2",valign:"top"},{rowIndex:11,colIndex:13,colSpan:2,rowSpan:1,text:J(f.day),bold:!0,bgColor:m.white},{rowIndex:11,colIndex:15,colSpan:2,rowSpan:1,text:J(f.month),bold:!0,bgColor:m.white},{rowIndex:12,colIndex:1,colSpan:1,rowSpan:1,text:"Sec",bold:!0,bgColor:"#A6C9EC"},{rowIndex:12,colIndex:2,colSpan:2,rowSpan:1,text:"Variable",bold:!0,bgColor:"#A6C9EC"},{rowIndex:12,colIndex:4,colSpan:3,rowSpan:1,text:"Meta Día",bold:!0,bgColor:"#A6C9EC"},{rowIndex:12,colIndex:7,colSpan:3,rowSpan:1,text:"Prod. Día",bold:!0,bgColor:"#A6C9EC"},{rowIndex:12,colIndex:10,colSpan:4,rowSpan:1,text:"Acumulado",bold:!0,bgColor:"#A6C9EC"},{rowIndex:12,colIndex:14,colSpan:3,rowSpan:1,text:`Sob./Fal.
Mes`,bold:!0,bgColor:"#A6C9EC"},{rowIndex:13,colIndex:1,colSpan:1,rowSpan:3,text:"INDIGO",vertical:!0,bgColor:"#DAE9F8"},{rowIndex:13,colIndex:2,colSpan:2,rowSpan:1,text:"Metros",bgColor:"#DAE9F8"},{rowIndex:13,colIndex:4,colSpan:3,rowSpan:1,text:X(u.day.meta),bgColor:"#DAE9F8"},{rowIndex:13,colIndex:7,colSpan:3,rowSpan:1,text:X(u.day.metros),bgColor:"#DAE9F8",color:u.day.metros>=u.day.meta?m.green:m.red},{rowIndex:13,colIndex:10,colSpan:4,rowSpan:1,text:X(u.month.metros),bgColor:"#DAE9F8",color:u.month.metros>=u.month.metaAcumulada?m.green:m.red},{rowIndex:13,colIndex:14,colSpan:3,rowSpan:1,text:ke(u.month.metros-u.month.metaAcumulada),bgColor:"#DAE9F8",color:u.month.metros-u.month.metaAcumulada>=0?m.green:m.red},{rowIndex:14,colIndex:2,colSpan:2,rowSpan:1,text:"Roturas 10³",bgColor:"#DAE9F8"},{rowIndex:14,colIndex:4,colSpan:3,rowSpan:1,text:ln(p.rot103),bgColor:"#DAE9F8"},{rowIndex:14,colIndex:7,colSpan:3,rowSpan:1,text:J(u.day.rot103),bgColor:"#DAE9F8",color:u.day.rot103<=p.rot103?m.green:m.red},{rowIndex:14,colIndex:10,colSpan:4,rowSpan:1,text:J(u.month.rot103),bgColor:"#DAE9F8",color:u.month.rot103<=p.rot103?m.green:m.red},{rowIndex:14,colIndex:14,colSpan:3,rowSpan:1,text:ke(u.month.rot103-p.rot103,2),bgColor:"#DAE9F8",color:p.rot103-u.month.rot103>=0?m.green:m.red},{rowIndex:15,colIndex:2,colSpan:2,rowSpan:1,text:"Est. Azul %",bgColor:"#DAE9F8"},{rowIndex:15,colIndex:4,colSpan:3,rowSpan:1,text:ln(p.estopaAzul),bgColor:"#DAE9F8"},{rowIndex:15,colIndex:7,colSpan:3,rowSpan:1,text:J(h.day.porcentaje),bgColor:"#DAE9F8",color:h.day.porcentaje<=p.estopaAzul?m.green:m.red},{rowIndex:15,colIndex:10,colSpan:4,rowSpan:1,text:J(h.month.porcentaje),bgColor:"#DAE9F8",color:h.month.porcentaje<=p.estopaAzul?m.green:m.red},{rowIndex:15,colIndex:14,colSpan:3,rowSpan:1,text:ke(h.month.porcentaje-p.estopaAzul,2),bgColor:"#DAE9F8",color:p.estopaAzul-h.month.porcentaje>=0?m.green:m.red},{rowIndex:16,colIndex:1,colSpan:1,rowSpan:5,text:"TECELAGEM",vertical:!0},{rowIndex:16,colIndex:2,colSpan:2,rowSpan:1,text:"Metros"},{rowIndex:16,colIndex:4,colSpan:3,rowSpan:1,text:X(d.day.meta)},{rowIndex:16,colIndex:7,colSpan:3,rowSpan:1,text:X(d.day.metros),color:d.day.metros>=d.day.meta?m.green:m.red},{rowIndex:16,colIndex:10,colSpan:4,rowSpan:1,text:X(d.month.metros),color:d.month.metros>=d.month.metaAcumulada?m.green:m.red},{rowIndex:16,colIndex:14,colSpan:3,rowSpan:1,text:ke(d.month.metros-d.month.metaAcumulada),color:d.month.metros-d.month.metaAcumulada>=0?m.green:m.red},{rowIndex:17,colIndex:2,colSpan:2,rowSpan:1,text:"Eficiencia %"},{rowIndex:17,colIndex:4,colSpan:3,rowSpan:1,text:X(d.day.metaEfi)},{rowIndex:17,colIndex:7,colSpan:3,rowSpan:1,text:ze(d.day.eficiencia),color:d.day.eficiencia>=d.day.metaEfi?m.green:m.red},{rowIndex:17,colIndex:10,colSpan:4,rowSpan:1,text:ze(d.month.eficiencia),color:d.month.eficiencia>=d.month.metaEfi?m.green:m.red},{rowIndex:17,colIndex:14,colSpan:3,rowSpan:1,text:ke(d.month.eficiencia-d.month.metaEfi,1),color:d.month.eficiencia-d.month.metaEfi>=0?m.green:m.red},{rowIndex:18,colIndex:2,colSpan:2,rowSpan:1,text:"Rot. TRA 10⁵"},{rowIndex:18,colIndex:4,colSpan:3,rowSpan:1,text:ze(d.day.metaRt105)},{rowIndex:18,colIndex:7,colSpan:3,rowSpan:1,text:ze(d.day.rotTra105),color:d.day.rotTra105<=d.day.metaRt105?m.green:m.red},{rowIndex:18,colIndex:10,colSpan:4,rowSpan:1,text:ze(d.month.rotTra105),color:d.month.rotTra105<=d.month.metaRt105?m.green:m.red},{rowIndex:18,colIndex:14,colSpan:3,rowSpan:1,text:ke(d.month.rotTra105-d.month.metaRt105,1),color:d.month.metaRt105-d.month.rotTra105>=0?m.green:m.red},{rowIndex:19,colIndex:2,colSpan:2,rowSpan:1,text:"Rot. URD 10⁵"},{rowIndex:19,colIndex:4,colSpan:3,rowSpan:1,text:ze(d.day.metaRu105)},{rowIndex:19,colIndex:7,colSpan:3,rowSpan:1,text:ze(d.day.rotUrd105),color:d.day.rotUrd105<=d.day.metaRu105?m.green:m.red},{rowIndex:19,colIndex:10,colSpan:4,rowSpan:1,text:ze(d.month.rotUrd105),color:d.month.rotUrd105<=d.month.metaRu105?m.green:m.red},{rowIndex:19,colIndex:14,colSpan:3,rowSpan:1,text:ke(d.month.rotUrd105-d.month.metaRu105,1),color:d.month.metaRu105-d.month.rotUrd105>=0?m.green:m.red},{rowIndex:20,colIndex:2,colSpan:2,rowSpan:1,text:"Est. Azul %"},{rowIndex:20,colIndex:4,colSpan:3,rowSpan:1,text:ze(d.day.metaEstopaAzul)},{rowIndex:20,colIndex:7,colSpan:3,rowSpan:1,text:ze(d.day.estopaAzulPct),color:d.day.estopaAzulPct<=d.day.metaEstopaAzul?m.green:m.red},{rowIndex:20,colIndex:10,colSpan:4,rowSpan:1,text:ze(d.month.estopaAzulPct),color:d.month.estopaAzulPct<=d.month.metaEstopaAzul?m.green:m.red},{rowIndex:20,colIndex:14,colSpan:3,rowSpan:1,text:ke(d.month.metaEstopaAzul-d.month.estopaAzulPct,1),color:d.month.metaEstopaAzul-d.month.estopaAzulPct>=0?m.green:m.red},{rowIndex:21,colIndex:1,colSpan:1,rowSpan:2,text:"ACAB",vertical:!0,bgColor:"#E8D5F0"},{rowIndex:21,colIndex:2,colSpan:2,rowSpan:1,text:"Metros",bgColor:"#E8D5F0"},{rowIndex:21,colIndex:4,colSpan:3,rowSpan:1,text:X(g.day.meta),bgColor:"#E8D5F0"},{rowIndex:21,colIndex:7,colSpan:3,rowSpan:1,text:X(g.day.metros),bgColor:"#E8D5F0",color:g.day.metros>=g.day.meta?m.green:m.red},{rowIndex:21,colIndex:10,colSpan:4,rowSpan:1,text:X(g.month.metros),bgColor:"#E8D5F0",color:g.month.metros>=g.month.metaAcumulada?m.green:m.red},{rowIndex:21,colIndex:14,colSpan:3,rowSpan:1,text:ke(g.month.metros-g.month.metaAcumulada),bgColor:"#E8D5F0",color:g.month.metros-g.month.metaAcumulada>=0?m.green:m.red},{rowIndex:22,colIndex:2,colSpan:2,rowSpan:1,text:"ENC URD %",bgColor:"#E8D5F0"},{rowIndex:22,colIndex:4,colSpan:3,rowSpan:1,text:J(g.day.metaEncUrd),bgColor:"#E8D5F0"},{rowIndex:22,colIndex:7,colSpan:3,rowSpan:1,text:J(g.day.encUrdPct),bgColor:"#E8D5F0",color:g.day.encUrdPct>=g.day.metaEncUrd?m.green:m.red},{rowIndex:22,colIndex:10,colSpan:4,rowSpan:1,text:J(g.month.encUrdPct),bgColor:"#E8D5F0",color:g.month.encUrdPct>=g.month.metaEncUrd?m.green:m.red},{rowIndex:22,colIndex:14,colSpan:3,rowSpan:1,text:ke(g.month.encUrdPct-g.month.metaEncUrd),bgColor:"#E8D5F0",color:g.month.encUrdPct-g.month.metaEncUrd>=0?m.green:m.red}]}function ba(e,t){const o=pa(t.colIndex),n=fa(t.rowIndex),r=ma(t.colIndex,t.colSpan),a=va(t.rowIndex,t.rowSpan);if(t.bgColor&&xa(e,o,n,r,a,t.bgColor),t.text!==void 0&&t.text!==null){const f={align:t.align||"center",color:t.color||m.black,bold:t.bold||!1,fontSize:ot.fontSize,valign:t.valign||"middle"};t.vertical?wa(e,t.text,o,n,r,a,f):ha(e,t.text,o,n,r,a,f)}e.strokeStyle=m.borderColor,e.lineWidth=1,t.rowIndex===10&&t.colIndex===11?(e.beginPath(),e.moveTo(o,n),e.lineTo(o+r,n),e.moveTo(o,n),e.lineTo(o,n+a),e.moveTo(o+r,n),e.lineTo(o+r,n+a),e.stroke()):t.rowIndex===11&&t.colIndex===11?(e.beginPath(),e.moveTo(o,n+a),e.lineTo(o+r,n+a),e.moveTo(o,n),e.lineTo(o,n+a),e.stroke(),e.lineWidth=2,e.beginPath(),e.moveTo(o+r,n),e.lineTo(o+r,n+a),e.stroke(),e.lineWidth=1):e.strokeRect(o,n,r,a),t.rowIndex===2&&(e.lineWidth=3,e.beginPath(),e.moveTo(o,n+a),e.lineTo(o+r,n+a),e.stroke()),t.rowIndex===8&&(e.lineWidth=1,e.beginPath(),e.moveTo(o,n+a-3),e.lineTo(o+r,n+a-3),e.stroke(),e.fillStyle=m.white,e.fillRect(o,n+a-2,r,1),e.beginPath(),e.moveTo(o,n+a),e.lineTo(o+r,n+a),e.stroke()),t.rowIndex===11&&(e.strokeStyle=m.black,e.lineWidth=4,e.beginPath(),e.moveTo(o,n+a),e.lineTo(o+r,n+a),e.stroke()),t.rowIndex>=1&&t.rowIndex<=11&&t.colIndex+t.colSpan-1===3&&(e.lineWidth=3,e.beginPath(),e.moveTo(o+r,n),e.lineTo(o+r,n+a),e.stroke()),t.rowIndex>=1&&t.rowIndex<=11&&t.colIndex+t.colSpan-1===10&&(e.strokeStyle=m.borderColor,e.lineWidth=t.rowIndex<=10?3:2,e.beginPath(),e.moveTo(o+r,n),e.lineTo(o+r,n+a),e.stroke()),t.rowIndex===10&&!(t.colIndex>=11&&t.colIndex<=12)&&(e.strokeStyle=m.black,e.lineWidth=4,e.beginPath(),e.moveTo(o,n+a),e.lineTo(o+r,n+a),e.stroke()),t.rowIndex===10&&t.colIndex>=11&&t.colIndex<=16&&(e.strokeStyle=m.borderColor,e.lineWidth=2,e.beginPath(),e.moveTo(o,n),e.lineTo(o+r,n),e.stroke()),t.rowIndex===11&&t.colIndex>=13&&t.colIndex<=16&&(e.strokeStyle=m.borderColor,e.lineWidth=2,e.beginPath(),e.moveTo(o,n),e.lineTo(o+r,n),e.stroke()),t.rowIndex===14&&t.colIndex+t.colSpan-1===10&&(e.strokeStyle=m.borderColor,e.lineWidth=4,e.beginPath(),e.moveTo(o+r,n),e.lineTo(o+r,n+a),e.stroke()),t.rowIndex===16&&(e.strokeStyle=m.borderColor,e.lineWidth=3,e.beginPath(),e.moveTo(o,n),e.lineTo(o+r,n),e.stroke()),t.rowIndex===20&&(e.strokeStyle=m.borderColor,e.lineWidth=3,e.beginPath(),e.moveTo(o,n+a),e.lineTo(o+r,n+a),e.stroke())}function Sa(e){const t=ga(e),o=yo.reduce((u,p)=>u+p,0),n=Io.reduce((u,p)=>u+p,0),r=document.createElement("canvas"),a=2;r.width=o*a,r.height=n*a;const f=r.getContext("2d");return f.scale(a,a),f.fillStyle=m.white,f.fillRect(0,0,o,n),t.forEach(u=>{ba(f,u)}),r}async function ya(e){const t=Sa(e);return new Promise((o,n)=>{t.toBlob(r=>{r?o(r):n(new Error("Error creando blob"))},"image/png",1)})}async function Ia(e){const t=await ya(e);if(navigator.clipboard&&navigator.clipboard.write){const o=new ClipboardItem({"image/png":t});return await navigator.clipboard.write([o]),!0}throw new Error("Clipboard API no disponible")}const Ca={class:"w-full h-screen px-2 md:px-4 py-3 flex flex-col relative"},Ea={key:0,class:"fixed inset-0 bg-white/40 backdrop-blur-[2px] flex items-center justify-center z-[9999] transition-all duration-300"},Da={class:"flex flex-col items-center gap-4 bg-white/90 px-10 py-8 rounded-2xl shadow-2xl border border-blue-100"},Aa={class:"flex flex-col items-center gap-1"},Ta={class:"text-xl text-slate-800 font-bold"},Fa={class:"flex flex-col gap-2 flex-1 min-h-0"},Ma={class:"flex gap-3 flex-1 min-h-0"},Oa={class:"quality-card shadow border border-slate-200 rounded overflow-hidden flex flex-col relative",style:{width:"fit-content",flex:"0 0 auto"}},ka={class:"flex items-center justify-between bg-gray-100 text-slate-800 px-2 py-1.5 text-xs font-semibold border-b border-slate-200"},Pa={class:"flex items-center gap-1.5"},Ra=["value"],$a={key:0,class:"calendar-dropdown"},Ba={class:"calendar-header"},Na={class:"calendar-selects"},La=["value"],za=["value"],Ua=["value"],ja=["value"],Wa={class:"calendar-weekdays"},Ha={class:"calendar-days"},Va=["onClick","disabled"],_a=["disabled"],Ga=["disabled"],Ya=["disabled"],qa=["disabled"],Ja={class:"excel-grid"},Xa={class:"flex items-center justify-between bg-gray-100 text-slate-800 px-2 py-1.5 text-xs font-semibold border-b border-slate-200 chart-header flex-shrink-0"},Ka={class:"whitespace-nowrap text-xs lg:hidden"},Qa={class:"flex items-center gap-1.5 flex-shrink-0"},Za={class:"hidden lg:inline"},ei=["value"],ti={class:"flex-1 p-3 overflow-hidden"},oi={class:"bg-white rounded-lg shadow-xl border border-slate-200 w-[420px]"},ni={class:"flex items-center justify-between px-4 py-2 border-b border-slate-200"},ri={class:"p-4"},ai={class:"excel-grid-debug"},ii={__name:"CalidadSectoresTabla",setup(e){no.register(...Pn,Rn);const t="".replace(/\/$/,""),o=t?`${t}/api`:"/api",n=new Date;n.setDate(n.getDate()-1);const r=`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`,a=V(r),f=V([]),u=V(!1),p=V(""),h=V(!1),d=V(!1),g=V(null),k=V(null),C=V(null),S=V([]),T=V("7/1 OE"),F=V(["7/1 OE"]),$=V(null),B=V(null),_=V(null),i=V(null),N=V(null),y=V(null),Y=V(null),oe=V(null),ee=V(null),G=V(!1),L=V(new Date().getMonth()),z=V(new Date().getFullYear()),q=V(null),me=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],ve=He(()=>{const l=new Date().getFullYear(),s=2020,c=[];for(let x=s;x<=l+1;x++)c.push(x);return c}),se=He(()=>{if(!a.value)return"";try{const[l,s,c]=a.value.split("-").map(Number);if(!l||!s||!c)return"";const x=new Date(l,s-1,c),O=["dom","lun","mar","mié","jue","vie","sáb"][x.getDay()],w=x.getDate().toString().padStart(2,"0"),M=(x.getMonth()+1).toString().padStart(2,"0"),W=x.getFullYear();return`${O} ${w}/${M}/${W}`}catch{return""}}),de=He(()=>{const l=[],s=new Date(z.value,L.value,1),c=new Date(z.value,L.value+1,0),x=new Date;x.setHours(0,0,0,0);let I=null;if(a.value){const[w,M,W]=a.value.split("-").map(Number);I=new Date(w,M-1,W)}for(let w=0;w<s.getDay();w++){const M=new Date(z.value,L.value,-s.getDay()+w+1);l.push({day:M.getDate(),otherMonth:!0,key:`prev-${w}`})}for(let w=1;w<=c.getDate();w++){const M=new Date(z.value,L.value,w);l.push({day:w,otherMonth:!1,selected:I&&I.getDate()===w&&I.getMonth()===L.value&&I.getFullYear()===z.value,today:x.getDate()===w&&x.getMonth()===L.value&&x.getFullYear()===z.value,key:`current-${w}`,date:M})}const O=42-l.length;for(let w=1;w<=O;w++)l.push({day:w,otherMonth:!0,key:`next-${w}`});return l});function ie(){if(G.value=!G.value,G.value&&a.value){const[l,s]=a.value.split("-").map(Number);L.value=s-1,z.value=l}}function be(l){L.value+=l,L.value>11?(L.value=0,z.value++):L.value<0&&(L.value=11,z.value--)}function Ee(l){if(l.otherMonth)return;const s=z.value,c=(L.value+1).toString().padStart(2,"0"),x=l.day.toString().padStart(2,"0");a.value=`${s}-${c}-${x}`,G.value=!1,Xe()}function Ye(l){L.value=parseInt(l.target.value)}function De(l){z.value=parseInt(l.target.value)}function Ae(l){if(!a.value)return;const[s,c,x]=a.value.split("-").map(Number),I=new Date(s,c-1,x);I.setDate(I.getDate()+l);const O=I.getFullYear(),w=(I.getMonth()+1).toString().padStart(2,"0"),M=I.getDate().toString().padStart(2,"0");a.value=`${O}-${w}-${M}`,Xe()}function Te(l){if(!a.value)return;const[s,c,x]=a.value.split("-").map(Number);let I=c+l,O=s;I>12?(I=1,O++):I<1&&(I=12,O--);const w=new Date(O,I,0).getDate(),M=O,W=I.toString().padStart(2,"0"),j=w.toString().padStart(2,"0");a.value=`${M}-${W}-${j}`,console.log(`🔄 Saltando al mes ${l>0?"siguiente":"anterior"}: ${a.value}`),Xe()}function Se(l){setTimeout(()=>{q.value&&!q.value.contains(document.activeElement)&&(G.value=!1)},250)}function Fe(l){q.value&&!q.value.contains(l.target)&&(G.value=!1)}const le=V({day:16667,month:49996}),xe=V({day:0,month:0}),H=V({day:{metros:0,rot103:0,meta:0},month:{metros:0,rot103:0,metaAcumulada:0}}),ne=V({rot103:1,estopaAzul:1.8}),ce=V({day:{porcentaje:0},month:{porcentaje:0}}),b=V({day:{metros:0,eficiencia:0,rotTra105:0,rotUrd105:0,estopaAzulPct:0,meta:0,metaEfi:0,metaRt105:0,metaRu105:0,metaEstopaAzul:0},month:{metros:0,eficiencia:0,rotTra105:0,rotUrd105:0,estopaAzulPct:0,metaAcumulada:0,metaEfi:0,metaRt105:0,metaRu105:0,metaEstopaAzul:0}}),U=V({day:{metros:0,encUrdPct:0,meta:0,metaEncUrd:-1.5},month:{metros:0,encUrdPct:0,metaAcumulada:0,metaEncUrd:-1.5}});Tn(T,(l,s)=>{h.value||(console.log(`🔄 Cambio manual de trama detectado: ${s} → ${l}`),Pt())}),Fn(()=>{Xe(),document.addEventListener("mousedown",Fe),zo(()=>{B.value&&Pe(B.value,{content:"Mes anterior (último día)",placement:"bottom",theme:"light-border",arrow:!0}),i.value&&Pe(i.value,{content:"Día anterior",placement:"bottom",theme:"light-border",arrow:!0}),N.value&&Pe(N.value,{content:"Día siguiente",placement:"bottom",theme:"light-border",arrow:!0}),_.value&&Pe(_.value,{content:"Mes siguiente (último día)",placement:"bottom",theme:"light-border",arrow:!0}),y.value&&Pe(y.value,{content:"Copiar gráfico al portapapeles",placement:"bottom",theme:"light-border",arrow:!0}),Y.value&&Pe(Y.value,{content:"Copiar tabla como imagen al portapapeles",placement:"bottom",theme:"light-border",arrow:!0}),oe.value&&Pe(oe.value,{content:"Seleccione una trama para filtrar el gráfico",placement:"bottom",theme:"light-border",arrow:!0}),ee.value&&Pe(ee.value,{content:"Seleccione una fecha: la tabla se calculará desde el inicio del mes hasta la fecha elegida. El gráfico se actualizará con el mismo período.",placement:"bottom",theme:"light-border",arrow:!0,maxWidth:280})})}),Mn(()=>{document.removeEventListener("mousedown",Fe),C.value&&C.value.destroy()});const rt=He(()=>{const l=at.value,s=R=>Ze.value.find(xt=>xt.sector===R)||{metrosDia:0,metrosMes:0,percDia:0,percMes:0,metaPct:0},c=s("S/ Def."),x=s("FIACAO"),I=s("INDIGO"),O=s("TECELAGEM"),w=s("ACABMTO"),M=s("GERAL"),W=Me.value.day,j=Me.value.month,P=R=>mt(R,0),K=R=>lt(R),Q=R=>lt(R),te=R=>vt(R);return[{id:"B5",rowIndex:1,colIndex:1,rowSpan:1,colSpan:3,text:l},{id:"E5",rowIndex:1,colIndex:4,rowSpan:1,colSpan:7,text:"Metros [m]"},{id:"L5",rowIndex:1,colIndex:11,rowSpan:1,colSpan:6,text:"Porcentaje [%]"},{id:"B6",rowIndex:2,colIndex:1,rowSpan:1,colSpan:3,text:"Sector"},{id:"E6",rowIndex:2,colIndex:4,rowSpan:1,colSpan:3,text:"Dia"},{id:"H6",rowIndex:2,colIndex:7,rowSpan:1,colSpan:4,text:"Acum."},{id:"L6",rowIndex:2,colIndex:11,rowSpan:1,colSpan:2,text:"Dia"},{id:"N6",rowIndex:2,colIndex:13,rowSpan:1,colSpan:2,text:"Mes"},{id:"P6",rowIndex:2,colIndex:15,rowSpan:1,colSpan:2,text:"Meta"},{id:"B7",rowIndex:3,colIndex:1,rowSpan:1,colSpan:3,text:"S/ Def."},{id:"E7",rowIndex:3,colIndex:4,rowSpan:1,colSpan:3,text:P(c.metrosDia)},{id:"H7",rowIndex:3,colIndex:7,rowSpan:1,colSpan:4,text:P(c.metrosMes)},{id:"L7",rowIndex:3,colIndex:11,rowSpan:1,colSpan:2,text:K(c.percDia)},{id:"N7",rowIndex:3,colIndex:13,rowSpan:1,colSpan:2,text:K(c.percMes)},{id:"P7",rowIndex:3,colIndex:15,rowSpan:1,colSpan:2,text:K(c.metaPct)},{id:"B8",rowIndex:4,colIndex:1,colSpan:3,rowSpan:1,text:"FIACAO"},{id:"E8",rowIndex:4,colIndex:4,colSpan:3,rowSpan:1,text:P(x.metrosDia)},{id:"H8",rowIndex:4,colIndex:7,colSpan:4,rowSpan:1,text:P(x.metrosMes)},{id:"L8",rowIndex:4,colIndex:11,colSpan:2,rowSpan:1,text:te(x.percDia)},{id:"N8",rowIndex:4,colIndex:13,colSpan:2,rowSpan:1,text:te(x.percMes)},{id:"P8",rowIndex:4,colIndex:15,rowSpan:1,colSpan:2,text:te(x.metaPct)},{id:"B9",rowIndex:5,colIndex:1,colSpan:3,rowSpan:1,text:"INDIGO"},{id:"E9",rowIndex:5,colIndex:4,colSpan:3,rowSpan:1,text:P(I.metrosDia)},{id:"H9",rowIndex:5,colIndex:7,colSpan:4,rowSpan:1,text:P(I.metrosMes)},{id:"L9",rowIndex:5,colIndex:11,colSpan:2,rowSpan:1,text:K(I.percDia)},{id:"N9",rowIndex:5,colIndex:13,colSpan:2,rowSpan:1,text:K(I.percMes)},{id:"P9",rowIndex:5,colIndex:15,rowSpan:1,colSpan:2,text:K(I.metaPct)},{id:"B10",rowIndex:6,colIndex:1,colSpan:3,rowSpan:1,text:"TECELAGEM"},{id:"E10",rowIndex:6,colIndex:4,colSpan:3,rowSpan:1,text:P(O.metrosDia)},{id:"H10",rowIndex:6,colIndex:7,colSpan:4,rowSpan:1,text:P(O.metrosMes)},{id:"L10",rowIndex:6,colIndex:11,colSpan:2,rowSpan:1,text:K(O.percDia)},{id:"N10",rowIndex:6,colIndex:13,colSpan:2,rowSpan:1,text:K(O.percMes)},{id:"P10",rowIndex:6,colIndex:15,rowSpan:1,colSpan:2,text:K(O.metaPct)},{id:"B11",rowIndex:7,colIndex:1,colSpan:3,rowSpan:1,text:"ACABMTO"},{id:"E11",rowIndex:7,colIndex:4,colSpan:3,rowSpan:1,text:P(w.metrosDia)},{id:"H11",rowIndex:7,colIndex:7,colSpan:4,rowSpan:1,text:P(w.metrosMes)},{id:"L11",rowIndex:7,colIndex:11,colSpan:2,rowSpan:1,text:K(w.percDia)},{id:"N11",rowIndex:7,colIndex:13,colSpan:2,rowSpan:1,text:K(w.percMes)},{id:"P11",rowIndex:7,colIndex:15,rowSpan:1,colSpan:2,text:K(w.metaPct)},{id:"B12",rowIndex:8,colIndex:1,colSpan:3,rowSpan:1,text:"GERAL"},{id:"E12",rowIndex:8,colIndex:4,colSpan:3,rowSpan:1,text:P(M.metrosDia)},{id:"H12",rowIndex:8,colIndex:7,colSpan:4,rowSpan:1,text:P(M.metrosMes)},{id:"L12",rowIndex:8,colIndex:11,colSpan:2,rowSpan:1,text:K(M.percDia)},{id:"N12",rowIndex:8,colIndex:13,colSpan:2,rowSpan:1,text:K(M.percMes)},{id:"P12",rowIndex:8,colIndex:15,rowSpan:1,colSpan:2,text:K(M.metaPct)},{id:"B13",rowIndex:9,colIndex:1,colSpan:3,rowSpan:1,text:"Revisado"},{id:"E13",rowIndex:9,colIndex:4,colSpan:3,rowSpan:1,text:P(W),color:W>=le.value.day?"#3C7D22":"#FF0000"},{id:"H13",rowIndex:9,colIndex:7,colSpan:4,rowSpan:1,text:P(j),color:j>=le.value.month?"#3C7D22":"#FF0000"},{id:"L13",rowIndex:9,colIndex:11,colSpan:2,rowSpan:1,text:"100"},{id:"N13",rowIndex:9,colIndex:13,colSpan:2,rowSpan:1,text:"100"},{id:"P13",rowIndex:9,colIndex:15,rowSpan:1,colSpan:2,text:"100"},{id:"B14",rowIndex:10,colIndex:1,colSpan:3,rowSpan:1,text:"Meta"},{id:"E14",rowIndex:10,colIndex:4,colSpan:3,rowSpan:1,text:P(le.value.day)},{id:"H14",rowIndex:10,colIndex:7,colSpan:4,rowSpan:1,text:P(le.value.month)},{id:"L14",rowIndex:10,colIndex:11,colSpan:2,rowSpan:2,text:"Pts 100²",wrapText:!0},{id:"N14",rowIndex:10,colIndex:13,colSpan:2,rowSpan:1,text:"Dia"},{id:"O14",rowIndex:10,colIndex:15,colSpan:2,rowSpan:1,text:"Mes"},{id:"B15",rowIndex:11,colIndex:1,colSpan:3,rowSpan:1,text:"Diferencia"},{id:"E15",rowIndex:11,colIndex:4,colSpan:3,rowSpan:1,text:(ye.value.day>=0?"+":"")+P(ye.value.day),color:ye.value.day>=0?"#3C7D22":"#FF0000"},{id:"H15",rowIndex:11,colIndex:7,colSpan:4,rowSpan:1,text:(ye.value.month>=0?"+":"")+P(ye.value.month),color:ye.value.month>=0?"#3C7D22":"#FF0000"},{id:"N15",rowIndex:11,colIndex:13,colSpan:2,rowSpan:1,text:te(xe.value.day)},{id:"O15",rowIndex:11,colIndex:15,colSpan:2,rowSpan:1,text:te(xe.value.month)},{id:"B16",rowIndex:12,colIndex:1,colSpan:1,rowSpan:1,text:"Sec",smallFont:!0,thickTopBorder:!0,thickBottomBorder:!0,bgColor:"#A6C9EC"},{id:"C16",rowIndex:12,colIndex:2,colSpan:2,rowSpan:1,text:"Variable",smallFont:!0,thickTopBorder:!0,thickBottomBorder:!0,bgColor:"#A6C9EC"},{id:"G16",rowIndex:12,colIndex:4,colSpan:3,rowSpan:1,text:"Meta Día",smallFont:!0,thickTopBorder:!0,thickBottomBorder:!0,bgColor:"#A6C9EC",wrapText:!0},{id:"J16",rowIndex:12,colIndex:7,colSpan:3,rowSpan:1,text:"Prod. Día",smallFont:!0,thickTopBorder:!0,thickBottomBorder:!0,bgColor:"#A6C9EC",wrapText:!0},{id:"M16",rowIndex:12,colIndex:10,colSpan:4,rowSpan:1,text:"Acumulado",smallFont:!0,thickTopBorder:!0,thickBottomBorder:!0,bgColor:"#A6C9EC"},{id:"P16",rowIndex:12,colIndex:14,colSpan:3,rowSpan:1,text:"Sob./Fal. Mes",smallFont:!0,thickTopBorder:!0,thickBottomBorder:!0,bgColor:"#A6C9EC",wrapText:!0},{id:"B17",rowIndex:13,colIndex:1,colSpan:1,rowSpan:3,text:"INDIGO",vertical:!0,bgColor:"#DAE9F8"},{id:"C17",rowIndex:13,colIndex:2,colSpan:2,rowSpan:1,text:"Metros",smallFont:!0,bgColor:"#DAE9F8",wrapText:!0},{id:"G17",rowIndex:13,colIndex:4,colSpan:3,rowSpan:1,text:P(H.value.day.meta),bgColor:"#DAE9F8"},{id:"J17",rowIndex:13,colIndex:7,colSpan:3,rowSpan:1,text:P(H.value.day.metros),color:H.value.day.metros>=H.value.day.meta?"#3C7D22":"#FF0000",bgColor:"#DAE9F8"},{id:"M17",rowIndex:13,colIndex:10,colSpan:4,rowSpan:1,text:P(H.value.month.metros),color:H.value.month.metros>=H.value.month.metaAcumulada?"#3C7D22":"#FF0000",bgColor:"#DAE9F8"},{id:"P17",rowIndex:13,colIndex:14,colSpan:3,rowSpan:1,text:(()=>{const R=H.value.month.metros-H.value.month.metaAcumulada;return(R>=0?"+":"")+P(R)})(),color:H.value.month.metros-H.value.month.metaAcumulada>=0?"#3C7D22":"#FF0000",bgColor:"#DAE9F8"},{id:"C18",rowIndex:14,colIndex:2,colSpan:2,rowSpan:1,text:"Roturas 10³",smallFont:!0,bgColor:"#DAE9F8",wrapText:!0},{id:"G18",rowIndex:14,colIndex:4,colSpan:3,rowSpan:1,text:K(ne.value.rot103),bgColor:"#DAE9F8"},{id:"J18",rowIndex:14,colIndex:7,colSpan:3,rowSpan:1,text:te(H.value.day.rot103),color:H.value.day.rot103<=ne.value.rot103?"#3C7D22":"#FF0000",bgColor:"#DAE9F8"},{id:"M18",rowIndex:14,colIndex:10,colSpan:4,rowSpan:1,text:te(H.value.month.rot103),color:H.value.month.rot103<=ne.value.rot103?"#3C7D22":"#FF0000",bgColor:"#DAE9F8"},{id:"P18",rowIndex:14,colIndex:14,colSpan:3,rowSpan:1,text:(()=>{const R=H.value.month.rot103-ne.value.rot103;return(R>=0?"+":"")+te(R)})(),color:ne.value.rot103-H.value.month.rot103>=0?"#3C7D22":"#FF0000",bgColor:"#DAE9F8"},{id:"C19",rowIndex:15,colIndex:2,colSpan:2,rowSpan:1,text:"Est. Azul %",smallFont:!0,bgColor:"#DAE9F8",thickBottomBorder:!0,wrapText:!0},{id:"G19",rowIndex:15,colIndex:4,colSpan:3,rowSpan:1,text:K(ne.value.estopaAzul),bgColor:"#DAE9F8",thickBottomBorder:!0},{id:"J19",rowIndex:15,colIndex:7,colSpan:3,rowSpan:1,text:te(ce.value.day.porcentaje),color:ce.value.day.porcentaje<=ne.value.estopaAzul?"#3C7D22":"#FF0000",bgColor:"#DAE9F8",thickBottomBorder:!0},{id:"M19",rowIndex:15,colIndex:10,colSpan:4,rowSpan:1,text:te(ce.value.month.porcentaje),color:ce.value.month.porcentaje<=ne.value.estopaAzul?"#3C7D22":"#FF0000",bgColor:"#DAE9F8",thickBottomBorder:!0},{id:"P19",rowIndex:15,colIndex:14,colSpan:3,rowSpan:1,text:(()=>{const R=ce.value.month.porcentaje-ne.value.estopaAzul;return(R>=0?"+":"")+te(R)})(),color:ne.value.estopaAzul-ce.value.month.porcentaje>=0?"#3C7D22":"#FF0000",bgColor:"#DAE9F8",thickBottomBorder:!0},{id:"B20",rowIndex:16,colIndex:1,colSpan:1,rowSpan:5,text:"TECELAGEM",vertical:!0,thinBorders:!0},{id:"C20",rowIndex:16,colIndex:2,colSpan:2,rowSpan:1,text:"Metros",smallFont:!0,wrapText:!0},{id:"G20",rowIndex:16,colIndex:4,colSpan:3,rowSpan:1,text:P(b.value.day.meta)},{id:"J20",rowIndex:16,colIndex:7,colSpan:3,rowSpan:1,text:P(b.value.day.metros),color:b.value.day.metros>=b.value.day.meta?"#3C7D22":"#FF0000"},{id:"M20",rowIndex:16,colIndex:10,colSpan:4,rowSpan:1,text:P(b.value.month.metros),color:b.value.month.metros>=b.value.month.metaAcumulada?"#3C7D22":"#FF0000"},{id:"P20",rowIndex:16,colIndex:14,colSpan:3,rowSpan:1,text:(()=>{const R=b.value.month.metros-b.value.month.metaAcumulada;return(R>=0?"+":"")+P(R)})(),color:b.value.month.metros-b.value.month.metaAcumulada>=0?"#3C7D22":"#FF0000"},{id:"C21",rowIndex:17,colIndex:2,colSpan:2,rowSpan:1,text:"Eficiencia %",smallFont:!0,wrapText:!0},{id:"G21",rowIndex:17,colIndex:4,colSpan:3,rowSpan:1,text:P(b.value.day.metaEfi)},{id:"J21",rowIndex:17,colIndex:7,colSpan:3,rowSpan:1,text:Q(b.value.day.eficiencia),color:b.value.day.eficiencia>=b.value.day.metaEfi?"#3C7D22":"#FF0000"},{id:"M21",rowIndex:17,colIndex:10,colSpan:4,rowSpan:1,text:Q(b.value.month.eficiencia),color:b.value.month.eficiencia>=b.value.month.metaEfi?"#3C7D22":"#FF0000"},{id:"P21",rowIndex:17,colIndex:14,colSpan:3,rowSpan:1,text:(()=>{const R=b.value.month.eficiencia-b.value.month.metaEfi;return(R>=0?"+":"")+Q(R)})(),color:b.value.month.eficiencia-b.value.month.metaEfi>=0?"#3C7D22":"#FF0000"},{id:"C22",rowIndex:18,colIndex:2,colSpan:2,rowSpan:1,text:"Rot. TRA 10⁵",smallFont:!0,wrapText:!0},{id:"G22",rowIndex:18,colIndex:4,colSpan:3,rowSpan:1,text:Q(b.value.day.metaRt105)},{id:"J22",rowIndex:18,colIndex:7,colSpan:3,rowSpan:1,text:Q(b.value.day.rotTra105),color:b.value.day.rotTra105<=b.value.day.metaRt105?"#3C7D22":"#FF0000"},{id:"M22",rowIndex:18,colIndex:10,colSpan:4,rowSpan:1,text:Q(b.value.month.rotTra105),color:b.value.month.rotTra105<=b.value.month.metaRt105?"#3C7D22":"#FF0000"},{id:"P22",rowIndex:18,colIndex:14,colSpan:3,rowSpan:1,text:(()=>{const R=b.value.month.rotTra105-b.value.month.metaRt105;return(R>=0?"+":"")+Q(R)})(),color:b.value.month.metaRt105-b.value.month.rotTra105>=0?"#3C7D22":"#FF0000"},{id:"C23",rowIndex:19,colIndex:2,colSpan:2,rowSpan:1,text:"Rot. URD 10⁵",smallFont:!0,wrapText:!0},{id:"G23",rowIndex:19,colIndex:4,colSpan:3,rowSpan:1,text:Q(b.value.day.metaRu105)},{id:"J23",rowIndex:19,colIndex:7,colSpan:3,rowSpan:1,text:Q(b.value.day.rotUrd105),color:b.value.day.rotUrd105<=b.value.day.metaRu105?"#3C7D22":"#FF0000"},{id:"M23",rowIndex:19,colIndex:10,colSpan:4,rowSpan:1,text:Q(b.value.month.rotUrd105),color:b.value.month.rotUrd105<=b.value.month.metaRu105?"#3C7D22":"#FF0000"},{id:"P23",rowIndex:19,colIndex:14,colSpan:3,rowSpan:1,text:(()=>{const R=b.value.month.rotUrd105-b.value.month.metaRu105;return(R>=0?"+":"")+Q(R)})(),color:b.value.month.metaRu105-b.value.month.rotUrd105>=0?"#3C7D22":"#FF0000"},{id:"C24",rowIndex:20,colIndex:2,colSpan:2,rowSpan:1,text:"Est. Azul %",smallFont:!0,wrapText:!0},{id:"G24",rowIndex:20,colIndex:4,colSpan:3,rowSpan:1,text:Q(b.value.day.metaEstopaAzul)},{id:"J24",rowIndex:20,colIndex:7,colSpan:3,rowSpan:1,text:Q(b.value.day.estopaAzulPct),color:b.value.day.estopaAzulPct<=b.value.day.metaEstopaAzul?"#3C7D22":"#FF0000"},{id:"M24",rowIndex:20,colIndex:10,colSpan:4,rowSpan:1,text:Q(b.value.month.estopaAzulPct),color:b.value.month.estopaAzulPct<=b.value.month.metaEstopaAzul?"#3C7D22":"#FF0000"},{id:"P24",rowIndex:20,colIndex:14,colSpan:3,rowSpan:1,text:(()=>{const R=b.value.month.metaEstopaAzul-b.value.month.estopaAzulPct;return(R>=0?"+":"")+Q(R)})(),color:b.value.month.metaEstopaAzul-b.value.month.estopaAzulPct>=0?"#3C7D22":"#FF0000"},{id:"B25",rowIndex:21,colIndex:1,colSpan:1,rowSpan:2,text:"ACAB",vertical:!0,bgColor:"#E8D5F0",thinBorders:!0},{id:"C25",rowIndex:21,colIndex:2,colSpan:2,rowSpan:1,text:"Metros",smallFont:!0,bgColor:"#E8D5F0",wrapText:!0},{id:"G25",rowIndex:21,colIndex:4,colSpan:3,rowSpan:1,text:P(U.value.day.meta),bgColor:"#E8D5F0"},{id:"J25",rowIndex:21,colIndex:7,colSpan:3,rowSpan:1,text:P(U.value.day.metros),color:U.value.day.metros>=U.value.day.meta?"#3C7D22":"#FF0000",bgColor:"#E8D5F0"},{id:"M25",rowIndex:21,colIndex:10,colSpan:4,rowSpan:1,text:P(U.value.month.metros),color:U.value.month.metros>=U.value.month.metaAcumulada?"#3C7D22":"#FF0000",bgColor:"#E8D5F0"},{id:"P25",rowIndex:21,colIndex:14,colSpan:3,rowSpan:1,text:(()=>{const R=U.value.month.metros-U.value.month.metaAcumulada;return(R>=0?"+":"")+P(R)})(),color:U.value.month.metros-U.value.month.metaAcumulada>=0?"#3C7D22":"#FF0000",bgColor:"#E8D5F0"},{id:"C26",rowIndex:22,colIndex:2,colSpan:2,rowSpan:1,text:"ENC URD %",smallFont:!0,bgColor:"#E8D5F0",thickBottomBorder:!0,wrapText:!0},{id:"G26",rowIndex:22,colIndex:4,colSpan:3,rowSpan:1,text:te(U.value.day.metaEncUrd),bgColor:"#E8D5F0",thickBottomBorder:!0},{id:"J26",rowIndex:22,colIndex:7,colSpan:3,rowSpan:1,text:te(U.value.day.encUrdPct),color:U.value.day.encUrdPct>=U.value.day.metaEncUrd?"#3C7D22":"#FF0000",bgColor:"#E8D5F0",thickBottomBorder:!0},{id:"M26",rowIndex:22,colIndex:10,colSpan:4,rowSpan:1,text:te(U.value.month.encUrdPct),color:U.value.month.encUrdPct>=U.value.month.metaEncUrd?"#3C7D22":"#FF0000",bgColor:"#E8D5F0",thickBottomBorder:!0},{id:"P26",rowIndex:22,colIndex:14,colSpan:3,rowSpan:1,text:(()=>{const R=U.value.month.encUrdPct-U.value.month.metaEncUrd;return(R>=0?"+":"")+te(R)})(),color:U.value.month.encUrdPct-U.value.month.metaEncUrd>=0?"#3C7D22":"#FF0000",bgColor:"#E8D5F0",thickBottomBorder:!0}]}),Me=He(()=>{const l=f.value.reduce((c,x)=>c+(Number(x.metrosDia)||0),0),s=f.value.reduce((c,x)=>c+(Number(x.metrosMes)||0),0);return{day:l,month:s}}),Ze=He(()=>{const l=Me.value.day||0,s=Me.value.month||0;return f.value.map(c=>({...c,percDia:l?c.metrosDia/l*100:0,percMes:s?c.metrosMes/s*100:0}))}),ye=He(()=>{const l=Me.value.day-le.value.day,s=Me.value.month-le.value.month;return{day:l,month:s,dayPct:le.value.day?l/le.value.day*100:0,monthPct:le.value.month?s/le.value.month*100:0}}),at=He(()=>it(a.value)),qe=He(()=>{if(!a.value)return"";const[l,s]=a.value.split("-");return`${["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"][parseInt(s)-1]} ${l}`});function Ne(l){const s=l.rowSpan||1,c=l.colSpan||1;return{gridRow:`${l.rowIndex} / span ${s}`,gridColumn:`${l.colIndex} / span ${c}`}}function je(l){const s=l.debugRowSpan||1,c=l.debugColSpan||1;return{gridRow:`${l.debugRowIndex} / span ${s}`,gridColumn:`${l.debugColIndex} / span ${c}`}}function et(l,s){return{...s,...l.color&&{color:l.color},...l.vertical&&{writingMode:"vertical-rl",textOrientation:"mixed",transform:"rotate(180deg)"},...l.smallFont&&{fontSize:"8pt"},...l.bgColor&&{background:l.bgColor},...l.thinBorders&&{borderLeft:"1px solid #0C769E",borderBottom:"1px solid #0C769E",borderTop:"1px solid #0C769E"},...l.thickTopBorder&&{borderTop:"2px solid #0C769E"},...l.thickBottomBorder&&{borderBottom:"2px solid #0C769E"},...l.noTopBorder&&{borderTop:"0"},...l.noBottomBorder&&{borderBottom:"0"},...l.wrapText&&{whiteSpace:"normal",wordBreak:"break-word",lineHeight:"1.1"}}}const Je=He(()=>{const l=["B17","C17","G17","J17"],s=new Map(rt.value.map(c=>[c.id,c]));return l.map((c,x)=>{const I=s.get(c);if(!I)return null;const O=1,w=x+1,{thickTopBorder:M,thickBottomBorder:W,thickLeftBorder:j,thickRightBorder:P,...K}=I;return{...K,debugRowIndex:O,debugColIndex:w,debugRowSpan:1,debugColSpan:1}}).filter(Boolean)});function it(l){if(!l)return"";const[s,c,x]=l.split("-").map(w=>parseInt(w,10));if(!s||!c||!x)return l;const I=new Date(s,c-1,x);return new Intl.DateTimeFormat("es-AR",{day:"2-digit",month:"short",year:"2-digit"}).format(I).replace(/ de /g,"-").replace(/\./g,"")}function mt(l,s=0){const c=new Intl.NumberFormat("es-AR",{minimumFractionDigits:s,maximumFractionDigits:s,useGrouping:!0}),x=typeof l=="number"?l:Number(l)||0;return c.format(x)}function lt(l){const s=new Intl.NumberFormat("es-AR",{minimumFractionDigits:1,maximumFractionDigits:1}),c=typeof l=="number"?l:Number(l)||0;return s.format(c)}function vt(l){const s=new Intl.NumberFormat("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2}),c=typeof l=="number"?l:Number(l)||0;return s.format(c)}async function Xe(l=!1){var s,c,x,I,O,w,M,W,j,P,K,Q,te,R,xt,Rt,he,re,ae,yt,$t,It,Bt,Nt,Lt,Ct,zt,Ut,Z,ue,jt,Wt,Co,Eo,Do,Ao,To,Fo,Mo,Oo;u.value=!0,h.value=!0,p.value="";try{const Ie=a.value,[Dn,An]=Ie.split("-"),st=`${Dn}-${An}-01`,dt=Ie;console.log(`📅 Cargando datos para fecha: ${Ie} (acumulado desde ${st} hasta ${dt})`);const Zt=await fetch(`${o}/calidad/sectores-resumen?date=${Ie}&monthStart=${st}&monthEnd=${dt}`);if(!Zt.ok)throw new Error(`HTTP ${Zt.status}`);const ko=await Zt.json(),Po=await fetch(`${o}/metas/resumen/${Ie}`);if(Po.ok){const A=await Po.json();le.value={day:Number(A.day||0),month:Number(A.month||0)},console.log(`🎯 Metas cargadas - Día: ${A.day}, Mes: ${A.month}`)}else console.warn("⚠️ No se encontraron metas para esta fecha, usando valores predeterminados"),le.value={day:0,month:0};const Ro=await fetch(`${o}/calidad/pts100m2?date=${Ie}&monthStart=${st}&monthEnd=${dt}`);if(Ro.ok){const A=await Ro.json();xe.value={day:Number(A.day||0),month:Number(A.month||0)},console.log(`📐 Pts 100m² cargados - Día: ${A.day.toFixed(1)}, Mes: ${A.month.toFixed(1)}`)}else console.warn("⚠️ No se pudieron calcular Pts 100m²"),xe.value={day:0,month:0};const $o=await fetch(`${o}/produccion/indigo-resumen?date=${Ie}&monthStart=${st}&monthEnd=${dt}`);if($o.ok){const A=await $o.json();H.value={day:{metros:Number(((s=A.day)==null?void 0:s.metros)||0),rot103:Number(((c=A.day)==null?void 0:c.rot103)||0),meta:Number(((x=A.day)==null?void 0:x.meta)||0)},month:{metros:Number(((I=A.month)==null?void 0:I.metros)||0),rot103:Number(((O=A.month)==null?void 0:O.rot103)||0),metaAcumulada:Number(((w=A.month)==null?void 0:w.metaAcumulada)||0)}},ne.value={rot103:Number(((M=A.day)==null?void 0:M.metaRot103)||((W=A.month)==null?void 0:W.metaRot103)||ne.value.rot103||0),estopaAzul:Number(((j=A.day)==null?void 0:j.metaEstopaAzul)||((P=A.month)==null?void 0:P.metaEstopaAzul)||ne.value.estopaAzul||0)},console.log(`🔵 INDIGO cargados - Día: ${H.value.day.metros} m, Meta: ${H.value.day.meta}, Rot: ${H.value.day.rot103.toFixed(2)}`),console.log(`🔵 INDIGO cargados - Mes: ${H.value.month.metros} m, Meta Acum: ${H.value.month.metaAcumulada}, Rot: ${H.value.month.rot103.toFixed(2)}`)}else console.warn("⚠️ No se pudieron cargar datos de INDIGO"),H.value={day:{metros:0,rot103:0,meta:0},month:{metros:0,rot103:0,metaAcumulada:0}};const Bo=await fetch(`${o}/produccion/estopa-azul?date=${Ie}&monthStart=${st}&monthEnd=${dt}`);if(Bo.ok){const A=await Bo.json();ce.value={day:{porcentaje:Number(((K=A.day)==null?void 0:K.porcentaje)||0)},month:{porcentaje:Number(((Q=A.month)==null?void 0:Q.porcentaje)||0)}},console.log(`🔷 Estopa Azul cargados - Día: ${ce.value.day.porcentaje.toFixed(2)}%, Mes: ${ce.value.month.porcentaje.toFixed(2)}%`)}else console.warn("⚠️ No se pudieron cargar datos de Estopa Azul"),ce.value={day:{porcentaje:0},month:{porcentaje:0}};const No=await fetch(`${o}/produccion/tecelagem-resumen?date=${Ie}&monthStart=${st}&monthEnd=${dt}`);if(No.ok){const A=await No.json();b.value={day:{metros:Number(((te=A.day)==null?void 0:te.metros)||0),eficiencia:Number(((R=A.day)==null?void 0:R.eficiencia)||0),rotTra105:Number(((xt=A.day)==null?void 0:xt.rotTra105)||0),rotUrd105:Number(((Rt=A.day)==null?void 0:Rt.rotUrd105)||0),estopaAzulPct:Number(((he=A.day)==null?void 0:he.estopaAzulPct)||0),meta:Number(((re=A.day)==null?void 0:re.meta)||0),metaEfi:Number(((ae=A.day)==null?void 0:ae.metaEfi)||0),metaRt105:Number(((yt=A.day)==null?void 0:yt.metaRt105)||0),metaRu105:Number((($t=A.day)==null?void 0:$t.metaRu105)||0),metaEstopaAzul:Number(((It=A.day)==null?void 0:It.metaEstopaAzul)||0)},month:{metros:Number(((Bt=A.month)==null?void 0:Bt.metros)||0),eficiencia:Number(((Nt=A.month)==null?void 0:Nt.eficiencia)||0),rotTra105:Number(((Lt=A.month)==null?void 0:Lt.rotTra105)||0),rotUrd105:Number(((Ct=A.month)==null?void 0:Ct.rotUrd105)||0),estopaAzulPct:Number(((zt=A.month)==null?void 0:zt.estopaAzulPct)||0),metaAcumulada:Number(((Ut=A.month)==null?void 0:Ut.metaAcumulada)||0),metaEfi:Number(((Z=A.month)==null?void 0:Z.metaEfi)||0),metaRt105:Number(((ue=A.month)==null?void 0:ue.metaRt105)||0),metaRu105:Number(((jt=A.month)==null?void 0:jt.metaRu105)||0),metaEstopaAzul:Number(((Wt=A.month)==null?void 0:Wt.metaEstopaAzul)||0)}},console.log(`🟢 TECELAGEM cargados - Día: ${b.value.day.metros} m, Efi: ${b.value.day.eficiencia.toFixed(1)}%`),console.log(`🟢 TECELAGEM cargados - Mes: ${b.value.month.metros} m, Efi: ${b.value.month.eficiencia.toFixed(1)}%`),console.log(`🟢 TECELAGEM Est. Azul - Día: ${b.value.day.estopaAzulPct}, Mes: ${b.value.month.estopaAzulPct}`)}else console.warn("⚠️ No se pudieron cargar datos de TECELAGEM"),b.value={day:{metros:0,eficiencia:0,rotTra105:0,rotUrd105:0,estopaAzulPct:0,meta:0,metaEfi:0,metaRt105:0,metaRu105:0,metaEstopaAzul:0},month:{metros:0,eficiencia:0,rotTra105:0,rotUrd105:0,estopaAzulPct:0,metaAcumulada:0,metaEfi:0,metaRt105:0,metaRu105:0,metaEstopaAzul:0}};const Lo=await fetch(`${o}/produccion/acabamento-resumen?date=${Ie}&monthStart=${st}&monthEnd=${dt}`);if(Lo.ok){const A=await Lo.json();U.value={day:{metros:Number(((Co=A.day)==null?void 0:Co.metros)||0),encUrdPct:Number(((Eo=A.day)==null?void 0:Eo.encUrdPct)||0),meta:Number(((Do=A.day)==null?void 0:Do.meta)||0),metaEncUrd:Number(((Ao=A.day)==null?void 0:Ao.metaEncUrd)||-1.5)},month:{metros:Number(((To=A.month)==null?void 0:To.metros)||0),encUrdPct:Number(((Fo=A.month)==null?void 0:Fo.encUrdPct)||0),metaAcumulada:Number(((Mo=A.month)==null?void 0:Mo.metaAcumulada)||0),metaEncUrd:Number(((Oo=A.month)==null?void 0:Oo.metaEncUrd)||-1.5)}},console.log(`🟣 ACABAMENTO cargados - Día: ${U.value.day.metros} m, ENC URD: ${U.value.day.encUrdPct.toFixed(2)}%`),console.log(`🟣 ACABAMENTO cargados - Mes: ${U.value.month.metros} m, ENC URD: ${U.value.month.encUrdPct.toFixed(2)}%`)}else console.warn("⚠️ No se pudieron cargar datos de ACABAMENTO"),U.value={day:{metros:0,encUrdPct:0,meta:0,metaEncUrd:-1.5},month:{metros:0,encUrdPct:0,metaAcumulada:0,metaEncUrd:-1.5}};if(Array.isArray(ko)){f.value=ko.map(Ke=>({sector:Ke.SECTOR||Ke.sector,metrosDia:Number(Ke.metrosDia||0),metrosMes:Number(Ke.metrosMes||0),metaPct:Number(Ke.metaPct||0)}));const A=f.value.reduce((Ke,eo)=>Ke+eo.metrosDia,0);console.log(`📊 Datos cargados - Día: ${A}, Mes: ${f.value.reduce((Ke,eo)=>Ke+eo.metrosMes,0)}`),A===0&&f.value.length===0&&(f.value=[{sector:"S/ Def.",metrosDia:0,metrosMes:0,metaPct:0},{sector:"FIACAO",metrosDia:0,metrosMes:0,metaPct:0},{sector:"INDIGO",metrosDia:0,metrosMes:0,metaPct:0},{sector:"TECELAGEM",metrosDia:0,metrosMes:0,metaPct:0},{sector:"ACABMTO",metrosDia:0,metrosMes:0,metaPct:0},{sector:"GERAL",metrosDia:0,metrosMes:0,metaPct:0}],console.log("⚠️ Sin datos para esta fecha - mostrando ceros")),p.value=""}else throw new Error("Formato inválido")}catch(Ie){console.error("Error:",Ie),p.value=`Error: ${Ie.message}`,f.value=[{sector:"S/ Def.",metrosDia:0,metrosMes:0,metaPct:0},{sector:"FIACAO",metrosDia:0,metrosMes:0,metaPct:0},{sector:"INDIGO",metrosDia:0,metrosMes:0,metaPct:0},{sector:"TECELAGEM",metrosDia:0,metrosMes:0,metaPct:0},{sector:"ACABMTO",metrosDia:0,metrosMes:0,metaPct:0},{sector:"GERAL",metrosDia:0,metrosMes:0,metaPct:0}]}finally{u.value=!1,h.value=!1,await Xt(),await Pt()}}async function Pt(){try{S.value=[];const l=a.value,[s,c]=l.split("-"),x=`${s}-${c}-01`,I=l,O=`${o}/produccion/eficiencia-roturas?date=${l}&monthStart=${x}&monthEnd=${I}&trama=${encodeURIComponent(T.value)}`;console.log(`📈 Cargando datos de gráfico desde ${x} hasta ${I}, trama: ${T.value}`),console.log(`🔗 URL: ${O}`);const w=await fetch(O);if(!w.ok){console.warn(`⚠️ No se pudieron cargar datos del gráfico - HTTP ${w.status}`),S.value=[],E();return}const M=await w.json();S.value=M,console.log(`📊 Datos de gráfico cargados: ${M.length} registros`),M.length>0&&(console.log("📅 Primer registro:",M[0]),console.log("📅 Último registro:",M[M.length-1])),await zo(),E()}catch(l){console.error("Error cargando datos del gráfico:",l),S.value=[],E()}}async function Xt(){try{const l=a.value,[s,c]=l.split("-"),x=`${s}-${c}-01`,I=l,O=`${o}/produccion/eficiencia-roturas?date=${l}&monthStart=${x}&monthEnd=${I}`;console.log(`🔍 Cargando tramas disponibles desde ${x} hasta ${I}`);const w=await fetch(O);if(!w.ok)return;const M=await w.json(),W=[...new Set(M.map(j=>j.trama))].filter(Boolean).sort();W.length>0&&(F.value=W,console.log(`📋 Tramas disponibles: ${W.join(", ")}`),W.includes(T.value)||(T.value=W[0]))}catch(l){console.error("Error cargando tramas disponibles:",l)}}const Le=ro.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:1500,timerProgressBar:!0,didOpen:l=>{l.onmouseenter=ro.stopTimer,l.onmouseleave=ro.resumeTimer}});async function Kt(){try{Le.fire({icon:"info",title:"Generando imagen...",timer:1500,showConfirmButton:!1}),console.log("📸 Generando imagen con Canvas 2D...");const l={fecha:at.value,sectores:Ze.value,totals:Me.value,metaTargets:le.value,differences:ye.value,pts100m2:xe.value,indigoData:H.value,indigoMetas:ne.value,estopaAzulData:ce.value,tecelagemData:b.value,acabamentoData:U.value};await Ia(l),Le.fire({icon:"success",title:"¡Imagen copiada!",text:"Pega con Ctrl+V donde quieras"}),console.log("✅ Imagen copiada al portapapeles con Canvas 2D")}catch(l){console.error("❌ Error copiando imagen:",l);try{console.log("⚠️ Intentando fallback con html2canvas..."),await Qt()}catch{Le.fire({icon:"error",title:"Error al copiar imagen",text:l.message})}}}async function Qt(){if(!$.value)throw new Error("Tabla no disponible");const s=$.value.querySelector(".excel-grid");if(!s)throw new Error("Grid no encontrado");const c=await $n(s,{backgroundColor:"#ffffff",scale:2,useCORS:!0,allowTaint:!0,logging:!1}),x=await new Promise((I,O)=>{c.toBlob(w=>{w?I(w):O(new Error("Error creando blob"))},"image/png",1)});if(navigator.clipboard&&navigator.clipboard.write){const I=new ClipboardItem({"image/png":x});await navigator.clipboard.write([I]),Le.fire({icon:"success",title:"¡Imagen copiada!",text:"Pega con Ctrl+V"})}else{const I=URL.createObjectURL(x),O=document.createElement("a");O.href=I,O.download=`tabla-calidad-${a.value}.png`,document.body.appendChild(O),O.click(),document.body.removeChild(O),URL.revokeObjectURL(I),Le.fire({icon:"info",title:"Imagen descargada",text:"Portapapeles no disponible"})}}async function v(){try{if(!g.value||!k.value||!S.value){console.error("❌ Elementos del gráfico no disponibles");return}console.log("📸 Generando gráfico optimizado con valores en la base...");const l=100,s=12,c=1,x=3,I=600,O=1100,w=document.createElement("canvas"),M=I*x-s*2*x-c*2*x,W=O*x-l*x-s*x-c*2*x;w.width=M,w.height=W;const j=Z=>{if(Z==null||Z==="")return 0;const ue=Number(String(Z).replace(",","."));return Number.isFinite(ue)?ue:0},P=S.value.map(Z=>{const[ue,jt,Wt]=Z.fecha.split("-");return`${Wt}-${jt}-${ue.slice(-2)}`}),K=S.value.map(Z=>j(Z.eficiencia)),Q=S.value.map(Z=>j(Z.rt105)),R=Math.max(...Q)*1.15,xt=w.getContext("2d"),Rt=new no(xt,{type:"bar",data:{labels:P,datasets:[{type:"bar",label:"Eficiencia %",data:K,backgroundColor:"rgba(56, 189, 248, 0.85)",borderColor:"rgba(56, 189, 248, 1)",borderWidth:0,borderRadius:6,maxBarThickness:18,yAxisID:"y",order:2,datalabels:{display:!0,align:"end",anchor:"start",color:"#1e293b",rotation:-90,font:{family:"Verdana",weight:"bold",size:43},formatter:Z=>{const ue=j(Z);return ue!==0?ue.toFixed(1):""}}},{type:"line",label:"RT105",data:Q,backgroundColor:"rgba(249, 115, 22, 0.15)",borderColor:"#f97316",borderWidth:2,pointRadius:3,pointHoverRadius:4,pointBackgroundColor:"#f97316",pointBorderWidth:0,yAxisID:"y1",order:1,tension:0,datalabels:{display:!0,align:"top",anchor:"end",offset:12,color:"#f97316",clip:!1,font:{family:"Verdana",weight:"bold",size:43},formatter:Z=>{const ue=j(Z);return ue!==0?ue.toFixed(1):""}}}]},options:{responsive:!1,maintainAspectRatio:!1,animation:!1,devicePixelRatio:x,plugins:{datalabels:{clip:!1},legend:{display:!1},title:{display:!1},tooltip:{enabled:!1}},scales:{x:{grid:{display:!1},ticks:{color:"#64748b",font:{family:"Verdana",size:35,weight:"bold"},autoSkip:!1,maxRotation:P.length>15?90:0,minRotation:P.length>15?90:0}},y:{type:"linear",display:!0,position:"left",grid:{color:"#f1f5f9",drawBorder:!1},ticks:{color:"#64748b",font:{family:"Verdana",size:39,weight:"bold"},callback:Z=>j(Z).toFixed(0)},min:0,max:100},y1:{type:"linear",display:!0,position:"right",grid:{drawOnChartArea:!1,drawBorder:!1},ticks:{color:"#f97316",font:{family:"Verdana",size:39,weight:"bold"},callback:Z=>j(Z).toFixed(1)},min:0,max:R}}}});await new Promise(Z=>setTimeout(Z,100));const he=document.createElement("canvas");he.width=I*x,he.height=O*x;const re=he.getContext("2d");re.fillStyle="#e2e8f0",re.fillRect(0,0,he.width,he.height);const ae=c*x;re.fillStyle="#ffffff",re.fillRect(ae,ae,he.width-ae*2,he.height-ae*2),re.fillStyle="#f3f4f6",re.fillRect(ae,ae,he.width-ae*2,l*x),re.strokeStyle="#e2e8f0",re.lineWidth=x,re.beginPath(),re.moveTo(ae,ae+l*x),re.lineTo(he.width-ae,ae+l*x),re.stroke();const yt=22*x;re.font=`600 ${yt}px Verdana, sans-serif`,re.fillStyle="#1e293b",re.textBaseline="top";const $t=`Eficiencia y RT105 - ${qe.value.substring(0,3)}-${qe.value.split(" ")[1]}`,It=ae+s*x;re.fillText($t,ae+s*x,It);const Bt=`Trama: ${T.value}`,Nt=It+yt+4*x;re.fillText(Bt,ae+s*x,Nt);const Lt=ae+s*x,Ct=ae+l*x,zt=he.width-ae*2-s*2*x,Ut=he.height-Ct-ae-s*x;re.drawImage(w,Lt,Ct,zt,Ut),Rt.destroy(),Le.fire({icon:"info",title:"Copiando gráfico...",timer:1500}),he.toBlob(async Z=>{try{await navigator.clipboard.write([new ClipboardItem({"image/png":Z})]),console.log("✅ Gráfico copiado (valores en la base)"),Le.fire({icon:"success",title:"Gráfico copiado!",text:"Con valores optimizados"})}catch(ue){console.error("❌ Error copiando al portapapeles:",ue),Le.fire({icon:"error",title:"Error al copiar",text:"Intenta de nuevo"})}},"image/png",1)}catch(l){console.error("❌ Error capturando gráfico:",l),Le.fire({icon:"error",title:"Error al capturar",text:"No se pudo generar la imagen"})}}function E(){if(!g.value)return;if(C.value){try{C.value.stop(),C.value.destroy()}catch{}C.value=null}if(!S.value||S.value.length===0){console.warn("⚠️ No hay datos para renderizar el gráfico");return}const l=S.value.map(w=>{const[M,W,j]=w.fecha.split("-");return`${j}-${W}-${M.slice(-2)}`}),s=w=>{if(w==null||w==="")return 0;const M=Number(String(w).replace(",","."));return Number.isFinite(M)?M:0},c=S.value.map(w=>s(w.eficiencia)),x=S.value.map(w=>s(w.rt105)),I=Math.max(...x),O=I*1.15;console.log(`🎨 Renderizando gráfico con ${l.length} puntos de datos`),console.log(`📊 Max RT105: ${I}, Scale Max: ${O.toFixed(2)}`),setTimeout(()=>{var w;try{const M=(w=g.value)==null?void 0:w.getContext("2d");if(!M){console.error("❌ No se pudo obtener el contexto del canvas");return}C.value=new no(M,{type:"bar",data:{labels:l,datasets:[{type:"bar",label:"Eficiencia %",data:c,backgroundColor:"rgba(56, 189, 248, 0.85)",borderColor:"rgba(56, 189, 248, 1)",borderWidth:0,borderRadius:6,maxBarThickness:18,yAxisID:"y",order:2,datalabels:{display:!0,align:"end",anchor:"end",color:"#64748b",rotation:-90,font:{family:"Verdana",weight:"normal",size:12},formatter:function(W){const j=s(W);return j!==0?j.toFixed(1):""}}},{type:"line",label:"RT105",data:x,backgroundColor:"rgba(249, 115, 22, 0.15)",borderColor:"#f97316",borderWidth:2,pointRadius:3,pointHoverRadius:4,pointBackgroundColor:"#f97316",pointBorderWidth:0,yAxisID:"y1",order:1,tension:0,datalabels:{display:!0,align:"top",anchor:"end",offset:6,color:"#f97316",clip:!1,font:{family:"Verdana",weight:"normal",size:12},formatter:function(W){const j=s(W);return j!==0?j.toFixed(1):""}}}]},options:{responsive:!0,maintainAspectRatio:!1,animation:!1,devicePixelRatio:3,interaction:{mode:"index",intersect:!1},plugins:{datalabels:{clip:!1},legend:{display:!1},title:{display:!1},tooltip:{enabled:!0,backgroundColor:"rgba(255, 255, 255, 0.98)",titleColor:"#1e293b",bodyColor:"#475569",borderColor:"#e2e8f0",borderWidth:1,cornerRadius:10,padding:10,boxPadding:4,usePointStyle:!0,titleFont:{family:"Verdana",size:11,weight:"600"},bodyFont:{family:"Verdana",size:10},callbacks:{label:function(W){let j=W.dataset.label||"";return j&&(j+=": "),W.parsed.y!==null&&(j+=W.parsed.y.toFixed(1)),j}}}},scales:{x:{grid:{display:!1},ticks:{color:"#64748b",font:{family:"Verdana",size:9},autoSkip:!1,maxRotation:l.length>15?90:0,minRotation:l.length>15?90:0,maxTicksLimit:void 0}},y:{type:"linear",display:!0,position:"left",title:{display:!1},ticks:{color:"#64748b",font:{family:"Verdana",size:9}},grid:{display:!0,color:"rgba(148, 163, 184, 0.25)"}},y1:{type:"linear",display:!0,position:"right",max:O,title:{display:!1},ticks:{color:"#64748b",font:{family:"Verdana",size:9}},grid:{drawOnChartArea:!1}}},layout:{padding:{top:6,bottom:0,left:0,right:0}}}})}catch(M){console.error("❌ Error renderizando gráfico:",M)}},200)}return(l,s)=>(pe(),fe(tt,null,[D("div",Ca,[u.value?(pe(),fe("div",Ea,[D("div",Da,[s[18]||(s[18]=D("div",{class:"relative"},[D("div",{class:"animate-spin rounded-full h-16 w-16 border-4 border-blue-50 border-t-blue-600"}),D("div",{class:"absolute inset-0 flex items-center justify-center"},[D("div",{class:"h-8 w-8 bg-blue-600 rounded-full animate-pulse opacity-10"})])],-1)),D("div",Aa,[s[17]||(s[17]=D("span",{class:"text-slate-500 font-medium tracking-wider uppercase text-[10px]"},"Cargando datos de",-1)),D("span",Ta,We(se.value),1)])])])):to("",!0),D("div",Fa,[D("div",Ma,[D("div",Oa,[D("div",ka,[D("div",Pa,[D("div",{class:"custom-datepicker",ref_key:"datepickerRef",ref:q},[D("input",{ref_key:"datepickerInputRef",ref:ee,type:"text",value:se.value,class:"datepicker-input-compact",placeholder:"Selecciona una fecha",onClick:ie,onKeydown:[s[0]||(s[0]=Uo(Oe(c=>Ae(-1),["prevent"]),["left"])),s[1]||(s[1]=Uo(Oe(c=>Ae(1),["prevent"]),["right"]))],onBlur:Se,readonly:""},null,40,Ra),D("span",{class:"calendar-icon",onClick:ie},"📅"),G.value?(pe(),fe("div",$a,[D("div",Ba,[D("button",{class:"calendar-nav-btn",onClick:s[2]||(s[2]=Oe(c=>be(-1),["stop"]))},"<"),D("div",Na,[D("select",{value:L.value,onChange:Ye,onClick:s[3]||(s[3]=Oe(()=>{},["stop"])),class:"calendar-select"},[(pe(),fe(tt,null,ct(me,(c,x)=>D("option",{key:x,value:x},We(c),9,za)),64))],40,La),D("select",{value:z.value,onChange:De,onClick:s[4]||(s[4]=Oe(()=>{},["stop"])),class:"calendar-select"},[(pe(!0),fe(tt,null,ct(ve.value,c=>(pe(),fe("option",{key:c,value:c},We(c),9,ja))),128))],40,Ua)]),D("button",{class:"calendar-nav-btn",onClick:s[5]||(s[5]=Oe(c=>be(1),["stop"]))},">")]),D("div",Wa,[(pe(),fe(tt,null,ct(["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"],c=>D("span",{key:c},We(c),1)),64))]),D("div",Ha,[(pe(!0),fe(tt,null,ct(de.value,c=>(pe(),fe("button",{key:c.key,class:oo(["calendar-day",{"other-month":c.otherMonth,selected:c.selected,today:c.today}]),onClick:Oe(x=>Ee(c),["stop"]),disabled:c.otherMonth},We(c.day),11,Va))),128))])])):to("",!0)],512),D("button",{ref_key:"prevMonthBtnRef",ref:B,class:"inline-flex items-center justify-center px-1.5 py-1.5 border border-slate-300 bg-gradient-to-b from-slate-50 to-slate-100 text-slate-700 rounded text-xs font-bold hover:from-slate-100 hover:to-slate-200 transition-all duration-150",onClick:s[6]||(s[6]=c=>Te(-1)),onMousedown:s[7]||(s[7]=Oe(()=>{},["prevent"])),tabindex:"-1",disabled:u.value},"<<",40,_a),D("button",{ref_key:"prevDayBtnRef",ref:i,class:"inline-flex items-center justify-center px-1.5 py-1.5 border border-slate-300 bg-gradient-to-b from-slate-50 to-slate-100 text-slate-700 rounded text-xs font-bold hover:from-slate-100 hover:to-slate-200 transition-all duration-150",onClick:s[8]||(s[8]=c=>Ae(-1)),onMousedown:s[9]||(s[9]=Oe(()=>{},["prevent"])),tabindex:"-1",disabled:u.value},"<",40,Ga),D("button",{ref_key:"nextDayBtnRef",ref:N,class:"inline-flex items-center justify-center px-1.5 py-1.5 border border-slate-300 bg-gradient-to-b from-slate-50 to-slate-100 text-slate-700 rounded text-xs font-bold hover:from-slate-100 hover:to-slate-200 transition-all duration-150",onClick:s[10]||(s[10]=c=>Ae(1)),onMousedown:s[11]||(s[11]=Oe(()=>{},["prevent"])),tabindex:"-1",disabled:u.value},">",40,Ya),D("button",{ref_key:"nextMonthBtnRef",ref:_,class:"inline-flex items-center justify-center px-1.5 py-1.5 border border-slate-300 bg-gradient-to-b from-slate-50 to-slate-100 text-slate-700 rounded text-xs font-bold hover:from-slate-100 hover:to-slate-200 transition-all duration-150",onClick:s[12]||(s[12]=c=>Te(1)),onMousedown:s[13]||(s[13]=Oe(()=>{},["prevent"])),tabindex:"-1",disabled:u.value},">>",40,qa)]),D("button",{ref_key:"copyTableBtnRef",ref:Y,onClick:Kt,class:"inline-flex items-center justify-center w-8 h-8 text-slate-500 hover:text-slate-700 hover:bg-slate-100 rounded transition-colors duration-150"},[...s[19]||(s[19]=[D("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[D("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)])],512)]),D("div",{ref_key:"excelTableRef",ref:$,class:"overflow-auto flex-1 min-h-0 excel-wrapper"},[D("div",Ja,[(pe(!0),fe(tt,null,ct(rt.value,c=>(pe(),fe("div",{key:c.id,class:oo(["excel-cell",[`cell-${c.id}`,c.colorClass,{"wrap-text":c.wrapText}]]),style:jo(et(c,Ne(c)))},We(c.text),7))),128))])],512)]),D("div",{ref_key:"chartContainerRef",ref:k,class:"flex-1 min-h-0 shadow border border-slate-200 rounded bg-white flex flex-col overflow-hidden"},[D("div",Xa,[s[22]||(s[22]=D("span",{class:"whitespace-nowrap hidden xl:block"},"Eficiencias y Roturas de Trama 105 - Tejeduría",-1)),s[23]||(s[23]=D("span",{class:"whitespace-nowrap hidden lg:block xl:hidden"},"Efic. y RT105 - Tejeduría",-1)),D("span",Ka,"Efic. y RT105 - "+We(qe.value),1),D("div",Qa,[D("span",Za,We(qe.value),1),s[21]||(s[21]=D("span",{class:"hidden lg:inline"},"-",-1)),On(D("select",{ref_key:"tramaSelectRef",ref:oe,"onUpdate:modelValue":s[14]||(s[14]=c=>T.value=c),class:"px-2 py-1 text-xs border border-slate-300 rounded bg-white text-slate-800 font-normal hover:border-slate-400 focus:outline-none focus:ring-1 focus:ring-blue-500"},[(pe(!0),fe(tt,null,ct(F.value,c=>(pe(),fe("option",{key:c,value:c},We(c),9,ei))),128))],512),[[kn,T.value]]),D("button",{ref_key:"copyBtnRef",ref:y,onClick:v,class:"inline-flex items-center justify-center w-8 h-8 text-slate-500 hover:text-slate-700 hover:bg-slate-100 rounded transition-colors duration-150"},[...s[20]||(s[20]=[D("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[D("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)])],512)])]),D("div",ti,[D("canvas",{ref_key:"chartCanvas",ref:g},null,512)])],512)])])]),d.value?(pe(),fe("div",{key:0,class:"fixed inset-0 z-[999] flex items-center justify-center bg-black/40",onClick:s[16]||(s[16]=Oe(c=>d.value=!1,["self"]))},[D("div",oi,[D("div",ni,[s[24]||(s[24]=D("span",{class:"text-sm font-semibold text-slate-700"},"Depuración de bordes (INDIGO / TECELAGEM)",-1)),D("button",{class:"text-slate-500 hover:text-slate-700",onClick:s[15]||(s[15]=c=>d.value=!1)},"✕")]),D("div",ri,[D("div",ai,[(pe(!0),fe(tt,null,ct(Je.value,c=>(pe(),fe("div",{key:`debug-${c.id}`,class:oo(["excel-cell",[`cell-${c.id}`,c.colorClass]]),style:jo(et(c,je(c)))},We(c.text),7))),128))]),s[25]||(s[25]=D("p",{class:"mt-3 text-xs text-slate-500"},"Este recorte usa las mismas celdas y estilos de la tabla (B17/C17/G17/J17).",-1))])])])):to("",!0)],64))}},mi=Bn(ii,[["__scopeId","data-v-a354b0bb"]]);export{mi as default};
